% Atiyah-MacDonald-25b
% !TEX encoding = UTF-8 Unicode
% https://docs.google.com/document/d/1qY50h1OrJgKLaqmX8YR0bmc0EbD8Ar0YSAvQMz7cLSQ/edit?tab=t.0
% https://www.site24x7.com/tools/time-stamp-converter.html 1749558176
% https://github.com/Pierre-Yves-Gaillard/Atiyah_MacDonald_c
% version a of 20180208 https://docs.google.com/document/d/1p2ri2Mu-zyF7-Gk1eeJ4f0OinG0BPXZEAsljF3af2zs/edit
\documentclass[12pt,letterpaper]{article}%\documentclass{article} % old
%\documentclass[parskip=half,fontsize=12pt]{scrartcl}%\documentclass[parskip=full]{scrartcl} % variable
%\documentclass[fontsize=12pt]{scrartcl} % variable
\usepackage{fancyhdr}
\fancyhf{}
\fancyfoot[R]{{\tiny Atiyah-MacDonald-25b,\ \filemodprintdate{\jobname},\ \filemodprinttime{\jobname},\ 1749558176}} 
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[C]{\thepage}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsmath,amsthm} 
\usepackage[letterpaper,top=50pt,left=55pt,right=55pt,bottom=100pt]{geometry}% previous:\usepackage[top=60pt,left=50pt,right=50pt,bottom=110pt]{geometry}% previous:\usepackage[top=90pt,left=50pt,right=50pt,bottom=120pt]{geometry}% print
%\usepackage[top=90pt,left=50pt,right=50pt,bottom=90pt]{geometry}
%\usepackage{geometry}% normal
%\usepackage[papersize={400pt,520pt},margin=15pt]{geometry} e-readers \usepackage[margin=15pt]{geometry}\usepackage[papersize={4.5in,6in},margin=0.5cm]{geometry} old
%\usepackage[parfill]{parskip}%https://tex.stackexchange.com/questions/133003/using-the-parskip-package-i-find-the-space-between-subtitles-ugly
%\usepackage{datetime}
%\usepackage{fancyhdr}
\usepackage{filemod}
\usepackage{microtype}
%\usepackage{mathptmx}
%%\usepackage[osf]{Baskervaldx} % oldstyle figures
%\usepackage{Baskervaldx}
%%\usepackage[baskervaldx]{newtxmath}
\usepackage{tikz-cd}
\usepackage{comment}
%\usepackage[dvipsnames]{xcolor} % creates clashes !!!
\usepackage[pdfusetitle]{hyperref}
\setlength{\parskip}{5pt} % variable
%\fancyhf{}%https://tex.stackexchange.com/a/91357/8816
%\renewcommand{\headrulewidth}{0pt}%https://tex.stackexchange.com/a/13897/8816
%\fancyfoot[C]{\thepage}
%\fancyfoot[R]{{\tiny\today\ \currenttime}}
\pagestyle{fancy}
%\pagestyle{empty}
%\newcommand{\nn}{\newcommand}
\newcommand{\oo}{\operatorname}\newcommand{\ooo}{\operatorname*}
\newcommand{\mb}{\mathbb}\newcommand{\mbb}{\mathbb}
\newcommand{\mc}{\mathcal}
\newcommand{\mf}{\mathfrak}
\newcommand{\aaa}{\mf a}
\newcommand{\bbb}{\mf b}
\newcommand{\ccc}{\mf c}
\newcommand{\mmm}{\mf m}
\newcommand{\nnn}{\mf n}
\newcommand{\ppp}{\mf p}
\newcommand{\qqq}{\mf q}
\newcommand{\NNN}{\mf N}\newcommand{\RRR}{\mf R}
\newcommand{\Ann}{\oo{Ann}}
\newcommand{\Ass}{\oo{Ass}}
\newcommand{\ov}{\overline}
\newcommand{\bu}{\bullet}
\DeclareMathOperator*{\colim}{colim}
\newcommand{\ds}{\displaystyle}
\newcommand{\epi}{\twoheadrightarrow}
\newcommand{\id}{\oo{id}}\newcommand{\Id}{\oo{Id}}
\newcommand{\incl}{\hookrightarrow}
\newcommand{\Ker}{\operatorname{Ker}}\newcommand{\Coker}{\operatorname{Coker}}
\newcommand{\mono}{\rightarrowtail}
\newcommand{\Spec}{\operatorname{Spec}}\newcommand{\Sp}{\operatorname{Spec}}
\newcommand{\Supp}{\operatorname{Supp}}
\newcommand{\Tor}{\operatorname{Tor}}
\newcommand{\xr}{\xrightarrow}
\newcommand{\nn}{\noindent}
\newcommand{\Z}{\mathbb Z}
%\newcommand{\lttr}{Left to the reader.}
%\newcommand{\todo}{To do: }%\newcommand{\up}{Unsolved problem: }
%\newcommand{\nt}{\newtheorem}
\newtheorem{thm}{Theorem}%[section]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{claim}[thm]{Claim}
\newtheorem{df}[thm]{Definition}
%\newtheorem{exo}[thm]{Exercise}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{note}[thm]{Note}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{qn}[thm]{Question}
%\newtheorem{rk}[thm]{Remark}
%\addtolength{\parskip}{.2\baselineskip}
%\title{About Atiyah and MacDonald's Book}\author{Pierre-Yves Gaillard}
%\date{\today,\currenttime}

\begin{document}%\ar[r,yshift=0.9ex]\ar[r,yshift=-0.9ex]%\ar[r,yshift=4pt]\large%{\oo c}

\begin{center}{\Huge About Atiyah and MacDonald's Book}\bigskip 

Pierre-Yves Gaillard\footnote{DOI 10.5281/zenodo.6498378. Links to this text: \href{https://zenodo.org/record/6498378}{Zenodo}, \href{https://github.com/Pierre-Yves-Gaillard/Atiyah_MacDonald_c}{GitHub} (the GitHub version, being updated more often, is the ``official'' version). My texts at: \href{https://tinyurl.com/3r5vscy8}{Zenodo}, \href{https://orcid.org/0000-0002-7960-1698}{ORCID}, \href{https://vixra.org/author/pierre-yves_gaillard}{viXra}. Email: pierre.yves.gaillard at gmail.com.} 
\end{center}

%\maketitle%\nn The last version is available at \href{https://tinyurl.com/yxb32wmu}{https://tinyurl.com/yxb32wmu} 

\tableofcontents

\newpage

\section{Introduction}\label{intro}%%\section\subsection\subsubsection\paragraph\subparagraph

Atiyah and MacDonald's book referred to in the title is of course the famous \textbf{Introduction to Commutative Algebra}. 

Here are some links to texts related to this book: 

\nn$\bu$ Errata \href{https://mathoverflow.net/q/42241/461}{https://mathoverflow.net/q/42241/461}

\nn$\bu$ Allen Altman and Steven Kleiman, A term of Commutative Algebra, \\ \href{https://www.researchgate.net/publication/325591008_A_term_of_Commutative_Algebra}{https://www.researchgate.net/publication/325591008\_A\_term\_of\_Commutative\_Algebra}\\ See also \href{https://mathoverflow.net/a/385313/461}{https://mathoverflow.net/a/385313/461} % \href{http://web.mit.edu/18.705/www/13Ed.pdf}{http://web.mit.edu/18.705/www/13Ed.pdf} \href{http://web.mit.edu/18.705/www/}{http://web.mit.edu/18.705/www/} Flores \href{http://www.math.ku.edu/~zflores/mathematics.html}{http://www.math.ku.edu/$\sim$zflores/mathematics.html}\\ Many parts of the present text are taken from the wonderful text 

\nn$\bu$ Jeffrey Daniel Kasik Carlson, Exercises to Atiyah and MacDonald's Introduction to Commutative Algebra, %by Jeffrey Daniel Kasik Carlson,
\href{https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf}{https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf} % previous: https://goo.gl/WEfMG7 %Here are some other links: \nn$\bu$ \href{https://sites.google.com/view/mathlife1}{https://sites.google.com/view/mathlife1}https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf

\nn$\bu$ Thomas Lam and Dustin Clausen\\\href{http://abel.math.harvard.edu/archive/221_spring_08/Math221.html}{http://abel.math.harvard.edu/archive/221\_spring\_08/Math221.html}

\nn$\bu$ Brent R. Doran\\\href{https://www2.math.ethz.ch/education/bachelor/lectures/hs2014/math/comm_alg.html}{https://www2.math.ethz.ch/education/bachelor/lectures/hs2014/math/comm\_alg.html} 

\nn$\bu$ Thomas J. Haines, Lectures on Commutative Algebra \\\href{http://www.math.umd.edu/~tjh/CommAlg.pdf}{http://www.math.umd.edu/$\sim$tjh/CommAlg.pdf}

%\nn$\bu$ Byeongsu Yu\\\href{https://www.math.tamu.edu/~byeongsu.yu/_pdf/Atiyah_Macdonald_Supplement.pdf}{https://www.math.tamu.edu/$\sim$byeongsu.yu/\_pdf/Atiyah\_Macdonald\_Supplement.pdf}

\nn$\bu$ Sarah Glaz \href{https://www2.math.uconn.edu/~glaz/math5020f14/}{https://www2.math.uconn.edu/$\sim$glaz/math5020f14/}

\nn$\bu$ Athanasios Papaioannou, Solutions to Atiyah and MacDonald’s Introduction to Commutative Algebra \href{https://tinyurl.com/r3y453b}{https://tinyurl.com/r3y453b}% \href{shorturl.at/mqzH9}{shorturl.at/mqzH9} https://tinyurl.com/r3y453b \href{https://dangtuanhiep.files.wordpress.com/2008/09/papaioannoua_solutions_to_atiyah.pdf}{https://dangtuanhiep.files.wordpress.com/2008/09/papaioannoua\_solutions\_to\_atiyah.pdf}

\nn$\bu$ Shengtian Yang, \href{http://arxiv.codlab.net/book/note-am-ica/note-am-ica_0.1.2.pdf}{\small http://arxiv.codlab.net/book/note-am-ica/note-am-ica\_0.1.2.pdf}% --- \\ \href{http://www.yangst.codlab.net}{http://www.yangst.codlab.net}

%\nn$\bu$ Yongwei Yao \href{http://www2.gsu.edu/~matyxy/math831/}{http://www2.gsu.edu/$\sim$matyxy/math831/} %\nn$\bu$ Takumi Murayama \href{http://www2.gsu.edu/~matyxy/math831/math831.html}{http://www2.gsu.edu/$\sim$matyxy/math831/math831.html}

%\nn$\bu$ Boocher \href{http://www.maths.ed.ac.uk/~aboocher/math/AMnotes.pdf}{\small http://www.maths.ed.ac.uk/$\sim$aboocher/math/AMnotes.pdf}

%\nn$\bu$ Wiki \href{http://am-solutions.wikispaces.com}{http://am-solutions.wikispaces.com}

\nn$\bu$ Dave Karpuk\\\href{https://mycourses.aalto.fi/pluginfile.php/426996/mod_resource/content/1/chap1solutions.pdf}{https://mycourses.aalto.fi/pluginfile.php/426996/mod\_resource/content/1/chap1solutions.pdf}

\nn$\bu$ Joshua Ruiter \href{https://tinyurl.com/3hj9btp3}{https://tinyurl.com/3hj9btp3} %https://users.math.msu.edu/users/ruiterj2/Math/Documents/Fall%202018/Commutative%20Algebra/Commutative%20Algebra%20Homework%201.pdf

\nn$\bu$ J. David Taylor\\\href{https://www.math.arizona.edu/~jtaylor/notes/atiyah_macdonald_solutions.pdf}{https://www.math.arizona.edu/$\sim$jtaylor/notes/atiyah\_macdonald\_solutions.pdf} 
\bigskip 

Thank you to Rafał Michalski for his help!

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 1

\newpage

\section{About Chapter~1}%%%

\subsection{Comments}%%

\subsubsection{Page 6}%

Proposition~1.9 will be used several times below. Here is the statement:

\begin{prop}[Proposition~1.9]\label{p1.9}
$x\in\RRR\iff1-xy$ is a unit in $A$ for all $y\in A$.
\end{prop}
[Recall that $\RRR$ is the Jacobson radical of $A$.]

\begin{note}\label{ef}
The intersection and the product of the empty family of ideals is the unit ideal.
\end{note}

It is written

\nn\emph{In the ring $\mathbb Z$, $\cap$ and + are distributive over each other. This is not the case in general.}

Here is an example: In the ring $K[x,y]$, where $K$ is a field and $x$ and $y$ are indeterminates, we have 
$$
(x+y)\cap\Big((x)+(y)\Big)\not\subset\Big((x+y)\cap (x)\Big)+\Big((x+y)\cap (y)\Big).
$$

\subsubsection{Page 7, Proposition~1.10}%

\nn\textbf{Chinese Remainder Theorem.} \emph{Let $A$ be a commutative ring and $\aaa_1,\dots,\aaa_n$ ideals such that $\aaa_i+\aaa_j=A$ for $i\not=j$. Then the natural morphism from $A$ to the product of the $A/\aaa_i$ is surjective. Moreover the intersection of the $\aaa_i$ coincides with their product.}

\begin{proof} 
We have
\begin{equation}\label{crt}
A=\aaa_1+\aaa_2\cdots\aaa_n.
\end{equation}
Indeed, this can be checked either by multiplying together the equalities $A=\aaa_1+\aaa_i$ for $i=2,\dots,n$, or by noting that a prime ideal containing a product of ideals contains one of the factors. Then \eqref{crt} implies the existence of an $a_1$ in $A$ such that $a_1\equiv1\bmod\aaa_1$ and $a_1\equiv0\bmod \aaa_i$ for all $i>1$. Similarly we can find elements $a_i$ in $A$ such that $a_i\equiv\delta_{ij}\bmod \aaa_j$ (Kronecker delta). This proves the first claim.

Let $\aaa$ be the intersection of the $\aaa_i$. Multiplying \eqref{crt} by $\aaa$ we get
$$
\aaa=
\aaa_1\aaa+
\aaa\aaa_2\cdots\aaa_n\subset
\aaa_1\ (\aaa_2\cap\cdots \cap \aaa_n)\subset \aaa.
$$
This gives the second claim, directly for $n=2$, by induction for $n>2$. 
\end{proof}

\subsubsection{Page 8}%

\nn$\bu$ \textbf{Proposition~1.11i, Prime Avoidance}

The following is taken from Wikipedia:

\href{https://en.wikipedia.org/wiki/Prime_avoidance_lemma}{https://en.wikipedia.org/wiki/Prime\_avoidance\_lemma}

\nn\emph{Let $A$ be a commutative ring and $S$ a multiplicatively closed additive subgroup of $A$. Let $\aaa_1,\dots,\aaa_n$, $n\ge1$ be ideals such that $\aaa_i$ is prime for $i\ge3$. If $S$ is not contained in any $\aaa_i$, then $S$ is not contained in their union.}

\begin{proof} 
We argue by induction on $n$. It suffices to find an element $s$ that is in $S$ and not in $\aaa_i$ for any $i$. 

\nn1. The case $n=1$ is trivial. 

\nn2. Suppose $n\ge2$. For each $i$ choose $s_i$ in $S\setminus\bigcup_{j \ne i}\aaa_j$, this set being nonempty by inductive hypothesis. We can assume $s_i \in \aaa_i$ for all $i$; otherwise, some $s_i$ avoids all the $\aaa_j$'s and we are done. 

\nn Claim: the element $s:=s_1\cdots s_{n-1}+s_n$ is in $S$ but not in $\aaa_i$ for any $i$. 

\nn2.1. If $s$ is in $\aaa_i$ for some $i\le n-1$, then $s_n$ is in $\aaa_i$, contradiction. 

\nn2.2. If $s$ is in $\aaa_n$, then $s_1\cdots s_{n-1}$ is in $\aaa_n$. 

\nn2.2.1. If $n$ is 2, we get $s_1\in \aaa_2$, contradiction.

\nn2.2.2. If $n>2$ then, since $\aaa_n$ is prime, there is an $i$ less than $n$ such that $s_i$ is in $\aaa_n$, contradiction.

\nn This proves the claim, and thus the statement. 
\end{proof}

Here is a version which is slightly weaker but sufficient for our purpose:

\begin{prop}[Proposition~1.11i p.~8 of the book]\label{p1.11i}
Let $A$ be a ring, let $\aaa$ be an ideal, and let $\ppp_1,\dots,\ppp_n,n\ge1$ be prime ideals. If $\aaa$ is not contained in any $\ppp_i$, then $\aaa$ is not contained in their union.
\end{prop}
\begin{proof} 
We can assume that $n\ge2$ and that there are elements $a_1,\dots,a_n$ in $\aaa$ such that 
$$
a_i\in\ppp_i\setminus\bigcup_{j\ne i}\ppp_j.
$$ 
Then $a:=a_1\cdots a_{n-1}+a_n$ is in $\aaa$ but not in $\ppp_i$ for any $i$.
\end{proof}

%About the proof of Part (ii) of Proposition~1.11 p.~8, if a prime ideal contains the intersection of a finite family of ideals, then it contains the product of this family, and thus one of the factors.

\nn$\bu$ \textbf{Proposition~1.11ii}%

\nn Note that $\ppp$ is prime $\iff$
$$
\ppp\supset\aaa\bbb\quad\implies\quad\ppp\supset\aaa\quad\text{or}\quad\ppp\supset\bbb.
$$

Recall Proposition~1.11ii:

\begin{prop}[Proposition~1.11ii p.~8 of the book]\label{p1.11ii}
Let $\aaa_1,\dots,\aaa_n$ be ideals and let $\ppp$ be a prime ideal containing $\bigcap_{i=1}^n\aaa_i$. Then $\ppp\supset\aaa_i$ for some $i$. If $\ppp=\bigcap\aaa_i$, then $\ppp=\aaa_i$ for some $i$.
\end{prop}

\nn$\bu$ \textbf{Quotient ideal}%

\nn We have 
$$
\aaa\subset\aaa',\ \bbb'\subset\bbb\ \implies\ (\aaa:\bbb)\subset(\aaa':\bbb'),
$$ 
$(1:\bbb)=(1)=(\aaa:0)$ and $(\aaa:1)=\aaa$. 

\subsubsection{Page 8, Exercise~1.12}%

\textbf{Statement.} (i) $\aaa\subset(\aaa:\bbb)$ 

\nn(ii) $(\aaa:\bbb)\bbb\subset\aaa$

\nn(iii) $((\aaa:\bbb):\ccc)=(\aaa:\bbb\ccc )=((\aaa:\ccc):\bbb)$

\nn(iv) $\left(\bigcap_i\aaa_i:\bbb\right)=\bigcap_i\ (\aaa_i:\bbb)$

\nn(v) $\left(\aaa:\sum_i\bbb_i\right)=\bigcap_i\ (\aaa:\bbb_i)$.

\nn\textbf{Solution.} Left to the reader.%easy? 1

\nn\textbf{Comments.}

\nn(a) The inclusion $\aaa\subset(\aaa:\bbb)$ in (i) is strict in general. To see this let $A$ be nonzero and set $\aaa=\bbb=(0)$.

\nn(b) The inclusion $(\aaa\!:\!\bbb)\,\bbb\subset(\aaa:\bbb)$ in (ii) is strict in general. To see this let $A$ be nonzero and set $\aaa=(1),\ \bbb=(0)$.

\subsubsection{Page 9, Exercise~1.13}%

\textbf{Statement.} (i) $r(\aaa)\supset\aaa$

\nn(ii) $r(r(\aaa))=r(\aaa)$

\nn(iii) $r(\aaa\bbb)=r(\aaa\cap\bbb)=r(\aaa)\cap r(\bbb)$ 

\nn(iv) $r(\aaa)=(1)\iff\aaa=(1)$

\nn(v) $r(\aaa+\bbb)=r(r(\aaa)+r(\bbb))$

\nn(vi) if $\ppp$ is prime, $r(\ppp^n)=\ppp$ for all $n>0$.

\nn\textbf{Solution.} Left to the reader.%easy? 1

\subsubsection{Page 9, extended ideal}%

If $f:A\to B$ is a morphism of rings and $\aaa$ is an ideal of $A$, then we can define $\aaa^{\oo e}$ by the formula
$$
\aaa^{\oo e}:=\sum_{\alpha\in\aaa}\ (f(\alpha)).
$$

\subsubsection{Page 10, Exercise~1.18}\label{ex1.18p10}%

\textbf{Statement.}
\begin{align*}
(\aaa_1+\aaa_2)^e&=\aaa_1^e+\aaa_2^e, &(\bbb_1+\bbb_2)^c&\supset\bbb_1^c+\bbb_2^c,\\%
(\aaa_1\cap\aaa_2)^e&\subset\aaa_1^e\cap\aaa_2^e, &(\bbb_1\cap\bbb_2)^c&=\bbb_1^c\cap\bbb_2^c,\\%
(\aaa_1\aaa_2)^e&=\aaa_1^e\aaa_2^e,                &(\bbb_1\bbb_2)^c&\supset\bbb_1^c\bbb_2^c,\\%
(\aaa_1:\aaa_2)^e&\subset(\aaa_1^e:\aaa_2^e), &(\bbb_1:\bbb_2)^c&\subset(\bbb_1^c:\bbb_2^c),\\%
r(\aaa)^e&\subset r(\aaa^e), &r(\bbb)^c&=r(\bbb^c).
\end{align*}
The set of ideals $E$ is closed under sum and product, and $C$ is closed under the other three operations.

\nn\textbf{Hint.} Let us prove that $C$ is closed under quotients [the other claims being left to the reader]. For $\aaa,\bbb\in C$ we have
$$
(\aaa:\bbb)\subset(\aaa:\bbb)^{\oo{ec}}\subset(\aaa^{\oo e}:\bbb^{\oo e})^{\oo c}\subset(\aaa^{\oo{ec}}:\bbb^{\oo{ec}})=(\aaa:\bbb).
$$ 
Indeed, the first inclusion follows from Proposition~1.17 p.~10, whereas the second and third inclusions follow from the first part of the exercise.

\nn\textbf{Comments.} 

\nn(a) Let $K$ be a field and let $X$ and $Y$ be indeterminates. If $\aaa$ is an ideal of $K[X,Y]$, we denote by $x$ and $y$ the images of $X$ and $Y$ in $K[X,Y]/\aaa$.

\nn$\bu$ Let us show that the inclusion $(\aaa_1\cap\aaa_2)^{\oo e}\subset\aaa_1^{\oo e}\cap\aaa_2^{\oo e}$ is strict in general. Set [with obvious notation] 
$$
A:=K[X,Y]/(X^2,XY,Y^2),\quad B:=K[X]/(X^2),\quad f:A\to B,\quad f(x):=x,\quad f(y):=0,
$$ 
$$
\aaa_1:=(x),\quad\aaa_2:=(x-y).
$$

\nn$\bu$ Let us show that the inclusion $\bbb_1^{\oo c}+\bbb_2^{\oo c}\subset(\bbb_1+\bbb_2)^{\oo c}$ is strict in general. Set [with obvious notation] 
$$
A:=K[X]/(X^2),\quad B:=K[X,Y]/(X^2,XY,Y^2),
$$ 
$$
f:A\to B,\quad f(x):=x,\quad\bbb_1:=(y),\quad\bbb_2:=(x-y).
$$

\nn$\bu$ Let us show that the inclusion $\bbb_1^{\oo c}\bbb_2^{\oo c}\subset(\bbb_1\bbb_2)^{\oo c}$ is strict in general. Set $A:=K[XY]$, $B:=K[X,Y]$, and let $f:A\to B$ be the inclusion. Then we have $(X)^{\oo c}(Y)^{\oo c}=(X^2Y^2)$ and $(XY)^{\oo c}=(XY)$. 

\nn$\bu$ Let us show that the inclusion $(\aaa_1:\aaa_2)^{\oo e}\subset(\aaa_1^{\oo e}:\aaa_2^{\oo e})$ is strict in general. Set $A:=K[X]$, $B:=K[X,Y]/(XY)$, $f(X):=x$. Then we have 
$$
y\in((0)^{\oo e}:(X)^{\oo e})=((0):(X)^{\oo e}),\quad y\notin(0)=(0)^{\oo e}=((0):(X))^{\oo e}.
$$

\nn$\bu$ Let us show that the inclusion $(\bbb_1:\bbb_2)^{\oo c}\subset(\bbb_1^{\oo c}:\bbb_2^{\oo c})$ is strict in general. Set $A:=K$, $B:=K[X]$, $\bbb_1:=(0)$, $\bbb_2:=(X)$. Then we have $1\in(\bbb_1^{\oo c}:\bbb_2^{\oo c})\setminus(\bbb_1:\bbb_2)^{\oo c}$. 

\nn$\bu$ Let us show that the inclusion $r(\aaa)^{\oo e}\subset r(\aaa^{\oo e})$ is strict in general. Set $A:=K[X^2]$, $B:=K[X]$, $\aaa:=(X^2)$. Then we have $X\in r(\aaa^{\oo e})\setminus r(\aaa)^{\oo e}$. 

\nn(b) For arbitrary sums and intersections we have 
$$
\left(\sum\aaa_i\right)^{\oo e}=\sum\aaa_i^{\oo e},\quad\left(\sum\bbb_i\right)^{\oo c}\supset\sum\bbb_i^{\oo c},
$$

$$
\left(\bigcap\aaa_i\right)^{\oo e}\subset\bigcap\aaa_i^{\oo e},\quad\left(\bigcap\bbb_i\right)^{\oo c}=\bigcap\bbb_i^{\oo c}.
$$

We prove the first of these four statements, leaving the others to the reader. We have 
$$
\left(\sum\aaa_i\right)^{\oo e}=\sum_{\alpha\in\sum\aaa_i}(f(\alpha)),\quad\sum\aaa_i^{\oo e}=\sum_i\sum_{\alpha_i\in\aaa_i}(f(\alpha_i)).
$$ 
The inclusion $\supset$ is clear. Let us prove the inclusion $\subset$. Let $\alpha$ be in $\sum\aaa_i$. This means that $\alpha$ is of the form $\sum\alpha_i$ with $\alpha_i\in\aaa_i$, $\alpha_i=0$ for almost all $i$. This yields 
$$
f(\alpha)=\sum_if(\alpha_i)\in\sum_i\sum_{\alpha_i\in\aaa_i}(f(\alpha_i))=\sum\aaa_i^{\oo e}.
$$

\subsection{Exercises}%%

\subsubsection{Page 10, Exercise~1.1}%

\textbf{Statement.} Let $x$ be a nilpotent element of a ring $A$. Show that $1+x$ is a unit of $A$. Deduce that the sum of a nilpotent element and a unit is a unit.

\nn\textbf{Solution.} If $x$ is nilpotent, then $\sum_{n\ge0}x^n$ is the inverse of $1-x$. If $u$ is a unit and $x$ is nilpotent, then $u+x=u\,(1+\frac xu)$ is a unit.

\subsubsection{Page 11, Exercise~1.2}\label{ex1.2}%

\textbf{Statement.} Let $A$ be a ring and let $A[x]$ be the ring of polynomials in an indeterminate $x$, with coefficients in $A$. Let $f=a_0+a_1x+\cdots+a_nx^n\in A[x]$. Prove that 

\nn(i) $f$ is a unit in $A[x]\iff a_0$ is a unit in $A$ and $a_1,\ldots,a_n$ are nilpotent. [If $b_0+b_1x+\cdots+b_mx^m$ is the inverse of $f$, prove by induction on $r$ that $a_n^{r+1}b_{m-r}=0$. Hence show that $a_n$ is nilpotent, and then use Ex.~1.]

\nn(ii) $f$ is nilpotent $\iff a_0,a_1,\ldots a_n$ are nilpotent.

\nn(iii) $f$ is a zero-divisor $\iff$ there exists $a\ne0$ in $A$ such that $af=0$. [Choose a polynomial $g=b_0+b_1x+\cdots+b_mx^m$ of least degree $m$ such that $fg=0$. Then $a_nb_m=0$, hence $a_ng=0$ (because $a_ng$ annihilates $f$ and has degree $<m$). Now show by induction that $a_{n-r}g=0$ ($0\le r\le n$).]

\nn(iv) $f$ is said to be primitive if $(a_0,a_1,\ldots,a_n)=(1)$. Prove that if $f,g\in A[x]$, then $fg$ is primitive $\iff f$ and $g$ are primitive.

\nn\textbf{Solution.} 
%\nn(i) If $a_0$ is a unit in $A$ and $a_1,\ldots,a_n$ are nilpotent, then $f$ is a unit by Exercise~1.1. Assume $f$ is a unit in $A[x]$ and let $\ppp$ be a prime ideal of $A$. Then the image of $f$ in $A/\ppp[x]$ is again a unit, and $a_1,\ldots,a_n$ are in $\ppp$. Since $\ppp$ is arbitrary, this shows that $a_1,\ldots,a_n$ are nilpotent.\\ \nn(ii) If $a_0,a_1,\ldots,a_n$ are nilpotent, then $f$ is nilpotent by Exercise~1.1. Assume $f$ is is nilpotent and let $\ppp$ be a prime ideal of $A$. Then the image of $f$ in $A/\ppp[x]$ is again nilpotent, and $a_1,\ldots,a_n$ are in $\ppp$. Since $\ppp$ is arbitrary, this shows that $a_0,a_1,\ldots,a_n$ are nilpotent.\\ Parts (iii) and (iv)
This will follow from Exercise~1.3. %See \href{https://goo.gl/sbszfj}{https://goo.gl/sbszfj}

\subsubsection{Page 11, Exercise~1.3}%

\textbf{Statement.} Generalize the results of Exercise~2 to a polynomial ring $A[x_1,\ldots,x_r]$ in several indeterminates.

\nn\textbf{Solution.} 

\nn$\bu$ (i) The condition ``$a_0$ is a unit in $A$ and $a_1,\ldots,a_n$ are nilpotent'' becomes ``the constant term is a unit in $A$ and the coefficients of the nonconstant monomials are nilpotent''.

If the constant term is a unit in $A$ and the coefficients of the nonconstant monomials are nilpotent, then $f$ is a unit by Exercise~1.1. Assume $f$ is a unit in $A[x_1,\ldots,x_r]$ and let $\ppp$ be a prime ideal of $A$. Then the image of $f$ in $A/\ppp[x_1,\ldots,x_r]$ is again a unit, that is the constant term is a unit in $A/\ppp$, and the coefficients of the nonconstant monomials are in $\ppp$. Since $\ppp$ is arbitrary, this shows that these coefficients are nilpotent.

\nn$\bu$ (ii) The condition ``$a_0,a_1,\ldots,a_n$ are nilpotent'' becomes ``all the coefficients of $f$ are nilpotent''.

If the coefficients of $f$ are nilpotent, then $f$ is nilpotent by Exercise~1.1. Assume $f$ is is nilpotent and let $\ppp$ be a prime ideal of $A$. Then the image of $f$ in $A/\ppp[x_1,\ldots,x_r]$ is again nilpotent, that is zero, and the coefficients of $f$ are in $\ppp$. Since $\ppp$ is arbitrary, this shows that these coefficients are nilpotent.

% Version of 210524 at 8:30: https://docs.google.com/document/d/1zWBFTV6fbZl0bDqR4drHDPGHhFD4hfjHpbzQzwA1m7M/edit

\nn$\bu$ (iii) We will give two solutions to Part (iii), and these solutions will be spelled out in Section~\ref{2sol} below.

\nn$\bu$ (iv) Let $f,g\in A[x_1,\ldots,x_r]$. Let $\aaa,\bbb,\ccc$ be respectively the ideals generated by the coefficients of $f,g,fg$. We must show $\ccc=(1)\iff\aaa=(1)=\bbb$. Since we have $\ccc\subset\aaa\bbb\subset\aaa\cap\bbb$, it suffices to prove $\aaa=(1)=\bbb\implies\ccc=(1)$, or equivalently $\ccc\ne(1)\implies(\aaa\ne(1)\text{ or }\bbb\ne(1))$. If $\ccc\ne(1)$, then $\ccc\subset\mmm$ for some maximal ideal $\mmm$, and the images $\overline f$ and $\overline g$ of $f$ and $g$ in $(A/\mmm)[x_1,\ldots,x_r]$ satisfy $\overline f\,\overline g=0$, so that we get $\overline f=0$ or $\overline g=0$, which implies $\aaa\ne(1)$ or $\bbb\ne(1)$.

\subsubsection{Exercise~1.3iii}\label{2sol}

\paragraph{First solution.}

% old version https://docs.google.com/document/d/1zlz5FlVrglnxgwCK_Tx-2QaKcUEMQXUG2O3q69s2y0A/edit
In the three statements below, $A$ and $B$ are rings, $p,q,r,s$ are nonnegative integers satisfying $q>0$ and $r<s$, and the $x_i$ and $y_j$ are indeterminates.

Recall the statement of Exercise~1.3iii: 

\nn$(\star)$ If $f\in A[x_1,\dots,x_p]$ has a nonzero annihilator in $A[x_1,\dots,x_p]$, then $f$ has a nonzero annihilator in $A$. 

\begin{lem}\label{1.3iiil1}
If $f\in B[y_1,\dots,y_q]$ has a nonzero annihilator in $B[y_1]$, then $f$ has a nonzero annihilator in $B$.
\end{lem}

\begin{lem}\label{1.3iiil2}
If $f\in A[x_1,\dots,x_s]$ has a nonzero annihilator in $A[x_1,\dots,x_{r+1}]$, then $f$ has a nonzero annihilator in $A[x_1,\dots,x_r]$.
\end{lem}

Clearly Lemma~\ref{1.3iiil2} implies $(\star)$. Moreover, Lemma~\ref{1.3iiil2} follows from Lemma~\ref{1.3iiil1} by setting $B=A[x_1,\ldots,x_r]$, $q=s-r$, $y_i=x_{r+i}$. Thus it only remains to prove Lemma~\ref{1.3iiil1}. To do so set 
$$
f=a_0+\cdots+a_n y_1^n,
$$ 
where $n$ is the $y_1$-degree of $f$ [we can assume $f\ne0$] and $a_i\in B[y_2,\ldots,y_q]$. Let 
$$
g=b_0+\cdots+b_m y_1^m\in B[y_1]
$$ 
be a nonzero polynomial of least degree $m$ such that 
\begin{equation}\label{1.3iii1}
fg=0.
\end{equation}
It suffices to prove 
\begin{equation}\label{1.3iii2}
m=0.
\end{equation}
It even suffices to prove
\begin{equation}\label{1.3iii3}
a_i g=0\ \forall\ i.
\end{equation}
Assume \eqref{1.3iii3} is false, and let $i$ be the largest index satisfying $a_i g\ne0$. Then \eqref{1.3iii1} implies $a_i b_m=0$ [because $a_i b_m\ne0$ would imply $\deg_{y_1}(fg)=i+m$, where $\deg_{y_1}$ is the $y_1$-degree, but we have $fg=0$] and thus $\deg_{y_1}(a_i g)<m$. As $f\cdot(a_i g)=0$, this entails $a_i g=0$, contradiction. This proves \eqref{1.3iii3} and thus \eqref{1.3iii2}, completing the proof of Lemma~\ref{1.3iiil1}.

\paragraph{Second solution.}

Let $f\in A[x_1,\dots,x_n]$ be a nonzero zero-divisor. We must show that there is a nonzero $b$ in $A$ such that $bf=0$. We equip the monomials with the graded lexicographic order, as defined in \href{https://en.wikipedia.org/wiki/Monomial_order}{https://en.wikipedia.org/wiki/Monomial\_order}.

We denote the multi-degree of $g\in A[x_1,\dots,x_n]$ by $\deg g$. Put 
$$
f=a_0+\cdots+a_\alpha x^\alpha,
$$ 
where $\alpha$ is the multi-degree of $f$. Let 
$$
g=b_0+\cdots+b_\beta x^\beta\in A[x_1,\dots,x_n]
$$ 
be a nonzero polynomial of least multi-degree $\beta$ such that 
\begin{equation}\label{1}
fg=0.
\end{equation}
It suffices to prove 
\begin{equation}\label{2}
\beta=0.
\end{equation}
It even suffices to prove
\begin{equation}\label{3}
a_\gamma g=0\ \forall\ \gamma.
\end{equation}
Assume \eqref3 is false, and let $\gamma$ be the largest multi-index satisfying $a_\gamma g\neq0$. Then \eqref1 implies $a_\gamma b_\beta=0$ [because $a_\gamma b_\beta\ne0$ would imply $\deg(fg)=\gamma+\beta$, but we have $fg=0$] and thus $\deg a_\gamma g<\beta$. As $f\cdot(a_\gamma g)=0$, this entails $a_\gamma g=0$, contradiction. This proves \eqref3 and thus \eqref2.

\subsubsection{Page 11, Exercise~1.4}%

\textbf{Statement.} In the ring $A[x]$, the Jacobson radical is equal to the nilradical.

\nn\textbf{Solution.} Let $f$ be in the Jacobson radical of $A[x]$. It suffices to show that $f$ is nilpotent. By Proposition~1.9 p.~6 of the book [Proposition~\ref{p1.9} p.~\pageref{p1.9}], $1-xf$ is a unit. Now use Exercise~1.2 p.~11 [Section~\ref{ex1.2} p.~\pageref{ex1.2}]: Part~(i) implies that the coefficients of $f$ are nilpotent, and Part~(ii) implies that $f$ itself is nilpotent.%Exercise~1.2i p.~11 [Section~\ref{ex1.2} p.~\pageref{ex1.2}] implies that the coefficients of $f$ are nilpotent, and Exercise~1.2ii [Section~\ref{ex1.2} p.~\pageref{ex1.2}] implies that $f$ itself is nilpotent. 

\subsubsection{Page 11, Exercise~1.5}\label{ex1.5}%

\textbf{Statement.} Let $A$ be a ring and let $A[[x]]$ be the ring of formal power series $f=\sum_{n=0}^\infty a_n\,x^n$ with coefficients in $A$. Show that

\nn(i) $f$ is a unit in $A[[x]]\iff a_0$ is a unit in $A$.

\nn(ii) If $f$ is nilpotent, then $a_n$ is nilpotent for all $n\ge0$. Is the converse true? (See Chapter~7, Exercise~2 [Section~\ref{ex7.2} p.~\pageref{ex7.2}].)

\nn(iii) $f$ belongs to the Jacobson radical of $A[[x]]\iff a_0$ belongs to the Jacobson radical of $A$.

\nn(iv) The contraction of a maximal ideal $\mmm$ of $A[[x]]$ is a maximal ideal of $A$, and $\mmm$ is generated by $\mmm^{\oo e}$ and $x$.

\nn(v) Every prime ideal of $A$ is the contraction of a prime ideal of $A[[x]]$.

\nn\textbf{Solution.} 

\nn$\bu$ (i) The formal series $g=b_0+b_1x+\cdots\in A[[x]]$ is an inverse of $f$ if and only if we have $a_0b_0=1$ and $a_0b_n+\cdots+a_nb_0=0$ for $n\ge1$, that is, if and only if $b_0$ is an inverse of $a_0$ and $b_n=-(a_1b_{n-1}+\cdots+a_nb_0)/a_0$ for $n\ge1$. This proves the statement.

\nn$\bu$ (ii) Assume that $f$ is nilpotent and let $\ppp$ be a prime ideal. Then the image of $f$ in $A/\ppp[[x]]$ is again nilpotent, that is zero. This implies that all the coefficients of $f$ are in $\ppp$. Since $\ppp$ is arbitrary, this entails that these coefficients are nilpotent.

Here is an example of a non-nilpotent formal power series all of whose coefficients are nilpotent. Put $B:=\mathbb Z[y_2,y_3,\dots]$ where $y_2,y_3,\dots$ are indeterminates. Let $\aaa$ be the ideal of $B$ generated by the $y_i^i$ for $i\ge2$ and the $y_iy_j$ for $i\neq j$. Let $a_i$ be the image of $y_i$ in $A:=B/\aaa$. We clearly have $a_i^{i-1}\neq0$, and $f:=a_2x^2+a_3x^3+\cdots$ satisfies $f^n=\sum_{i>n}a_i^nx^{in}\neq0$. 

\nn$\bu$ (iii) [Other wording: $\RRR(A[[x]])=\RRR(A)+(x)$.] Proof: Let $f\in A[[x]]$. Then we have: $f\in\RRR(A[[x]])$ $\iff$ $1-fg$ is a unit for all $g\in A[[x]]$ $\iff$  $1-a_0b$ is a unit in $A$ for all $b\in A$ $\iff$ $a_0\in\RRR(A)$.

\nn$\bu$ (iv) Let $\mmm$ be a maximal ideal of $A[[x]]$. We must show that $\mmm^{\oo c}$ is maximal and that $\mmm=\mmm^{\oo c}+(x)$. We have 

\nn(a) $x\in\mmm$. Proof: this follows from (iii).%$1-xf$ is a unit of $A[[x]]$ for all $f\in A[[x]]$ by (i).

\nn(b) $A[[x]]=A+\mmm$. Proof: $A[[x]]=A+(x)\overset{(\text a)}\subset A+\mmm$.

\nn(c) $A/\mmm^{\oo c}\simeq A[[x]]/\mmm$. Proof: $A/\mmm^{\oo c}=A/(A\cap\mmm)\simeq(A+\mmm)/\mmm\overset{(\text b)}=A[[x]]/\mmm$. 

Then (c) implies that $\mmm^{\oo c}$ is maximal.

\nn(d) $\mmm=\mmm^{\oo c}+(x)$. Proof: Let $f=a_0+a_1x+\cdots\in A[[x]]$. We have  $f=a_0+xg$ for some $g\in A[[x]]$. Since $xg\in\mmm$ by (a), we have $f\in\mmm\iff a_0\in\mmm\iff a_0\in\mmm^{\oo c}$. 

\nn$\bu$ (v) In the next few lines, $A^*$ shall designate the set of prime ideals of the ring $A$, and $f^*:B^*\to A^*$ shall denote the map induced by the ring morphism $f:A\to B$. 

We must show that $A[[x]]^*\to A^*$ is surjective.

If $A\xrightarrow fB\xrightarrow gC$ are ring morphisms and if $(g\circ f)^*:C^*\to A^*$ is surjective, then so is $f^*:B^*\to A^*$. We solve Exercise~1.5v by applying this observation to the natural morphisms $A\to A[[x]]\to A$, whose composition is the identity of $A$. 

\subsubsection{Page 11, Exercise~1.6}%

\textbf{Statement.} A ring $A$ is such that every ideal not contained in the nilradical contains a non-zero idempotent [that is, an element $e$ such that $e^2=e\ne0$]. Prove that the nilradical and Jacobson radical of $A$ are equal.

\nn\textbf{Hint.} This is an immediate consequence of the following lemma:

\begin{lem}\label{idemjac}
Let $e=e^2$ be an idempotent in a ring $A$. If $e$ is a unit, then $e=1$. If $e\in\RRR$, then $e=0$.%Zero is the only idempotent in $\RRR$.
\end{lem}
\begin{proof}
The first claim is clear. If $e\in\RRR$, then the element $1-e$, which is again idempotent, is a unit by Proposition~1.9 p.~6 of the book [Proposition~\ref{p1.9} p.~\pageref{p1.9}], and the first claim implies $1-e=1$, that is $e=0$. [Other argument: If $e\in\RRR$, since we have $(e)^2=(e)$, Nakayama's Lemma, stated as Proposition~\ref{nak} p.~\pageref{nak}, implies $e=0$.]
\end{proof}

\subsubsection{Page 11, Exercise~1.7}\label{ex1.7}%

\textbf{Statement.} Let $A$ be a ring in which every element $x$ satisfies $x^n=x$ for some $n>1$ (depending on $x$). Show that every prime ideal in $A$ is maximal.

\nn\textbf{Solution.} We can assume that $A$ is a domain, and it suffices to show that it is a field. We have, in above notation, $x\,(x^{n-1}-1)=0$. This implies that $x$ is zero or a unit.

\subsubsection{Page 11, Exercise~1.8}\label{ex1.8}%

\textbf{Statement.} Let $A$ be a ring $\ne0$. Show that the set of prime ideals of $A$ has minimal elements with respect to inclusion.

\nn\textbf{Hint.} The intersection of a totally ordered set of prime ideals is a prime ideal.

\nn\textbf{Comment.} Let $X$ be the set of prime ideals of $A$. If $Y$ is a subset of $X$, and if the intersection of any totally ordered subset of $Y$ belongs to $Y$, then $Y$ has a minimal element.

In particular, if $\ppp_0\in X$ and if $\aaa$ is an ideal of $A$, then then the set $\{\ppp\in X\ |\ \aaa\subset\ppp\subset\ppp_0\}$ has a minimal element.

\subsubsection{Page 11, Exercise~1.9}%

\textbf{Statement.} Let $\aaa$ be an ideal $\ne(1)$ in a ring $A$. Show that $\aaa=r(\aaa)$ if and only if $\aaa$ is an intersection of prime ideals.

\nn\textbf{Solution.} %If $\aaa$ is an intersection of prime ideals, then it is the intersection of the prime ideals which contain $\aaa$, intersection which coincides with $r(\aaa)$.\\ The above solution uses implicitly the following result:
Recall:

\begin{prop}\label{p114}[Proposition~1.14] The radical of an ideal $\aaa$ is the intersection of the prime ideals which contain $\aaa$.
\end{prop}

In particular $\aaa=r(\aaa)$ implies that $\aaa$ is an intersection of prime ideals. Conversely, if $\aaa$ is an intersection of prime ideals, then it is the intersection of the prime ideals which contain $\aaa$, intersection which coincides with $r(\aaa)$.

\subsubsection{Page 11, Exercise~1.10}%

\textbf{Statement.} Let $A$ be a ring, $\NNN$ its nilradical. Show that the following are equivalent: 

\nn(i) $A$ has exactly one prime ideal;

\nn(ii) every element of $A$ is either a unit or nilpotent; 

\nn(iii) $A/\NNN$ is a field.

\nn\textbf{Solution.} 

\nn(i)$\implies$(ii): The unique prime ideal of $A$ is equal to $\NNN$. Let $a$ be in $A\setminus\NNN$. If $a$ was not a unit, it would be contained in a maximal ideal, which would coincide with $\NNN$. 

\nn(ii)$\implies$(iii): Let $x$ be a nonzero element of $A/\NNN$, and let $a\in A$ be a lift of $x$. Since $a$ is not in $\NNN$, it is a unit, and so is its image $x$. 

\nn(iii)$\implies$(i): If $\ppp$ is a prime ideal, then $\NNN\subset\ppp$, and thus $\NNN=\ppp$ because $\NNN$ is maximal.%The set $\NNN$ is a maximal ideal, hence a prime ideal, hence the unique minimal prime ideal.

\subsubsection{Page 11, Exercise~1.11}\label{ex1.11}%

\textbf{Statement.} A ring $A$ is Boolean if $x^2=x$ for all $x\in A$. In a Boolean ring $A$, show that 

\nn(i) $2x=0$ for all $x\in A$;

\nn(ii) every prime ideal $\ppp$ is maximal, and $A/\ppp$ is a field with two elements; 

\nn(iii) every finitely generated ideal in $A$ is principal.

\nn\textbf{Solution.}

\nn(i) We have $x+1=(x+1)^2=x^2+2x+1=3x+1$.

\nn(ii) We can assume $A$ is a domain and it suffices that $A/\ppp$ is a field with two elements. Since the equation $x^2=x$ has exactly two solutions, this is clear.

\nn(iii) Let $A$ be boolean, and let us show that any finitely generated ideal $\aaa$ is principal. We can assume $\aaa=(x,y)$. Then $z:=x+y-xy\in\aaa$ satisfies $xz=x,yz=y$, and we get $\aaa=(z)$.

\subsubsection{Page 11, Exercise~1.12}\label{ex1.12}%

\textbf{Statement.} A local ring $(A,\mmm)$ contains no idempotent $\neq0,1$. 

\nn\textbf{Solution.} Let $e\in A$ be idempotent. If $e$ is a unit, Lemma~\ref{idemjac} p.~\pageref{idemjac} yields $e=1$. If $e$ is not a unit, then $e\in\mmm=\RRR$, and the same lemma implies $e=0$.%$1-e$ is a unit [by Proposition~1.9 p.~6 of the book, stated as Proposition~\ref{p1.9} p.~\pageref{p1.9} above] and an idempotent, and thus equal to $1$, hence $e=0$.

\subsubsection{Page 11, Exercise~1.13}%

\textbf{Statement.} [Construction of an algebraic closure of a field (E. Artin).] Let $K$ be a field and let $\Sigma$ be the set of all irreducible monic polynomials $f$ in one indeterminate with coefficients in $K$. Let $A$ be the polynomial ring over $K$ generated by indeterminates $x_f$, one for each $f\in\Sigma$. Let $\aaa$ be the ideal of $A$ generated by the polynomials $f(x_f)$ for all $f\in\Sigma$. Show that $\aaa\ne(1)$.

Let $\mmm$ be a maximal ideal of $A$ containing $\aaa$, and let $K_1=A/\mmm$. Then $K_1$ is an extension field of $K$ in which each $f\in\Sigma$ has a root. Repeat the construction with $K_1$ in place of $K$, obtaining a field $K_2$, and so on. Let $L=\bigcup_{n=1}^\infty K_n$. Then $L$ is a field in which each $f\in\Sigma$ splits completely into linear factors. Let $\ov K$ be the set of all elements of $L$ which are algebraic over $K$. Then $\ov K$ is an algebraic closure of $K$.

\nn\textbf{Hints.} To show $\aaa\neq(1)$, let $f_1,\dots,f_n$ be in $\Sigma$, set $x_i:=x_{f_i}$ for $i=1,\dots,n$. Assuming $\aaa=(1)$ by contradiction, we can choose $f_1,\dots,f_n$ as above in such a way that there are $g_i(x_1,\dots,x_n)$ in $K[x_1,\dots,x_n]$ such that 
$$
\sum_{i=1}^n\,g_i(x_1,\dots,x_n)f_i(x_i)=1.
$$ 
Letting $L$ be an extension of $K$ in which each $f_i$ has a root $\alpha_i$, we get the equality $0=1$ in $L$ by evaluating the above display at $(\alpha_1,\dots,\alpha_n)$.

To show that each $f\in\Sigma$ has a root in $K_1$, note the equality $f(\ov{x_f})=0$, where $\ov{x_f}\in K_1$ is the image of $x_f$. 

To show that each $f\in\Sigma$ splits completely into linear factors in $L$, let $g$ be an irreducible monic divisor of $f$ in $L[x]$. It suffices to prove that $g$ has a root in $L$. Note that $g$ is an irreducible monic polynomial in $K_n[x]$ for some $n$, and thus $g$ has a root in $K_{n+1}\subset L$.

Let $f$ be in $\Sigma$. To show that $\ov K$ is an algebraic closure of $K$, it suffices to check that $f$ has a root in $\ov K$. We saw that $f$ has a root in $L$, and this root is certainly in $\ov K$.

\subsubsection{Page 12, Exercise~1.14}\label{ex1.14}%

\textbf{Statement.} In a ring $A$, let $\Sigma$ be the set of all ideals in which every element is a zero-divisor. Show that the set $\Sigma$ has maximal elements and that every maximal element of $\Sigma$ is a prime ideal. Hence the set of zero-divisors in $A$ is a union of prime ideals.

\nn\textbf{Hints.} More precisely, for each $\aaa\in\Sigma$ there is a maximal element $\bbb\in\Sigma$ such that $\aaa\subset\bbb$. To show that $\Sigma$ has maximal elements, note that the union of a totally ordered subset of $\Sigma$ is in $\Sigma$. The proof that every maximal element of $\Sigma$ is a prime ideal is similar to that of Proposition~1.8 p.~5 of the book. Here are some details. Let $\ppp$ be a maximal element of $\Sigma$, and let $a$ and $b$ be in $A\setminus\ppp$. Since the ideals $\ppp+(a)$ and $\ppp+(b)$ contain elements which are not zero-divisors, so does their product $\ppp+(ab)$. This implies that $ab$ is not in $\ppp$.

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 2

\subsubsection{Page 12, Exercise~1.15}\label{ex1.15}%

\textbf{Statement.} [The prime spectrum of a ring.] Let $A$ be a ring and let $X$ be the set of all prime ideals of $A$. For each subset $E$ of $A$, let $V(E)$ denote the set of all prime ideals of $A$ which contain $E$. Prove that

\nn(i) if $\aaa$ is the ideal generated by $E$, then $V(E)=V(\aaa)=V(r(\aaa))$; 

\nn(ii) $V(0)=X$, $V(1)=\varnothing$;

\nn(iii) if $(E_i)_{i\in I}$ is any family of subsets of $A$, then
$$
V\left(\bigcup_{i\in I}E_i\right)=\bigcap_{i\in I}V(E_i);
$$
(iv) $V(\aaa\cap\bbb)=V(\aaa\bbb)=V(\aaa)\cup V(\bbb)$ for any ideals $\aaa,\bbb$ of $A$.

These results show that the sets $V(E)$ satisfy the axioms for closed sets in a topological space. The resulting topology is called the \textbf{Zariski topology}. The topological space $X$ is called the \textbf{prime spectrum} of $A$, and is written $\Spec(A)$.

\nn\textbf{Hints.} 

\nn(i) If $\ppp$ contains $E$, then $\ppp$ contains $\aaa$, and $\ppp=r(\ppp)$ contains $r(\aaa)$. 

Say that a \textbf{radical ideal} is an ideal equal to its radical. The following proposition will be useful:

\begin{prop}\label{ri}
\emph{(a)} The map $\aaa\mapsto V(\aaa)$ is a bijection between the radial ideals of $A$ and the closed subsets of $\Spec(A)$. Its inverse is given by $Y\mapsto\bigcap Y$ where 
$$
\bigcap Y:=\bigcap_{\ppp\in Y}\ppp.
$$ 
\nn\emph{(b)} The above bijections are decreasing.

\nn\emph{(c)} If $\aaa$ and $\bbb$ are ideals of $A$, then $V(\aaa)\subset V(\bbb)$ $\iff$ $\bbb\subset r(\aaa)$.

\nn\emph{(d)} The set $V(\bigcap Y)$ is the closure of $Y$ for all $Y\subset X:=\Spec(A)$.
\end{prop}

\begin{proof}
(a) As just observed, each $V(E)$ is equal to $V(\aaa)$ where $\aaa$ is the radical ideal generated by $E$. We have $\bigcap V(\aaa)=\aaa$ if $\aaa$ is a radical ideal by Proposition~\ref{p114} p.~\pageref{p114} above [proposition which says that the radical of an ideal is the intersection of the prime ideals which contain that ideal]. Let us show that $V(\aaa)\ne V(\bbb)$ if $\aaa$ and $\bbb$ are distinct radical ideals. We can assume there is an $a$ in $\aaa\setminus\bbb$. Using Proposition~\ref{p114} again we see that there is a prime ideal $\ppp$ which contains the ideal $\bbb$ but not the element $a$, and we get $\ppp\in V(\bbb)\setminus V(\aaa)$.

\nn(b) Clear.

\nn(c) Clear.

\nn(d) Note that the inclusion $Y\subset V(\bigcap Y)$ is obvious. Let $\aaa$ be an ideal of $A$ satisfying $Y\subset V(\aaa)$. It suffices to show $V(\bigcap Y)\subset V(\aaa)$. But this is clear because we have $\aaa\subset\ppp$ for all $\ppp\in Y$, and thus $\aaa\subset\bigcap_{\ppp\in Y}\ppp=\bigcap Y$.
\end{proof}

\nn(ii) Clear.

\nn(iii) Clear.

\nn(iv) If $\ppp$ contains $\aaa\bbb$, then $\ppp$ contains $\aaa$ or $\bbb$. In both cases $\ppp$ contains $\aaa\cap\bbb$.

\subsubsection{Page 12, Exercise~1.16}%\label{ex1.16}%

\textbf{Statement.} Draw pictures of $\Spec(\Z)$, $\Spec(\mathbb R)$, $\Spec(\mathbb C[x])$, $\Spec(R[x])$, $\Spec(\Z[x])$.

\nn\textbf{Solution.} Omitted.% declined

\subsubsection{Page 12, Exercise~1.17}\label{ex1.17}%

\textbf{Statement.} For each $f\in A$, let $X_f$ denote the complement of $V(f)$ in $X= \Spec(A)$. The sets $X_f$ are open. Show that they form a basis of open sets for the Zariski topology, and that

\nn(i) $X_f\cap X_g=X_{fg}$;

\nn(ii) $X_f=\varnothing\iff f$ is nilpotent;

\nn(iii) $X_f=X\iff f$ is a unit; 

\nn(iv) $X_f=X_g\iff r((f))=r((g))$;

\nn(v) $X$ is quasi-compact [that is, every open covering of $X$ has a finite sub-covering].

\nn(vi) More generally, each $X_f$ is quasi-compact.

\nn(vii) An open subset of $X$ is quasi-compact if and only if it is a finite union of
sets $X_f$.

\nn The sets $X_f$ are called \textbf{basic open sets} of $X=\Spec(A)$.

\nn\textbf{Hints.} 

\nn To show that the $X_f$ form a basis of open sets for the Zariski topology, let $\ppp$ be in $X$ and $\aaa$ an ideal such that $\ppp\not\supset\aaa$, and note that there is an $f$ in $\aaa\setminus\ppp$. This implies $\ppp\in X_f\subset X\setminus V(\aaa)$. 

\nn(i) Clear.

\nn(ii) It suffices to show $V(f)=X\iff f$ is nilpotent, which follows from Proposition~\ref{p114} p.~\pageref{p114} [proposition which says that the radical of an ideal is the intersection of the prime ideals which contain that ideal].

\nn(iii) Clear.

\nn(iv) It suffices to show $V(f)=V(g)\iff r(f)=r(g)$. But this follows from Proposition~\ref{ri}.a p.~\pageref{ri}.

\nn(v) Will follow from (vi).

\nn(vi) We must show that $X_f$ is quasi-compact, that is, assuming $X_f\subset \bigcup_{i\in I}X_{g_i}$, we must show that there is a finite subset $F$ of $I$ such that 
\begin{equation}\label{117}
X_f\subset\bigcup_{i\in F}X_{g_i}.
\end{equation}
Our assumption means $\bigcap_{i\in F}V(g_i)\subset V(f)$. Writing $\aaa$ for the ideal generated by the $g_i$, the above display is equivalent to $V(\aaa)\subset V(f)$, that is to $f^n\in\aaa$ for some $n$ [see Proposition~\ref{ri}.c p.~\pageref{ri}]. But this holds if and only if $f^n$ belongs to the ideal generated by $\{g_i\ |\ i\in F\}$ for some finite subset $F$ of $I$, and $F$ clearly satisfies \eqref{117}. 

\nn(vii) If $U$ is a quasi-compact open subset of $X$, then $U$ is covered by basic open subsets, and thus by finitely many such subsets. Conversely a finite union of quasi-compact open subsets is quasi-compact and open.

\subsubsection{Page 13, Exercise~1.18}%

\textbf{Statement.} For psychological reasons it is sometimes convenient to denote a prime ideal of $A$ by a letter such as $x$ or $y$ when thinking of it as a point of $X=\Spec(A)$. When thinking of $x$ as a prime ideal of $A$, we denote it by $\ppp_x$ (logically, of course, it is the same thing). Show that

\nn(i) the set $\{x\}$ is closed (we say that $x$ is a ``closed point'') in $\Spec(A)\iff\ppp_x$ is maximal;

\nn(ii) $\ov{\{x\}}=V(\ppp_x)$;

\nn(iii) $y\in\ov{\{x\}}\iff\ppp_x\subset\ppp_y$;

\nn(iv) Prove that $\Spec(A)$ is a T0-space [this means that if $x,y$ are distinct points of $\Spec(A)$, then either there is a neighborhood of $x$ which does not contain $y$, or else there is a neighborhood of $y$ which does not contain $x$].

\nn\textbf{Solution.} 

\nn(i) Will follow from (ii).

\nn(ii) Follows from Proposition~\ref{ri}.d p.~\pageref{ri} above. 

\nn(iii) Follows from (ii).

\nn(iv) Let $\ppp,\qqq\in\Spec(A)$ be distinct. It suffices to show that there is an ideal $\aaa$ such that either $\ppp\supset\aaa$ and $\qqq\not\supset\aaa$ or $\qqq\supset\aaa$ and $\ppp\not\supset\aaa$. We can assume $\qqq\not\subset\ppp$, and it suffices to set $\aaa:=\ppp$.

\subsubsection{Page 13, Exercise~1.19}\label{irr}%

\textbf{Statement.} A topological space $X$ is said to be \textbf{irreducible} if $X\ne\varnothing$ and if every pair of non-empty open sets in $X$ intersect, or equivalently if every non-empty open set is dense in $X$. Show that $\Spec(A)$ is irreducible if and only if the nilradical of $A$ is a prime ideal.

\nn\textbf{Observations.}

\nn$\bu$ The statement implies that the closed irreducible subsets of $\Spec(A)$ are the closures of the singletons, i.e. the $V(\ppp)$. 

\nn$\bu$ $X\ne\varnothing$ is irreducible if and only if $X=C\cup D$ with $C$ and $D$ closed implies $C=X$ or $D=X$. 

Assume $X\ne\varnothing$. Let us show that $X$ is irreducible if and only if every non-empty open set is dense in $X$, or, equivalently, let us prove that $X$ is reducible if and only if some non-empty open set is not dense in $X$. 

If $X$ is reducible, there are disjoint non-empty open subsets $U$ and $V$. Then $V$ is contained in the complement of the closure of $U$, and $U$ is not dense. 

If some non-empty open subset $U$ is not dense in $X$, the complement of the closure of $U$ is non-empty open subset disjoint from $U$. 

\nn\textbf{Hint.} The following conditions are equivalent:

\nn(a) $X$ is reducible, 

\nn(b) there are ideals $\aaa$ and $\bbb$ such that $\aaa\not\subset\NNN$, $\bbb\not\subset\NNN$, $\aaa\bbb\subset\NNN$, 

\nn(c) $\NNN$ is not prime. 

\subsubsection{Page 13, Exercise~1.20}\label{ex1.20}%

\textbf{Statement.} Let $X$ be a topological space.

\nn(i) If $Y$ is an irreducible (Exercise~19) subspace of $X$, then the closure $\overline Y$ of $Y$ in $X$ is irreducible.

\nn(ii) Every irreducible subspace of $X$ is contained in a maximal irreducible subspace.

\nn(iii) The maximal irreducible subspaces of $X$ are closed and cover $X$. They are called the \textbf{irreducible components} of $X$. What are the irreducible components of a Hausdorff space?

\nn(iv) If $A$ is a ring and $X=\Spec(A)$, then the irreducible components of $X$ are the closed sets $V(\ppp)$, where $\ppp$ is a minimal prime ideal of $A$ (Exercise~8 [Exercise~\ref{ex1.8} p.~\pageref{ex1.8}]).

\nn\textbf{Solution.} (i) This results immediately from the following observations:

\nn$\bu\ Y$ is irreducible if and only if for all open subsets $U,V$ of $X$ we have: $U$ and $V$ meet $Y$ implies that $U\cap V$ meets $Y$.

\nn$\bu$ An open subset of $X$ which meets $\overline Y$ meets $Y$. [Proof: If $U$ does not meet $Y$, then $Y\subset X\setminus U$, and thus $\overline Y\subset X\setminus U$.] 

Parts (ii) and (iii) are left to the reader.

\nn(iv) This follows from the first observation made in Section~\ref{irr} p.~\pageref{irr} above.

\subsubsection{Page 13, Exercise~1.21}\label{ex1.21}%

\textbf{Statement.} Let $\phi:A\to B$ be a ring homomorphism. Let $X=\Spec(A)$ and $Y=\Spec(B)$. If $\qqq\in Y$, then $\phi^{-1}(\qqq)$ is a prime ideal of $A$, i.e., a point of $X$. Hence $\phi$ induces a mapping $\phi^*:Y\to X$. Show that

\nn(i) If $f\in A$ then $\phi^{*-1}(X_f)=Y_{\phi(f)}$ and hence that $\phi^*$ is continuous.

\nn(ii) If $\aaa$ is an ideal of $A$, then $\phi^{*-1}(V(\aaa))=V(\aaa^{\text e})$.

\nn(iii) If $\bbb$ is an ideal of $B$, then $\ov{\phi^*(V(\bbb))}=V(\bbb^{\text c})$.

\nn(iv) If $\phi$ is surjective, then $\phi^*$ is a homeomorphism of $Y$ onto the closed subset $V(\Ker(\phi))$ of $X$. (In particular, $\Spec(A)$ and $\Spec(A/\NNN)$ (where $\NNN$ is the nilradical of $A$) are naturally homeomorphic.)

\nn(v) If $\phi$ is injective, then $\phi^*(Y)$ is dense in $X$. More precisely, $\phi^*(Y)$ is dense in $X\iff\Ker(\phi)\subset\NNN$.

\nn(vi) Let $\psi:B\to C$ be another ring homomorphism. Then $(\psi\circ\psi)^*=\phi^*\circ\psi*$.

\nn(vii) Let $A$ be an integral domain with just one non-zero prime ideal $\ppp$ and let $K$ be the field of fractions of $A$. Let $B=(A/\ppp)\times K$. Define $\phi:A\to B$ by $\phi(x)=(\ov x,x)$, where $\ov x$ is the image of $x$ in $A/\ppp$. Show that $\phi^*$ is bijective but not a homeomorphism.

\nn\textbf{Hints.} Parts (iv), (vi) and (vii) are left to the reader. The solutions to (i), (iii) and (v) are given below.

\nn$\bu$ (i) $\qqq\in\phi^{*-1}(X_f)\iff\phi^*(\qqq)\in X_f\iff f\notin\phi^*(\qqq)\iff\phi(f)\notin\qqq\iff\qqq\in Y_{\phi(f)}$.

\nn$\bu$ (ii) $\qqq\in\phi^{*-1}(V(\aaa))\iff\phi^*(\qqq)\in V(\aaa)\iff\phi^*(\qqq)\supset\aaa\iff\qqq\supset\aaa^{\text e}\iff\qqq\in V(\aaa^{\text e})$.

\nn$\bu$ (iii) We have 
$$
\overline{\phi^*(V(\bbb))}=V\left(\bigcap_{\ppp\in\phi^*(V(\bbb))}\ppp\right)=V\left(\bigcap_{\qqq\supset\bbb}\qqq^{\oo c}\right)=V\left(\left(\bigcap_{\qqq\supset\bbb}\qqq\right)^{\oo c}\right)=V(r(\bbb)^{\oo c})=V(r(\bbb^{\oo c}))=V(\bbb^{\oo c}).
$$
%Let $\mathcal I$ be the set of radical ideals of $A$, let $\mathcal C$ be the set of closed subsets of $\Spec(A)$, and define $W:\mathcal C\to\mathcal I$ by $W(C):=\bigcap_{\ppp\in C}\ \ppp$.\\ \begin{prop}\label{gal}\\ The map $W$ is bijective and its inverse is $\aaa\mapsto V(\aaa)$.\\ \end{prop}\\ This follows from Proposition~\ref{ri} p.~\pageref{ri} above.

\nn$\bu$ (v) We must show $\overline{\phi^*(Y)}=X\iff\Ker\phi\subset\NNN(A)$. More generally we have $\overline{\phi^*(Y)}=V(\Ker\phi)$ by Part (iii) of the same exercise.

\subsubsection{Page 13, Exercise~1.22}\label{ex1.22}%

\textbf{Statement.} Let $A=\prod_{i=1}^nA_i$ be the direct product of rings $A_i$. Show that $\Spec(A)$ is the disjoint union of open (and closed) subspaces $X_i$, where $X_i$ is canonically homeomorphic with $\Spec(A_i)$.

Conversely, let $A$ be any ring. Show that the following statements are equivalent:

\nn(i) $X=\Spec(A)$ is disconnected.

\nn(ii) $A\simeq A_1\times A_2$ where neither of the rings $A_1,A_2$ is the zero ring.

\nn(iii) $A$ contains an idempotent $\ne0,1$.

In particular, the spectrum of a local ring is always connected (Exercise~12 [Section~\ref{ex1.12} p.~\pageref{ex1.12}]).

\nn\textbf{Solution.} We can assume $n\ge2$ and $A_i\ne0$ for all $i$. A prime ideal of $A$ is of the form $\prod_{i=1}^n\aaa_i$ where one of the $\aaa_i$, say $\aaa_j$ is a prime ideal of $A_j$, and each of the other $\aaa_i$ is equal to $A_i$.

\nn(i)$\implies$(iii): We assume that $\Spec(A)$ is disconnected and we must show that $A$ has a nontrivial idempotent. We have $X=V(\aaa)\sqcup V(\bbb)$ with $\aaa,\bbb\ne(1)$. This implies $\aaa+\bbb=(1)$ and $\aaa\cap\bbb\subset\NNN$. Hence there are $a\in\aaa$ and $b\in\bbb$ such that $a+b=1$ and $ab\in\NNN$. We have 
$$
(a^n)+(b^n)=(1),\quad a^nb^n=0,\quad(a^n)\ne(1)\ne(b^n)
$$ 
for some $n$, hence $e+f=1$, $ef=0$ and $e\ne1\ne f$ for some $e\in(a^n)$ and some $f\in(b^n)$. This gives $e-e^2=ef=0$, and thus $e^2=e$. Similarly $f^2=f$.

\nn(iii)$\implies$(ii): If $e$ is an idempotent, then each of the ideals $(e)$ and $(1-e)$ has a structure of ring which makes the natural isomorphism of $A$-modules $A\simeq(e)\times(1-e)$ an isomorphism of rings.

\nn(ii)$\implies$(i): This follows from the first part of the exercise.

\subsubsection{Page 14, Exercise~1.23}%

\textbf{Statement.} Let $A$ be a Boolean ring (Exercise~11 [Exercise~\ref{ex1.11} p.~\pageref{ex1.11}]), and let $X=\Spec(A)$. 

\nn(i) For each $f\in A$, the set $X_f$ (Exercise~17 [Exercise~\ref{ex1.17} p.~\pageref{ex1.17}]) is both open and closed in $X$. 

\nn(ii) Let $f_1,\ldots,f_n\in A$. Show that $X_{f_1}\cup\cdots\cup X_{f_n}=X_f$ for some $f\in A$.

\nn(iii) The sets $X_f$ are the only subsets of $X$ which are both open and closed. [Let $Y \subset X$ be both open and closed. Since $Y$ is open, it is a union of basic open sets $X_f$. Since $Y$ is closed and $X$ is quasi-compact (Exercise~17 [Exercise~\ref{ex1.17} p.~\pageref{ex1.17}]), $Y$ is quasi-compact. Hence $Y$ is a finite union of basic open sets; now use (ii) above.]

\nn(iv) $X$ is a compact Hausdorff space.

\nn\textbf{Solution.} 

\nn(i) In fact we have $X=X_f\sqcup X_{1-f}$ for all $f$ in $A$.

\nn(ii) See the proof of Statement~(iii) in Section~\ref{ex1.11} p.~\pageref{ex1.11}.

\nn(iii) The hint is a complete solution.

\nn(iv) If $f\in\ppp\setminus\qqq$ then $\ppp\in X_{1-f}$ and $\qqq\in X_f$.

\subsubsection{Page 14, Exercise~1.24}%

\textbf{Statement.} Let $L$ be a lattice, in which the sup and inf of two elements $a,b$ are denoted by $a\lor b$ and $a\land b$ respectively. $L$ is a \textbf{Boolean lattice} (or \textbf{Boolean algebra}) if

\nn(i) $L$ has a least element and a greatest element (denoted by $0,1$ respectively). 

\nn(ii) Each of $\lor$ and $\land$ is distributive over the other.

\nn(iii) Each $a\in L$ has a unique ``complement'' $a'\in L$ such that $a\vee a'=1$ and $a\land a'=0$. (For example, the set of all subsets of a set, ordered by inclusion, is a Boolean lattice.)

Let $L$ be a Boolean lattice. Define addition and multiplication in $L$ by the rules $a+b=(a\land b')\lor (a'\land b)$, $ab=a\land b$. Verify that in this way $L$ becomes a Boolean ring, say $A(L)$.

Conversely, starting from a Boolean ring $A$, define an ordering on $A$ as follows: $a\le b$ means that $a=ab$. Show that, with respect to this ordering, $A$ is a Boolean lattice. [The sup and inf are given by $a\lor b=a+b+ab$ and $a\land b=ab$, and the complement by $a'=1-a$.] In this way we obtain a one-to-one correspondence between (isomorphism classes of) Boolean rings and (isomorphism classes of) Boolean lattices.

\nn\textbf{Solution.} Left to the reader.%easy? 1

\subsubsection{Page 14, Exercise~1.25}%

\textbf{Statement.} From the last two exercises deduce Stone's theorem, that every Boolean lattice is isomorphic to the lattice of open-and-closed subsets of some compact Hausdorff topological space.

\nn\textbf{Hint.} Let $a$ and $b$ be elements of a boolean ring $A$. We claim
\begin{equation}\label{125a}
(a)=(b)\iff a=b.
\end{equation} 
In words: In a boolean ring, any principal ideal has a unique generator. Let us first show 
\begin{equation}\label{125b}
a\in(b)\iff ab=a.
\end{equation}
Assuming $a\in(b)$, that is $a=bc$ for some $c$, we get $ab=b^2c=bc=a$. The other implication is trivial. This proves \eqref{125b}. To prove the non-obvious implication in \eqref{125a}, assume $(a)=(b)$, that is $a\in(b)$ and $b\in(a)$. By \eqref{125b} this gives $a=ab=b$. $\square$

Since ideals in boolean rings are radical, \eqref{125a} and Proposition~\ref{ri} p.~\pageref{ri} imply $X_f=X_g\iff f=g$.

Note also the following: Let $A$ be a boolean ring. Then the map $a\mapsto(a)$ is a bijection from $A$ to the set $P$ of principal ideals of $A$. Moreover we have $(a)+(b)=(a+b+ab)$ and $(a)\cap(b)=(ab)$, showing that $P$ is the lattice attached to $A$ and also a sublattice of the lattice of ideals of $A$.

\subsubsection{Page 14, Exercise~1.26}%

\textbf{Statement.} Let $A$ be a ring. The subspace of $\Spec(A)$ consisting of the \textbf{maximal} ideals of $A$, with the induced topology, is called the \textbf{maximal spectrum} of $A$ and is denoted by $\oo{Max}(A)$. For arbitrary commutative rings it does not have the nice functorial properties of $\Spec(A)$ (see Exercise~21 [Section~\ref{ex1.21} p.~\pageref{ex1.21}]), because the inverse image of a maximal ideal under a ring homomorphism need not be maximal.

Let $X$ be a compact Hausdorff space and let $C(X)$ denote the ring of all real-valued continuous functions on $X$ (add and multiply functions by adding and multiplying their values). For each $x\in X$, let $\mmm_x$ be the set of all $f\in C(X)$ such that $f(x)=0$. The ideal $\mmm_x$ is maximal, because it is the kernel of the (surjective) homomorphism $C(X)\to\mathbb R$ which takes $f$ to $f(x)$. If $\widetilde X$ denotes $\oo{Max}(C(X))$, we have therefore defined a mapping $\mu:X\to\widetilde X$, namely $x\mapsto\mmm_x$.

We shall show that $\mu$ is a homeomorphism of $X$ onto $\widetilde X$.

\nn(i) Let $\mmm$ be any maximal ideal of $C(X)$, and let $V=V(\mmm)$ be the set of common zeros of the functions in $\mmm$: that is,
$$
V=\{x\in X\ |\ f(x)=0\text{ for all }f\in\mmm\}.
$$
Suppose that $V$ is empty. Then for each $x\in X$ there exists $f_x\in\mmm$ such that $f_x(x) \ne0$. Since $f_x$ is continuous, there is an open neighborhood $U_x$ of $x$ in $X$ on which $f_x$ does not vanish. By compactness a finite number of the neighborhoods, say $U_{x_1},\ldots,U_{x_n}$, cover $X$. Let
$$
f=f_{x_1}^2+\cdots+f_{x_n}^2.
$$
Then $f$ does not vanish at any point of $X$, hence is a unit in $C(X)$. But this contradicts $f\in\mmm$, hence $V$ is not empty.

Let $x$ be a point of $V$. Then $\mmm\subset\mmm_x$, hence $\mmm=\mmm_x$ because $\mmm$ is maximal. Hence $\mu$ is surjective.

\nn(ii) By Urysohn's lemma (this is the only non-trivial fact required in the argument) the continuous functions separate the points of $X$. Hence $x\ne y\implies\mmm_x\ne\mmm_y$, and therefore $\mu$ is injective.

\nn(iii) Let $f\in C(X)$; let
$$
U_f=\{x\in X\ |\ f(x)\ne0\}
$$ 
and let 
$$
\widetilde U_f=\{\mmm\in\widetilde X\ |\ f\notin\mmm\}.
$$
Show that $\mu(U_f)=\widetilde U_f$. The open sets $U_f$ (resp. $\widetilde U_f$) form a basis of the topology of $X$ (resp. $\widetilde X$) and therefore $\mu$ is a homeomorphism.

Thus $X$ can be reconstructed from the ring of functions $C(X)$.

\nn\textbf{Solution.} Omitted. [The hint in the book is fairly complete.]

\subsubsection{Page 14, Exercise~1.27}\label{ex1.27}%

\textbf{Statement.} Let $k$ be an algebraically closed field and let 
$$
f_\alpha(t_1,\ldots,t_n)=0
$$
be a set of polynomial equations in $n$ variables with coefficients in $k$. The set $X$ of all points $x=(x_1,\ldots,x_n)\in k^n$ which satisfy these equations is an \textbf{affine algebraic variety}.

Consider the set of all polynomials $g\in k[t_1,\ldots,t_n]$ with the property that $g(x)=0$ for all $x\in X$. This set is an ideal $I(X)$ in the polynomial ring, and is called the \textbf{ideal of the variety} $X$. The quotient ring
$$
P(X)=k[t_1,\ldots,t_n]/I(X)
$$ 
is the ring of polynomial functions on $X$, because two polynomials $g,h$ define the same polynomial function on $X$ if and only if $g-h$ vanishes at every point of $X$, that is, if and only if $g-h\in I(X)$.

Let $\xi_i$ be the image of $t_i$ in $P(X)$. The $\xi_i$ ($1\le i\le n$) are the \textbf{coordinate functions} on $X$: if $x\in X$, then $\xi_i(x)$ is the ith coordinate of $x$. $P(X)$ is generated as a $k$-algebra by the coordinate functions, and is called the \textbf{coordinate ring} (or affine algebra) of $X$.

As in Exercise~26, for each $x\in X$ let $\mmm_x$, be the ideal of all $f\in P(X)$ such that $f(x)=0$; it is a maximal ideal of $P(X)$. Hence, if $\widetilde X=\oo{Max}(P(X))$, we have defined a mapping $\mu:X\to\widetilde X$, namely $x\mapsto\mmm_x$.

It is easy to show that $\mu$ is injective: if $x\ne y$, we must have $x_i\ne y_i$ for some $i$ ($1\le i\le n$), and hence $\xi_i-x_i$ is in $\mmm_x$, but not in $\mmm_y$, so that $\mmm_x\ne\mmm_y$. What is less obvious (but still true) is that $\mu$ is \textbf{surjective}. This is one form of Hilbert's Nullstellensatz (see Chapter~7).

\nn\textbf{Solution.} Omitted. [This is more a comment than an exercise.]

\subsubsection{Page 16, Exercise~1.28}% 

\textbf{Statement.} Let $f_1,\ldots,f_m$ be elements of $k[t_1,\ldots,t_n]$. They determine a \textbf{polynomial mapping} $\phi:k^n\to k^m$: if $x\in k^n$, the coordinates of $\phi(x)$ are $f_1(x),\ldots,f_m(x)$.

Let $X,Y$ be affine algebraic varieties in $k^n,k^m$ respectively. A mapping $\phi:X\to Y$ is said to be \textbf{regular} if $\phi$ is the restriction to $X$ of a polynomial mapping from $k^n$ to $k^m$.

If $\eta$ is a polynomial function on $Y$, then $\eta\circ\phi$ is a polynomial function on X. Hence $\phi$ induces a $k$-algebra homomorphism $P(Y)\to P(X)$, namely $\eta\mapsto\eta\circ\phi$. Show that in this way we obtain a one-to-one correspondence between the regular mappings $X\to Y$ and the $k$-algebra homomorphisms $P(Y)\to P(X)$.

\nn\textbf{Solution.} Assume that $k$ is infinite [not necessarily algebraically closed] and set $t:=(t_1,\dots,t_n)$, $u:=(u_1,\dots,u_m)$, where the $t_i$ and $u_j$ are indeterminates. 

To a polynomial map $\phi:k^n\to k^m$ we attach a $k$-algebra morphism $\psi:k[u]\to k[t]$ by setting $\psi(g):=g\circ\phi$, where $g\in k[u]$ is viewed as a polynomial map $g:k^m\to k$. 

Conversely, to a $k$-algebra morphism $\psi:k[u]\to k[t]$ we attach a polynomial map $\phi:k^n\to k^m$ by setting $\phi_i(x):=\psi(u_i)(x)$. 

We claim that $\phi\mapsto\psi$ and $\psi\mapsto\phi$ are inverse bijections.

Let $\phi:k^n\to k^m$ be a polynomial map, let $\psi:k[u]\to k[t]$ be the corresponding $k$-algebra morphism, and let $\phi':k^n\to k^m$ be the polynomial map attached to $\psi$. For $x\in k^n$ we have 
$$
\phi_i'(x)=\psi(u_i)(x)=u_i(\phi(x))=\phi_i(x).
$$ 

Conversely, let $\psi:k[u]\to k[t]$ be a $k$-algebra morphism, let $\phi:k^n\to k^m$ be the corresponding polynomial map, and let $\psi':k[u]\to k[t]$ be the $k$-algebra morphism attached to $\phi$. For $g\in k[u]$ and $x\in k^n$ we have 
$$
\psi'(g)(x)=g(\phi(x))=g(\phi_1(x),\dots,\phi_m(x))=g(\psi(u_1)(x),\dots,\psi(u_m)(x)). 
$$ 
As the $k$-algebra morphisms $\alpha,\beta:k[u]\rightrightarrows k$ defined by 
$$
\alpha(g):=g(\psi(u_1)(x),\dots,\psi(u_m)(x))\quad\text{and}\quad\beta(g):=\psi(g)(x)
$$ 
coincide on the $u_i$, they are equal, so that we get 
\begin{equation}\label{128}
g(\psi(u_1)(x),\dots,\psi(u_m)(x))=\psi(g)(x),
\end{equation}
and thus $\psi'(g)(x)=\psi(g)(x)$. This shows that $\phi\mapsto\psi$ and $\psi\mapsto\phi$ are inverse bijections, proving the claim. To complete the solution to the exercise, it suffices to show [using obvious notation]:

\nn(a) If $\phi:k^n\to k^m$ maps $X$ into $Y$, then $\psi:k[u]\to k[t]$ maps $I(Y)$ into $I(X)$. 

\nn(b) If $\psi:k[u]\to k[t]$ maps $I(Y)$ into $I(X)$, then $\phi:k^n\to k^m$ maps $X$ into $Y$. 

\nn Proof of (a): For $g\in I(Y)$ and $x\in X$ we have $\psi(g)(x)=g(\phi(x))=0$. 

\nn Proof of (b): For $x\in X$ and $g\in I(Y)$ we have 
$$
g(\phi(x))=g(\phi_1(x),\dots,\phi_m(x))=g\big(\psi(u_1)(x),\dots,\psi(u_m)(x)\big)=\psi(g)(x)=0,
$$ 
the penultimate equality being justified by \eqref{128}.% comment removed: https://docs.google.com/document/d/1auR2cq3XwTck00fSWk4i_h-Fuy9JKwLC6WVMjiXaGdM/edit

\newpage

\section{About Chapter~2}%%%

\subsection{Comments}%%

\subsubsection{Page 21, Proposition~2.4}\label{p2.4}%

Proposition~2.4 reads:

\nn\emph{Let $M$ be a finitely generated $A$-module, let $\aaa$ be an ideal of $A$, and let $\phi$ be an $A$-module endomorphism of $M$ such that $\phi(M)\subseteq\aaa M$. Then $\phi$ satisfies an equation of the form
$$
\phi^n+a_1\,\phi^{n-1}+\cdots+a_n=0
$$ 
where the $a_i$ are in $\aaa$.}

Strictly speaking, this makes no sense because $\phi$ and the $a_i$ belong to different rings. We suggest the following restatement:

\nn\emph{Let $M$ be a finitely generated $A$-module, let $\aaa$ be an ideal of $A$, let $\phi$ be an $A$-module endomorphism of $M$ such that $\phi(M)\subseteq\aaa M$, and let $\psi:A\to\oo{End}_A(M)$ be the natural morphism. Then $\phi$ satisfies an equation of the form
$$
\phi^n+\psi(a_1)\,\phi^{n-1}+\cdots+\psi(a_n)=0
$$ 
where the $a_i$ are in $\aaa$.}

[We have used the symbol $\subseteq$ above to make the quote accurate, but in general we denote inclusions by $\subset$.]

Another fix would be to equip $\operatorname{End}_A(M)$ with its natural $A$-module structure and change the display to 
$$
\phi^n+a_1\,\phi^{n-1}+\cdots+a_n\,\phi^0=0.
$$

If $\phi=\psi(y)$ for some $y$ in $A$ we get 
\begin{equation}\label{eq2124}
\psi(y^n+a_1y^{n-1}+\cdots+a_n)=0.
\end{equation}
This yields the following:

\nn\emph{If $yM\subset\aaa M$ for some $y$ in $A$, then there is an $x$ in $A$ such that $xM=0$ and $x\equiv y^n\pmod{\aaa}$ for some $n$.}

Corollary 2.5 reads:

\begin{cor}[Corollary 2.5 p.~21]\label{c2.5}
Let $M$ be a finitely generated $A$-module and let $\aaa$ be an ideal of $A$ such that $\aaa M=M$. Then there exists $x\equiv1\pmod{\aaa}$ such that $xM=0$.
\end{cor}

The proof reads: Take $\phi=$ identity, $x=1+a_1+\cdots+a_n$ in (2.4).

I suggest the following restatement of the proof:

Since $\phi=$ identity, we can take $y=1$ in \eqref{eq2124}. This gives $\psi(1+a_1+\cdots+a_n)=0$, and we can set $x:=1+a_1+\cdots+a_n$.

Note that Corollary 2.5 can also be stated as follows: 

\begin{cor}
Let $M$ be a finitely generated $A$-module and let $\aaa$ be an ideal of $A$ such that $\aaa M=M$. Then there exists $\alpha\in\aaa$ such that $\alpha m=m$ for all $m\in M$.
\end{cor}

In other words, we go from $\aaa M=M$ to $\alpha m=m$. Here is a particular case [take $\aaa:=(a)$]: 

\begin{cor}\label{ak}
Let $M$ be a finitely generated $A$-module and let $a\in A$ satisfy $aM=M$. Then there is a $b\in A$ such that $abm=m=bam$ for all $m\in M$. In particular, if the endomorphism $m\mapsto am$ of $M$ is surjective, then it is bijective. 
\end{cor}

Here is a particular case of the particular case: 

\begin{cor}\label{notor}
Let $M$ be a finitely generated $A$-module and $\phi$ a surjective endomorphism of $M$. Then $\phi$ is bijective. 
\end{cor} 

\begin{proof}
Let $x$ be an indeterminate, view $M$ as an $A[x]$-module on which $x$ acts by $\phi$, and apply Corollary~\ref{ak} to the ring $A[x]$ and the element $x$. 
\end{proof}

Let us also state Nakayama's Lemma [Proposition~2.6 p.~21 of the book]:

\begin{prop}[Nakayama's Lemma]\label{nak}
Let $M$ be a finitely generated $A$-module and $\aaa$ an ideal of $A$ contained in the Jacobson radical of $A$. Then $\aaa M=M$ implies $M=0$. 
\end{prop}

Let us rewrite the proof of Proposition~2.4 to turn it into a proof of the corrected statement: 

\nn Let $x_1,\dots,x_n$ be a set of generators of $M$. Then each $\phi(x_i)\in\aaa M$, so that we have say $\phi(x_i)=\sum_{j=1}^na_{ij}x_j\ (1\le i\le n; a_{ij}\in\aaa)$, i.e., $
\sum_{j=1}^n\ (\delta_{ij}\phi-\psi(a_{ij}))\ x_j=0,$ where $\delta_{ij}$ is the Kronecker delta. Set $b_{ij}:=\delta_{ij}\phi-\psi(a_{ij})$, and let us regard the matrix $(b_{ij})$ as a matrix with entries in the subring $B$ of $\text{End}_A(M)$ generated by $\psi(A)$ and $\phi$, subring which is clearly commutative. Letting $(c_{ij})$ be the adjoint of $(b_{ij})$, we get 
$$
0=\sum_jc_{ij}\sum_kb_{jk}x_k=\sum_{j,k}c_{ij}b_{jk}x_k=\sum_k\left(\sum_jc_{ij}b_{jk}\right)x_k=\sum_k\delta_{ik}\det(b_{j\ell})\,x_k=\det(b_{j\ell})\,x_i.
$$ 
It follows that $\det(b_{j\ell})$ annihilates each $x_i$, hence is the zero endomorphism of $M$. Expanding out the determinant, we have an equation of the required form.

[The underlying reasoning is that we consider the natural morphism from the ring of $n$ by $n$ matrices with entries in $B$ to the endomorphism ring of the $A$-module $M^n$.] 

\subsubsection{Page 23, proof of Proposition~2.9 (i)}%

Let us prove: $\overline v$ injective $\implies$ $v$ surjective. If $\phi:M''\to M''/\oo{Im}(v)$ is the canonical projection, we get 
$$
0=\phi\circ v=\overline v(\phi)\ \implies\ \phi=0\ \implies\ v\text{ surjective.}
$$

\subsubsection{Page 24, vanishing tensors}\label{vt}%Permanent tag: vanten.

This is taken from Lemma 10, Chapter~1, Section~2, Subsection~11, page~41 in Nicolas Bourbaki, \textbf{Algèbre commutative: Chapitres 1 à 4}, Masson, Paris 1985:

\nn\emph{Let $A$ be a (non necessarily commutative) associative ring with $1$, let $M$ be a right $A$-module, let $N$ be a left $A$-module, let $(y_i)_{i\in I}\subset N$ be a generating family, let $(\,x_i)_{i\in I}\subset M$ be a finitely supported family, and assume that we have $\sum_{i\in I}x_i\otimes y_i=0$ in $M\otimes_AN$. Then there is a finite set $J$ and there are finitely supported families $(x'_j)_{j\in J}\subset M$ and $(a_{ij})_{i\in I,j\in J}\subset A$ such that $\sum_{j\in J} x'_ja_{ij}=x_i$ for all $i$ and $\sum_{i\in I}a_{ij}y_i=0$ for all $j$.}

\begin{proof} 
Let $F$ be the free left $A$-module whose basis is the family of symbols $(\,e_i)_{i\in I}$, and consider the exact sequence $0\to R\xrightarrow\iota F\xrightarrow\varphi N\to 0$, where $\varphi$ is defined by $\varphi(e_i)=y_i$. It induces the exact sequence $M\otimes_AR\xrightarrow{\iota'}M\otimes_AF\xrightarrow{\varphi'}M\otimes_AN\to 0$, and we get successively
$$
\varphi'\left(\sum_{i\in I}x_i\otimes e_i\right)=\sum_{i\in I}x_i\otimes y_i=0,
$$ 
$$
\sum_{i\in I}x_i\otimes e_i=\iota'\left(\sum_{j\in J}x'_j\otimes r_j\right)=\sum_{j\in J}x'_j\otimes\iota(r_j)
$$ 
where $J$ is a finite set, where $x'_j$ is in $M$ and where $r_j$ is in $R$, $
\iota(r_j)=\sum_{i\in I}a_{ij}e_i$ for some finitely supported family $(a_{ij})_{i\in I,j\in J}\subset A$, 
$$
\sum_{i\in I}x_i\otimes e_i=\sum_{j\in J}x'_j\otimes\iota(r_j)=\sum_{j\in J} x'_j\otimes\sum_{i\in I}a_{ij}e_i=\sum_{i\in I}\sum_{j\in J} x'_j\otimes a_{ij}e_i=\sum_{i\in I}\left(\sum_{j\in J}x'_ja_{ij}\right)\otimes e_i,
$$ 
$$
x_i=\sum_{j\in J}x'_ja_{ij}\quad\text{and}\quad0=\varphi(\iota(r_j))=\sum_{i\in I}a_{ij}y_i.
$$ 
\end{proof}

In the same spirit, we have:

\nn\emph{Let $A$ be a (non necessarily commutative) associative ring with $1$; let $I$ be a set; let $J$ be a finite set; let $A^{\oplus I}\xrightarrow\phi A^{\oplus J}\xrightarrow\psi N\to0$ be an exact sequence of left $A$-modules; let $\phi$ be given by $\phi(e_i)=\sum_ja_{ij}f_j$, where $(e_i)$ and $(f_j)$ are the obvious canonical bases; for $j$ in $J$ set $v_j:=\psi(f_j)\in N$; let $M$ be a right $A$-module; let $u$ in $M^{\oplus J}$ satisfy $\sum u_j\otimes v_j=0$ in $M\otimes_AN$. Then there is a $w$ in $M^{\oplus I}$ such that $\sum_iw_ia_{ij}=u_j$ for all $j$.}

\begin{proof} 
Applying $M\otimes_A-\ $ to the above exact sequence we get the exact sequence 
$$
M^{\oplus I}\xrightarrow{\phi'}M^{\oplus J}\xrightarrow{\psi'}M\otimes_AN\to0
$$ 
and $\psi'(u)=0$. Thus there is a $w$ in $M^{\oplus I}$ such that $\phi'(w)=u$, and it's easy to see that this $w$ does the job. 
\end{proof}

\subsubsection{Page 27, contracted ideals}\label{27}%

If $A\to B$ is a morphism, then an ideal $\aaa$ of $A$ is contracted if and only if the natural map $A/\aaa\to B\otimes_A A/\aaa$ is injective. In particular, if a proper ideal $\aaa$ is contracted, we have $B\otimes_A A/\aaa\ne0$. Indeed, $B\otimes_A A/\aaa\simeq B/\aaa^{\oo e}$ and $\oo{Ker}(A/\aaa\to B\otimes_A A/\aaa)\simeq\aaa^{\oo{ec}}/\aaa$. %(Compare with Section~\ref{43b} p.~\pageref{43b}.)

\subsubsection{Page 29, Proposition~2.19}%

I do not understand the proof that (ii) implies (i). Here is another argument.

We start by proving (ii)$\iff$(iii) as in the book. Then we prove (iii)$\implies$(i) as follows:

Let $P\xr fQ\xr gR$ be exact, let $Q\xr{g'}g(Q)$ and $g(Q)\xr iR$ be the obvious maps, and let $T$ be the functor $N\otimes_A-$. We must show that 
$$
T(P)\xr{T(f)}T(Q)\xr{T(g)}T(R)
$$ 
is exact. The sequences 
$$
P\xr fQ\xr{g'}g(Q)\to0,\quad0\to g(Q)\xr{i'}R,
$$ 
$$
T(P)\xr{T(f)}T(Q)\xr{T(g')}T(g(Q))\to0,\quad0\to T(g(Q))\xr{T(i')}T(R),
$$ 
being exact, we get $
\Ker(T(g))=\Ker(T(i)\circ T(g'))=\oo{Im}(T(f))$.

\subsubsection{Page 30, Tensor product of algebras}\label{tpa}%

The claim on p.~31 that ``the mapping $a\mapsto f(a)\otimes g(a)$ is a ring homomorphism $A\to D$'' is incorrect. The expression $f(a)\otimes g(a)$ should be replaced with $f(a)\otimes1$ [which is equal to $1\otimes g(a)$].

Note that the tensor product $B\otimes_AC$ of the $A$-algebras $B$ and $C$ ``is'' their coproduct. The tensor product of an arbitrary family $(B_\lambda)_{\lambda\in\Lambda}$ of $A$-algebras defined in Exercise~23 p.~34 [Section~\ref{ex2.23} p.~\pageref{ex2.23}] is also the coproduct of the family: see this Mathematics Stackexchange post of Eric Wofsey: \href{https://math.stackexchange.com/a/2441323/660}{https://math.stackexchange.com/a/2441323/660}.

\subsection{Exercises}%%

\subsubsection{Page 31, Exercise~2.1}%

\textbf{Statement.} Show that $(\mathbb Z/m\mathbb Z)\times_{\mathbb Z}(\mathbb Z/n\mathbb Z)=0$ if $m,n$ are coprime.

Generalization: compute $A/\aaa\otimes_AA/\bbb$ [obvious notation]. 

\nn\textbf{Solution.} Using Exercise 2.2 in Section~\ref{ex2.2} below, we get
$$
\frac{A}{\aaa}\otimes_A\frac{A}{\bbb}\simeq\frac{A/\bbb}{\aaa(A/\bbb)}\simeq\frac{A/\bbb}{\aaa/(\aaa\cap\bbb)}\simeq\frac{A/\bbb}{(\aaa+\bbb)/\bbb}\simeq\frac A{\aaa+\bbb}\ .
$$
More precisely this means that the solid diagram 
% https://q.uiver.app/?q=WzAsNCxbMCwwLCJBXFxvdGltZXMgQSJdLFsxLDAsIkEiXSxbMCwxLCJcXGZyYWMgQXtcXG1hdGhmcmFrIGF9XFxvdGltZXNcXGZyYWMgQXtcXG1hdGhmcmFrIGJ9Il0sWzEsMSwiXFxmcmFjIEF7XFxtYXRoZnJha3thK2J9fSJdLFswLDFdLFswLDJdLFsxLDNdLFsyLDMsIiIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	{A\otimes A} & A \\
	{\frac A{\mathfrak a}\otimes\frac A{\mathfrak b}} & {\frac A{\mathfrak{a+b}}}
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow[dashed, from=2-1, to=2-2]
\end{tikzcd}\]
where the solid arrows are the obvious ones, can be completed as indicated in a unique way, and that the induced map is bijective.

\subsubsection{Page 31, Exercise~2.2}\label{ex2.2}%

\textbf{Statement.} Let $A$ be a ring, $\aaa$ an ideal, $M$ an $A$-module. Show that $(A/\aaa)\otimes_AM$ is isomorphic to $M/\aaa M$.

\nn[Tensor the exact sequence $0\to\aaa\to A\to A/\aaa\to0$ with $M$.]

\nn\textbf{Solution.} Here is a more precise statement: there is a unique $A$-linear map $f:(A/\aaa)\otimes_AM\to M/\aaa M$ such that $f(\ov a)\otimes x=\ov{ax}$ for all $a\in A$, $x\in M$, where $\ov a\in A/\aaa$ is the image of $a\in A$ and $\ov{ax}\in M/\aaa M$ is the image of $ax\in M$. Moreover $f$ is bijective.

Let us sketch the proof. Consider the sequence 
$$
\aaa\otimes_AM\xr gM\xr h(A/\aaa)\otimes_AM\to0,
$$ 
where $g$ and $h$ are defined by $g(a\otimes x)=ax$ and $h(x)=1\otimes x$. This sequence is exact, and the image of $g$ is $\aaa M\subset M$.

\subsubsection{Page 31, Exercise~2.3}\label{ex2.3}%

\textbf{Statement.} Let $A$ be a local ring, $M$ and $N$ finitely generated $A$-modules. Prove that if $M\otimes N=0$, then $M=0$ or $N=0$.

\nn[Let $\mmm$ be the maximal ideal, $k=A/\mmm$ the residue field. Let $M_k=k\otimes_AM$ $\simeq$ $M/\mmm M$ by Exercise~2. By Nakayama's lemma (Proposition~\ref{nak} p.~\pageref{nak}), $M_k=0$ $\implies$ $ M=0$. But $M\otimes_AN=0$ $\implies$ $(M\otimes_AN)_k=0$ $\implies$ $M_k\otimes_k N_k=0$ $\implies$ $M_k=0$ or $N_k=0$, since $M_k,N_k$ are vector spaces over a field.]

\nn\textbf{Solution.} Omitted. [The hint is fairly complete.]

\subsubsection{Page 31, Exercise~2.4}%

\textbf{Statement.} Let $M_i$ ($i\in I$) be any family of $A$-modules, and let $M$ be their direct sum. Prove that $M$ is flat $\iff$ each $M_i$ is flat.

\nn\textbf{Solution.} This will follow from the solution to Exercise~2.20 given below in Section~\ref{ex2.20} p.~\pageref{ex2.20}.

\subsubsection{Page 32, Exercise~2.5}%

\textbf{Statement.} Let $A[x]$ be the ring of polynomials in one indeterminate over a ring $A$. Prove that $A[x]$ is a flat $A$-algebra. [Use Exercise~4.]

\nn\textbf{Solution.} As an $A$-module $A[x]$ is a direct sum of copies of $A$. Since $A$ is $A$-flat, this implies that $A[x]$ is also $A$-flat.%Left to the reader. [The hint is fairly complete.]

\subsubsection{Page 32, Exercise~2.6}%

\textbf{Statement.} For any $A$-module, let $M[x]$ denote the set of all polynomials in $x$ with coefficients in $M$, that is to say expressions of the form 
$$
m_0+m_1x+\cdots+m_rx^r\qquad(m_i\in M).
$$
Defining the product of an element of $A[x]$ and an element of $M[x]$ in the obvious way, show that $M[x]$ is an $A[x]$-module.

Show that $M[x]\simeq A[x]\otimes_A M$.

\nn\textbf{Solution.} Left to the reader.%easy? 2

\subsubsection{Page 32, Exercise~2.7}%

\textbf{Statement.} Let $\ppp$ be a prime ideal in $A$. Show that $\ppp[x]$ is a prime ideal in $A[x]$. If $\mmm$ is a maximal ideal in $A$, is $\mmm[x]$ a maximal ideal in $A[x]$? 

\nn\textbf{Solution.} By the previous two exercises we have an isomorphism of $A$-modules $A[x]/\ppp[x]\simeq(A/\ppp)[x]$, and it is easy to check that it is in fact an isomorphism of $A$-algebras [and in particular an isomorphism of rings]. If $A$ is a field, then $(0)$ is a maximal ideal of $A$ but $(0)[x]=(0)$ is not a maximal ideal of $A[x]$.

\subsubsection{Page 32, Exercise~2.8}\label{ex2.8}%

\textbf{Statement.} (i) If $M$ and $N$ are flat $A$-modules, then so is $M\otimes_AN$.

\nn(ii) If $B$ is a flat $A$-algebra and $N$ is a flat $B$-module, then $N$ is flat as an $A$-module.% 9. Let $0\to M'\to M\to M''\to0$ be an exact sequence of $A$-modules. If $M'$ and $M''$ are finitely generated, then so is $M$.

\nn\textbf{Hints.} (i) We have $(M\otimes_AN)\otimes_AP\simeq M\otimes_A(N\otimes_AP)$.

\nn(ii) We have $N\otimes_AP\simeq N\otimes_B(B\otimes_AP)$.

\subsubsection{Page 32, Exercise~2.9}%

\textbf{Statement.} Let $0\to M'\to M\to M''\to 0$ be an exact sequence of $A$-modules. If $M'$ and $M''$ are finitely generated, then so is $M$.

\nn\textbf{Solution.} Let $f$ be the map from $M'$ to $M$ occurring in the above exact sequence; let $x'_1,\ldots,x'_m$ be generators of $M'$; let $x''_1,\ldots,x''_n$ be generators of $M''$; and let $x_j\in M$ be a pre-image of $x''_j$ ($1\le j\le n$). It is easily seen that the $f(x'_i)$ together with the $x_j$ generate $M$.

\subsubsection{Page 32, Exercise~2.10}%

\textbf{Statement.} Let $A$ be a ring, $\aaa$ an ideal contained in the Jacobson radical of $A$; let $M$ be an $A$-module and $N$ a finitely generated $A$-module, and let $u:M\to N$ be a homomorphism. If the induced homomorphism $M/\aaa M\to N/\aaa N$ is surjective, then $u$ is surjective.

\nn\textbf{Solution.} We have $N=\aaa N+u(M)$, and Corollary~2.7 p.~22 of the book implies $N=u(M)$. Recall that Corollary~2.7 is a corollary to Proposition 2.6, which is Nakayama's lemma. Here is the statement of Corollary~2.7:
\begin{cor}[Corollary~2.7 p.~22 of the book]
Let $M$ be a finitely generated $A$-module, $N$ a submodule of $M$, $\aaa\subset\RRR$ an ideal. Then $M=\aaa M+N\implies M=N$.
\end{cor}

\subsubsection{Page 32, Exercise~2.11}%

\textbf{Statement.} Let $A$ be a ring $\ne0$. Show that $A^m\simeq A^n\implies m=n$.

\nn[Let $\mmm$ be a maximal ideal of $A$ and let $\phi:A^m\to A^n$ be an isomorphism. Then $1\otimes\phi:(A/\mmm)\otimes_A^m\to(A/\mmm)\otimes_A^n$ is an isomorphism between vector spaces of dimensions $m$ and $n$ over the field $k=A/\mmm$. Hence $m=n$.] (Cf. Chapter~3, Exercise~15 [Section~\ref{ex3.15} p.~\pageref{ex3.15}].)

If $\phi:A^m\to A^n$ is surjective, then $m\ge n$.

If $\phi:A^m\to A^n$ is injective, is it always the case that $m\le n$?

\nn\textbf{Hint.} We only solve the last part of Exercise~2.11. We claim that if $f:A^m\to A^n$ is an $A$-linear injection, then $m\le n$. The claim is an immediate consequence of the following lemma.

\begin{lem}
If $A$ is a ring, $M_1$ and $M_2$ are finitely generated $A$-modules, $M_2$ is faithful and $f:M_1\oplus M_2\to M_1$ is a morphism, then $f$ is not injective.
\end{lem}

\begin{proof}
Suppose for the sake of contradiction that $f$ is injective. Setting $M:=M_1\oplus M_2$, define $g:M\to M$ by $g(x+y):=f(x+y)$ for $x\in M_1$, $y\in M_2$ [we regard $M_1$ and $M_2$ as submodules of $M$]. Note that $g$ is injective. By Proposition~2.4 p.~21 of the book [see Section~\ref{p2.4} p.~\pageref{p2.4} above] we have 
\begin{equation}\label{gna}
g^n+a_1\,g^{n-1}+\cdots+a_{n-1}\,g^1+a_n\,g^0=0
\end{equation} 
for some $a_1,\ldots,a_n\in A$. We can assume that $n$ is minimal [note that we have $n\ge2$]. Applying \eqref{gna} to $y\in M_2$ yields 
$$
\Big(g^n(y)+a_1\,g^{n-1}(y)+\cdots+a_{n-1}\,g(y)\Big)+(a_n\,y)=0.
$$ 
Since the first parenthesis is in $M_1$, both parenthesis vanish. Since $y$ is arbitrary and $M_2$ is faithful, this implies $a_n=0$, and \eqref{gna} becomes 
$$
g\,\Big(g^{n-1}+a_1\,g^{n-2}+\cdots+a_{n-1}\,g^0\Big)=0.
$$ 
The parenthesis being zero by injectivity of $g$, we get a contradiction with the minimality of $n$.
\end{proof}%Set $k:=i+j$ and define $g:A^k\to A^k$ by $g(x,y):=(f(x,y),0)$ for $x\in A^i$, $y\in A^j$. Note that $g$ is injective. By Proposition~2.4 p.~21 of the book [see Section~\ref{p2.4} p.~\pageref{p2.4} above] there is a monic polynomial $P\in A[t]$ and an $a\in A$ such that \\ \begin{equation}\label{211}\\ gP(g)=a\oo{id}_{A^k}.\\ \end{equation} \\ We can assume that the degree of $P$ is minimal for this condition. In particular $P(g)$ is nonzero. Evaluating \eqref{211} on $(0,y)$, $y\in A^j$, gives $ay=0$. As $y$ is arbitrary, this implies $a=0$, and thus $gP(g)=0$, and the injectivity of $g$ yields $P(g)=0$, contradiction. 

\subsubsection{Page 32, Exercise~2.12}%\label{ex2.12}%

\textbf{Statement.} Let $M$ be a finitely generated $A$-module and $\phi:M\to A^n$ a surjective homomorphism. Show that $\Ker(\phi)$ is finitely generated.

\nn[Let $e_1,\ldots,e_n$ be a basis of $A^n$ and choose $u_i\in M$ such that $\phi(u_i)=e_i$ ($1\le i\le n$). Show that $M$ is the direct sum of $\Ker(\phi)$ and the submodule generated by $u_1,\ldots,u_n$.]

\nn\textbf{Solution.} We follow the hint. Let $N$ be submodule of $M$ generated by $u_1,\ldots,u_n$. Let $x$ be in $M$. We have $\phi(x)=\sum a_ie_i$ for some $a_i\in A$. Set $y:=\sum a_iu_i\in N$. We get $x=(x-y)+y$ with $\phi(x-y)=0$. This shows $M=\Ker(\phi)+N$. Let $x$ be in $\Ker(\phi)\cap N$. We have $x=\sum a_iu_i$ for some $a_i\in A$, hence $0=\phi(x)=\sum a_ie_i$, hence $x=0$. This shows $M=\Ker(\phi)\oplus N$.

\subsubsection{Page 32, Exercise~2.13}\label{ex2.13}%

\textbf{Statement.} Let $f:A\to B$ be a ring homomorphism, and let $N$ be a $B$-module. Regarding $N$ as an $A$-module by restriction of scalars, form the $B$-module $N_B=B\otimes_AN$. Show that the homomorphism $g:N\to N_B$ which maps $y$ to $1\otimes y$ is injective and that $g(N)$ is a direct summand of $N_B$.

\nn[Define $p:N_B\to N$ by $p(b\otimes y)=by$, and show that $N_B=\oo{Im}(g)\oplus\Ker(p)$.]

\nn\textbf{Hint.} Note that $p\circ g=\oo{id}_N$.

\subsubsection{A digression about limits and colimits}\label{lim}%

The purpose of this section is to give a naive motivation for the expression of limits in terms of products and equalizers, and, dually, for the expression of colimits in terms of coproducts and coequalizers [when such exist]. These expressions are used in some of the subsequent sections.

We shall describe only limits of sets, but we shall try to do it in a way that suggests an obvious generalization for limits in categories with products and equalizers, and for colimits in categories with coproducts and coequalizers.%\\ We start with limits of sets. 

Let $\phi$ be a set such that each $f\in\Phi$ is a map $f:X_f\to Y_f$ from a set $X_f$ to a set $Y_f$. Put 
$$
\Omega:=\{X_f\ |\ f\in\Phi\}\cup\{Y_f\ |\ f\in\Phi\}.
$$
%Let $\Omega$ and $\Phi$ be two sets such that each $f\in\Phi$ is a map $f:X_f\to Y_f$ with $X_f,Y_f\in\Omega$. 
Let $L$ be a set equipped with a map $\pi_Z:L\to Z$ for each $Z\in\Omega$ such that $\pi_{Y_f}\circ f=\pi_{X_f}$:
% https://q.uiver.app/?q=WzAsMyxbMCwwLCJYX2YiXSxbMSwwLCJZX2YiXSxbMSwxLCJMIl0sWzAsMSwiZiJdLFsxLDIsIlxccGlfe1lfZn0iXSxbMCwyLCJcXHBpX3tYX2Z9IiwyXV0=
\[\begin{tikzcd}
	{X_f} & {Y_f} \\
	& L
	\arrow["f", from=1-1, to=1-2]
	\arrow["{\pi_{Y_f}}", from=1-2, to=2-2]
	\arrow["{\pi_{X_f}}"', from=1-1, to=2-2]
\end{tikzcd}\]
for all $f\in\Phi$. Such a pair $(L,(\pi_Z)_{Z\in\Omega})$ is a \textbf{limit} of the set $\Phi$ %pair $(\Omega,\Phi)$ 
if for each family $(A,(a_Z)_{Z\in\Omega})$ such that for each $a_Z$ is a map $a_Z:A\to Z$ satisfying $a_{Y_f}\circ f=a_{X_f}$ for all $f\in\Phi$ there is a unique map $a:A\to L$ making the diagram 
% https://q.uiver.app/?q=WzAsNixbMCwyLCJBIl0sWzIsMCwiWF9mIl0sWzIsNCwiWV9mIl0sWzQsMiwiTCJdLFsyLDJdLFszLDFdLFswLDEsImFfe1hfZn0iXSxbMCwyLCJhX3tZX2Z9IiwyXSxbMSwyLCJmIiwwLHsibGFiZWxfcG9zaXRpb24iOjcwfV0sWzMsMSwiXFxwaV97WF9mfSIsMl0sWzMsMiwiXFxwaV97WF9mfSJdLFswLDMsImEiLDAseyJsYWJlbF9wb3NpdGlvbiI6NzB9XV0=
\[\begin{tikzcd}
	&& {X_f} \\
	&&& {} \\
	A && {} && L \\
	\\
	&& {Y_f}
	\arrow["{a_{X_f}}", from=3-1, to=1-3]
	\arrow["{a_{Y_f}}"', from=3-1, to=5-3]
	\arrow["f"{pos=0.7}, from=1-3, to=5-3]
	\arrow["{\pi_{X_f}}"', from=3-5, to=1-3]
	\arrow["{\pi_{X_f}}", from=3-5, to=5-3]
	\arrow["a"{pos=0.7}, from=3-1, to=3-5]
\end{tikzcd}\]
commutes.

It is clear that if such a limit exists it is unique up to unique isomorphism [we leave the precise definition of the phrase ``unique up to unique isomorphism'' to the reader]. At first we assume the such a limit exists. This will yields a recipe to construct this limit, and will be easy [end left again to the reader] to verify that this recipe works.

Note that the $\pi_Z$ define a map $\pi:L\to\prod_{Z\in\Omega}Z$.

The trick is to consider the case when $A$ is a singleton. We then see that $L$ can be identified with the set of all $a=(a_Z)_{Z\in\Omega}\in\prod_{Z\in\Omega}Z$ such that $f(a_{X_f})=a_{Y_f}$ for all $f\in\Phi$.

Denoting by $p_T:\prod_{Z\in\Omega}Z\to T$ (for $T\in\Omega$) the canonical projection, we can rewrite the condition 
$$
f(a_{X_f})=a_{Y_f}\text{ for all }f\in\Phi
$$ as 
$$
(f\circ p_{X_f})(a)=p_{Y_f}(a)\text{ for all }f\in\Phi.
$$ 
We thus have two natural maps from $\prod_{Z\in\Omega}Z$ to $Y_f$ parametrized by $f\in\Phi$, namely $f\circ p_{X_f}$ and $p_{Y_f}$. To organize them into two maps from $\prod_{Z\in\Omega}Z$ to $\prod_{f\in\Phi}Y_f$ as follows. Let $q_g:\prod_{f\in\Phi}Y_f\to Y_g$ be the canonical projection, and define the maps $u$ and $v$ from $\prod_{Z\in\Omega}Z$ to $\prod_{f\in\Phi}Y_f$ by the commutative diagrams 
% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXHByb2Rfe1pcXGluXFxPbWVnYX1aIl0sWzEsMCwiXFxwcm9kX3tmXFxpblxcUGhpfVlfZiJdLFswLDEsIlhfZyJdLFsxLDEsIllfZyJdLFszLDAsIlxccHJvZF97WlxcaW5cXE9tZWdhfVoiXSxbNCwwLCJcXHByb2Rfe2ZcXGluXFxQaGl9WV9mIl0sWzQsMSwiWV9nIl0sWzIsMV0sWzAsMSwidSJdLFswLDIsInBfe1hfZ30iLDJdLFsxLDMsInFfZyJdLFsyLDMsImYiLDJdLFs0LDUsInYiXSxbNSw2LCJxX2ciXSxbNCw2LCJwX3tZX2d9IiwyXV0=
\[\begin{tikzcd}
	{\prod_{Z\in\Omega}Z} & {\prod_{f\in\Phi}Y_f} && {\prod_{Z\in\Omega}Z} & {\prod_{f\in\Phi}Y_f} \\
	{X_g} & {Y_g} & {} && {Y_g}
	\arrow["u", from=1-1, to=1-2]
	\arrow["{p_{X_g}}"', from=1-1, to=2-1]
	\arrow["{q_g}", from=1-2, to=2-2]
	\arrow["f"', from=2-1, to=2-2]
	\arrow["v", from=1-4, to=1-5]
	\arrow["{q_g}", from=1-5, to=2-5]
	\arrow["{p_{Y_g}}"', from=1-4, to=2-5]
\end{tikzcd}\]
Then we see $L$ is the equalizer of $u$ and $v$.

We can summarize this by the single diagram 
% https://q.uiver.app/?q=WzAsNyxbMSwxLCJcXHByb2Rfe1pcXGluXFxPbWVnYX1aIl0sWzIsMSwiXFxwcm9kX3tmXFxpblxcUGhpfVlfZiJdLFsyLDIsIllfZyJdLFswLDJdLFsxLDAsIlhfZyJdLFsyLDAsIllfZyJdLFswLDEsIkwiXSxbMCwxLCJ2IiwyLHsib2Zmc2V0IjoxfV0sWzEsMiwicV9nIl0sWzAsMiwicF97WV9nfSIsMl0sWzAsMSwidSIsMCx7Im9mZnNldCI6LTF9XSxbNCw1LCJmIl0sWzAsNCwicF97WF9nfSJdLFsxLDUsInFfZyIsMl0sWzYsMCwiXFxwaSJdXQ==
\[\begin{tikzcd}
	& {X_g} & {Y_g} \\
	L & {\prod_{Z\in\Omega}Z} & {\prod_{f\in\Phi}Y_f} \\
	{} && {Y_g}
	\arrow["v"', shift right=1, from=2-2, to=2-3]
	\arrow["{q_g}", from=2-3, to=3-3]
	\arrow["{p_{Y_g}}"', from=2-2, to=3-3]
	\arrow["u", shift left=1, from=2-2, to=2-3]
	\arrow["f", from=1-2, to=1-3]
	\arrow["{p_{X_g}}", from=2-2, to=1-2]
	\arrow["{q_g}"', from=2-3, to=1-3]
	\arrow["\pi", from=2-1, to=2-2]
\end{tikzcd}\]
This diagram makes sense whenever the appropriate products and equalizers exist.

We can also reverse the arrows and replace products with coproducts and equalizers with coequalizers to define colimits.

\subsubsection{Page 32, Exercise~2.14}\label{colim}%

\textbf{Statement.} A partially ordered set $I$ is said to be a \textbf{directed} set if for each pair $i,j$ in $I$ there exists $k\in I$ such that $i\le k$ and $j\le k$.

Let $A$ be a ring, let $I$ be a directed set and let $(M_i)_{i\in I}$ be a family of $A$-modules indexed by $I$. For each pair $i,j$ in $I$ such that $i\le j$, let $\mu_{ij}:M_i\to M_j$ be an $A$-homomorphism, and suppose that the following axioms are satisfied:

\nn(1) $\mu_{ii}$ is the identity mapping of $M_i$ for all $i\in I$;

\nn(2) $\mu_{ik}=\mu_{jk}\circ\mu_{ij}$ whenever $i\le j\le k$.

Then the modules $M_i$ and homomorphisms $\mu_{ij}$ are said to form a \textbf{direct system} $M=(M_i,\mu_{ij})$ over the directed set $I$.

We shall construct an $A$-module $M$ called the \textbf{direct limit} of the direct system $M$. Let $C$ be the direct sum of the $M_i$ and identify each module $M_i$ with its canonical image in $C$. Let $D$ be the submodule of $C$ generated by all elements of the form $x_i-\mu_{ij}(x_i)$ where $i\le j$ and $x_i\in M_i$. Let $M=C/D$, let $\mu:C\to M$ be the projection and let $\mu_i$ be the restriction of $\mu$ to $M_i$.

The module $M$, or more correctly the pair consisting of $M$ and the family of homomorphisms $\mu_i:M_i\to M$, is called the \textbf{direct limit} of the direct system $M$, and is written $\varinjlim M_i$. From the construction it is clear that $\mu_i=\mu_j\circ\mu_{ij}$ whenever $i\le j$.

\nn\textbf{Solution.} Here is a slightly more general construction.

Assume we have an inductive system $(M_i)$ of $A$-modules indexed by a category $I$, that is, for each object $i$ of $I$ we have an $A$-module $M_i$, and for each morphism $f:d(f)\to c(f)$ in $I$ we have an $A$-linear map $M_f:M_{c(f)}\to M_{d(f)}$. 

Consider the commutative diagram 
$$
\begin{tikzcd}
M_{d(f)}\ar[d,"\alpha_{f}"']\ar[dr,"\beta_{d(f)}"]&M_i\ar[d,"\beta_i"]\\ 
\ds\bigoplus_gM_{d(g)}\ar[r,yshift=0.9ex,"u"]\ar[r,yshift=-0.9ex,"v"']&\ds\bigoplus_jM_j\ar[r,"\pi"]&C\\ 
M_{d(f)}\ar[u,"\alpha_{f}"]\ar[r,"M_f"']&M_{c(f),}\ar[u,"\beta_{c(f)}"']
\end{tikzcd}
$$ 
where the $\alpha_f$ and the $\beta_i$ are the coprojections, and the middle row is exact [i.e. the last arrow is a coequalizer]. 

We claim that $C$ is a \textbf{colimit} of our system [see Section~\ref{lim} p.~\pageref{lim}].

Let $h:\bigoplus M_j\to N$ be $A$-linear. We have 
$$
h\circ u=h\circ v\iff h\circ u\circ\alpha_f=h\circ v\circ\alpha_f\ \forall\ f\iff h\circ\beta_{d(f)}=h\circ\beta_{c(f)}\circ M_f\ \forall\ f.
$$ 
This shows that $C$ is indeed a colimit of our system.

The following definition is taken from the Stacks Project\\ \href{https://stacks.math.columbia.edu/tag/002V}{https://stacks.math.columbia.edu/tag/002V}:

\begin{df}
We say that a category $I$ is \textbf{filtered} if the following conditions hold:
\begin{enumerate}
\item the category $I$ has at least one object,
\item for every pair of objects $x, y$ of $I$ there exists an object $z$ and morphisms $x \to z$, $y \to z$, and
\item for every pair of objects $x, y$ of $I$ and every pair of morphisms $a, b : x \to y$ of $I$ there exists a morphism $c : y \to z$ of $I$ such that $c \circ a=c\circ b$ as morphisms in $\mathcal{C}$.
\end{enumerate}
\end{df}

Assume now that the category $I$ is filtered, and form the commutative diagram 
$$
\begin{tikzcd}
M_{d(f)}\ar[d,"\alpha'_{f}"']\ar[dr,"\beta'_{d(f)}"]&M_i\ar[d,"\beta'_i"]\ar[dr,"\gamma_i"]\\ 
\ds\bigsqcup_gM_{d(g)}\ar[r,yshift=0.9ex,"u"]\ar[r,yshift=-0.9ex,"v"']&\ds\bigsqcup_iM_i\ar[r,"\pi'"]&C'\\ 
M_{d(f)}\ar[u,"\alpha'_{f}"]\ar[r,"M_f"']&M_{c(f),}\ar[u,"\beta'_{c(f)}"']
\end{tikzcd}
$$ 
which is the ``set theoretical analog'' of the previous one, that is, $\bigsqcup$ denotes disjoint union, and the middle row is exact in the category of sets [i.e. the last arrow is a set theoretical coequalizer]. Then $C'$ is the set theoretical colimit of our inductive system [see Section~\ref{lim} p.~\pageref{lim}]. 

We claim that the natural set theoretical map $C'\to C$ is bijective. 

To prove this we define a structure of $A$-module on $C'$. To define the addition it suffices to define $\gamma_i(x_i)+\gamma_j(x_j)$ for $x_i\in M_i$, $x_j\in M_j$. To do this we choose morphisms $f:i\to k$, $g:j\to k$, we check that the element $\gamma_k(M_f(x_i)+M_g(x_j))\in C'$ does not depend on the choice of $k,f$ and $g$, and we set 
$$
\gamma_i(x_i)+\gamma_j(x_j):=\gamma_k(M_f(x_i)+M_g(x_j))\in C'.
$$ 
Then we define the map $A\times C'\to C'$ [details left to the reader], we check that we have indeed defined a structure of $A$-module on $C'$, we use it to define a morphism $C\to C'$, and we check that this morphism is inverse to the morphism $C'\to C$ previously defined. Again, the details are left to the reader.% comment removed https://docs.google.com/document/d/1p9Zb4h4QfJOoEdHG-OtcEpEXKNNxvEHr9XZ5lTQ6tg8/edit

\subsubsection{Page 33, Exercise~2.15}\label{ex2.15}%

\textbf{Statement.} In the situation of Exercise~14, show that every element of $M$ can be written in the form $\mu_i(x_i)$ for some $i\in I$ and some $x_i\in M_i$.

Show also that if $\mu_i(x_i)=0$ then there exists $j\ge i$ such that $\mu_{ij}(x_i)=0$ in $M_j$.

\nn\textbf{Solution.} This follows from the comments made in the previous section [Section~\ref{colim} p.~\pageref{colim}].%; see also Section~\ref{lim} p.~\pageref{lim}].

\subsubsection{Page 33, Exercise~2.16}\label{ex2.16}%

\textbf{Statement.} Show that the direct limit is characterized (up to isomorphism) by the following property. Let $N$ be an $A$-module and for each $i\in I$ let $\alpha_i:M_i\to N$ be an $A$-module homomorphism such that $\alpha_i=\alpha_j\circ\mu_{ij}$ whenever $i\le j$. Then there exists a unique homomorphism $\alpha:M\to N$ such that $\alpha_i=\alpha\circ\mu_i$ for all $i\in I$.

\nn\textbf{Solution.} This follows from the comments made in Section~\ref{colim} p.~\pageref{colim}.% [see also Section~\ref{lim} p.~\pageref{lim}].

\subsubsection{Page 33, Exercise~2.17}%

\textbf{Statement.} Let $(M_i)_{i\in I}$ be a family of submodules of an $A$-module, such that for each pair of indices $i,j$ in $I$ there exists $k\in I$ such that $M_i+M_i\subset M_k$. Define $i\le j$ to mean $M_i\subset M_j$ and let $\mu_{ij}:M_i\to M_j$ be the embedding of $M_i$ in $M_j$. Show that
$$
\varinjlim M_i=\sum M_i=\bigcup M_i.
$$
In particular, any $A$-module is the direct limit of its finitely generated submodules.

\nn\textbf{Solution.} This follows from the comments made in Section~\ref{colim} p.~\pageref{colim}.% [see also Section~\ref{lim} p.~\pageref{lim}].

\subsubsection{Page 33, Exercise~2.18}%

\textbf{Statement.} Let $\mathbf M=(M_i,\mu_{ij})$, $\mathbf N=(N_i,\nu_{ij})$ be direct systems of $A$-modules over the same directed set. Let $M,N$ be the direct limits and $\mu_i:M_i\to M$, $\nu_i:N_i\to N$ the associated homomorphisms.

A \textbf{homomorphism} $\mathbf\Phi:\mathbf M\to\mathbf N$ is by definition a family of $A$-module homomorphisms $\phi_i:M_i\to N_i$ such that $\phi_j\circ\mu_{ij}=\nu_{ij}\circ\phi_i$ whenever $i\le j$. Show that $\mathbf\Phi$ defines a unique homomorphism $\phi=\varinjlim\phi_i:M\to N$ such that $\phi\circ\mu_i=\nu_i\circ\phi_i$ for all $i\in I$.

\nn\textbf{Solution.} Left to the reader.%easy? 2

\subsubsection{Page 33, Exercise~2.19}%

\textbf{Statement.} A sequence of direct systems and homomorphisms
$$
\mathbf M\to\mathbf N\to\mathbf P
$$ 
is \textbf{exact} if the corresponding sequence of modules and module homomorphisms is exact for each $i\in I$. Show that the sequence $M\to N\to P$ of direct limits is then exact. [Use Exercise~15 (Section~\ref{ex2.15} p.~\pageref{ex2.15}).]

\nn\textbf{Hint.} Using obvious notation, writing $\mathbf\Phi:\mathbf M\to\mathbf N$, $\mathbf\Psi:\mathbf N\to\mathbf P$, $\phi:M\to N$ and $\psi:N\to P$ for the morphisms in the statement and denoting by $\mu_{ji},\nu_{ji},\pi_{ji}$ what the book designates by $\mu_{ij},\nu_{ij},\pi_{ij}$, let $y\in\Ker\psi$. Then $y$ is of the form $\nu_i(y_i)$ for some $i\in I$ and $y_i\in N_i$ such that $\pi_i(\psi_i(y_i))=0$. Thus there is a $j\ge i$ with $\pi_{ji}(\psi_i(y_i))=0$, that is $\psi_j(\nu_{ji}(y_i))=0$. Hence there is an $x_j\in M_j$ with $\nu_{ji}(y_i)=\phi_j(x_j)$, and it is straightforward to check that we have $y=\mathbf\phi(\mu_j(x_j))$.

Note that colimits are \textbf{not} exact in general. For instance cokernels are \textbf{not} exact, as shown by the following example. Consider the exact sequence 
$$
0\to 4\Z\to\Z\text{ and }0\to 2\Z\to\Z,
$$ 
where the morphisms are the inclusions. A morphism from the first exact sequence to the second one is given by the commutative diagram 
% https://q.uiver.app/?q=WzAsNixbMCwwLCIwIl0sWzEsMCwiNFxcbWF0aGJiIFoiXSxbMiwwLCJcXG1hdGhiYiBaIl0sWzEsMSwiMlxcbWF0aGJiIFoiXSxbMiwxLCJcXG1hdGhiYiBaIl0sWzAsMSwiMCJdLFswLDFdLFsxLDJdLFswLDVdLFsxLDNdLFsyLDRdLFs1LDNdLFszLDRdXQ==
\[\begin{tikzcd}
	0 & {4\mathbb Z} & {\mathbb Z} \\
	0 & {2\mathbb Z} & {\mathbb Z}
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow[from=1-3, to=2-3]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
\end{tikzcd}\]
[the morphisms are again the inclusions]. The sequence of cokernels is clearly not exact.

\subsubsection{Page 33, Exercise~2.20}\label{ex2.20}% comment removed https://docs.google.com/document/d/17kV4NGPGv6_o1oibgrm3QyNS-c5T0mJVynjJzqlLK9o/edit

\textbf{Statement.} Keeping the same notation as in Exercise~14, let $N$ be any $A$-module. Then $(M_i\otimes N,\mu_{ij}\otimes1)$ is a direct system; let $P=\varinjlim\,(M_i\otimes N)$ be its direct limit.

For each $i\in I$ we have a homomorphism $\mu_i\otimes1:M_i\otimes N\to M\otimes N$, hence by Exercise~16 [Section~\ref{ex2.16} p.~\pageref{ex2.16}] a homomorphism $\psi:P\to M\otimes N$. Show that $\psi$ is an isomorphism, so that
$$
\varinjlim\,(M_i\otimes N)\simeq\left(\varinjlim M_i\right)\otimes N.
$$ 
[For each $i\in I$, let $g_i:M_i\times N\to M_i\otimes N$ be the canonical bilinear mapping. Passing to the limit we obtain a mapping $g:M\times N\to P$. Show that $g$ is $A$-bilinear and hence define a homomorphism $\phi:M\otimes N\to P$. Verify that
$\phi\circ\psi$ and $\psi\circ\phi$ are identity mappings.]

\nn\textbf{Solution.} In view of Section~\ref{colim} p.~\pageref{colim}, to prove that 
\begin{equation}\label{tpcwc}
\text{the tensor product commutes with colimits,} 
\end{equation}
it suffices to check that it commutes with direct sums.

To do so, let $M$ be an $A$-module, let $(N_i)$ be a family of $A$-module, let $\alpha_i:N_i\to\bigoplus_iN_i$ and $\beta_i:M\otimes N_i\to M\otimes(\bigoplus_iN_i)$ be the canonical coprojections [in this section the tensor products are taken over $A$], and define the morphism $f:M\otimes(\bigoplus_iN_i)\to\bigoplus_i(M\otimes N_i)$ by the commutative diagram 
$$
\begin{tikzcd} 
\bigoplus_i(M\otimes N_i)\ar[r,"f"]& M\otimes\left(\bigoplus_iN_i\right)\\ 
M\otimes N_i\ar[u,"\beta_i"]\ar[r,equal]&M\otimes N_i.\ar[u,"1\otimes\alpha_i"']
\end{tikzcd}
$$ 
It suffices to show that $f$ is bijective. We will define a morphism 
$$
g:M\otimes(\bigoplus_iN_i)\to\bigoplus_i(M\otimes N_i)
$$ 
and show that it is inverse to $f$. Let $x$ be in $M$. We define 
$$
g_x:\bigoplus_iN_i\to\bigoplus_i(M\otimes N_i)
$$ 
by the commutative diagram 
% https://q.uiver.app/?q=WzAsNCxbMCwwLCJcXGJpZ29wbHVzX2lOX2kiXSxbMSwwLCJcXGJpZ29wbHVzX2koTVxcb3RpbWVzIE5faSkiXSxbMCwxLCJOX2kiXSxbMSwxLCJNXFxvdGltZXMgTl9pIl0sWzAsMSwiZ194Il0sWzIsMCwiXFxhbHBoYV9pIl0sWzMsMSwiXFxiZXRhX2kiLDJdLFsyLDMsImdfe3gsaX0iLDJdXQ==
\[\begin{tikzcd}
	{\bigoplus_iN_i} & {\bigoplus_i(M\otimes N_i)} \\
	{N_i} & {M\otimes N_i,}
	\arrow["{g_x}", from=1-1, to=1-2]
	\arrow["{\alpha_i}", from=2-1, to=1-1]
	\arrow["{\beta_i}"', from=2-2, to=1-2]
	\arrow["{g_{x,i}}"', from=2-1, to=2-2]
\end{tikzcd}\]
where $g_{x,i}$ sends $y$ to $x\otimes y$. Since $g_x(y)$ depends linearly on $x$, the family $(g_x)_{x\in M}$ induces the desired morphism $g$, and we leave it to the reader to check that $g$ is inverse to $f$.

\subsubsection{Page 34, Exercise~2.21}\label{ex2.21}%

\textbf{Statement.} Let $(A_i)_{i\in I}$ be a family of rings indexed by a directed set $I$, and for each pair $i\le j$ in $I$ let $\alpha_{ij}:A_i\to A_j$ be a ring homomorphism, satisfying conditions (1) and (2) of Exercise~14. Regarding each $A_i$ as a $\mathbb Z$-module we can then form the direct limit $A=\varinjlim A_i$. Show that $A$ inherits a ring structure from the $A_i$ so that the mappings $A_i\to A$ are ring homomorphisms. The ring $A$ is the \textbf{direct limit} of the system $(A_i,\alpha_{ij})$.

If $A=0$ prove that $A_i=0$ for some $i\in I$. [Remember that all rings have identity elements!]

\nn\textbf{Solution.} Follows from the hint and Exercise 2.15 [Section~\ref{ex2.15} p.~\pageref{ex2.15}]. %Left to the reader.

\subsubsection{Page 34, Exercise~2.22}\label{ex2.22}%

\textbf{Statement.} Let $(A_i)_{i\in I}$ be a direct system of rings and let $\NNN_i$ be the nilradical of $A_i$. Show that $\varinjlim\NNN_i$ is the nilradical of $\varinjlim A_i$.

If each $A_i$ is an integral domain, then $\varinjlim A_i$ is an integral domain.

\nn\textbf{Solution.} Follows from Exercise 2.15 [Section~\ref{ex2.15} p.~\pageref{ex2.15}]. %Left to the reader.

\subsubsection{Page 34, Exercise~2.23}\label{ex2.23}%

\textbf{Statement.} Let $(B_\lambda)_{\lambda\in\Lambda}$ be a family of $A$-algebras. For each finite subset $J$ of $\Lambda$ let $B_J$ denote the tensor product (over $A$) of the $B_\lambda$ for $\lambda\in J$. If $J'$ is another finite subset of $\Lambda$ and $J\subset J'$, there is a canonical $A$-algebra homomorphism $B_J\to B_{J'}$. Let $B$ denote the direct limit of the rings $B_J$ as $J$ runs through all finite subsets of $\Lambda$. The ring $B$ has a natural $A$-algebra structure for which the homomorphisms $B_J\to B$ are $A$-algebra homomorphisms. The $A$-algebra $B$ is the \textbf{tensor product} of the family $(B_\lambda)_{\lambda\in\Lambda}$.

\nn\textbf{Solution.} Follows from Exercise 2.21 [Section~\ref{ex2.21} p.~\pageref{ex2.21}]. %Left to the reader.

\nn\textbf{Note.} As mentioned in Section~\ref{tpa} p.~\pageref{tpa} above, the $A$-algebra $B$ defined in the statement of the exercise is the \textbf{coproduct} of the family $(B_\lambda)_{\lambda\in\Lambda}$. We repeat the reference to this Mathematics Stackexchange post of Eric Wofsey: \href{https://math.stackexchange.com/a/2441323/660}{https://math.stackexchange.com/a/2441323/660}.

Here is an important consequence of the above note:

\begin{thm}
If $A$ is a ring, then the category of $A$-algebras has all limits and all colimits.
\end{thm}
\begin{proof}[Proof (sketch)] 
In view of the argument described in Section~\ref{lim} p.~\pageref{lim} and Section~\ref{colim} p.~\pageref{colim}, it suffices to show that the following particular limits and colimits exist in the category of $A$-algebras: products, equalizers, coproducts and coequalizers. Products and equalizers can be computed in the category of sets. As just indicated, arbitrary coproducts are given by tensor products. The coequalizer of a pair of parallel morphisms $f,g:B\rightrightarrows C$ is furnished by the canonical projection $C\to C/\ccc$ where $\ccc$ is the ideal generated by the elements of the form $f(b)-g(b)$. The details are left to the reader.% The details of the proof are left to the reader, but the main ingredient is the argument described in Section~\ref{colim} p.~\pageref{colim}.
\end{proof}

\nn\textbf{Comment.} Exercises 2.21 and 2.22 of the book imply that $B=0$ if and only if $B_{\lambda_1}\otimes_A\cdots\otimes_AB_{\lambda_n}=0$ for some family $(\lambda_1,\dots,\lambda_n)$ of distinct elements of $\Lambda$.

\subsubsection{Page 34, Exercise~2.24}%

\textbf{Statement.} If $M$ is an $A$-module, the following are equivalent: 

\nn(i) $M$ is flat;

\nn(ii) $\oo{Tor}^A_n(M,N)=0$ for all $n>0$ and all $A$-modules $N$;

\nn(iii) $\oo{Tor}^A_1(M,N)=0$ for all $A$-modules $N$.

\nn[To show that (i) $\implies$ (ii), take a free resolution of $N$ and tensor it with $M$. Since $M$ is flat, the resulting sequence is exact and therefore its homology groups, which are the $\oo{Tor}^A_n(M, N)$, are zero for $n>0$. To show that (iii) $\implies$ (i), let $0\to N'\to N\to N''\to 0$ be an exact sequence. Then, from the $\oo{Tor}$ exact sequence,
$$
\oo{Tor}^A_1(M,N'')\to M\otimes N'\to M\otimes N\to M\otimes N''\to0
$$
is exact. Since $\oo{Tor}^A_1(M,N'')=0$ it follows that $M$ is flat.]

\nn\textbf{Solution.} Omitted.% declined

\subsubsection{Page 34, Exercise~2.25}%\label{ex2.25}%

Recall the statement of Exercise~2.25:

\begin{prop}[Exercise~2.25]\label{e225}
Let $0\to N'\to N\to N''\to0$ be an exact sequence, with $N''$ flat. Then $N'$ is flat if and only if $N$ is flat.
\end{prop}

Here is a [very long!] solution to Exercise~2.25 which does \textbf{not} use the Tor functor. Of course, the solution using the Tor functor [and assuming the Tor functor and some of its basic properties are known] is much simpler.

The proof below follows closely the proof of Proposition~1.2.5.5 in Bourbaki's \textbf{Algèbre commutative}.

In this section, the ground ring is denoted by $R$, not by $A$.

\paragraph{Part 1: The Snake Lemma.}%\label{ssl}

Let 
\begin{equation}\label{b10}
\begin{tikzcd}
A\ar[d,"\alpha"]\ar[r,"u"]&B\ar[d,"\beta"]\ar[r,"v"]&C\ar[d,"\gamma"]\\ 
A'\ar[r,"u'"']&B'\ar[r,"v'"']&C'
\end{tikzcd}
\end{equation}
be a commutative diagram of $R$-modules with exact rows. 

\begin{lem}\label{b1i}
If $\gamma$ is injective, we have $\oo{Im}(\beta)\cap\oo{Im}(u')=\oo{Im}(u'\circ\alpha)=\oo{Im}(\beta\circ u)$. 
\end{lem}

\begin{proof}
We clearly have $\oo{Im}(u'\circ\alpha)=\oo{Im}(\beta\circ u)\subset\oo{Im}(\beta)\cap\oo{Im}(u')$. Conversely, let $b'\in\oo{Im}(\beta)\cap\oo{Im}(u')$. There is a $b\in B$ such that $b'=\beta(b)$. As $v'\circ u'=0$, we have $0=v'(b')=v'(\beta(b))=\gamma(v(b))$, whence $v(b)=0$ since $\gamma$ is injective. The first row of \eqref{b10} being exact, there is an $a\in A$ such that $b=u(a)$, whence $b'=\beta(u(a))$.
\end{proof}

\begin{lem}\label{b1ii}
If $\alpha$ is surjective, we have $\oo{Ker}(\beta)+\oo{Im}(u)=\oo{Ker}(v'\circ\beta)=\oo{Ker}(\gamma\circ v)$. 
\end{lem}

\begin{proof}
As $v\circ u=0$ and $v'\circ u'=0$, it is clear that $\oo{Ker}(\beta)+\oo{Im}(u)\subset\oo{Ker}(v'\circ\beta)=\oo{Ker}(\gamma\circ v)$. Conversely, let $b\in\oo{Ker}(v'\circ\beta)$. Then $\beta(b)\in\oo{Ker}(v')$, and there is a $a'\in A'$ such that $u'(a')=\beta(b)$ since the bottom row of \eqref{b10} is exact. As $\alpha$ is surjective, there is an $a\in A$ such that $\alpha(a)=a'$, whence 
$
\beta(b)=u'(\alpha(a))=\beta(u(a));
$ 
this implies that $b-u(a)$ is in in $\oo{Ker}(\beta)$.
\end{proof}

We extend the commutative diagram \eqref{b10} as follows:
\begin{equation}\label{b10x}
\begin{tikzcd}
\oo{Ker}(\alpha)\ar[d]\ar[r,"u_1"]&\oo{Ker}(\beta)\ar[d,"j"]\ar[r,"v_1"]&\oo{Ker}(\gamma)\ar[d,"k"]\\ 
A\ar[d,"\alpha"]\ar[r,"u"]&B\ar[d,"\beta"]\ar[r,"v"]&C\ar[d,"\gamma"]\\ 
A'\ar[d,"p"]\ar[r,"u'"]&B'\ar[d,"q"]\ar[r,"v'"]&C'\ar[d]\\ 
\oo{Coker}(\alpha)\ar[r,"u_2"]&\oo{Coker}(\beta)\ar[r,"v_2"]&\oo{Coker}(\gamma),
\end{tikzcd}
\end{equation} 
the new maps being the natural ones.

Recall that we are working under the assumption that the second and third rows of \eqref{b10x} are exact.

\begin{lem}\label{b2i}
The sequence $\oo{Ker}(\alpha)\xr{u_1}\oo{Ker}(\beta)\xr{v_1}\oo{Ker}(\gamma)$ is a complex. Moreover, if $u'$ is injective, this complex is exact.
\end{lem}
 
\begin{proof}
The first claim is clear. We have $\oo{Ker}(v_1)=\oo{Ker}(\beta)\cap\oo{Ker}(v)=\oo{Ker}(\beta)\cap\oo{Im}(u)=\oo{Im}(j)\cap\oo{Im}(u)$. Assume that $u'$ is injective. As Lemma~\ref{b1i} implies $\oo{Im}(j)\cap\oo{Im}(u)=\oo{Im}(j\circ u_1)=\oo{Im}(u_1)$, we get $\oo{Ker}(v_1)=\oo{Im}(u_1)$.
\end{proof}

\begin{lem}\label{b2ii}
The sequence $\oo{Coker}(\alpha)\xr{u_2}\oo{Coker}(\beta)\xr{v_2}\oo{Coker}(\gamma)$ is a complex. Moreover, if $v$ is surjective, this complex is exact.
\end{lem}

\begin{proof}
As $u_2$ and $v_2$ are obtained from $u$ and $v$ by taking quotients, it is clear that $v_1\circ u_2=0$. Suppose $v$ is surjective; $q$ and $p$ being surjective, we get, in view of the assumptions and Lemma~\ref{b1ii},
$$
\oo{Ker}(v_2) = q(\oo{Ker}(v_2\circ q))= q(\oo{Ker}(v')+\oo{Im}(\beta))=q(\oo{Ker}(v'))
$$ 
$$
=q(\oo{Im}(u'))=\oo{Im}(q\circ u')=\oo{Im}(u_2\circ p)=\oo{Im}(u_2).
$$ 
(Lemma~\ref{b1ii} is used to prove the second equality.)
\end{proof} 

\begin{thm}[Snake Lemma]\label{lsl}
Assume that $u'$ is injective and that $v$ is surjective. Then the correspondence [see Bourbaki's \textbf{Théorie des ensembles}, Section II.3] 
$$
\delta:=p\circ u'^{-1}\circ\beta\circ v^{-1}\circ k
$$ 
is an $R$-linear map. On other words, there is a unique $R$-linear map $\delta:\oo{Ker}(\gamma)\to\oo{Coker}(\alpha)$ having the following property: if $c\in\oo{Ker}(\gamma),b\in B$ and $a'\in A'$ satisfy $v(b)=k(c)$ and $u'(a')= \beta(b)$, then we have $\delta(c)=p(a')$. Moreover the sequence 
%$$\oo{Ker}(\alpha)\xr{u_1}\oo{Ker}(\beta)\xr{v_1}\oo{Ker}(\gamma)\xr \delta\oo{Coker}(\alpha)\xr{u_2}\oo{Coker}(\beta)\xr{v_2}\oo{Coker}(\gamma)$$ 
$$
\begin{tikzcd}
\Ker(\alpha)\ar["u_1"]{r}&\Ker(\beta)\ar["v_1"]{r}&\Ker(\gamma)\ar["\delta"']{ddll}\\ \\ 
\Coker(\alpha)\ar["u_2"']{r}&\Coker(\beta)\ar["v_2"']{r}&\Coker(\gamma).
\end{tikzcd}
$$ 
is exact.
\end{thm}

The name ``Snake Lemma'' comes from the fact that the above exact sequence can be displayed as 
$$%https://tex.stackexchange.com/a/82774/8816
\begin{tikzcd}
  \Ker(\alpha) \ar["u_1"]{r} & \Ker(\beta) \ar["v_1"]{r}
             \ar[draw=none]{d}[name=X, anchor=center]{}
    & \Ker(\gamma) \ar[rounded corners,
            to path={ -- ([xshift=2ex]\tikztostart.east)
                      |- (X.center) \tikztonodes
                      -| ([xshift=-2ex]\tikztotarget.west)
                      -- (\tikztotarget)}]{dll}[at end]{} \\      
  \Coker(\alpha) \ar["u_2"]{r} & \Coker(\beta) \ar["v_2"]{r} & \Coker(\gamma).
\end{tikzcd}
$$

\begin{proof} (a) The correspondence $\delta$ is a map: For $c\in\oo{Ker}(\gamma)$ there is a $b\in B$ such that $v(b)=k(c)$ because $v$ is surjective; moreover, we have $v'(\beta(b))=\gamma(k(c))=0$, and thus there is a unique $a'\in A'$ such that $u'(a')=\beta(b)$ because $u'$ is injective. Let us show that the element $p(a')\in\oo{Coker}(\alpha)$ does not depend on the choice of the element $b\in B$ such that $v(b)=k(c)$. Indeed, if $b^*\in B$ is another element such that $v(b^*)=k(c)$, we have $b^*=b+u(a)$ where $a\in A$; let us show that if $a'^*\in A'$ is such that $u'(a'^*)=\beta(b^*)$, then $a'^*=a'+\alpha(a)$; indeed we have 
$$
u'(a'+\alpha(a))=u'(a')+u'(\alpha(a))=\beta(b)+\beta(u(a))=\beta(b+u(a))=\beta(b^*)=u'(a'^*),
$$ 
and the injectivity of $u'$ implies $a'+\alpha(a)=a'^*$. Finally, we conclude that $p(a'^*)=p(a')+p(\alpha(a))=p(a')$. We can thus set $\delta(c)=p(a')$ and we have defined a map $\delta:\oo{Ker}(\gamma)\to\oo{Coker}(\alpha)$.

\nn(b) Linearity of $\delta$: If $c_1,c_2$ are in $\oo{Ker}(\gamma)$ and $c=c_1+c_2$, pick $b_1$ and $b_2$ in $B$ such that $v(b_1)=k(c_1)$ and $v(b_2)=k(c_2)$, and define $b\in B$ by $b:=b_1+b_2$; it is then obvious that $\delta(c)=\delta(c_1)+\delta(c_2)$. We prove similarly that $\delta(rc)=r\delta(c)$ for $r\in R$.

\nn(c) Exactness at $\oo{Ker}(\beta)$ and $\oo{Coker}(\beta)$: Follows from Lemmas \ref{b2i} and \ref{b2ii} respectively.

\nn(d) Equality $\delta\circ v_1=0$: Suppose that $c=v_1(\overline b)$ with $\overline b\in\oo{Ker}(\beta)$; we then take for $b\in B$ the element $j(\overline b)$. As $\beta(j(\overline b))=0$, we see that $\delta(c)=0$, hence $\delta\circ v_1=0$. 

\nn(e) Exactness at $\oo{Ker}(\gamma)$: Suppose that $\delta(c)=0$. It suffices to show that we have $c=v_1(b^*)$ for some $b^*\in\oo{Ker}(\beta)$. Defining $b$ and $a'$ as in (a), we get $p(a')=\delta(c)=0$. Thus there is an $a$ in $A$ such that $a'=\alpha(a)$, 
and we get $\beta(b)=u'(a')=u'(\alpha(a))=\beta(u(a))$, that is, $\beta(b-u(a))=0$. The element $b-u(a)$ is thus of the form $j(b^*)$ for some $b^*\in\oo{Ker}(\beta)$. It is enough to show $c=v_1(b^*)$. We have 
$$
k(c)=v(b)= v(u(a)+j(b^*))=v(j(b^*))=k(v_1(b^*)).
$$ 
The injectivity of $k$ yields $c=v_1(b^*)$, as desired.

\nn(f) Equality $u_2\circ\delta=0$: We have [still with the notation of (a)] 
$$
u_2(\delta(c))=u_2(p(a'))=q(u'(a'))=q(\beta(b))=0.
$$ 
%hence $u_2\circ\delta=0$. 

\nn(g) Exactness at $\oo{Coker}(\alpha)$: Suppose that an element $p(a')$ in $\oo{Coker}(\alpha)$ (with $a'\in A'$) satisfies $u_2(p(a'))=0$. It suffices to prove $p(a')=\delta(c)$ for some $c\in\oo{Ker}(\gamma)$. We have $q(u'(a'))=0$, and thus $u'(a')=\beta(b)$ for some $b\in B$; as $v'(u'(a')))=0$, we get $v'(\beta(b))=0$, thus $\gamma(v(b))=0$, that is $v(b)=k(c)$ for some $c\in\oo{Ker}(\gamma)$, and we obtain the sought-for equality $p(a')=\delta(c)$ by definition of $\delta$.
\end{proof}

\paragraph{Part 2.}

\begin{lem}\label{b254}
If $M$ is a flat $R$-module, if $0\to M_1\to M_2\to M\to0$ is an exact sequence of $R$-modules, and if $N$ is an $R$-module, then the sequence 
$$
0\to M_1\otimes_RN\to M_2\otimes_RN\to M\otimes_RN\to0
$$ 
is exact.
\end{lem}

\begin{proof}
Let $0\to P\to F\to N\to 0$ be an exact sequence of $R$-modules such that $F$ is free, and form the diagram
$$
\begin{tikzcd}
&M_1\otimes P\ar[d]\ar[r]&M_2\otimes P\ar[d,"f"]\ar[r]&M\otimes P\ar[d,"g"]\ar[r]&0\\ 
0\ar[r]&M_1\otimes F\ar[d]\ar[r]&M_2\otimes F\ar[d]\ar[r]&M\otimes F\\ 
&M_1\otimes N\ar[d]\ar[r]&M_2\otimes N\ar[d]\\ 
&0&0,
\end{tikzcd}
$$ 
where the tensor products are taken over $R$, and where the maps are the natural ones. This diagram is clearly commutative and exact. By the Snake Lemma [Theorem~\ref{lsl}] there is an exact sequence  
$
\oo{Ker}(f)\to\oo{Ker}(g)\to M_1\otimes N\to M_2\otimes N.
$ 
As $M$ is flat, $g$ is injective. Thus $M_1\otimes N\to M_2\otimes N$ is also injective. 
\end{proof}

Clearly the following lemma implies Exercise~2.25 [stated as Proposition~\ref{e225} p.~\pageref{e225}].

\begin{lem}
Let $0\to M'\to M\to M''\to0$ be an exact sequence of $R$-modules with $M''$ flat. Then $M'$ if flat if and only if $M$ is flat.
\end{lem}

\begin{proof}
Let $N'\to N$ be a monomorphism of $R$-modules and form the commutative diagram 
$$
\begin{tikzcd}
&&&0\ar[d]\\ 
0\ar[r]&M'\otimes N'\ar[d,"\alpha"]\ar[r,"f"]&M\otimes N'\ar[d,"\beta"]\ar[r]&M''\otimes N'\ar[d,"\gamma"]\ar[r]&0\\ 
0\ar[r]&M'\otimes N\ar[r,"g"]&M\otimes N\ar[r]&M''\otimes N\ar[r]&0,
\end{tikzcd}
$$ 
the maps being the natural ones. The diagram is exact by flatness of $M''$ and Lemma~\ref{b254}.

Assume that $M$ is flat. Then $\beta$ is injective, and so is $\beta\circ f=g\circ\alpha$. This shows that $\alpha$ is injective, and thus that $M'$ is flat.

Assume that $M'$ is flat. Then $\alpha$ is injective, and Lemma~\ref{b2i} implies that $\beta$ is injective, and thus that $M$ is flat.

The solution to Exercise~2.25 p.~34 of the book is now complete.
\end{proof} 

% long comment removed, Tor functor https://docs.google.com/document/d/1YKQb05wd6S3eoq-TeX-WcgUCrp-ke6-WWgQ9yrqJ74I/edit

\subsubsection{Page 35, Exercise~2.26}\label{ex2.26}%

The goal is to show:

\begin{thm}\label{flatcrit}
In the above setting, $M$ is flat if and only if for all finitely generated ideal $\aaa$ the morphism $M\otimes\aaa\to M$ sending $x\otimes a$ to $xa$ is injective.
\end{thm}

Here is the sketch of a solution [following Bourbaki's \textbf{Algèbre commutative}].

Given $A$-modules $M$ and $N$ we say that $M$ is $N$\textbf{-flat} if for all submodule $N'$ of $N$ the natural morphism $M\otimes N'\to M\otimes N$ is injective. [Here and in the sequel ``$\otimes$'' means ``$\otimes_A$''.] 

\nn(a) If $M\otimes N'\to M\otimes N$ is injective for all \textbf{finitely generated} submodule $N'$ of $N$, then $M$ is $N$-flat.

\begin{proof} 
Let $N''$ be an arbitrary submodule of $N$; let $x_1,\dots,x_n$ be in $M$; let $y_1,\dots,y_n$ be in $N''$; define $t''\in M\otimes N''$ by $t''=\sum x_i\otimes y_i$; define $t\in M\otimes N$ by $t=\sum x_i\otimes y_i$; and assume $t=0$. It suffices to show $t''=0$. Let $N'$ be the submodule of $N''$ generated by the $y_i$. By assumption the tensor $t'\in M\otimes N'$ defined by $t'=\sum x_i\otimes y_i$ vanishes. As the natural map $M\otimes N'\to M\otimes N''$ sends $t'$ to $t''$, we have indeed $t''=0$. 
\end{proof}

\nn(b) If $M$ is $N$-flat and if $P$ is a submodule or a quotient of $N$, then $M$ is $P$-flat. 

\begin{proof} 
The case of the submodules is left to the reader. Let $0\to R\xrightarrow iN\xrightarrow pQ\to0$ be exact, and let us show that $M$ is $Q$-flat. Let $Q'$ be a submodule of $Q$, and set $N':=p^{-1}(Q')$. We get a commutative diagram with exact rows
$$
\begin{tikzcd}
0\ar[r]&R\ar[d,"r"]\ar[r,"i'"]&N'\ar[d,"n"]\ar[r,"p'"]& Q'\ar[d,"q"]\ar[r]&0\\ 
0\ar[r]&R\ar[r,"i"']&N\ar[r,"p"']& Q\ar[r]&0,
\end{tikzcd}
$$ 
where $r$ is the identity of $R$, and the maps $i',p',n$ and $q$ are the obvious ones. Letting $S\mapsto\overline S$ be the functor $M\otimes-$ we obtain the commutative diagram with exact rows
$$
\begin{tikzcd}
\overline R\ar[d,"\overline r"]\ar[r,"\overline{i'}"]&\overline{N'}\ar[d,"\overline n"]\ar[r,"\overline{p'}"]& \overline{Q'}\ar[d,"\overline q"]\ar[r]&0\\ 
\overline R\ar[r,"\overline i"']&\overline N\ar[r,"\overline p"']& \overline Q\ar[r]&0,
\end{tikzcd}
$$ 
where $\overline r$ is the identity of $\overline R$. As $\overline n$ is injective, so is $\overline q$. 
\end{proof}

\nn(c) If $N=\bigoplus_{i\in I}N_i$ is the direct sum of a family of submodules, and if $M$ is $N_i$-flat for each $i$, then $M$ is $N$-flat. 

\begin{proof} 
Let $(N_i)_{i\in I}$ be our family. 

\nn$\bu$ First assume $I=\{1,2\}$. Consider the \textbf{split} exact sequence $0\to N_1\xrightarrow i N_1\oplus N_2\xrightarrow pN_2\to0$, let $N'$ be a submodule of $N$, set $N'_1:=N'\cap N_1$, let $N'_2$ be the image of $N'$ in $N_2$, and let 
$$
\begin{tikzcd}
0\ar[r]&N'_1\ar[d,"f_1"]\ar[r,"i'"]&N'\ar[d,"f"]\ar[r,"p'"]&N'_2\ar[d,"f_2"]\ar[r]&0\\ 
0\ar[r]&N_1\ar[r,"i"']&N\ar[r,"p"']&N_2\ar[r]&0
\end{tikzcd}
$$  
be the obvious commutative diagram with exact rows. Writing again $S\mapsto\overline S$ for the functor $M\otimes-$, we obtain the commutative diagram with exact rows
$$
\begin{tikzcd}
\overline{N'_1}\ar[d,"\overline{f_1}"]\ar[r,"\overline{i'}"]&\overline{N'}\ar[d,"\overline f"]\ar[r,"\overline{p'}"]& \overline{N'_2}\ar[d,"\overline{f_2}"]\\ 
\overline{N_1}\ar[r,"\overline i"']&\overline N\ar[r,"\overline p"']& \overline{N_2}.
\end{tikzcd}
$$ 
It is easy to see that $\overline{f_1},\overline{f_2}$ and $\overline i$ are injective, and that this implies that $\overline f$ is also injective. This completes the proof of (c) in the case $I=\{1,2\}$.

\nn$\bu$ Second assume that $I$ is \textbf{finite}. We prove the statement by induction.

\nn$\bu$ Third assume that $I$ is \textbf{arbitrary}, and let $N'$ be a finitely generated submodule of $N=\bigoplus_{i\in I}N_i$. Then there is a finite subset $J$ of $I$ such that $N'\subset\bigoplus_{j\in J}N_j$, and we have 
$$
N=\left(\bigoplus_{j\in J}N_j\right)\oplus\left(\bigoplus_{i\in I\setminus J}N_i\right). 
$$ 
We leave the rest of the proof to the reader.

From this point, the proof of Theorem~\ref{flatcrit} p.~\pageref{flatcrit} is straightforward. The details are again left to the reader.

\end{proof}

\subsubsection{Page 35, flat modules (a digression)}%

Taken from Chapter~1, Section 2, Subsection 11 in Nicolas Bourbaki, \textbf{Algèbre commutative: Chapitres 1 à 4}, Masson, Paris 1985:

\nn\emph{Let $A$ be a [non necessarily commutative] associative ring with $1$, let $M$ be a right $A$-module, and let $N$ be a left $A$-module. Then $M$ is $N$-flat [see \S\ref{ex2.26}] if and only if the following condition holds:}

\nn\emph{For all finite families $(x_i)\subset M,(y_i)\subset N$ such that $\sum x_i\otimes y_i=0$ there are finite families $(a_{ij})\subset A$ and $(x'_j)\subset M$ such that $\sum_jx'_ja_{ij}=x_i$ for all $i$ and $\sum_ia_{ij}y_i=0$ for all $j$.}

\nn\emph{Proof.} This follows easily from \S\ref{vt}. $\square$

We also have:

\nn\emph{Let $A$ be a [non necessarily commutative] associative ring with $1$ and $M$ a right $A$-module. Then $M$ is flat if and only if the following condition holds:}

\nn\emph{For all finite families $(x_i)\subset M,(a_i)\subset A$ such that $\sum x_ia_i=0$ there are finite families $(a'_{ij})\subset A$ and $(x'_j)\subset M$ such that $\sum_jx'_ja'_{ij}=x_i$ for all $i$ and $\sum_ia'_{ij}a_i=0$ for all $j$.}

\nn\emph{Proof.} We set $N:=A$ in the previous statement and use \S\ref{ex2.26}. $\square$

There is also a statement and a proof of this result in the Stacks Project; see the tag\\  \href{http://stacks.math.columbia.edu/tag/00HK}{http://stacks.math.columbia.edu/tag/00HK}

\subsubsection{Page 35, Exercise~2.27}\label{ex2.27}%

\textbf{Statement.} A ring $A$ is \textbf{absolutely flat} if every $A$-module is flat. Prove that the following are equivalent:

\nn(i) $A$ is absolutely flat.

\nn(ii) Every principal ideal is idempotent.

\nn(iii) Every finitely generated ideal is a direct summand of $A$.

\nn[(i) $\implies$ (ii). Let $x\in A$. Then $A/(x)$ is a flat $A$-module, hence in the diagram
% https://q.uiver.app/?q=WzAsNCxbMCwwLCIoeClcXG90aW1lcyBBIl0sWzEsMCwiKHgpXFxvdGltZXMgQS8oeCkiXSxbMCwxLCJBIl0sWzEsMSwiQS8oeCkiXSxbMCwxLCJcXGJldGEiXSxbMCwyXSxbMSwzLCJcXGFscGhhIl0sWzIsM11d
\[\begin{tikzcd}
	{(x)\otimes A} & {(x)\otimes A/(x)} \\
	A & {A/(x)}
	\arrow["\beta", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow["\alpha", from=1-2, to=2-2]
	\arrow[from=2-1, to=2-2]
\end{tikzcd}\] 
the mapping $\alpha$ is injective. Hence $\oo{Im}(\beta)=0$, hence $(x)=(x^2)$. (ii) $\implies$ (iii). Let $x\in A$. Then $x =ax^2$ for some $a\in A$, hence $e=ax$ is idempotent and we have $(e)=(x)$. Now if $e,f$ are idempotents, then $(e,f)=(e+f-ef)$. Hence every finitely generated ideal is principal, and generated by an idempotent $e$, hence is a direct summand because $A=(e)\oplus(1-e)$. (iii) $\implies$ (i). Use the criterion of Exercise~26 (see Theorem~\ref{flatcrit} p.~\pageref{flatcrit}).]

\nn\textbf{Solution.}

\nn$\bu$ (i)$\implies$(ii): Let $x$ be in $A$. Tensoring the exact sequence $0\to(x)\to A$ with the flat module $A/(x)$ yields the exact sequence $0\to(x)/(x)^2\xr fA/(x)$. We clearly have $\oo{Im}f=0$, hence $f=0$, hence $(x)^2=(x)$.

\nn\textbf{Note:} On replacing the principal ideal $(x)$ with an arbitrary ideal this shows that \textbf{all} ideals of an absolutely flat ring are idempotent. Here is a naive way of proving that ``all \textbf{principal} ideals of $A$ are idempotent'' implies ``\textbf{arbitrary} ideals of $A$ are idempotent'': Otherwise there would be an $x$ in $\aaa\setminus\aaa^2$ for some ideal $\aaa$, which would yield $x\in(x^2)\subset\aaa^2$, contradiction.%https://math.stackexchange.com/a/137883/660

% comment removed https://docs.google.com/document/d/1qNW_ZVfE2nwm_A5NCGzWo_yu8CYKC0g1NUcCXkT2Igs/edit

\nn$\bu$ (ii)$\implies$(iii): The hint given in the book is complete.

\nn$\bu$ (iii)$\implies$(i): Let $M$ be an $A$-module and $\aaa$ a finitely generated ideal. By Theorem~\ref{flatcrit} p.~\pageref{flatcrit} above it suffices to check that the natural morphism $\aaa\otimes M\to M$ is injective [in this section tensor products are taken over $A$]. This morphism is the composite of the obvious morphisms 
$$
\aaa\otimes M\to(\aaa\oplus\bbb)\otimes M=A\otimes M\to M,
$$ 
where $\bbb$ is an ideal such that $A=\aaa\oplus\bbb$ [such an ideal exists by assumption]. These morphisms are clearly injective.

\begin{note}
The above arguments show that \emph{(i)}, \emph{(ii)} and \emph{(iii)} are also equivalent to

\emph{(iv)} every finitely generated ideal is generated by an idempotent,

\nn and also to 

\emph{(v)} for all $a$ in $A$ there is an $x$ in $A$ such that $a=a^2x$. 

\nn In particular an absolutely flat ring has no nonzero nilpotent element. 
\end{note}

Each of the following three conditions is equivalent to (i):

\nn(vi) each ideal is idempotent,

\nn(vii) each principal ideal is radical,

\nn(viii) each ideal is radical.

Indeed, we already know that (i) and (vi) are equivalent [see the note after the proof that (i) implies (ii)], and that (viii) implies trivially (vii). To prove that (ii) implies (viii), assume $a^n\in\aaa$ for some element $a$ of $A$, some positive integer $n$ and some ideal $\aaa$ of $A$, and observe that we get $a\in(a)=(a^n)\subset\aaa$. To show that (vii) implies (ii), let $a$ be in $A$ and note that we have $a\in r(a^2)=(a^2)$.

\subsubsection{Page 35, Exercise~2.28}\label{ex2.28}%

\textbf{Statement.} A Boolean ring is absolutely flat. The ring of Chapter~1, Exercise~7 [Section~\ref{ex1.7} p.~\pageref{ex1.7}] is absolutely flat. Every homomorphic image of an absolutely flat ring is absolutely flat. If a local ring is absolutely flat, then it is a field.

If $A$ is absolutely flat, every non-unit in $A$ is a zero-divisor.

\nn\textbf{Solution.} The first three sentences follow from Property~(v) above [Section~\ref{ex2.27}]. The fact that an absolutely flat local ring is a field follows immediately from Property~(iv) above and Exercise~1.12 p.~11 of the book [see Section~\ref{ex1.12} p.~\pageref{ex1.12} above].

\newpage

\section{About Chapter~3}%%%

\subsection{Comments}%%

\subsubsection{Page 37}%

Recall that $f:A\to S^{-1}A$ is the canonical morphism.

It is written:

"Conversely, these three conditions determine the ring $S^{-1}A$ up to isomorphism. Precisely:

\nn\textbf{Corollary 3.2.} \emph{If $g:A\to B$ is a ring homomorphism such that}

\nn(i) $s\in S\implies g(s)$ \emph{is a unit in} $B$;

\nn(ii) $g(a)=0\implies as=0$ \emph{for some} $s\in S$;

\nn(iii) \emph{Every element of $B$ is of the form} $g(a)g(s)^{-1}$.

\nn\emph{Then there is a unique isomorphism $h:S^{-1}A\to B$ such that} $g=h\circ f$."

The following wording would be slightly better:

Conversely, these three conditions determine the ring $S^{-1}A$ up to unique isomorphism. Precisely:

\nn\textbf{Corollary 3.2.} \emph{If $g:A\to B$ is a ring homomorphism such that}

\nn(i) $s\in S\implies g(s)$ \emph{is a unit in} $B$;

\nn(ii) $g(a)=0\implies as=0$ \emph{for some} $s\in S$;

\nn(iii) \emph{Every element of $B$ is of the form} $g(a)g(s)^{-1}$.

\nn\emph{Then there is a unique morphism $h:S^{-1}A\to B$ such that $g=h\circ f$. Moreover this morphism is an isomorphism.}

\subsubsection{Page 39, Proposition~3.4}%

It is easy to see that we have $S^{-1}\sum M_i=\sum S^{-1}M_i$. It is also easy to see that we have 
$$
S^{-1}\bigcap M_i\ \subset\ \bigcap S^{-1}M_i.
$$ 
But the converse inclusion 
$$
\bigcap S^{-1}M_i\ \subset\ S^{-1}\bigcap M_i
$$ 
is not true in general. Here is a counterexample. Let $K$ be a field and $x$ an indeterminate. Setting $A:=K[x]$, $S:=K[x]\setminus\{0\}$ we get 
$$
\bigcap_n S^{-1}(x^n)=K(x),\quad S^{-1}\bigcap_n(x^n)=(0).
$$

\subsubsection{Pages 39-40, Propositions 3.5 and 3.7}\label{p3.5,3.7}%

Recall the statements of these propositions:

\begin{prop}[Proposition 3.5 of the book]\label{p3.5}
Let $M$ be an $A$-module. Then the $S^{-1}A$ modules $S^{-1}M$ and $S^{-1}A \otimes_AM$ are isomorphic; more precisely, there exists a unique isomorphism $f:S^{-1}A\otimes_AM\to S^{-1}M$ for which
$$
f((a/s)\otimes m)=am/s\text{ for all }a\in A,m\in M,s\in S.
$$
\end{prop}

\begin{prop}[Proposition 3.7 of the book]\label{p3.7}
If $M,N$ are $A$-modules, there is a unique isomorphism of $S^{-1}A$-modules 
$$
f:S^{-1}M\otimes_{S^{-1}A}S^{-1}N\to S^{-1}(M\otimes_AN)
$$ 
such that 
$$
f((m/s)\otimes(n/t))=(m\otimes n)/st.
$$ 
In particular, if $\ppp$ is any prime ideal, then
$$
M_\ppp\otimes_{A_\ppp}N_\ppp\simeq(M\otimes_AN)_\ppp
$$ 
as $A_\ppp$-modules.
\end{prop}

The natural $A$-linear map $f:M\to S^{-1}M$ has the following universal property:

For all $A$-linear map $g:M\to N$ from $M$ to an $S^{-1}A$-module $N$ such that $sm=0$ for some $s$ in $S$ and some $m$ in $M$ implies $g(m)=0$, there is a unique $S^{-1}A$-linear map $h:S^{-1}M\to N$ such that $g=h\circ f$: 
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJNIl0sWzEsMCwiTiJdLFswLDEsIlNeey0xfU0iXSxbMCwyLCJmIiwyXSxbMCwxLCJnIl0sWzIsMSwiaCIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	M & N \\
	{S^{-1}M}
	\arrow["g", from=1-1, to=1-2]
	\arrow["f"', from=1-1, to=2-1]
	\arrow["h"', dashed, from=2-1, to=1-2]
\end{tikzcd}\] 

Using this universal property one can describe explicitly the respective inverses of the isomorphisms in Propositions 3.5 and 3.7. 

If $\ppp$ is a prime ideal of $A$, then the modules $M_\ppp/\ppp M_\ppp$ and $(M/\ppp M)_\ppp$ are naturally isomorphic. Moreover we clearly have $\ppp M_\ppp=(\ppp M)_\ppp=\ppp_\ppp M_\ppp$ (see Paragraph~(v) p.~\pageref{pam}), and thus $M_\ppp/\ppp M_\ppp=M_\ppp/(\ppp M)_\ppp=M_\ppp/\ppp_\ppp M_\ppp$.  

To prove the isomorphism $M_\ppp/\ppp M_\ppp\simeq(M/\ppp M)_\ppp$, note that the sequence 
$$
0\to (\ppp M)_\ppp\to M_\ppp\to(M/\ppp M)_\ppp\to 0
$$ 
is exact by Proposition~3.3 p.~39 of the book. 

\subsubsection{Page 39, Proposition~3.5}%

In the setting of Proposition~3.5 p.~39 [Proposition~\ref{p3.5}] we have:

\nn\emph{If $1\otimes x=0$ in $S^{-1}A\otimes_AM$ then we have $sx=0$ for some} $s\in S$.

\nn\emph{Proof.} We have $1\otimes x=0$ in $N\otimes_AM$ where $N$ is some finitely generated sub-$A$-module of $S^{-1}A$. For any $s\in S$ set $A/s:=\{a/s\ |\ a\in A\}$; this is also a sub-$A$-module of $S^{-1}A$. Then $N\subset A/s$ for some $s$, and we have $1\otimes x=0$ in $A/s\otimes_AM$. Defining $f:A\to A/s$ by $f(a):=a/s$ and letting $B$ be the kernel of $f$, and $g:M\to A/s\otimes_AN$ the map induced by $f$, we get exact sequences 
$$
B\otimes_AM\to M\xr gA/s\otimes_AM\to0\quad\text{and}\quad0\to BM\to M\xr gA/s\otimes_AM\to0.
$$ 
We have $g(sx)=0$ and thus $sx=\sum_{i=1}^nb_ix_i$ with $b_i\in B$ and $x_i\in M$. As $b_i/s=0$ in $S^{-1}A$ there is a $t\in S$ such that $tb_i=0$ for all $i$. This gives $tsx=0.\ \square$ 

\subsubsection{Page 40, More natural isomorphisms}\label{Smore}% 

In the notation of Proposition 3.7, the $A_\ppp$-modules 
\begin{equation}\label{E5iso}
M_\ppp/\ppp M_\ppp,\quad (M/\ppp M)_\ppp,\quad(A_\ppp/\ppp_\ppp)\otimes_AM,\quad (A/\ppp)_\ppp\otimes_AM,\quad A_\ppp\otimes_A(M/\ppp M)
\end{equation} 
are naturally isomorphic. 

\nn Proof: Call these modules $M_1,M_2,M_3,M_4,M_5$. The isomorphisms $M_1\simeq M_2$ and $M_3\simeq M_4$ follow from the end of Section~\ref{p3.5,3.7} p.~\pageref{p3.5,3.7}. The isomorphism $M_2\simeq M_5$ results from Proposition~3.5 p.~39 of the book. Let us prove $M_1\simeq M_4$. The sequence $\ppp_\ppp\otimes_AM\to A_\ppp\otimes_AM\to(A_\ppp/\ppp_\ppp)\otimes_AM\to0$, that is $\ppp_\ppp\otimes_AM\to A_\ppp\otimes_AM\to M_4\to0$, is exact by Proposition~3.3 p.~39 of the book. By Proposition~3.5 p.~39 of the book, we get an exact sequence $\ppp_\ppp\otimes_AM\to M_\ppp\to M_4\to0$, and the image of $\ppp_\ppp\otimes_AM$ in $M_\ppp$ is clearly $\ppp M_\ppp$. 

Finally note that, if $M$ is an $A$-algebra (that is, a commutative ring together with a morphism $A\to M$), then the isomorphisms in \eqref{E5iso} are isomorphisms of $M$-algebras. 

\subsubsection{Page 40, Proposition~3.8}%

Recall the statement of Proposition~3.8. 

\begin{prop}[Proposition~3.8 p.~40]\label{38}
Let $M$ be an $A$-module. Then the following are equivalent:

\nn\emph{(i)} $M=0$;

\nn\emph{(ii)} $M_\ppp=0$ for all prime ideals $\ppp$ of $A$;

\nn\emph{(iii)} $M_\mmm=0$ for all maximal ideals $\mmm$ of $A$.
\end{prop}

Here is a corollary: 

\begin{cor}\label{ap}
For $a\in A$ and $\ppp\in\Spec(A)$ write $a_\ppp$ for the element $a/1\in A_\ppp$. Then we have for $a\in A$:
$$
a=0\iff a_\ppp=0\ \forall\ \ppp\in\Spec(A)\iff a_\mmm=0\ \forall\ \mmm\text{ maximal.}
$$
\end{cor}

This follows from Proposition~3.8 and the easy equality $(a)_\ppp=(a_\ppp)$. 

\subsubsection{Page 40, Proposition~3.9}\label{re}%

Here is a mild generalization:

\nn\emph{The complex of $A$-modules $M\xr fN\xr g P$ is exact if and only if the complex} $M_\mmm\xr{f_\mmm}N_\mmm\xr{g_\mmm}P_\mmm$ \emph{is exact for all maximal ideal $\mmm$ of} $A$.
\begin{proof}
Use the isomorphism $\oo{Ker}(g_\mmm)/\oo{Im}(f_\mmm)\simeq(\oo{Ker}(g)/\oo{Im}(f))_\mmm$ and Proposition~3.8 of the book.
\end{proof}

\subsubsection{Pages 41-42, Proposition~3.11}%

Recall the proposition:

\begin{prop}[Proposition~3.11 p.~41 of the book]\label{p3.11}
\emph{(i)} Every ideal in $S^{-1}A$ is an extended ideal. 

\nn\emph{(ii)} If $\aaa$ is an ideal in $A$, then $\aaa^{\oo{ec}}=\bigcup_{s\in S}(\aaa:s)$. Hence $\aaa^{\oo e}=(1)$ if and only if $\aaa$ meets $S$.

\nn\emph{(iii)} $\aaa\in C\iff$ no element of $S$ is a zero-divisor in $A/\aaa$.

\nn\emph{(iv)} The prime ideals of $S^{-1}A$ are in one-to-one correspondence $(\ppp\leftrightarrow S^{-1}\ppp)$ with the prime ideals of $A$ which don't meet $S$.

\nn\emph{(v)} The operation $S^{-1}$ commutes with formation of finite sums, products, intersections and radicals.
\end{prop}

Here are some additional comments about Parts (ii) and (iv).

\paragraph{Part (ii).}\phantom x

\nn$\bu$ Here is a more detailed proof of the statement 

\emph{If $\aaa$ is an ideal in $A$, then $\aaa^{\oo{ec}}=\bigcup_{s\in S}\ (\aaa:s)$}.

\nn We have 

$x\in\aaa^{\oo{ec}}=(S^{-1}\aaa)^{\oo c}$

$\ds\iff\frac{x}{1}=\frac{a}{s'}$ for some $a\in\aaa,s'\in S$ 

$\iff(xs'-a)t'=0$ for some $a\in\aaa$ and some $s',t'\in S$ 

$\iff xst\in\aaa$ for some $s,t\in S$

$\iff xs\in\aaa$ for some $s\in S$

$\iff x\in\bigcup_{s\in S}\ (\aaa:s)$.

\nn To prove 

$xst\in\aaa$ for some $s,t\in S$ $\implies$ $(xs'-a)t'=0$ for some $a\in\aaa$ and some $s',t'\in S$, 

\nn we set $a:=xst$, $s':=st$, $t':=1$. 

\nn$\bu$ A particular case of the statement 

\centerline{\emph{$\aaa^{\oo e}=(1)$ if and only if $\aaa$ meets $S$}} 

\nn is 

\centerline{\emph{$(0)^{\oo e}=(1)$ if and only if $\ 0\in S$,}}

\nn that is 
\begin{equation}\label{s-1a}
S^{-1}A=0\iff\ 0\in S. 
\end{equation}
[It is easy to prove this particular case directly.] 

\paragraph{Part (iv).}\label{prcor}%

Set $X:=\Sp(A),Y:=\Sp(S^{-1}A)$ and let $c:Y\to X$ be the contraction map. In view of Proposition~1.17iii p.~10 of the book, it suffices to show: $c(Y)=\{\ppp\in X\ |\ \ppp\cap S=\varnothing\}$ and $\ppp\in c(Y)\implies S^{-1}\ppp\in X$. The conclusion is that 

\nn\emph{The contraction and extension maps are inverse inclusion preserving bijections between $Y$ and $c(Y)$.} 

% comment removed https://docs.google.com/document/d/1bFidiNFmzhw5CQkg8ZiIsbVKhNkEZ8LJnyYfJD2KPLg/edit

\paragraph{Part (v).}\label{pam}%

With obvious notation, we have $S^{-1}(\aaa M)=S^{-1}\aaa\cdot S^{-1}M=\aaa\cdot S^{-1}M$ (equalities as submodules of $S^{-1}M$). 

\subsubsection{Page 43, Proposition~3.14}%

The inclusion $S^{-1}\oo{Ann}M\subset\oo{Ann}S^{-1}M$ holds even is $M$ is not finitely generated. Here is a counterexample to the reverse inclusion:

Let $K$ be a field and $x$ an indeterminate. Set 
$$
A:=K[x],\quad S:=K[x]\setminus\{0\},\quad M:=\bigoplus A/(x^n).
$$ 
We get $\oo{Ann}M=(0)$, $S^{-1}M=0$, $\oo{Ann}S^{-1}M=(1)$. 

\subsubsection{Page 43, Proposition~3.16}%

Here is the statement: 
%
\begin{prop}[Proposition~3.16]\label{p3.16}
Let $A\to B$ be a ring homomorphism and let $\ppp$ be a prime ideal of $A$. Then $\ppp$  is the contraction of a prime ideal of $B$ if and only if $\ppp^{\mathrm{ec}}=\ppp$.
\end{prop}

Compare with Exercise~3.21iv p.~47 of the book [Section~\ref{321iv} p.~\pageref{321iv} below].

\subsubsection{Proof of Proposition~3.16}

The commutative diagram
$$
\begin{tikzcd}
\kern-22pt\ppp\subsetneqq A\ar[d,"\alpha"']\ar[r,"f"]&B\supsetneqq\ppp B\ar[d,"\beta"]\kern-30pt\\ 
\kern-22pt\ppp_\ppp\subsetneqq A_\ppp\ar[r,"f_\ppp"']&B_\ppp\supsetneqq \mmm\supset\ppp B_\ppp\kern-66pt.
\end{tikzcd}
$$ 
might help. Note that we have $f_\ppp^{-1}(\mmm)=\ppp_\ppp$.

%https://docs.google.com/document/d/1YYUDEGhoImy-b_Lx9foGoetelzzXbN1IiNbpo7pXh98/edit comment 180522

\subsubsection{Strengthening of Proposition~3.16}\label{43}

Proposition~3.16 can also be stated as follows:

\nn\emph{Let $A\to B$ be a morphism of commutative rings, let $\aaa$ be a contracted ideal in $A$, and let $\Sigma$ be the set of those ideals in $B$ which contract to $\aaa$. [In particular $\Sigma$ is nonempty.] Order $\Sigma$ by inclusion. Then we have}

\nn(a) \emph{$\aaa^{\oo e}$ is the least element of $\Sigma$, or, equivalently, $\aaa^{\oo e}$ is the intersection of all the elements of $\Sigma$,}

\nn(b) \emph{$\Sigma$ has one, or more, maximal elements,}

\nn(c) \emph{if $\ \aaa$ is prime, then any maximal element of $\Sigma$ is also prime.}

The proofs of these statements are straightforward and elementary. We will prove (c), the proofs of (a) and (b) being similar and left to the reader.

To prove (c), let $\qqq$ be a maximal element of $\Sigma$. Assume by contradiction that $\qqq$ is not prime. Then there are ideals $\mf{b,b}'$ in $B$ such that $\qqq\not\supset\bbb$, $\qqq\not\supset\bbb'$, $\qqq\supset\mf{bb}'$. Replacing $\bbb$ and $\bbb'$ with $\bbb+\qqq$ and $\bbb'+\qqq$, we can assume that $\qqq$ is a proper sub-ideal of $\bbb$ and $\bbb'$. By maximality of $\qqq$, the prime ideal $\aaa$ is a proper sub-ideal of $\bbb^{\oo c}$ and $\bbb'^{\oo c}$. By Exercise~1.18 p.~10 [Section~\ref{ex1.18p10} p.~\pageref{ex1.18p10}] we also have $\bbb^{\oo c}\bbb'^{\oo c}\subset(\mf{bb}')^{\oo c}\subset\qqq^{\oo c}=\aaa$, in contradiction with the primality of $\aaa$.

\subsubsection{Related result}\label{res}% previous version https://docs.google.com/document/d/1FLOY6fmb0i51WurlovxJkWdDL-SOx5gDK0UZWK0kUjA/edit

Here is a related result:
\begin{equation}\label{fiber1}
\ppp\text{ is the contraction of a prime ideal if and only if }(A_\ppp/\ppp_\ppp)\otimes_AB\ne0.
\end{equation}
This will follow from Claim~1 and Claim~2 below.

\nn\textbf{Claim~1.} The five $B$-algebras 
$$
B_\ppp/\ppp B_\ppp,\quad (B/\ppp B)_\ppp,\quad(A_\ppp/\ppp_\ppp)\otimes_AB,\quad (A/\ppp)_\ppp\otimes_AB,\quad A_\ppp\otimes_A(B/\ppp B)
$$ 
are naturally isomorphic. %Then for any $1\le i,j\le5$ there is a unique $B$-algebra morphism $C_i\to C_j$, and this morphism is bijective. ??? 

This follows from the end of Section~\ref{Smore} p.~\pageref{Smore}. 

\begin{comment}

\nn\textbf{Proof of Claim~1.} Note that $C_i$ has a unique $B_\ppp$-algebra structure which extends its natural $B$-algebra structure. In other words, the image in $C_i$ of any $s\in A\setminus\ppp$ is a unit. Moreover, any element of $C_i$ is equal to $\frac bs\cdot1$ for some $b$ in $B$ and $s$ in $A\setminus\ppp$. This implies that there is at most one morphism of $B$-algebras $\phi_{ji}:C_i\to C_j$. To prove that such morphisms exist, we proceed as follows. If $U$ is an additive group and $V$ a subgroup, we denote the class in $U/V$ of $u\in U$ by $\ov u$ when $V$ is clear from the context. For $i=1,\ldots,5$ define the set theoretical map $f_i:A\times(A\setminus\ppp)\times B\to C_i$ by 
$$
\big(f_1(a,s,b),\ldots,f_5(a,s,b)\big):=\left(
\frac as\otimes\ov b\, ,\ 
\frac{\ov{a\cdot b}}s\ ,
\left(\frac{a\cdot b}s\right)^{\!\!\!\!-},
\left(\frac as\right)^{\!\!\!-}\otimes b\ ,\ 
\frac{\ov a}s\otimes b
\right).
$$ 
We leave it to the reader to check that, for $i,j=1,\ldots,5$, there is a $B$-algebra morphism $\phi_{ji}:C_i\to C_j$ such that $\phi_{ji}(f_i(a,s,b))=f_j(a,s,b)$ for all $a,s,b$. 

Note that $C_i$ is an initial object in the category of those $B$-algebras $C$ such that the image of $a\in A$ in $C$ is zero if $a\in\ppp$ and is a unit if $a\notin\ppp$. 

\end{comment}

\nn\textbf{Claim~2.} We have $\big(B/\ppp^{\oo e}\big)_\ppp=0\iff\ppp^{\oo{ec}}\ne\ppp$. 

\nn\textbf{Proof of Claim~2.} 
$$
\big(B/\ppp^{\oo e}\big)_\ppp=0\iff\frac11=\frac01\text{ in }\big(B/\ppp^{\oo e}\big)_\ppp\iff\exists\ s\in A\setminus\ppp\ |\ f(s)\in\ppp^{\oo e}\iff\exists\ s\in\ppp^{\oo{ec}}\setminus\ppp\iff\ppp^{\oo{ec}}\ne\ppp.
$$ 
Statement \eqref{fiber1} follows also from Exercise~3.21iv p.~47 of the book [see Section~\ref{321iv} p.~\pageref{321iv} below]. 

% comment removed https://docs.google.com/document/d/1fIl3kyz4VZj3UEkEyfreFtOzEm6ZO_1WCRS14hkmw1w/edit

\subsection{Exercises}%%

\subsubsection{Page 43, Exercise~3.1}%

\textbf{Statement.} Let $S$ be a multiplicatively closed subset of a ring $A$, and let $M$ be a finitely generated $A$-module. Prove that $S^{-1}M=0$ if and only if there exists $s\in S$ such that $sM=0$.

\nn\textbf{Solution.} If there exists $s\in S$ such that $sM=0$ and if $x\in M$, then we have $\frac x1=\frac{sx}s=0$. If $S^{-1}M=0$ and $x_1,\ldots x_n$ generate $M$, then for all $i$ there is an $s_i\in S$ such that $s_ix_i=0$, and the product $s_1\cdots s_n$ annihilates $M$.

\subsubsection{Page 43, Exercise~3.2}%

\textbf{Statement.} Let $\aaa$ be an ideal of a ring $A$, and let $S=1+\aaa$. Show that $S^{-1}\aaa$ is contained in the Jacobson radical of $S^{-1}A$.

Use this result and Nakayama's lemma [Proposition~\ref{nak} p.~\pageref{nak}] to give a proof of (2.5) [Corollary~\ref{c2.5} p.~\ref{c2.5}] which does not depend on determinants. [If $M=\aaa M$, then $S^{-1}M=(S^{-1}\aaa)(S^{-1}M)$, hence by Nakayama we have $S^{-1}M=0$. Now use Exercise~1.]

\nn\textbf{Hint.} $S^{-1}\aaa$ is contained in the Jacobson radical of $S^{-1}A$: For $\alpha,\beta,\gamma\in\aaa$ and $a\in A$ we have 
$$
1-\frac\alpha{1+\beta}\frac a{1+\gamma}=\frac{1+\beta+\gamma+\beta\gamma-\alpha a}{1+\beta+\gamma+\beta\gamma}
$$ 
with $1+\beta+\gamma+\beta\gamma-\alpha a\in S$.

\subsubsection{Page 43, Exercise~3.3}%

\textbf{Statement.} Let $A$ be a ring, let $S$ and $T$ be two multiplicatively closed subsets of $A$, and let $U$ be the image of $T$ in $S^{-1}A$. Show that the rings $(ST)^{-1}A$ and $U^{-1}(S^{-1}A)$ are isomorphic.

\nn\textbf{Solution.} We have $U=\{\frac t1\in S^{-1}A\ |\ t\in T\}$. 

We define the $A$-algebra morphism 
$$
f:(ST)^{-1}A\to U^{-1}(S^{-1}A)
$$ 
as follows. Let $f'$ be the composite of the natural morphisms $A\to S^{-1}A\to U^{-1}(S^{-1}A)$, and let $s\in S$, $t\in T$. To define $f$ it suffices to show that $f'(st)$ is a unit. Clearly the inverse of 
$$
f'(st)=\frac{\ \frac{st}1\ }{\ \frac 11\ }
$$ 
is 
$$
\frac{\ \frac1s\ }{\ \frac t1\ }\ .
$$ 

We define the $A$-algebra morphism 
$$
g:U^{-1}(S^{-1}A)\to(ST)^{-1}A
$$ 
as follows. We first define the $A$-algebra morphism $g':S^{-1}A\to(ST)^{-1}A$ by noting that the image of the element $s\in S$ under the natural $A$-algebra morphism $A\to(ST)^{-1}A$ is a unit. Let $t$ be in $T$. To complete the definition of $g$ it suffices to show that $g'(\frac t1)=\frac t1$ is a unit, which is clear.

We then have 
$$
f\left(\frac a{st}\right)=\frac{\ \frac as\ }{\ \frac t1\ }\quad\text{and}\quad g\left(\frac{\ \frac as\ }{\ \frac t1\ }\right)=\frac a{st}
$$ 
for all $a\in A$, $s\in S$, $t\in T$, and it is clear that $f$ and $g$ are inverse $A$-algebra isomorphisms.

\subsubsection{Page 44, Exercise~3.4}%

\textbf{Statement.} Let $f:A\to B$ be a homomorphism of rings and let $S$ be a multiplicatively closed subset of $A$. Let $T=f(S)$. Show that $S^{-1}B$ and $T^{-1}B$ are isomorphic as $S^{-1}A$-modules.

\nn\textbf{Hint.} $S^{-1}B$ is the quotient of $B\times S$ by a certain equivalence relation $\sim$, and $f(S)^{-1}B$ is the quotient of $B\times f(S)$ by a certain equivalence relation $\approx$. Define $g:B\times S\to B\times f(S)$ by $g(b,s)=(b,f(s))$. One easily checks that, for $b,c\in B$ and $s,t\in S$ the conditions $(b,s)\sim(c,t)$ and $(b,(f(s))\approx(c,f(t))$ are equivalent. This implies that there is a bijection $h:S^{-1}B\to T^{-1}B$ such that $h(\frac bs)=\frac b{f(s)}$ for all $b\in B$, $s\in S$. It is straightforward to verify that $h$ is $S^{-1}A$-linear.

\subsubsection{Page 44, Exercise~3.5}%

\textbf{Statement.} Let $A$ be a ring. Suppose that, for each prime ideal $\ppp$, the local ring $A_\ppp$ has no nilpotent element $\ne0$. Show that $A$ has no nilpotent element $\ne0$. If each $A_\ppp$ is an integral domain, is $A$ necessarily an integral domain?

\nn\textbf{Hint.} First part: Use Corollary~\ref{ap} p.~\pageref{ap} above. Alternatively, use Proposition~\ref{38} p.~\pageref{38} and Corollary~3.12 p.~42 of the book\footnote{Statement of the corollary: If $\NNN$ is the nilradical of $A$, the nilradical of $S^{-1}A$ is $S^{-1}\NNN$.}. Second part: take the zero ring [or a product of two fields].

\subsubsection{Page 44, Exercise~3.6}\label{ex3.6}%

\textbf{Statement.} Let $A$ be a ring $\ne0$ and let $\Sigma$ be the set of all multiplicatively closed subsets $S$ of $A$ such that $0\notin S$. Show that $\Sigma$ has maximal elements, and that $S\in\Sigma$ is maximal if and only if $A\setminus S$ is a minimal prime ideal of $A$.

\nn\textbf{Hint.} The union of a chain in $\Sigma$ belongs to $\Sigma$. If $S\in\Sigma$ is maximal, then $S^{-1}A\ne0$. In particular $A$ has a prime ideal $\ppp$ disjoint from $S$, and $A\setminus\ppp$ is an element of $\Sigma$ containing $S$, hence equal to $S$ by maximality of $S$.

% previous version of E 3.7 and E 3.8 https://docs.google.com/document/d/17YFAWtEXwYAJzdMWuQHhimOkH3r1XfLmwqo1q8LgB80/edit

\subsubsection{Page 44, Exercise~3.7}%

\paragraph{Preliminaries.}\label{satprel}

Here are a few comments one can make at the outset.

\begin{note}
Let $S$ and $T$ be two multiplicative subsets of $A$. Then there is at most one $A$-algebra morphism from $S^{-1}A\to T^{-1}A$. Moreover such a morphism exists if and only if for each $s\in S$ the image of $s$ in $T^{-1}A$ is a unit.
\end{note}

\begin{note}
Let $S$ be a multiplicative subset of $A$. Then the following five subsets of $A$ are equal:

\nn$\bullet$ the intersection of all saturated multiplicative subsets of $A$ containing $S$,

\nn$\bullet$ the set of all those elements of $A$ whose image in $S^{-1}A$ is a unit,

\nn$\bullet$ the complement in $A$ of the union of the prime ideals of $A$ which are disjoint from $S$,

\nn$\bullet$ the set of all those elements $a\in A$ such that $ab\in S$ for some $b\in A$.

\nn Moreover this set is the least saturated multiplicative subset of $A$ containing $S$.
\end{note}

This set is called the \textbf{saturation} of $S$ and is denoted by $\overline S$.

\begin{note}
The unique $A$-algebra morphism $S^{-1}A\to\overline S^{-1}A$ is bijective. Moreover, if $T$ is another multiplicative subset, then there is a [necessarily unique] $A$-algebra morphism $S^{-1}A\to T^{-1}A$ if and only if $\overline S\subset T$.
\end{note}

\begin{note}\label{eqcat}
Let $A$ be a ring, let $\mathcal A$ be the category whose objects are the $A$-algebras of the form $S^{-1}A$, where $S$ is a multiplicative subset of $A$, and whose morphisms are the $A$-algebra morphisms, let $\mathcal B$ be the category whose objects are the subsets of $\Spec(A)$ and whose morphisms are defined by 
$$
\oo{Hom}_{\mathcal B}(Y,Z)=\begin{cases}\{\varnothing\}&\text{if }Z\subset Y\\ \varnothing&\text{otherwise}\end{cases}
$$ 
[that is $\mathcal B^{\oo{op}}$ is the poset given by power set of $\Spec(A)$, poset viewed as a category], and let $F:\mathcal A\to\mathcal B$ the functor $S^{-1}A\mapsto\Spec(S^{-1}A)$, where $\Spec(S^{-1}A)$ is viewed as the set of those prime ideals of $A$ disjoint from $S$. Then $F$ is an equivalence.
\end{note}

\paragraph{Statement.} 

A multiplicatively closed subset $S$ of a ring $A$ is said to be \textbf{saturated} if 
$$
xy\in S\iff x\in S\text{ and }y\in S.
$$
Prove that

\nn(i) $S$ is saturated $\iff A\setminus S$ is a union of prime ideals.

\nn(ii) If $S$ is any multiplicatively closed subset of $A$, there is a unique smallest saturated multiplicatively closed subset $\ov S$ containing $S$, and that $\ov S$ is the complement in $A$ of the union of the prime ideals which do not meet $S$. ($\ov S$ is called the \textbf{saturation} of $S$.)

\nn If $S=1+\aaa$, where $\aaa$ is an ideal of $A$, find $\ov S$.

\paragraph{Solution.}\label{ex3.7}%

Let $U$ be the union of the prime ideals which do not meet $S$.

\nn(i) Implication $\Longleftarrow$ is easy. Let us prove $\implies$. Assume by contradiction that there is an $a\in A\setminus S$ which is not in $U$. Then $a/1$ belongs to no prime ideal of $S^{-1}A$, and is therefore a unit of $S^{-1}A$. Hence there are $b\in A$ and $s\in S$ such that 
$$
\frac{ab}s=\frac a1\frac bs=\frac11\ .
$$ 
This implies $abt\in S$ for some $t\in S$, contradicting the saturation of $S$.

\nn(ii) Follows from Section~\ref{satprel} p.~\pageref{satprel} above.

\nn(iii) $\overline S$ is the complement of the union of the maximal ideals containing $\aaa$. 

\nn\emph{Proof.} Let $M$ be the union of the maximal ideals containing $\aaa$, and let $P$ be the union of the prime ideals disjoint from $1+\aaa$:
$$
M:=\bigcup_{\mmm\supset\aaa}\mmm,\quad P:=\bigcup_{\ppp\cap(1+\aaa)=\varnothing}\ppp.
$$ 
It suffices to show $M=P$. 

To prove $M\subset P$, assume $\mmm\supset\aaa$, $\mmm$ maximal. It is enough to check $\mmm\cap(1+\aaa)=\varnothing$. If there was an $x$ in $\mmm\cap(1+\aaa)$, there would be an $a$ in $\aaa$ with $x=1+a$, which would imply $1\in\mmm$, contradiction. 

Let us verify $P\subset M$. Assume $\ppp\cap(1+\aaa)=\varnothing$, with $\ppp$ prime. It suffices to show $\ppp\subset M$. We claim $\ppp+\aaa\ne(1)$. If not we would have $p+a=1$ with $p\in\ppp$ and $a\in\aaa$, and thus 
$$
p=1-a\in\ppp\cap(1+\aaa)=\varnothing.
$$ 
As $\ppp+\aaa\ne(1)$, there is a maximal ideal containing $\ppp$ and $\aaa$. This implies $\ppp\subset M$, as announced.

\subsubsection{Page 44, Exercise~3.8}%

\textbf{Statement.} Let $S,T$ be multiplicatively closed subsets of $A$, such that $S\subset T$. Let $\phi:S^{-1}A\to T^{-1}A$ be the homomorphism which maps each $a/s\in S^{-1}A$ to $a/s$ considered as an element of $T^{-1}A$. Show that the following statements are equivalent:

\nn(i) $\phi$ is bijective.

\nn(ii) For each $t\in T$, $t/1$ is a unit in $S^{-1}A$.

\nn(iii) For each $t\in T$ there exists $x\in A$ such that $xt\in S$. 

\nn(iv) $T$ is contained in the saturation of $S$ (Exercise~7).

\nn(v) Every prime ideal which meets $T$ also meets $S$.

\nn\textbf{Solution.}

\nn(i)$\implies$(ii): The element $x=t/1$ of $S^{-1}A$ is a unit if and only if $\phi(x)$ is a unit of $T^{-1}A$, which is true because $\phi(x)$ is equal to $t/1\in T^{-1}A$.

\nn(ii)$\implies$(iii): If $a/s$ is the inverse of $t/1\in S^{-1}A$, we have $\frac as\frac t1=\frac11$ in $S^{-1}A$, that is $as't=ss'\in S$ for some $s'\in S$.

\nn(iii)$\implies$(iv): Obvious.

\nn(iv)$\implies$(v): This follows from Part (ii) of the previous exercise.

\nn(v)$\implies$(ii): Let $t\in T$ be such that $t/1\in T$ is not a unit in $S^{-1}A$. Then $t/1$ belongs to some prime ideal of $S^{-1}A$, that is, $t$ belongs to some prime ideal of $A$ disjoint from $S$.

\nn(ii)$\implies$(i): There is a [necessarily unique] $A$-algebra morphism $\psi:T^{-1}A\to S^{-1}A$ such that $\psi(a/t)=\frac a1\,(\frac t1)^{-1}$, and $\psi$ is the inverse of $\phi$.

\subsubsection{Page 44, Exercise~3.9}%

See Section \ref{ex1.14} p.~\pageref{ex1.14}. --- Actually there are two proofs of the fact that the set of zero-divisors  is a union of prime ideals: one is Exercise~1.14 p.~12, the other is Exercise~3.7 p.~44 [see Section~\ref{ex3.7} p~\pageref{ex3.7}]. 

\nn$\bu$ To show that a minimal prime ideal $\ppp$ consists of zero-divisors, set $S:=A\setminus\ppp$. Then $S$ is a maximal element of the set denoted $\Sigma$ in Exercise~3.6 [see Section~\ref{ex3.6} p.~\pageref{ex3.6}]. It suffices to prove $S_0\subset S$. Let $s_0$ be in $S_0$. If $s_0$ was not in $S$, then $s_0$ and $S$ would generate a multiplicative set not containing $0$ which is larger than $S$, contradiction. 

\nn$\bu$ (ii) Assume that $a/s\in S_0^{-1}A$ is neither a unit nor a zero-divisor. We have $a\notin S_0$. Then there is a nonzero $b$ in $A$ with $ab=0$, and we get $\frac as\frac b1=0$, hence $\frac b1=0$, that is $bs_0=0$ for some $s_0\in S_0$. This implies $b=0$, contradiction.

\subsubsection{Page 44, Exercise~3.10}\label{ex3.10}%

\textbf{Statement.} Let $A$ be a ring.

\nn(i) If $A$ is absolutely flat (Chapter~2, Exercise~27, Section~\ref{ex2.27} p.~\pageref{ex2.27}) and $S$ is any multiplicatively closed subset of $A$, then $S^{-1}A$ is absolutely flat.

\nn(ii) $A$ is absolutely flat $\iff$ $A_\mmm$ is a field for each maximal ideal $\mmm$.

\nn\textbf{Solution.}

\nn(i) We have, with obvious notation, 
$$
a=a^2x\implies\frac{a^2}{s^2}\frac{sx}1=\frac{a^2xs}{s^2}=\frac{a^2x}s=\frac as\ .
$$ 
(ii) Note that the statement to prove is equivalent to any of the following two statements:

\nn$\bu\ A$ is absolutely flat if and only if for all maximal ideal $\mmm$ of $A$ we have $\mmm_\mmm=(0)$.

\nn$\bu\ A$ is absolutely flat if and only if for all $\mu\in\mmm\subset A$ with $\mmm$ maximal, there is an $s\in A\setminus\mmm$ such that $s\mu=0$. 

Let us show that $A$ is absolutely flat if and only if $A_\mmm$ is a field for each maximal ideal $\mmm$. 

If $A$ is absolutely flat, then so is $A_\mmm$ by Part (i) of the same exercise, and $A_\mmm$ is a field by Exercise~2.28 p.~35 of the book [see Section~\ref{ex2.28} p.~\pageref{ex2.28} above].

Conversely, assume that $A_\mmm$ is a field for each maximal ideal $\mmm$ of $A$, and let $a$ be in $A$. We have $(a^2)_\mmm=(a)_\mmm$ for all maximal $\mmm$, and thus $(a^2)=(a)$. This shows that $A$ is absolutely flat by the implication (ii) $\implies$ (i) in Exercise~2.27 p.~35 of the book [see Section~\ref{ex2.27} p.~\pageref{ex2.27}].

\subsubsection{Page 44, Exercise~3.11}\label{ex3.11}%

\textbf{Statement.} Let $A$ be a ring. Prove that the following are equivalent:

\nn(i) $A/\NNN$ is absolutely flat [$\,\NNN$ being the nilradical of $A$].

\nn(ii) Every prime ideal of $A$ is maximal.

\nn(iii)  $\Spec(A)$ is a T1-space [i.e., every subset consisting of a single point is closed].

\nn(iv) $\Spec(A)$ is Hausdorff.

If these conditions are satisfied, show that $\Spec(A)$ is compact and totally disconnected [i.e. the only connected subsets of $\Spec(A)$ are those consisting of a single point].

\nn\textbf{Solution.} We clearly have (iv)$\implies$(iii)$\iff$(ii).

\nn(ii)$\implies$(iv): We assume that each prime ideal of $A$ is maximal and we show that $X=\Spec(A)$ is Hausdorff. Let $x$ and $y$ be two distinct points of $X$. We claim:

\nn$(\star)$ There are elements $a\in\ppp_y\setminus\ppp_x$, $b\in\ppp_x\setminus\ppp_y$ such that $ab=0$.

Statement $(\star)$ implying that $X_a$ and $X_b$ are disjoint open neighborhoods of $x$ and $y$ respectively, it suffices to prove $(\star)$.

Assume $(\star)$ is false. Then $S:=(A\setminus\ppp_x)(A\setminus\ppp_y)$ is a multiplicatively closed subset avoiding $0$, hence $S^{-1}A$ is not the zero ring, hence there is a maximal ideal $\mmm$ in $S^{-1}A$. The contraction $\mmm^{\oo c}$ of $\mmm$ in $A$ is a prime, and thus maximal, ideal contained in $A\setminus S\subset\ppp_x$ (because $A\setminus\ppp_x\subset S$). This implies $\mmm^{\oo c}=\ppp_x$. Similarly we have $\mmm^{\oo c}=\ppp_y$. As $\ppp_x\ne\ppp_y$, this is a contradiction. $\square$

At this point we know that (ii), (iii) and (iv) are equivalent.

Introduce the following notation: For any ideal $\aaa$ of any ring $R$ write $\overline\aaa$ for the image of $\aaa$ in $\overline R:=R/\NNN(R)$, and define $\overline r\in\overline R$ for $r\in R$ similarly.

\nn(i)$\implies$(ii): Let $A/\mathfrak N$ be absolutely flat and assume by contradiction that there is a prime ideal $\ppp$ strictly contained in a maximal ideal $\mmm$. Let us denote this situation by $\ppp\subsetneqq \mmm$. Then we get firstly $\overline\ppp\subsetneqq \overline\mmm$ with $\overline\ppp$ prime and $\overline\mmm$ maximal, and secondly $\overline\ppp_{\overline\mmm}\subsetneqq \overline\mmm_{\overline\mmm}$ with $\overline\ppp_{\overline\mmm}$ prime and $\overline\mmm_{\overline\mmm}$ maximal. But Exercise~3.10ii p.~44 of the book [see Section~\ref{ex3.10} above] implies $\overline\mmm_{\overline\mmm}=(\overline0)$. $\square$% comment removed https://docs.google.com/document/d/14jVzaDzT3fBsM44o-TqK-vj3Y-ffV171uFQfRRwIR9g/edit

\nn(ii)$\implies$(i): We assume that the prime ideals of $A$ are maximal and we show that $A/\mathfrak N$ is absolutely flat. Let $\mmm$ be a maximal ideal of $A$. By Section~\ref{ex3.10} above it suffices to show $\overline\mmm_{\overline\mmm}=(0)$. But we have $\overline\mmm_{\overline\mmm}=\NNN\left(\overline A_{\overline\mmm}\right)=\NNN\left(\overline A\right)_{\overline\mmm}=(0)$, the second equality following from Corollary 3.12 p.~42 of the book. $\square$% comment removed https://docs.google.com/document/d/1mij8FgdhlRfU_TojPAxb68_PkIviz2Fb7nNJBkzCiWM/edit

\nn Proof that $X$ is totally disconnected: Let $x$ and $y$ be two different points of $X$. We saw that there is an $a\in A$ such that $x\in X_a$ and $y\notin X_a$ [see Statement $(\star)$ above]. It suffices to show that $X_a$ is closed, but this follows from the fact that $X$ is Hausdorff and $X_a$ is compact.  
$\square$

Here is a related result: 

\nn\emph{The following conditions on a ring $A$ are equivalent:}

\nn(a) \emph{the Krull dimension of $A$ is at most zero,}

\nn(b) \emph{$A/\NNN$ is absolutely flat, where $\NNN$ is the nilradical of $A$,}

\nn(c) \emph{for each $a$ in $A$ the descending chain $(a)\supset(a^2)\supset\cdots$ stabilizes.}

\nn\emph{Proof.} In view of Exercise~3.11 p. 44 of the book [see Section~\ref{ex3.11} p.~\pageref{ex3.11}], it suffices to prove (b)$\implies$(c)$\implies$(a). 

\nn(b)$\implies$(c): With obvious notation we have $\overline a=\overline a^2\overline b$ for some $b$ in $A$, that is $(a-a^2b)^n=0$ for some $n\ge1$. This is easily seen to imply $a^n\in(a^{n+1})$ and thus $(a^{n+1})=(a^n)$. 

\nn(c)$\implies$(a): Let $\ppp$ be a prime ideal of $A$ and let $a$ be in $A\setminus\ppp$. We have $a^n(1-ab)=0$ for some $b$ in $A$ and some $n$ in $\mathbb N$. In particular $a^n(1-ab)\in\ppp$, and thus $1-ab\in\ppp$. This implies that $A/\ppp$ is a field, and therefore that $\ppp$ is maximal. $\square$

\subsubsection{Page 45, Exercise~3.12}%

\textbf{Statement.} Let $A$ be an integral domain and $M$ an $A$-module. An element $x\in M$ is a \textbf{torsion element} of $M$ if $\Ann(x)\ne0$, that is if $x$ is killed by some non-zero element of $A$. Show that the torsion elements of $M$ form a submodule of $M$. This submodule is called the \textbf{torsion submodule} of $M$ and is denoted by $T(M)$. If $T(M)=0$, the module $M$ is said to be torsion-free. Show that

\nn(i) If $M$ is any $A$-module, then $M/T(M)$ is torsion-free.

\nn(ii) If $f: M\to N$ is a module homomorphism, then $f(T(M))\subset T(N)$.

\nn(iii) If $0\to M'\to M\to M''$ is an exact sequence, then the sequence $0\to T(M')\to T(M)\to T(M'')$ is exact.

\nn(iv) If $M$ is any $A$-module, then $T(M)$ is the kernel of the mapping $x\mapsto1 \otimes x$ of $M$ into $K\otimes_AM$, where $K$ is the field of fractions of $A$.

[For iv), show that $K$ may be regarded as the direct limit of its submodules $A\xi$ ($\xi\in K$); using Chapter~1, Exercise~15 and Exercise~20 [Exercise~\ref{ex1.15} p.~\pageref{ex1.15} and Exercise~\ref{ex1.20} p.~\pageref{ex1.20}], show that if $1\otimes X=0$ in $K\otimes M$ then $1\otimes x=0$ in $A\xi\otimes M$ for some $\xi\ne0$. Deduce that $\xi^{-1}x=0$.]

\nn\textbf{Hints.}

\nn(i) Let $x+T(M)\in M/T(M)$ with $x\in M$, and let $a\in A$, $a\ne0$, satisfy $a(x+T(M))=0$, that is $ax\in T(M)$. Then there is a nonzero $b\in A$ such that $bax=0$, and thus $x\in T(M)$.

\nn(ii) If $x\in T(M)$, then we get $ax=0$ for some $a\in A$, $a\ne0$, and thus $af(x)=f(ax)=0$.

\nn(iii) The exactness at $T(M')$ is clear. To prove the exactness at $T(M)$, let $x$ be in $T(M)$, and let $x''$ be its image in $M''$; in particular $x''\in T(M'')$. Suppose $x''=0$. Then $x$ is the image of some $x'\in M'$. We have $ax=0$ for some nonzero $a\in A$, and thus $ax'=0$. This shows that $x'\in T(M')$.

\nn(iv) [In the hint, ``Chapter~1'' should be ``Chapter~2''.] By Exercise~2.20 p.~33 of the book we have 
$$
K\otimes_AM\simeq\left(\colim_{a\in A\setminus\{0\}}Aa^{-1}\right)\otimes_AM\simeq\colim_{a\in A\setminus\{0\}}\left(Aa^{-1}\otimes_AM\right).
$$ 
If $1\otimes x$ vanishes in $K\otimes_AM$, then Exercise~2.15 p.~33 of the book implies that $1\otimes x$ already vanishes in $Aa^{-1}\otimes_AM$ for some $a\in A\setminus\{0\}$, and we get $0=1\otimes x=a^{-1}a\otimes x=a^{-1}\otimes ax$ in $Aa^{-1}\otimes_AM$. This implies $ax=0$ because the map $M\to Aa^{-1}\otimes_AM$, $y\mapsto a^{-1}\otimes y$ is an isomorphism.

\subsubsection{Page 45, Exercise~3.13}%

\textbf{Statement.} Let $S$ be a multiplicatively closed subset of an integral domain $A$. In the notation of Exercise~12, show that $T(S^{-1}M)=S^{-1}(TM)$. Deduce that the following are equivalent:

\nn(i) $M$ is torsion-free.

\nn(ii) $M_\ppp$ is torsion-free for all prime ideals $\ppp$.

\nn(iii) $M_\mmm$ is torsion-free for all maximal ideals $\mmm$.

\nn[Note the implicit assumption $0\notin S$.]

\nn\textbf{Solution.} We claim 
\begin{equation}\label{anfr}
\Ann\left(\frac xs\right)=S^{-1}\Ann(x).
\end{equation} 
Proof: We have $\Ann(\frac xs)=\Ann(\frac x1)=\Ann((S^{-1}A)\frac x1)=\Ann(S^{-1}(Ax))=S^{-1}\Ann(Ax)=S^{-1}\Ann(x)$, the equality $\Ann(S^{-1}(Ax))=S^{-1}\Ann(Ax)$ following from Proposition~3.14 p.~43 of the book. This proves \eqref{anfr}.

To show
\begin{equation}\label{tsm}
T(S^{-1}M)=S^{-1}(TM)
\end{equation}
let first $\frac xs\in T(S^{-1}M)$. We have $(0)\ne\Ann(\frac xs)=S^{-1}\Ann(x)$ by \eqref{anfr}. This implies $\Ann(x)\ne(0)$, hence $x\in T(M)$, hence $\frac xs\in S^{-1}T(M)$. Suppose now $\frac xs\in S^{-1}T(M)$, that is $\frac xs=\frac yt$ with $y\in T(M)$, $t\in S$ and $tux=suy$ for some $u\in S$; and we get $\Ann(\frac xs)=\Ann(\frac yt)=S^{-1}\Ann(y)$ by \eqref{anfr}. Since $\Ann(y)$ is nonzero, so is $S^{-1}\Ann(y)$, hence $\frac xs\in T(S^{-1}M)$. This completes the proof of \eqref{tsm}.

We now show that (i), (ii) and (iii) are equivalent:

\nn(i)$\implies$(ii): Follows immediately from \eqref{tsm}.

\nn(ii)$\implies$(iii): Obvious.

\nn(iii)$\implies$(i): Follows immediately from \eqref{tsm} and Proposition~3.8 p.~40 of the book.

\subsubsection{Page 45, Exercise~3.14}\label{ex3.14}%

\textbf{Statement.} Let $M$ be an $A$-module and $\aaa$ an ideal of $A$. Suppose that $M_\mmm=0$ for all maximal ideals $\mmm\supset\aaa$. Prove that $M=\aaa M$. 

\nn\textbf{Solution.} Let $\mmm$ be a maximal ideal of $A/\aaa$. It suffices to show $(M/\aaa M)_\mmm=0$. Letting $\mmm^{\oo c}$ be the contraction of $\mmm$ in $A$, we get $
(M/\aaa M)_\mmm\simeq(M/\aaa M)_{\mmm^{\oo c}}\simeq M_{\mmm^{\oo c}}/(\aaa M)_{\mmm^{\oo c}}=0$. 

\subsubsection{Page 45, Exercise~3.15}\label{ex3.15}%

\textbf{Statement.} Let $A$ be a ring. Show that every set of $n$ generators of $A^n$ is a basis of $A^n$. Deduce that every set of generators of $A^n$ has at least $n$ elements. [Hint. Let $x_1,\ldots,x_n$ be a set of generators and $e_1,\ldots,e_n$ the canonical basis of $A^n$. Define $\phi:A^n\to A^n$ by $\phi(e_i)=x_i$. Then $\phi$ is surjective and we have to prove that it is an isomorphism. By (3.9) we may assume that $A$ is a local ring. Let $N$ be the kernel of $\phi$ and let $k=A/\mmm$ be the residue field of $A$\ldots] 

\nn\textbf{Solution.} Use Corollary~\ref{notor} p.~\pageref{notor}. %[Argument stolen from Altman and Kleiman, see Section~\ref{intro} p.~\pageref{intro}.] 

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 3
% comment removed https://docs.google.com/document/d/1xq5VCYuRUAVFwrbOqkGsjJjaLqYfpHNf5kZr2zub8rs/edit

\subsubsection{Page 46, Exercise~3.16}\label{ex3.16}%

\textbf{Statement.} Let $B$ be a flat $A$-algebra. Then the following conditions are equivalent: 

\nn(i) $\aaa^{\oo{ec}}=\aaa$ for all ideals $\aaa$ of $A$.

\nn(ii) $\Spec(B)\to\Spec(A)$ is surjective.

\nn(iii) For every maximal ideal $\mmm$ of $A$ we have $\mmm^{\oo e}\ne(1)$.

\nn(iv) If $M$ is any non-zero $A$-module, then $M_B\ne0$.

\nn(v) For every $A$-module $M$, the mapping $x\mapsto1\otimes x$ of $M$ into $M_B$ is injective.

\nn[For (i) $\implies$ (ii), use (3.16) [Proposition~\ref{p3.16} p.~\pageref{p3.16}]. (ii) $\implies$ (iii) is clear.

\nn(iii) $\implies$ (iv): Let $x$ be a non-zero element of $M$ and let $M'=Ax$. Since $B$ is flat over $A$ it is enough to show that $M'_B\ne0$. We have $M'\simeq A/\aaa$ for some ideal $\aaa\ne(1)$, hence $M'_B\simeq B/\aaa^{\oo e}$. Now as $\aaa\subset\mmm$ for some maximal ideal $\mmm$, hence $\aaa^{\oo e}\subset\mmm^{\oo e}\ne(1)$. Hence $M'_B\ne0$.

\nn(iv) $\implies$ (v): Let $M'$ be the kernel of $M\to M_B$. Since $B$ is flat over $A$, the sequence $0\to M'_B\to M_B\to(M_B)_B$ is exact. But (Chapter 2, Exercise 13 [Section~\ref{ex2.13} p.~\pageref{ex2.13}], with $N=M_B$) the mapping $M_B\to(M_B)_B$ is injective, hence $M'_B=0$ and therefore $M'=0$.

\nn(v) $\implies$ (i): Take $M=A/\aaa$.]

\nn$B$ is said to be \textbf{faithfully flat} over $A$.

\nn\textbf{Hints.} We claim that Property (vi) below is equivalent to Properties (i) to (v).

\nn(vi) For any $A$-linear map $M'\to M$, if $M'_B\to M_B$ is injective, then so is $M'\to M$.

\nn(vi)$\implies$(v): We must prove that $M\to M_B$ is injective. It suffices to show that $M_B\to M_{BB}$ is injective. But this follows from Exercise~2.13 p.~32 of the book.

\nn(iv)$\implies$(vi): Let $0\to M'\to M\to M''$ be an exact sequence such that $M_B\to M''_B$ is injective. It suffices to show $M'=0$, or even $M'_B=0$. But this follows from the fact that $0\to M'_B\to M_B\to M''_B$ is exact.

% Missing: Statements of Exercises 3.17, 3.18, 3.19, 3.20 p. 46

\subsubsection{Page 46, Exercise~3.17}\label{ex3.17}%

\textbf{Statement.} Let $A\xr fB\xr gC$ be ring homomorphisms. If $g\circ f$ is flat and $g$ is faithfully flat, then $f$ is flat.

\nn\textbf{Hints.} Let $M'\to M$ be injective. We must show that $M'_B\to M_B$ is injective.  By Section~\ref{ex3.16} p.~\pageref{ex3.16} and by the fact that $B\to C$ is faithfully flat, it suffices to check that $M'_{BC}\to M_{BC}$ is injective, i.e., that $M'_C\to M_C$ is injective. But this follows from the fact that $A\to C$ is flat.

\subsubsection{Page 46, Exercise~3.18}%

\textbf{Statement.} Let $f:A\to B$ be a flat homomorphism of rings, let $\qqq$ be a prime ideal of $B$ and let $\ppp=\qqq^{\oo c}$. Then $f^*:\Spec(B_\qqq)\to\Spec(A_\ppp)$ is surjective. [For $B_\ppp$ is flat over $A_\ppp$ by (3.10)\footnote{Proposition 3.10 p.~41 of the book says that for any $A$-module $M$, the following statements are equivalent: (i) $M$ is a flat $A$-module, (ii) $M_\ppp$ is a flat $A_\ppp$-module for each prime ideal $\ppp$; (iii) $M_\mmm$ is a flat $A_\mmm$-module for each maximal ideal $\mmm$.}, and $B_\qqq$ is a local ring of $B_\ppp$, hence is flat over $B_\ppp$. Hence $B_\qqq$ is flat over $A_\ppp$ and satisfies condition (3) of Exercise~16.]

\nn\textbf{Hints.} The phrase ``$B_\qqq$ is a local ring of $B_\ppp$'' means ``$B_\qqq$ is a localization of $B_\ppp$''.

\subsubsection{Page 46, Exercise~3.19}\label{ex3.19}%

\textbf{Statement.} Let $A$ be a ring, $M$ an $A$-module. The support of $M$ is defined to be the set $\oo{Supp}(M)$ of prime ideals $\ppp$ of $A$ such that $M_\ppp\ne0$. Prove the following results:

\nn(i) $M\ne0\iff\oo{Supp}(M)\ne\varnothing$.

\nn(ii) $V(\aaa)=\oo{Supp}(A/\aaa)$.

\nn(iii) If $0\to M'\to M\to M''\to0$ is an exact sequence, then $\oo{Supp}(M) =\oo{Supp}(M')\cup\oo{Supp}(M'')$.

\nn(iv) If $M=\sum M_i$ then $\oo{Supp}(M)=\bigcup\oo{Supp}(M_i)$.

\nn(v) If $M$ is finitely generated, then $\oo{Supp}(M)=V(\Ann(M))$ (and is therefore
a closed subset of $\Spec(A)$).

\nn(vi) If $M,N$ are finitely generated, then $\oo{Supp}(M\otimes_AN)=\oo{Supp}(M)\cap\oo{Supp}(N)$. [Use Chapter~2, Exercise~3, Section~\ref{ex2.3} p.~\pageref{ex2.3}.]

\nn(vii) If $M$ is finitely generated and $\aaa$ is an ideal of $A$, then $\oo{Supp}(M/\aaa M)=V(\aaa+\Ann(M))$.

\nn(viii) If $f:A\to B$ is a ring homomorphism and $M$ is a finitely generated $A$-module, then $\oo{Supp}(B\otimes_AM)=f^{*-1}(\oo{Supp}(M))$.

\nn\textbf{General Observation.} If $P(M)$ is a property that an $A$-module $M$ may or may not have, then to prove $P(M)$ for all finitely generated module, it suffices to prove that 

\nn$\bu\ P(A/\aaa)$ holds for all ideal $\aaa$,

\nn$\bu\ P(M_1+M_2)$ holds for all finitely generated submodules $M_1$ and $M_2$ of a module $M$ whenever $P(M_1)$ and $P(M_2)$ hold.

\nn\textbf{Hints.} It seems better to start by proving (iii) and (iv), and then (ii). For (iv), see \eqref{tpcwc} p.~\pageref{tpcwc}. For (v), use (ii) and the General Observation. 

\nn Hint for (vi): Use Proposition~3.7 p. 40 of the book [Proposition~\ref{p3.7} p.~\ref{p3.7}].

\nn Proof of (vii): Let $\bbb$ be the annihilator of $M$. Set $\ov A:=A/\aaa$ and $\ov M:=M/\aaa M$. Let $\pi:A\to\ov A$ be the canonical projection and put $\ov\ccc:=\pi(\ccc)$ for any ideal $\ccc$ of $A$. Let $\ppp$ be a prime ideal of $A$. We must show $\ov M_\ppp\ne0\iff\ppp\supset\aaa+\bbb$. Since $\ppp\not\supset\aaa$ implies $\aaa_\ppp=(1)$ and thus 
$$
\ov M_\ppp\simeq M_\ppp/\aaa_\ppp M_\ppp=M_\ppp/M_\ppp=0,
$$ 
we can assume $\ppp\supset\aaa$, and we get $\ov M_\ppp\ne0\iff\ov M_{\ov\ppp}\ne0\iff\ov\ppp\supset\ov\bbb\iff\ppp\supset\bbb$ by (v). 

To prove (viii) we will use the following lemma: 

\begin{lem}\label{L25a} 
If $f:A\to B$ is a ring homomorphism as above, then we have: 

\nn\emph{(a)} The $A$-linear morphism $B\otimes_AA\to B$ characterized by the condition $b\otimes a\mapsto ba$ for all $b\in B$ and $a\in A$ is a ring isomorphism. 

\nn\emph{(b)} If $n$ is a nonnegative integer, then there is a $B$-linear isomorphism $B\otimes_AA^n\to B^n$. (In particular $B\otimes_AA^n=0\implies n=0\implies A^n=0$.) %Let $k$ be a field, let $K$ be an extension of $k$ (that is, $K$ is a field containing $k$), and let $V$ be an $n$-dimensional $k$-vector space (where $n$ is a nonnegative integer). Then $K\otimes_kV$ is an $n$-dimensional $K$-vector space.
\end{lem}

\begin{proof} 
(a) Proposition~2.14iv p.~26 of the book implies that there is an $A$-linear isomorphism $B\otimes_AA\to B$ characterized by the condition $b\otimes a\mapsto ba$ for all $b\in B$ and $a\in A$, and it is easy to see that this is a ring morphism. Now (b) follows from (a) and Proposition~2.14iii p.~26 of the book which says that there is an $A$-module isomorphism $(M\oplus N)\otimes_AP\to(M\otimes_AP)\oplus(N\otimes_AP)$, where $M,N$ and $P$ are $A$-modules. %[This follows immediately from Proposition~2.14iii (p.~26 of the book) and the observation just before Proposition 2,17 (p.~28 of the book). [Proposition~2.14iii says that there is an $A$-module isomorphism $(M\oplus N)\otimes_AP\to(M\otimes_AP)\oplus(N\otimes_AP)$, where $M,N$ and $P$ are $A$-modules. ???] 
\end{proof}

\nn Proof of (viii): Let $\qqq\in\Spec(B)$ and set $\ppp:=\qqq^{\oo c}$. It suffices to show $M_{B,\qqq}=0\iff M_\ppp=0$. We claim
\begin{equation}\label{mbq}
\frac{M_{B,\qqq}}{\qqq M_{B,\qqq}}\simeq\frac{B_\qqq}{\qqq_\qqq}\otimes_{A_\ppp/\ppp_\ppp}\frac{M_\ppp}{\ppp M_\ppp}\ .
\end{equation}

\nn As $A_\ppp/\ppp_\ppp$ is a field and $M$ is finitely generated, \eqref{mbq} will imply, in view of Lemma~\ref{L25a}, that 
$$
M_{B,\qqq}=0\iff\frac{M_{B,\qqq}}{\qqq M_{B,\qqq}}=0\iff\frac{M_\ppp}{\ppp M_\ppp}=0\iff M_\ppp=0.
$$ 
Let us prove \eqref{mbq}. We have 
$$
\frac{M_{B,\qqq}}{\qqq M_{B,\qqq}}=
\frac{(B\otimes_AM)_\qqq}{\qqq(B\otimes_AM)_\qqq}\simeq
\frac{B_\qqq}{\qqq_\qqq}\otimes_BB\otimes_AM\simeq
\frac{B_\qqq}{\qqq_\qqq}\otimes_AM
$$ 
$$
\simeq
\frac{B_\qqq}{\qqq_\qqq}\otimes_{A_\ppp/\ppp_\ppp}\frac{A_\ppp}{\ppp_\ppp}\otimes_AM\simeq
\frac{B_\qqq}{\qqq_\qqq}\otimes_{A_\ppp/\ppp_\ppp}\frac{M_\ppp}{\ppp M_\ppp}\ .
$$ 
Let us show that the inclusion $f^{*-1}(\oo{Supp}(M))\subset\oo{Supp}(M_B)$ holds even if $M$ is not finitely generated. It suffices to prove $(B\otimes_AM)_\qqq\simeq B_\qqq\otimes_{A_\ppp}M_\ppp$. We have 
$$
(B\otimes_AM)_\qqq\simeq B_\qqq\otimes_BB\otimes_AM\simeq
B_\qqq\otimes_AM\simeq B_\qqq\otimes_{A_\ppp}A_\ppp\otimes_AM
\simeq B_\qqq\otimes_{A_\ppp}M_\ppp\ .
$$

\subsubsection{Page 46, Exercise~3.20}%

\textbf{Statement.} Let $f:A\to B$ be a ring homomorphism, $f^*:\Spec(B)\to\Spec(A)$ the associated mapping. Show that

\nn(i) Every prime ideal of $A$ is a contracted ideal $\iff f^*$ is surjective. 

\nn(ii) Every prime ideal of $B$ is an extended ideal $\implies f^*$ is injective.

\nn Is the converse of (ii) true?

\nn\textbf{Hints.} (i) See Proposition~\ref{p3.16} p.~\pageref{p3.16} above. 

Counterexample to the converse of (ii): $A:=K$ a field, $B:=K[\varepsilon]$ with $\varepsilon^2=0$, $f:K\to K[\varepsilon]$ the inclusion. 

\subsubsection{Page 46, Exercise~3.21}\label{321iv}%

\textbf{Statement.} (i) Let $A$ be a ring, $S$ a multiplicatively closed subset of $A$, and $\phi:A\to S^{-1}A$ the canonical homomorphism. Show that $\phi^*:\Spec(S^{-1}A)\to\Spec(A)$ is a homeomorphism of $\Spec(S^{-1}A)$ onto its image in $X=\Spec(A)$. Let this image be denoted by $S^{-1}X$.

\nn In particular, if $f\in A$, the image of $\Spec(A_f)$ in $X$ is the basic open set $X_f$ (Chapter~1, Exercise~17).

\nn(ii) Let $f:A\to B$ be a ring homomorphism. Let $X=\Spec(A)$ and $Y=\Spec(B)$, and let $f^*:Y\to X$ be the mapping associated with $f$. Identifying $\Spec(S^{-1}A)$ with its canonical image $S^{-1}X$ in $X$, and $\Spec(S^{-1}B)(=\Spec(f(S)^{-1}B))$ with its canonical image $S^{-1}Y$ in $Y$, show that $S^{-1}f^*:\Spec(S^{-1}B)\to\Spec(S^{-1}A)$ is the restriction of $f^*$ to $S^{-1}Y$, and that $S^{-1}Y=f^{*-1}(S^{-1}X)$.

\nn(iii) Let $\aaa$ be an ideal of $A$ and let $\bbb=\aaa^{\oo e}$ be its extension in $B$. Let $\ov f:A/\aaa\to B/\bbb$ be the homomorphism induced by $f$. If $\Spec(A/\aaa)$ is identified with its canonical image $V(\aaa)$ in $X$, and $\Spec(B/\bbb)$ with its image $V(\bbb)$ in $Y$, show that $\ov f^*$ is the restriction off $f^*$ to $V(\bbb)$.

\nn(iv) Let $\ppp$ be a prime ideal of $A$. Take $S=A\setminus\ppp$ in (ii) and then reduce mod $S^{-1}\ppp$ as in (iii). Deduce that the subspace $f^{*-1}(\ppp)$ of $Y$ is naturally homeomorphic to $\Spec(B_\ppp/\ppp B_\ppp)=\Spec(k(\ppp)\otimes_AB)$, where $k(\ppp)$ is the residue field of the local ring $A_\ppp$.

$\Spec(k(\ppp)\otimes_AB)$ is called the fiber of $f^*$ over $\ppp$.

\nn\textbf{Solution.} (i) Set $S^{-1}X:=\{\ppp\in X\ |\ \ppp\cap S=\varnothing\}$. By Proposition~3.11iv p.~41 of the book [Proposition~\ref{p3.11} p.~\pageref{p3.11}] the maps % https://q.uiver.app/?q=WzAsMixbMCwwLCJcXHRleHR7U3BlY30oU157LTF9QSkiXSxbMSwwLCJTXnstMX1YIl0sWzAsMSwiXFxwaGleKiIsMCx7Im9mZnNldCI6LTF9XSxbMSwwLCJTXnstMX0iLDAseyJvZmZzZXQiOi0xfV1d
\[\begin{tikzcd}
	{\Spec(S^{-1}A)} & {S^{-1}X}
	\arrow["{\phi^*}", shift left=1, from=1-1, to=1-2]
	\arrow["{S^{-1}}", shift left=1, from=1-2, to=1-1]
\end{tikzcd}\]
are inverse bijections. Let us equip $S^{-1}X\subset X$ with the induced topology. Then the closed subsets of $S^{-1}X$ are precisely the subsets of the form $V(\aaa)\cap S^{-1}X$ where $\aaa$ is an ideal of $A$. By Proposition~3.11i p.~41 of the book [Proposition~\ref{p3.11} p.~\pageref{p3.11}], the closed subsets of $S^{-1}A$ are precisely the subsets of the form $V(S^{-1}\aaa)$ where $\aaa$ is an ideal of $A$. Thus it suffices to show that, given an ideal $\aaa$ of $A$ and a prime ideal $\ppp$ of $A$, we have $S^{-1}\aaa\subset S^{-1}\ppp\iff\aaa\subset\ppp$. Implication $\Leftarrow$ is clear. Conversely $S^{-1}\aaa\subset S^{-1}\ppp$ implies 
$$
\aaa\subset\phi^*S^{-1}\aaa\subset\phi^*S^{-1}\ppp=\ppp.
$$ 
(ii) Since the diagram 
% https://q.uiver.app/#q=WzAsNSxbMCwwLCJBIl0sWzAsMl0sWzAsMSwiU157LTF9QSJdLFsxLDAsIkIiXSxbMSwxLCJTXnstMX1CIl0sWzAsMywiZiJdLFswLDJdLFsyLDQsIlNeey0xfWYiLDJdLFszLDRdXQ==
\[\begin{tikzcd}
	A & B \\
	{S^{-1}A} & {S^{-1}B} \\
	{}
	\arrow["f", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow["{S^{-1}f}"', from=2-1, to=2-2]
\end{tikzcd}\] 
commutes, so does 
% https://q.uiver.app/#q=WzAsNSxbMCwwLCJYIl0sWzAsMl0sWzAsMSwiU157LTF9WCJdLFsxLDAsIlkiXSxbMSwxLCJTXnstMX1ZIl0sWzMsMCwiZl4qIiwyXSxbMiwwLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6ImJvdHRvbSJ9fX1dLFs0LDIsIihTXnstMX1mKV4qIl0sWzQsMywiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJib3R0b20ifX19XV0=
\[\begin{tikzcd}
	X & Y \\
	{S^{-1}X} & {S^{-1}Y.} \\
	{}
	\arrow["{f^*}"', from=1-2, to=1-1]
	\arrow[hook', from=2-1, to=1-1]
	\arrow[hook', from=2-2, to=1-2]
	\arrow["{(S^{-1}f)^*}", from=2-2, to=2-1]
\end{tikzcd}\] 
This proves the first claim. To show $S^{-1}Y=f^{*-1}(S^{-1}X)$, note that, for $\qqq\in Y$, we have 
$$
\qqq\in S^{-1}Y\iff f(S)\cap\qqq=\varnothing\iff S\cap f^*(\qqq)=\varnothing\iff f^*(\qqq)\in S^{-1}X\iff\qqq\in f^{*-1}(S^{-1}X).
$$ 
\nn(iii) Since the diagram 
% https://q.uiver.app/#q=WzAsNSxbMCwwLCJBIl0sWzAsMl0sWzAsMSwiU157LTF9QSJdLFsxLDAsIkIiXSxbMSwxLCJTXnstMX1CIl0sWzAsMywiZiJdLFswLDJdLFsyLDQsIlNeey0xfWYiLDJdLFszLDRdXQ==
\[\begin{tikzcd}
	A & B \\
	A/\aaa & B/\bbb \\
	{}
	\arrow["f", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow["\overline f"', from=2-1, to=2-2]
\end{tikzcd}\] 
commutes, so does 
% https://q.uiver.app/#q=WzAsNSxbMCwwLCJYIl0sWzAsMl0sWzAsMSwiVihcXG1hdGhmcmFrIGEpIl0sWzEsMCwiWSJdLFsxLDEsIlYoXFxtYXRoZnJhayBiKSJdLFszLDAsImZeKiIsMl0sWzIsMCwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJib3R0b20ifX19XSxbNCwyLCJcXG92ZXJsaW5lIGZeKiJdLFs0LDMsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoiYm90dG9tIn19fV1d
\[\begin{tikzcd}
	X & Y \\
	{V(\mathfrak a)} & {V(\mathfrak b).} \\
	{}
	\arrow["{f^*}"', from=1-2, to=1-1]
	\arrow[hook', from=2-1, to=1-1]
	\arrow[hook', from=2-2, to=1-2]
	\arrow["{\overline f^*}", from=2-2, to=2-1]
\end{tikzcd}\] 
(iv) We have the commuting diagrams 
% https://q.uiver.app/#q=WzAsOCxbMSwwLCJBIl0sWzIsMCwiQiJdLFsxLDEsIkEvXFxtYXRoZnJhayBwIl0sWzIsMSwiQi9cXG1hdGhmcmFrIHBCIl0sWzIsMiwiKEIvXFxtYXRoZnJhayBwQilfe1xcbWF0aGZyYWsgcH0iXSxbMSwyLCIoQS9cXG1hdGhmcmFrIHApX3tcXG1hdGhmcmFrIHB9Il0sWzAsMiwiayhcXG1hdGhmcmFrIHApIl0sWzMsMiwiQl97XFxtYXRoZnJhayBwfS9cXG1hdGhmcmFrIHBCX3tcXG1hdGhmcmFrIHB9Il0sWzAsMSwiZiJdLFsyLDNdLFs1LDRdLFswLDJdLFsxLDNdLFsyLDVdLFszLDRdLFs2LDUsIiIsMCx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNiw1LCIiLDAseyJvZmZzZXQiOjEsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNCw3LCIiLDAseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzQsNywiIiwwLHsib2Zmc2V0IjoxLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV1d
\[\begin{tikzcd}
	& A & B \\
	& {A/\mathfrak p} & {B/\mathfrak pB} \\
	{k(\mathfrak p)} & {(A/\mathfrak p)_{\mathfrak p}} & {(B/\mathfrak pB)_{\mathfrak p}} & {B_{\mathfrak p}/\mathfrak pB_{\mathfrak p}}
	\arrow["f", from=1-2, to=1-3]
	\arrow[from=1-2, to=2-2]
	\arrow[from=1-3, to=2-3]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-2, to=3-2]
	\arrow[from=2-3, to=3-3]
	\arrow[no head, from=3-1, to=3-2]
	\arrow[shift right, no head, from=3-1, to=3-2]
	\arrow[from=3-2, to=3-3]
	\arrow[no head, from=3-3, to=3-4]
	\arrow[shift right, no head, from=3-3, to=3-4]
\end{tikzcd}\] 
and 
% https://q.uiver.app/#q=WzAsNixbMCwwLCJYIl0sWzAsMiwiXFx7XFxtYXRoZnJhayBwXFx9Il0sWzAsMSwiVihcXG1hdGhmcmFrIHApIl0sWzEsMCwiWSJdLFsxLDEsIlYoXFxtYXRoZnJhayBwQikiXSxbMSwyLCJaIl0sWzMsMCwiZl4qIiwyXSxbMiwwLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6ImJvdHRvbSJ9fX1dLFs0LDIsIlxcb3ZlcmxpbmUgZl4qIiwyXSxbNCwzLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6ImJvdHRvbSJ9fX1dLFs1LDEsIlxcb3ZlcmxpbmUgZl97XFxtYXRoZnJhayBwfV4qIl0sWzEsMiwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJib3R0b20ifX19XSxbNSw0LCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6ImJvdHRvbSJ9fX1dXQ==
\[\begin{tikzcd}
	X & Y \\
	{V(\mathfrak p)} & {V(\mathfrak pB)} \\
	{\{\mathfrak p\}} & Z
	\arrow["{f^*}"', from=1-2, to=1-1]
	\arrow[hook', from=2-1, to=1-1]
	\arrow[hook', from=2-2, to=1-2]
	\arrow["{\overline f^*}"', from=2-2, to=2-1]
	\arrow[hook', from=3-1, to=2-1]
	\arrow[hook', from=3-2, to=2-2]
	\arrow["{\overline f_{\mathfrak p}^*}", from=3-2, to=3-1]
\end{tikzcd}\] 
with $Z:=\Spec(B_{\mathfrak p}/\mathfrak pB_{\mathfrak p})$. The second claim of (ii) implies $Z=\overline f^{*-1}(\ppp)$. Finally note that we have 
$$
\overline f^{*-1}(\ppp)=\{\qqq\in Y\ |\ \qqq\supset f(\ppp),\ f^*(\qqq)=\ppp\}=\{\qqq\in Y\ |\ f^*(\qqq)=\ppp\}=f^{*-1}(\ppp),
$$ 
that is, $\Spec(B_{\mathfrak p}/\mathfrak pB_{\mathfrak p})=f^{*-1}(\ppp)$, as required. Finally, the natural isomorphism $B_\ppp/\ppp B_\ppp\simeq k(\ppp)\otimes_AB)$ follows from Section~\ref{res} p.~\pageref{res}. 

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 4

\subsubsection{Page 47, Exercise~3.22}\label{ex3.22}%

\textbf{Statement.} Let $A$ be a ring and $\ppp$ a prime ideal of $A$. Then the canonical image of $\Spec(A_\ppp)$ in $\Spec(A)$ is equal to the intersection of all the open neighborhoods of $\ppp$ in $\Spec(A)$.

\nn\textbf{Solution.} Let $X:=\Spec(A)$. It suffices to show 
$$
\{\qqq\in X\ |\ \qqq\subset\ppp\}=\bigcap_{f\notin\ppp}X_f.
$$ 
We have 
$$
\bigcap_{f\notin\ppp}X_f=\{\qqq\in X\ |\ f\notin\ppp\implies f\notin\qqq\}=\{\qqq\in X\ |\ f\in\qqq\implies f\in\ppp\}=\{\qqq\in X\ |\ \qqq\subset\ppp\}.
$$ 

\subsubsection{Page 47, Exercise~3.23}%

\textbf{Statement.} Let $A$ be a ring, let $X=\Spec(A)$ and let $U$ be a basic open set in $X$ (i.e., $U=X_f$ for some $f\in A$: Chapter~1, Exercise~17).

\nn(i) If $U=X_f$, show that the ring $A(U)=A_f$ depends only on $U$ and not on $f$.

\nn(ii) Let $U'=X_g$ be another basic open set such that $U'\subset U$. Show that there is an equation of the form $g^n=uf$ for some integer $n>0$ and some $u\in A$, and use this to define a homomorphism $\rho:A(U)\to A(U')$ (i.e., $A_f\to A_g$) by mapping $a/f^m$ to $au^m/g^{mn}$. Show that $\rho$ depends only on $U$ and $U'$. This homomorphism is called the \textbf{restriction} homomorphism.

\nn(iii) If $U=U'$, then $\rho$ is the identity map.

\nn(iv) If $U\supset U'\supset U''$ are basic open sets in $X$, show that the diagram% https://q.uiver.app/?q=WzAsMyxbMCwwLCJBKFUpIl0sWzEsMSwiQShVJykiXSxbMiwwLCJBKFUnJykiXSxbMCwxXSxbMCwyXSxbMSwyXV0=
\[\begin{tikzcd}
	{A(U)} && {A(U'')} \\
	& {A(U')}
	\arrow[from=1-1, to=2-2]
	\arrow[from=1-1, to=1-3]
	\arrow[from=2-2, to=1-3]
\end{tikzcd}\]
(in which the arrows are restriction homomorphisms) is commutative.

\nn(v) Let $x(=\ppp)$ be a point of $X$. Show that
$$
\varinjlim_{U\ni x}A(U)\simeq A_\ppp.
$$
\nn\textbf{Solution.} In this Section we freely use the Notes in Section~\ref{satprel} p.~\pageref{satprel} above.

\nn(i) - (iv) In the notation of Note~\ref{eqcat} p.~\pageref{eqcat} above we have $F(A_f)=X_f$, and the statements follow from Note~\ref{eqcat}.

\nn(v) More generally, if $S$ is any multiplicative subset of $A$ then there is a natural isomorphism 
\begin{equation}\label{colfins}
\colim_{f\in S}A_f\xrightarrow{\sim}S^{-1}A.
\end{equation}
This can be proved as follows [using again Note~\ref{eqcat}]. For $f\in S$ let $\phi_f$ be the unique $A$-algebra morphism from $A_f$ to $S^{-1}A$. Let $B$ be an $A$-algebra, and for each $f\in S$ let $\psi_f:A_f\to B$ be an $A$-algebra morphism. The choice of such an $A$-algebra morphism $\psi_f$ is equivalent to the choice of a unit $b_f$ in $B$, the dictionary being given by $\psi_f(f)=b_f$. To prove \eqref{colfins} it suffices to show that there is a unique $A$-algebra morphism $\psi:S^{-1}A\to B$ such that $\psi\circ\phi_f=\psi_f$ for all $f\in S$, or, equivalently, such that $\psi(f)=b_f$ for all $f\in S$. Let us check that the formula $\psi(\frac af):=\psi(a)b_f^{-1}$ does define our morphism $\psi$. If we have $\frac af=\frac ug$, there is an $h\in S$ such that $agh=bfh$, hence $\psi(a)b_gb_h=\psi(u)b_fb_h$, hence $\psi(a)b_f^{-1}=\psi(u)b_g^{-1}$.

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 5

\subsubsection{Page 47, Exercise~3.24}%

\textbf{Statement.} Show that the presheaf of Exercise~23 has the following property. Let $(U_i)_{i\in I}$ be a covering of $X$ by basic open sets. For each $i\in I$ let $s_i\in A(U_i)$ be such that, for each pair of indices $i,j$, the images of $s_i$ and $s_j$ in $A(U_i\cap U_j)$ are equal. Then there exists a unique $s\in A\ (=A(X))$ whose image in $A(U_i)$ is $s_i$ for all $i\in I$. (This essentially implies that the presheaf is a sheaf.)

\nn\textbf{Solution.} We can assume that $I$ is nonempty, and that $0\in I$. Let $\alpha_i:A\to A_{f_i}$ and $\phi_{ij}:A_{f_i}\to A_{f_if_j}$ be the natural morphisms, and consider the diagram 
$$
0\to A\xr\alpha\prod_{i\in I}A_{f_i}\xr\beta\prod_{i,j\in I}A_{f_if_j},
$$ 
where $\alpha$ is induced by the $\alpha_i$ and $\beta$ is defined by $\beta((a_i)):=(\phi_{ij}(a_i)-\phi_{ji}(a_j))$. This is clearly a complex. It suffices to show that it is exact. By Section~\ref{re} p.~\pageref{re} above, we can assume that $A$ is local. As the $f_i$ generate the unit ideal, one of them is a unit, so that we can assume $f_0=1$. It is easy to see that $\alpha$ is injective. Assuming $\beta((a_i))=0$, it is straightforward to check that $(a_i)$ is equal to $\alpha(a_0)$.% comment removed 200107 https://docs.google.com/document/d/1nZ86Grp6YG7veFXRPQgj-yQq6R6okAPliI_Fy0BJaAU/edit

\subsubsection{Page 48, Exercise~3.25}%

\textbf{Statement.} Let $f:A\to B$, $g:A\to C$ be ring homomorphisms and let $h:A\to B\otimes_AC$ be defined by $h(x)=f(x)\otimes g(x)$. Let $X,Y,Z,T$ be the prime spectra of $A,B,C,B\otimes_AC$ respectively. Then $h^*(T)=f^*(Y)\cap g^*(Z)$.

\nn[Let $\ppp\in X$, and let $k=k(\ppp)$ be the residue field at $\ppp$. By Exercise~21, the fiber $h^{*-1}(\ppp)$ is the spectrum of $(B\otimes_AC)\otimes_Ak\simeq(B\otimes_Ak)\otimes_k(C\otimes_Ak)$. Hence 
$$
\ppp\in h^*(T)\iff(B\otimes_Ak)\otimes(C\otimes_Ak)\ne0\iff B\otimes_Ak\ne0
$$ 
and $C\otimes_Ak\ne0\iff\ppp\in f^*(Y)\cap g^*(Z)$.]

\nn\textbf{Note.} For the hint see Exercise~3.21iv p. 47 of the book and Section~\ref{res} p.~\pageref{res} above.

\subsubsection{Page 48, Exercise~3.26}%

For the hint see Exercise~3.21iv p. 47 of the book and Section~\ref{res} p.~\pageref{res} above.

\subsubsection{Page 48, Exercise~3.27}%

In the hint to (i), ``Examples 25 and 26'' should be ``Exercises 25 and 26''. 

\nn Part (ii): see Exercise~1.22 p.~13 of the book [Section~\ref{ex1.22} p.~\pageref{ex1.22}]. 

\nn For (iv), see Section~\ref{ex2.23} p.~\pageref{ex2.23}.

\subsubsection{Page 48, Exercise~3.28}%

\textbf{Statement.} (Continuation of Exercise~27.)

\nn(i) For each $g\in A$, the set $X_g$ (Chapter~1, Exercise~17) is both open and closed
in the constructible topology.

\nn(ii) Let $C'$ denote the smallest topology on $X$ for which the sets $X_g$ are both open
and closed, and let $X_{C'}$ denote the set $X$ endowed with this topology. Show
that $X_{C'}$ is Hausdorff.

\nn(iii) Deduce that the identity mapping $X_C\to X_{C'}$ is a homeomorphism. Hence a
subset $E$ of $X$ is of the form $f^*(\Spec(B))$ for some $f: A\to B$ if and only if it
is closed in the topology $C'$.

\nn(iv) The topological space $X_C$ is compact, Hausdorff and totally disconnected.

\nn\textbf{Solution.} (i) More generally, for each multiplicative subset $S\subset A$ the subset 
$$
S^{-1}X:=\{\ppp\in X\ |\ \ppp\cap S=\varnothing\}
$$ 
is closed
in the constructible topology. In particular, so is $X_g$. But $X_g$, being open in the Zariski topology, is also open in the constructible topology.

\nn(ii) Let $\ppp,\qqq\in X$, $\ppp\ne\qqq$. We can assume that there is a $g\in A$ which is in $\qqq$ but not in $\ppp$. Consider the subsets $X_g,V(g)\subset X$: they are disjoint and open, and we have $\ppp\in X_g$, $\qqq\in V(g)$.

\nn(iii) Follows from (i) and (ii), coupled with Part~(iv) of Exercise~26.

\nn(iv) In the notation of the solution to Part~(ii), the connected component of $\ppp$ [for the constructible topology], being contained in $X_g$, does not contain $\qqq$.

\subsubsection{Page 49, Exercise~3.30}%

\textbf{Statement.} Show that the Zariski topology and the constructible topology on $\Spec(A)$ are the same if and only if $A/\NNN$ is absolutely flat (where $\NNN$ is the nilradical of $A$). [Use Exercise~11.]

\nn\textbf{Solution.} By Exercise~3.27iii p.~48 of the book, the identity of $X$ is a continuous map $X\to X_C$. By Exercise~3.28iv p.~48 of the book, this map is a homeomorphism if and only if $X$ is Hausdorff. Thus the Zariski and constructible topologies coincide if and only if $X$ is Hausdorff. By Exercise~3.11 pages 44 and 45 of the book, $X$ is Hausdorff if and only if $A/\NNN$ is absolutely flat. Therefore the Zariski and constructible topologies coincide if and only if $A/\NNN$ is absolutely flat.

\newpage 

\section{About Chapter~4}%%%

\subsection{Comments}%%

\subsubsection{Contracted primary ideals}\label{cpi}%

Section~\ref{43} p.~\pageref{43} prompts the question: Is a contracted primary ideal the contraction of a primary ideal? We show that the answer is negative.

Let $K$ be a field and set $A:=K[\varepsilon]$ with $\varepsilon^2=0$ but $\varepsilon\ne0$. Note that $(0)\subset A$ is primary. We will define a ring $B$ which contains $A$. Then $(0)\subset A$ will be a contracted primary ideal, and we will show that $(0)\subset A$ is not the contraction of a primary ideal of $B$. 

We define $B$ by 
$$
B=K[X,Y_1,Y_2,\dots]/\mathfrak b=K[x,y_1,y_2,\dots]
$$ 
[obvious notation] with 
$$
\mathfrak b=(X^2Y_1)+\sum_{i\ge2}(X^nY_n-XY_1),
$$
and we embed $A$ in $B$ by setting $\varepsilon:=xy_1$. We get $\varepsilon x=0$ and $\varepsilon=x^ny_n$ for all $n\ge1$; in particular $\varepsilon\in(x^n)$ for all $n\ge1$.

We claim that we have $XY_1\notin\mathfrak b$, or, equivalently, $\varepsilon\ne0$.

\nn Proof of the claim: Assume by contradiction $XY_1\in(X^2Y_1,X^2Y_2-XY_1,\dots,X^nY_n-XY_1)$. Dividing by $X$ we get 
$$
Y_1\in(XY_1,XY_2-Y_1,X^2Y_3-Y_1,\dots,X^{n-2}Y_{n-1}-Y_1,X^{n-1}Y_n-Y_1).
$$ 
Setting $Y_i:=X^{n-i}Y_n$ for $1\le i\le n-1$ we get $X^{n-1}Y_n\in(X^nY_n)$, which is false. 

The above proof was explained to me by an anonymous user, whose user name is user26857, of the Mathematics Stackexchange forum; see \href{https://math.stackexchange.com/q/2389114/660}{https://math.stackexchange.com/q/2389114/660}. 

We prove that $(0)\subset A$ is not the contraction of a primary ideal of $B$.

Let $\mathfrak q$ be a primary ideal of $B$. If we had $\varepsilon\notin\mathfrak q$ and $x^n\notin\mathfrak q$ for all $n\ge1$, then $x$ would be a non nilpotent zero-divisor in $B/\mathfrak q$, contradicting the assumption that $\mathfrak q$ is primary. Thus we have $x^n\in\mathfrak q$ for some $n\ge1$, or $\varepsilon\in\mathfrak q$. But, since $\varepsilon\in(x^n)$, we get $\varepsilon\in\mathfrak q$ in both cases, and $\mathfrak q$ contracts to $(1)$ instead of contracting to $(0)$.

\subsubsection{Page 50}\label{contrpry}%

Just before Proposition~4.1: In fact, the contraction of a $\ppp$-primary ideal is a $\ppp^{\oo c}$-primary ideal.

\subsubsection{Page 52, Corollary to Theorem 4.5}%%

(Theorem 4.5 is the First Uniqueness Theorem.)
\begin{cor}\label{c45}
In the notation of Theorem 4.5, if $(\aaa:x)$ is prime, then $(\aaa:x)$ $=\ppp_i$ for some $i$. 
\end{cor}

\subsubsection{Page 52, Proof of Theorem 4.5}%

The following statement, occurring in the proof of Theorem 4.5, is often used in the sequel of the book:

\nn\emph{In the setting of Theorem 4.5 we have} 
\begin{equation}\label{ex4.5}
r(\aaa:x)=\bigcap_{x\notin\qqq_j}\ppp_j.
\end{equation}
[See Note~\ref{ef} p.~\pageref{ef}.] Here are more details. Still in the setting and notation of Theorem 4.5, for $x$ in $A$ set $J(x):=\{j\ |\ x\notin\qqq_j\}$. Then $(\qqq_j:x)$ is $\ppp_j$-primary for $j\in J(x)$, and we have 
$$
(\aaa:x)=\bigcap_{j\in J(x)}(\qqq_j:x).
$$ 
In particular, we have $J(x_i)=\{i\}$, and thus $(\aaa:x_i)=(\qqq_i:x_i)$ and $r(\aaa:x_i)=\ppp_i$. 

\subsubsection{Page 52, Corollary to Proposition~4.6}%

\begin{note}\label{fmme}
If $\aaa$ is decomposable, then the set of prime ideals containing $\aaa$ has only finitely many minimal elements.
\end{note}

\subsubsection{Page 53, decomposable ideals}\label{di}%

The purpose of this section is to prove the following statement:

\nn\emph{An ideal having only finitely many minimal primes is not necessarily decomposable.}

The statements in this section are due to user26857 of Mathematics Stackexchange.\bigskip\bigskip

\hrule\bigskip

\nn Taken from \href{https://math.stackexchange.com/a/207468/660}{https://math.stackexchange.com/a/207468/660}:

In order to find an ideal which does not have a primary decomposition, the following construction is useful. Let $R$ be a commutative ring and $M$ an $R$-module. On the set $A=R\times M$ one defines the following two algebraic operations:
$$
(a,x)+(b,y)=(a+b,x+y),\quad(a,x)(b,y)=(ab,ay+bx).
$$
With these two operations $A$ becomes a commutative ring with $(1,0)$ as unit element. ($A$
is called the \textbf{idealization} of the $R$-module $M$ or the \textbf{trivial extension} of $R$ by $M$.)

Let us list some important properties of this ring:

\nn1. $\{0\}\times M$ is an ideal of $A$ isomorphic to $M$ (as $R$-modules) and there is a ono-to-one correspondence between the ideals of $R$ and the ideals of $A$ containing $\{0\}\times M$, the ideal $\aaa\subset R$ corresponding to $\aaa\times M\subset A$.

\nn2. $A$ is a Noetherian ring if and only if $R$ is Noetherian and $M$ is finitely generated.

\nn3. All prime (maximal) ideals of $A$ have the form $\ppp\times M$, where $\ppp$ is a prime (maximal) ideal of $R$.

\nn4. If $R$ is an integral domain and $M$ is divisible, then all the ideals of $A$ have the form $\aaa\times M$ with $\aaa$ ideal of $R$, or $\{0\}\times N$ with $N$ submodule of $M$.\bigskip\bigskip

\hrule\bigskip%

\nn Taken from \href{https://math.stackexchange.com/a/1679116/660}{https://math.stackexchange.com/a/1679116/660}:\bigskip 

\begin{note}%\label{nice}
If $A$ is the idealization of the $\mathbb Z$-module $\mathbb Q$, then the primary ideals of $A$ are  

\nn$\bullet\quad p^n\mathbb Z\times\mathbb Q$ with $p$ prime, $n\ge1$, 

\nn$\bullet\quad\{0\}\times\mathbb Q$,

\nn$\bullet\quad\{0\}\times\{0\}$. 

\nn Moreover $\{0\}\times\mathbb Q$ is the only minimal prime of $\{0\}\times\mathbb Z$, and $\{0\}\times\mathbb Z$ has no primary decomposition [see Note~\ref{fmme}].
\end{note}\bigskip
%Then $\aaa:=\{0\}\times\mathbb Z$ has only one minimal prime $\{0\}\times\mathbb Q$ and $\aaa$ has no primary decomposition.\bigskip%https://math.stackexchange.com/a/1679116/660

\hrule\bigskip

\subsubsection{Page 53, proof of Proposition~4.8.ii}\label{prycor}%\label{contrpry}

Proposition~4.8 states the correspondence between primary ideals of $A$ and $S^{-1}A$. We try to describe below this correspondence as precisely as possible.

Using the notation of Section~\ref{prcor} p.~\pageref{prcor} and taking Section~\ref{contrpry} p.~\pageref{contrpry} into account, we set 
$$
X':=\{\qqq\ |\ \qqq\text{ primary ideal of }A\},\quad Y':=\{\qqq\ |\ \qqq\text{ primary ideal of }S^{-1}A\}.
$$ 
We then have a contraction map $c:Y'\to X'$ compatible with radicals. We check that  
$$
c(Y')=\{\qqq\in X'\ |\ r(\qqq)\in c(Y)\}
$$ 
and that $\qqq\in c(Y')\implies S^{-1}\qqq\in X'$, and we observe the following facts: 

\nn\emph{The contraction and extension maps are inverse bijections between $Y'$ and $c(Y')$. Moreover they preserve inclusions and are compatible with radicals.} 

\nn\emph{Moreover, a primary ideal of $A$ is contracted if and only if its radical is disjoint from $S$.}

In particular, if $\ppp$ is a minimal prime ideal, then the kernel of the natural morphism $A\to A_\ppp$ is a minimal \textbf{primary} ideal.

% comment removed https://docs.google.com/document/d/1830-SPd2EETXXy-5Sbq7s8ppPc7O1mbrr0CMLll1ZL8/edit

\subsubsection{Page 54, Proposition~4.9}%

Recall the statement:

\begin{prop}[Proposition~4.9 p.~54 of the book]\label{p4.9}
Let $S$ be a multiplicatively closed subset of $A$ and let $\aaa$ be a decomposable ideal. Let $\aaa=\bigcap_{i=1}^n\qqq_i$ be a minimal primary decomposition of $\aaa$. Let $\ppp_i=r(\qqq_i)$ and suppose the $\qqq_i$ numbered so that $S$ meets $\ppp_{m+1},\ldots,\ppp_n$ but not $\ppp_1,\ldots,\ppp_m$. Then
$$
S^{-1}\aaa=\bigcap_{i=1}^mS^{-1}\qqq_i,\quad S(\aaa)=\bigcap_{i=1}^m\qqq_i.
$$
\end{prop}

\subsubsection{Page 54, Theorem 4.10}%
%Theorem 4.10 is the Second Uniqueness Theorem.
Recall the statement:

\begin{thm}[Theorem 4.10 p.~54 of the book, Second Uniqueness Theorem]
Let $\aaa$ be a decomposable ideal, let $\aaa=\bigcap_{i=1}^n\qqq_i$ be a minimal primary decomposition of $\aaa$, and let $\{\ppp_{i_1},\ldots,\ppp_{i_m}\}$ be an isolated set of prime ideals of $\aaa$. Then $\qqq_{i_1}\cap\cdots\cap\qqq_{i_m}$ is independent of the decomposition.
\end{thm}

Recall also Corollary~4.11:

\begin{cor}[Corollary~4.11 p.~54 of the book]\label{c2.11}
The isolated primary components (i.e., the primary components $\qqq_i$ corresponding to minimal prime ideals $\ppp_i$) are uniquely determined by $\aaa$.
\end{cor}

Here is a corollary to the corollary [see also Proposition~\ref{p1.11ii} p.~\pageref{p1.11ii}]:

\begin{cor}\label{ctoc4.11}
Let $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ be a reduced primary decomposition.

\nn\emph{(a)} If $\ppp_i:=r(\qqq_i)$ is isolated, then $\qqq_i$ is the smallest $\ppp_i$-primary ideal containing $\aaa$.

\nn\emph{(b)} If $r(\aaa)=\ppp$ for some prime ideal $\ppp$, then $\ppp$ is the only isolated prime ideal of $\aaa$, and the corresponding primary component is the smallest $\ppp$-primary ideal containing $\aaa$.
\end{cor}

\begin{proof}
(a) Assume $i=1$ without lost of generality. Step~1: if $\qqq\subset\qqq_1$ is a $\ppp_1$-primary ideal containing $\aaa$, then $\aaa=\qqq\cap\qqq_2\cap\cdots\cap\qqq_n$ is a reduced primary decomposition; by Corollary~\ref{c2.11} we have $\qqq=\qqq_1$. Step~2: if $\qqq$ is an arbitrary $\ppp_1$-primary ideal containing $\aaa$, then $\qqq\cap\qqq_1$ is again $\ppp_1$-primary by Lemma~4.3 p.~51 of the book, and we get $\qqq\cap\qqq_1=\qqq_1$ by Step~1, hence $\qqq_1\subset\qqq$.

\nn(b) We have $\ppp=\ppp_1\cap\cdots\cap\ppp_n$ and Proposition~\ref{p1.11ii} p.~\pageref{p1.11ii} implies $\ppp=\ppp_i$ for some $i$, hence $\ppp_i\subset\ppp_j$ for all $j$. So $\ppp_i$ is isolated and the claim follows from (a).
\end{proof}

\subsection{Exercises}%% 

\subsubsection{Page 55, Exercise~4.1}% 

\textbf{Statement.} If an ideal $\aaa$ has a primary decomposition, then $\Spec(A/\aaa)$ has only finitely many irreducible components.

\nn\textbf{Hint.} Use Exercise~1.20iv p.~13 of the book [see Section~\ref{ex1.20} p.~\pageref{ex1.20} above] and Proposition~4.6 p.~52 of the book. 

\subsubsection{Page 55, Exercise~4.2}% 

\textbf{Statement.} If $\aaa=r(\aaa)$, then $\aaa$ has no embedded prime ideals.

\nn\textbf{Solution.} It is implicitly assumed that $\aaa$ is decomposable. In general, if $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ is a reduced primary decomposition of $\aaa$ such that the minimal prime ideals of $\aaa$ are $\ppp_1,\dots,\ppp_m$ [with $\ppp_i=r(\qqq_i)$], then $r(\aaa)=\ppp_1\cap\cdots\cap\ppp_m$ is the unique reduced primary decomposition of $r(\aaa)$. In particular $r(\aaa)$ has no embedded prime ideals. 

Summary: If $\aaa$ is decomposable, then so is $r(\aaa)$, and $r(\aaa)$ has no embedded prime ideals.

\subsubsection{Page 55, Exercise~4.3}% 

\textbf{Statement.} If $A$ is absolutely flat, every primary ideal is maximal.

\nn\textbf{Solution.} Assume $A$ is absolutely flat and $(0)$ is primary in $A$. It suffices to show that $A$ is a field. Let $0\ne a\in A$. There is an $x\in A$ such that $a=a^2x$, that is $a(ax-1)=0$. If $ax=1$, then $a$ is a unit and we are done. Otherwise $a$ is a zero-divisor, hence $a$ is nilpotent, and we get $(a)=(a)^2=(a)^3=\cdots=(0)$, contradiction.

\subsection{Page 55, About Exercise 4.3}%

The only reference I know for the proposition below, which is the converse of Exercise~4.3, is the Mathematics Stackexchange post \href{https://math.stackexchange.com/a/569442/660}{https://math.stackexchange.com/a/569442/660} by user wxu.

\begin{prop}\label{pp}
Let $A$ be a ring. If all the primary ideals of $A$ are prime, then $A$ is absolutely flat.
\end{prop}
\begin{proof}
Following wxu, say that a ring is \textbf{PP} if all its primary ideals of $A$ are prime. 

By the results of Section~\ref{ex3.10} p.~\pageref{ex3.10} it suffices to show that each local PP ring is a field. Also note that the property of being PP is inherited by quotients and rings of fractions.

Throughout this proof we assume that $A$ is a local PP ring with maximal ideal $\mmm$, and that $\mmm\ne(0)$. In view of the previous paragraph, it is enough to derive a contradiction.

\nn Case 1: $\mmm$ is the only prime ideal of $A$. We have $r(0)=\mmm$, hence $(0)$ is primary, hence prime, hence equal to $\mmm$, contradiction.

\nn Case 2: $A$ is a domain and $\mmm$ is minimal over $(a)$ for some nonzero $a$ in $\mmm$. We get $r(a)=\mmm$, hence, as before, $(a)=\mmm$; in particular $\mmm$ is finitely generated. Since $\mmm^2$ is $\mmm$-primary, we have also $\mmm^2=\mmm$, and Nakayama's Lemma [Proposition~\ref{nak} p.~\pageref{nak}] implies $\mmm=(0)$, contradiction.

\nn Case 3: $A$ is a domain. Let $a$ be a nonzero element of $\mmm$ and $\ppp$ a prime which is minimal over $(a)$. Then $\ppp_\ppp$ is minimal over $(\frac a1)$, and Case~2 implies $\ppp_\ppp=(0)$, hence $\ppp=(0)$, contradiction.

\nn Case 4: this is the general case. In view of Case~1 we can assume that we have $\ppp\subsetneqq\mmm$ for some prime ideal $\ppp$. Then the ideal $(0)\subset A/\ppp$ is a proper prime sub-ideal of $\mmm/\ppp$, and Case~3 implies $\ppp=\mmm$, contradiction.
\end{proof}

\subsubsection{Page 55, Exercise~4.4}% 

\textbf{Statement.} In the polynomial ring $\mathbb Z[t]$, the ideal $\mmm=(2,t)$ is maximal and the ideal $\qqq=(4,t)$ is $\mmm$-primary, but is not a power of $\mmm$.

\nn\textbf{Hints.} We have $\mathbb Z[t]/\qqq\simeq\mathbb Z/(4)$ and $\mmm^2\subsetneqq\qqq\subsetneqq\mmm$.

\subsubsection{Page 55, Exercise~4.5}%

\textbf{Statement.} In the polynomial ring $K[x,y,z]$ where $K$ is a field and $x,y,z$ are independent indeterminates, let $\ppp_1=(x,y)$, $\ppp_2=(x,z)$, $\mmm=(x,y,z)$; $\ppp_1$ and $\ppp_2$ are prime, and $\mmm$ is maximal. Let $\aaa=\ppp_1\ppp_2$. Show that $\aaa=\ppp_1\cap\ppp_2\cap\mmm^2$ is a reduced primary decomposition of $\aaa$. Which components are isolated and which are embedded?

\nn\textbf{Hints.} Let $\aaa$ be an ideal of $A:=K[x,y,z]$. Then $\aaa$ is generated by monomials if and only if it has the following property:

A polynomial $f\in A$ is in $\aaa$ if and only if all the monomials occurring in $f$ are in $\aaa$.

\nn In particular, if two ideals are generated by monomials, so is their intersection.

Here is a variant of the exercise: Let $A$ be the $K$-algebra [$K$ a field] generated by $x,y,z$ with the relations $0=x^2=xy=xz=yz$, and set $\ppp_1:=(x,y),\ppp_2:=(x,z),\mmm:=(x,y,z)$. Show that $\ppp_1\cap\ppp_2\cap\mmm^2$ is a primary decomposition of $(0)$ in $A$.

We have:
$$
A=K\oplus Kx\oplus yK[y]\oplus zK[z],\quad\ppp_1=Kx\oplus yK[y],\quad\ppp_2=Kx\oplus zK[z],
$$ 
$$
\mmm^2=y^2K[y]\oplus z^2K[z],\quad\ppp_1\cap\ppp_2=Kx,\quad\ppp_1\cap\mmm^2=y^2K[y]\quad\ppp_2\cap\mmm^2=z^2K[z].
$$

\subsubsection{Page 55, Exercise~4.6}%

\textbf{Statement.} Let $X$ be an infinite compact Hausdorff space, $C(X)$ the ring of real-valued continuous functions on $X$ (Chapter~1, Exercise~26). Is the zero ideal de- composable in this ring?

\nn\textbf{Hints.} Claim: any prime ideal is contained in a \textbf{unique} maximal ideal.

\nn Proof: Using Urysohn's Lemma it is easy to see that, given distinct points $x$ and $y$ in $X$ and denoting by $\mmm_x$ and $\mmm_y$ the corresponding maximal ideals, there are $f,g\in C(X)$ such that $fg=0$, $f\in\mmm_x\setminus\mmm_y$, $g\in\mmm_y\setminus\mmm_x$. 

The claim implies that there are infinitely many minimal prime ideals. 

\subsubsection{Page 55, Exercise~4.7}\label{ex4.7}%

\textbf{Statement.} Let $A$ be a ring and let $A[x]$ denote the ring of polynomials in one indeterminate over $A$. For each ideal a of $A$, let $\aaa[x]$ denote the set of all polynomials in $A[x]$ with coefficients in $\aaa$.

\nn(i) $\aaa[x]$ is the extension of a to $A[x]$.

\nn(ii) If $\ppp$ is a prime ideal in $A$, then $\ppp[x]$ is a prime ideal in $A[x]$.

\nn(iii) If $\qqq$ is a $\ppp$-primary ideal in $A$, then $\qqq[x]$ is a $\ppp[x]$-primary ideal in $A[x]$. [Use Chapter~1, Exercise~2.]

\nn(iv) If $\aaa=\bigcup_{i=1}^n\qqq_i$, is a minimal primary decomposition in $A$, then $\aaa[x]=\bigcup_{i=1}^n\qqq_i[x]$ is a minimal primary decomposition in $A[x]$.

\nn(v) If $\ppp$ is a minimal prime ideal of $\aaa$, then $\ppp[x]$ is a minimal prime ideal of $\aaa[x]$.

\nn\textbf{Hints.} Observe that $A[x]$ is faithfully flat over $A$: see Exercise~3.16 p.~45 of the book and Section~\ref{ex3.16} p.~\pageref{ex3.16} above.

Note that we have $M[x]\simeq A[x]\otimes_AM$ for any $A$-module $M$. In particular $M\mapsto M[x]$ is exact. [See Exercise~2.6 p.~32 of the book.]

\nn$\bu$ Part (i) is clear.

\nn$\bu$ Part (ii): In fact we have 

\begin{lem}\label{fiberx}
If $f:A\to A[x]$ is the natural embedding, then the fiber $f^{*-1}(\ppp)$ of 
$$
f^*:\Spec(A[x])\to\Spec(A)
$$ 
above a prime ideal $\ppp$ of $A$ is order isomorphic to the spectrum of $k\otimes_AA[x]\simeq k[x],$ where $k$ is the residue field at $\ppp$. Moreover, the least element of $f^{*-1}(\ppp)$ is $\ppp[x]$, and $\ppp[x]+(x)$ is a maximal element of $f^{*-1}(\ppp)$.
\end{lem}

See Exercise~3.21iv p.~47 of the book and Section~\ref{321iv} p.~\pageref{321iv} above. Also note that, if $A\to B$ is a ring morphism and $\aaa$ a contracted ideal of $A$, then $\aaa^{\oo e}$ is the least element of the set of ideals of $B$ contracting to $\aaa$.

\nn$\bu$ Part (iii): Use Exercises 1.2ii and 1.2iii p.~11.% comment removed https://docs.google.com/document/d/17k969GrD4mEbiSx2cWbae1UARFO3VnJi98nEKwM8Lmg/edit

\nn$\bu$ Part (iv) is clear.

\nn$\bu$ Part (v): We have 
\begin{equation}\label{asb}
\aaa\subset\bbb\iff\aaa[x]\subset\bbb[x]
\end{equation}
[obvious notation], and Part (v) follows from Lemma~\ref{fiberx}. 

\subsubsection{Page 55, Exercise~4.8}%

\textbf{Statement.} Let $k$ be a field. Show that in the polynomial ring $k[x_1,\ldots,x_n]$ the ideals $\ppp_i=(x_1,\ldots,x_i)$ ($1\le i\le n$) are prime and all their powers are primary. [Use Exercise~7.]

\nn\textbf{Hints.} Setting 
$$
B:=k[x_1,\dots,x_r],\quad A:=B[y_1,\dots,y_s],\quad\mmm:=(x_1,\dots,x_r)\subset B,\quad\ppp:=(x_1,\dots,x_r)\subset A,
$$ 
we get $\ppp^n=\mmm^n[y_1,\dots,y_s]$, and we can use Exercise~4.7iii.% comment removed https://docs.google.com/document/d/1fOqIMiNtLhAGSNjEWSk4jp_hfhwqHIqFx3DEPyU_zHg/edit

\subsubsection{Page 55, Exercise~4.9}\label{ex4.9}%

\textbf{Statement.} [I found it convenient to make some minor changes to the wording of the book.] In a ring $A$, let $D(A)$ denote the set of prime ideals $\ppp$ which satisfy the following condition: there exists $a\in A$ such that $\ppp$ is minimal in the set of prime ideals containing $(0:a)$. 

\nn(a) Show that $b\in A$ is a zero-divisor if and only if $b\in\ppp$ for some $\ppp\in D(A)$.

\nn(b) Let $S$ be a multiplicatively closed subset of $A$, and write $S^{-1}D(A)$ for the set of all prime ideals of the form $S^{-1}\ppp$ with $\ppp\in D(A)$ [in particular such a $\ppp$ is disjoint from $S$]. Show that
$$
D(S^{-1}A)=S^{-1}D(A).
$$
(c) If the zero ideal has a primary decomposition, show that $D(A)$ is the set of associated prime ideals of $(0)$.

\nn\textbf{Hints.} 

\nn(a) Let $a,b\in A$ and $\ppp\in\Spec(A)$ be such that $b\in\ppp$ and $\ppp$ is minimal over $(0:a)$.

\nn\textbf{Claim 1:} $b$ is zero-divisor.

\nn\emph{Proof of Claim 1.} Assume by contradiction that $b$ is not a zero-divisor. Obviously $a\ne0$ and $b\notin(0:a)$. Let $s$ be in $A\setminus\ppp$ and $n$ be in $\mathbb N$. To prove Claim~1, we first prove:

\nn\textbf{Claim 2:} $b^ns\notin(0:a)$.

\nn\emph{Proof of Claim 2.} Assume by contradiction that $b^ns\in(0:a)$. We can suppose that $n$ is minimum for this condition. We have $n\ge1$ [because otherwise we would get $s\in(0:a)\subset\ppp$] and $b(b^{n-1}sa)=b^nsa=0$. Since $b$ is not a zero-divisor, this implies $b^{n-1}sa=0$, that is $b^{n-1}s\in(0:a)$, in contradiction with the minimality of $n$. $\square$

To complete the proof of Claim~1 set $T:=\{\ b^ns\ |\ n\in\mathbb N,s\in A\setminus\ppp\}$. This is a multiplicative set. Claim~2 implies that $T$ is disjoint from $(0:a)$. Thus there is a prime ideal $\ppp'$ which contains $(0:a)$ and is disjoint from $T$, and we have $A\setminus\ppp\subset T\subset A\setminus\ppp'$, hence $(0:a)\subset\ppp'\subset\ppp$. By minimality of $\ppp$ over $(0:a)$ this forces $\ppp'=\ppp$, and thus $b\in\ppp\cap T=\ppp'\cap T=\varnothing$, contradiction. This completes the proof of Claim~1. $\square$

It remains to show that if $b$ is a zero-divisor there is an element $a$ of $A$ and a prime ideal $\ppp$ of $A$ such that $b\in\ppp$ and $\ppp$ is minimal over $(0:a)$. By Proposition~1.15 p.~9 of the book, there is an $a\in A$ such that $b\in r(0:a)$, and it suffices to let $\ppp$ be any prime ideal which is minimal over $(0:a)$.% comment removed https://docs.google.com/document/d/1BC9kzpvjeCytRBmyZYoAjIPlupnoTbLJT9d_T6a0iSA/edit

\nn(b) It is enough to prove any of the following two equivalent statements: 

\nn(b1) Let $a$ be an element of $A$ and $\ppp$ a prime ideal of $A$ disjoint from $S$. Then $S^{-1}\ppp$ is minimal over $(0:\frac a1)$ if and only if $\ppp$ is minimal over $(0:a)$.

\nn(b2) If $a$ is an element of $A$ and $\ppp$ a prime ideal of $A$ disjoint from $S$, then 
$$
S^{-1}\ppp\supset\left(0:\frac a1\right)\quad\iff\quad\ppp\supset(0:a).
$$
The proof is left to the reader.%[Note the inclusion $S^{-1}(0:a)\subset(0:\frac a1)$.]

\nn(c) Let $(0)=\qqq_1\cap\cdots\cap\qqq_n$ be a reduced decomposition of $(0)$ in $A$ and set $\ppp_i:=r(\qqq_i)$. Each $\ppp_i$ is of the form $r(0:a)$ by Theorem 4.5 p.~52 of the book [the First Uniqueness Theorem]. In particular $\ppp_i$ is minimal over $r(0:a)$, and thus $\ppp_i\in D(A)$. Conversely, if $\ppp\in D(A)$, then $\ppp$ is minimal over $(0:a)$ for some $a\in A$. By \eqref{ex4.5} p.~\pageref{ex4.5} we have 
$$
\bigcap_{\qqq_i\not\ni a}\ \ppp_i=r(0:a)\subset\ppp.
$$ 
By Proposition~\ref{p1.11ii} p.~\pageref{p1.11ii}] this implies $\ppp\supset\ppp_j$ for some $j$. As $\ppp_j\supset(0:a)$, we get $\ppp=\ppp_j$ by minimality of $\ppp$.

\subsubsection{Page 55, Exercise~4.10}\label{ex4.10}%

\textbf{Statement.} For any prime ideal $\ppp$ in a ring $A$, let $S_\ppp(0)$ denote the kernel of the homomorphism $A\to A_\ppp$. Prove that

\nn(i) $S_\ppp(0)\subset\ppp$,

\nn(ii) $\ppp$ is a minimal prime ideal of $A$ $\iff$ $r_A(S_\ppp(0))=\ppp$,

\nn(iii) if $\ppp\supset\ppp'$, then $S_\ppp(0)\subset S_{\ppp'}(0)$,

\nn(iv) $\bigcap_{\ppp\in D(A)}S_\ppp(0)=(0)$, where $D(A)$ is defined in Exercise~9 [Section~\ref{ex4.9} p.~\pageref{ex4.9}].

\nn\textbf{Solution.} Note that $S_\ppp(0)=(0)^{\oo c}$, where the contraction is taken with respect to $A\to A_\ppp$. We also have 
\begin{equation}\label{sp0}
S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)
\end{equation}  
and $r_A(S_\ppp(0))=r_A((0)^{\oo c})=(r_{A_\ppp}(0))^{\oo c}$ [Exercise~1.18 p.~10 and Proposition~3.11ii p.~41; see Section~\ref{ex1.18p10} p.~\pageref{ex1.18p10} and Proposition~\ref{p3.11} p.~\pageref{p3.11}].

\nn(i) Follows from \eqref{sp0} above.

\nn(ii) If $\ppp$ is a minimal prime ideal of $A$ we have $r_{A_\ppp}(0)=\ppp_\ppp$ [because $\ppp_\ppp$ is the unique prime ideal of $A_\ppp$] and thus $r_A(S_\ppp(0))=(r_{A_\ppp}(0))^{\oo c}=(\ppp_\ppp)^{\oo c}=\ppp$. 

If $\ppp$ is \textbf{not} minimal, there is a prime ideal $\ppp'$ such that $\ppp'\subsetneqq \ppp$, and we get $r_{A_\ppp}(0)\subset\ppp'_\ppp\subsetneqq \ppp_\ppp$, hence $r_A((0)^{\oo c})\subset\ppp'\subsetneqq \ppp$ and thus $(r_{A_\ppp}(0))^{\oo c}\ne\ppp$.

\nn(iii) We have 
$$
S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)\subset\bigcup_{s'\in A\setminus\ppp'}(0:s')=S_{\ppp'}(0).
$$
\nn(iv) Let $0\ne a\in A$. There is a prime ideal $\ppp$ which is minimal over $(0:a)$. In particular $\ppp\in D(A)$. Then 
$
a\in S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)
$ 
would imply $as=0$ for some $s\in A\setminus\ppp$, and thus $s\in(0:a)\subset\ppp$, contradiction.

\subsubsection{Page 56, Exercise~4.11}\label{ex4.11}%

\textbf{Statement.} 

\nn(a) If $\ppp$ is a minimal prime ideal of a ring $A$, show that $S_\ppp(0)$ [Exercise~10] is the smallest $\ppp$-primary ideal. 

\nn(b) Let $\aaa$ be the intersection of the ideals $S_\ppp(0)$ as  $\ppp$ runs through the minimal prime ideals of $A$. Show that $\aaa$ is contained in the nilradical of $A$.

\nn(c) Suppose that the zero ideal is decomposable. Prove that $\aaa=(0)$ if and only if every prime ideal of $(0)$ is isolated.

\nn\textbf{Solution.}\\ (a) The ideal $\ppp_\ppp$, being the unique prime ideal of $A_\ppp$, coincides with the nilradical: $\ppp_\ppp=r_{A_\ppp}(0)$. Proposition~4.2 p.~51 of the book [see reminder below] implies that $(0)$ is $\ppp_\ppp$-primary, and is thus the smallest $\ppp_\ppp$-primary ideal of $A_\ppp$. As $\ppp_\ppp$ contracts to $\ppp$, Section~\ref{prycor} p.~\pageref{prycor} above entails that $S_\ppp(0)=(0)^{\oo c}$ is the smallest $\ppp$-primary ideal of $A$.

Recall Proposition~4.2:

\begin{prop}[Proposition~4.2 p.~51 of the book]\label{p4.2}
If $r(\aaa)$ is maximal, then $\aaa$ is primary. In particular, the powers of a maximal ideal $\mmm$ are $\mmm$-primary.
\end{prop}

\nn(b) This follows from Exercise~4.10i p. 55, see Section~\ref{ex4.10} p.~\pageref{ex4.10} above.

\nn(c) Let $(0)=\qqq_1\cap\cdots\cap\qqq_n$ be a reduced decomposition. We can assume that there is an $m$ such that $1\le m\le n$ and $\ppp_i:=r(\qqq_i)$ is isolated if and only if $i\le m$. The Second Uniqueness Theorem [Theorem 4.10 p.~54 of the book] and (a) above imply 
\begin{equation}\label{eq411}
(0)=S_{\ppp_1}(0)\cap\cdots\cap S_{\ppp_m}(0)\cap\qqq_{m+1}\cap\cdots\cap\qqq_n
\end{equation} 
$$
=\aaa\cap\qqq_{m+1}\cap\cdots\cap\qqq_n,
$$ 
and we must show $\aaa=(0)\iff m=n$. Implication $\Longleftarrow$ is clear. Conversely if $\aaa=(0)$, then $m=n$ because \eqref{eq411} is a \textbf{reduced} decomposition.

\subsubsection{Page 56, Exercise~4.12}%

\textbf{Statement.} Let $A$ be a ring, $S$ a multiplicatively closed subset of $A$. For any ideal $\aaa$, let $S(\aaa)$ denote the contraction of $S^{-1}\aaa$ in $A$. The ideal $S(\aaa)$ is called the \textbf{saturation} of $\aaa$ with respect to $S$. Prove that

\nn(i) $S(\aaa)\cap S(\bbb)=S(\aaa\cap\bbb)$,

\nn(ii) $S(r(\aaa))=r(S(\aaa))$,

\nn(iii) $S(\aaa)=(1)\iff\aaa$ meets $S$,

\nn(iv) $S_1(S_2(\aaa))=(S_1S_2)(\aaa)$.

If $\aaa$ has a primary decomposition, prove that the set of ideals $S(\aaa)$ (where $S$ runs through all multiplicatively closed subsets of $A$) is finite.

\nn\textbf{Solution.} Follows from statements 1.18, 3.11ii and 3.11v and 4.9 in the book [see Section~\ref{ex1.18p10} p.~\pageref{ex1.18p10}, Proposition~\ref{p3.11} p.~\pageref{p3.11} and Proposition~\ref{p4.9} p.~\pageref{p4.9}.

\subsubsection{Page 56, Exercise~4.13}\label{ex4.13}%

\textbf{Statement.} Let $A$ be a ring and $\ppp$ a prime ideal of $A$. The $n$-th \textbf{symbolic power} of $\ppp$ is defined to be the ideal (in the notation of Exercise~12) 
$$
\ppp^{(n)}=S_\ppp(\ppp^n)
$$ 
where $S_\ppp=A\setminus\ppp$. Show that 

\nn(i) $\ppp^{(n)}$ is a $\ppp$-primary ideal;

\nn(ii) if $\ppp^n$ has a primary decomposition, then $\ppp^{(n)}$ is its $\ppp$-primary component;

\nn(iii) if $\ppp^{(m)}\ppp^{(n)}$ has a primary decomposition, then $\ppp^{(m+n)}$ is its $\ppp$-primary component;

\nn(iv) $\ppp^{(n)}=\ppp^n\iff\ppp^n$ is $\ppp$-primary.

\nn\textbf{Note.} $\ppp^{(n)}$ is the contraction in $A$ of $\ppp_\ppp^n\subset A_\ppp$.

\nn\textbf{Solution.} \nn(i) We must show that $(\ppp_\ppp^n)^{\oo c}$ is $\ppp$-primary. This results from the following facts: $\ppp_\ppp$ is a maximal ideal of $A_\ppp$, a power of a maximal ideal is primary [Proposition~\ref{p4.2} p.~\pageref{p4.2}], the contraction of a $\ppp'$-primary ideal is $\ppp'^{\oo c}$-primary, the contraction of $\ppp_\ppp$ is $\ppp$ [Proposition~\ref{p3.11}iv p~\pageref{p3.11}].

We shall use Claims (a) and (b) below.

\nn(a) If $\aaa\subset\ppp$ is an ideal such that $\aaa_\ppp=\ppp_\ppp^k$, then $\ppp^{(k)}$ is the smallest $\ppp$-primary ideal containing $\aaa$.

\nn Proof. Assuming $\aaa\subset\qqq\subset\ppp$ with $\qqq$ a $\ppp$-primary ideal, we get $\ppp^k_\ppp=\aaa_\ppp\subset\qqq_\ppp\subset\ppp_\ppp$, and thus $\ppp^{(k)}\subset\qqq\subset\ppp$.

\nn(b) If $\aaa$ and $k$ are as above and if in addition $r(\aaa)=\ppp$ and $\aaa$ has a primary decomposition, then $\ppp^{(k)}$ is its $\ppp$-primary component.

\nn Proof. Let $\aaa=\qqq_1\cap\cdots\cap\qqq_s$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_s$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. The statement now follows from (a) and Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11}.

\nn(ii) Follows from (b) with $\aaa=\ppp^n$ and $k=n$.

\nn(iii) Since we have $r(\ppp^{(m)}\ppp^{(n)})=r(\ppp^{(m)})\cap r(\ppp^{(n)})=\ppp$ by (i), the statement follows from (b) with $\aaa=\ppp^{(m)}\ppp^{(n)}$ and $k=m+n$.

\begin{comment}
% 2108041504
\nn(i') $\ppp^{(n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^n$. Proof: assuming $\ppp^n\subset\qqq\subset\ppp$ with $\qqq$ a $\ppp$-primary ideal, we get $\ppp^n_\ppp\subset\qqq_\ppp\subset\ppp_\ppp$, and thus $\ppp^{(n)}\subset\qqq\subset\ppp$.

\nn(ii) Let $\ppp^n=\qqq_1\cap\cdots\cap\qqq_k$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_k$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. The statement now follows from (a) [with $\aaa=\ppp^n$ and $k=n$] and Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11}.

\nn(iii) We have $r(\ppp^{(m)}\ppp^{(n)})=r(\ppp^{(m)})\cap r(\ppp^{(n)})=\ppp$ by (i). Let $\ppp^{(m)}\ppp^{(n)}=\qqq_1\cap\cdots\cap\qqq_k$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_k$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. The statement follows again from (a) [with $\aaa=\ppp^{(m)}\ppp^{(n)}$ and $k=m+n$] and Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11}.
\end{comment}

\begin{comment}
% removed on 2108041427
\nn(i') $\ppp^{(n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^n$. Proof: assuming $\ppp^n\subset\qqq\subset\ppp$ with $\qqq$ a $\ppp$-primary ideal, we get $\ppp^n_\ppp\subset\qqq_\ppp\subset\ppp_\ppp$, and thus $\ppp^{(n)}\subset\qqq\subset\ppp$.

\nn(ii) Let $\ppp^n=\qqq_1\cap\cdots\cap\qqq_k$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_k$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. The statement now follows from (i') and Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11}.

\nn(iii) We have $r(\ppp^{(m)}\ppp^{(n)})=r(\ppp^{(m)})\cap r(\ppp^{(n)})=\ppp$ by (i). Let $\ppp^{(m)}\ppp^{(n)}=\qqq_1\cap\cdots\cap\qqq_k$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_k$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. The statement follows again from (i') and Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11}.
\end{comment}

\nn(iv) We must show $\ppp^{(n)}=\ppp^n\iff\ppp^n$ is $\ppp$-primary. Implication $\implies$ follows from (i). If $\ppp^n$ is $\ppp$-primary, then $\ppp^n=\ppp^n$ is a reduced primary decomposition, and (ii) implies $\ppp^{(n)}=\ppp^n$.

%\begin{comment} 2108031324
\begin{comment}
\nn\textbf{Solution.} \nn(i) We must show that $(\ppp_\ppp^n)^{\oo c}$ is $\ppp$-primary. This results from the following facts: $\ppp_\ppp$ is a maximal ideal of $A_\ppp$, a power of a maximal ideal is primary [Proposition~\ref{p4.2} p.~\pageref{p4.2}], the contraction of a $\ppp'$-primary ideal is $\ppp'^{\oo c}$-primary, the contraction of $\ppp_\ppp$ is $\ppp$.

\nn(ii) Let $\ppp^n=\qqq_1\cap\cdots\cap\qqq_k$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_k$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. By Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11} it suffices to show that $\ppp^{(n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^n$. Assuming $\ppp^n\subset\qqq\subset\ppp$ with $\qqq$ a $\ppp$-primary ideal, we get $\ppp^n_\ppp\subset\qqq_\ppp\subset\ppp_\ppp$, and thus $\ppp^{(n)}\subset\qqq\subset\ppp$.

\nn(iii) We have $r(\ppp^{(m)}\ppp^{(n)})=r(\ppp^{(m)})\cap r(\ppp^{(n)})=\ppp$ by (i). Let $\ppp^{(m)}\ppp^{(n)}=\qqq_1\cap\cdots\cap\qqq_k$ be a reduced primary decomposition. Taking radical we get $\ppp=\ppp_1\cap\cdots\cap\ppp_k$ with $\ppp_i=r(\qqq_i)$. By Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} this implies $\ppp=\ppp_i$ for some $i$, and $\ppp$ is isolated. By Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11} it suffices to show that $\ppp^{(m+n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^{m+n}$. Assuming $\ppp^{m+n}\subset\qqq\subset\ppp$ with $\qqq$ a $\ppp$-primary ideal, we get $\ppp^{m+n}_\ppp\subset\qqq_\ppp\subset\ppp_\ppp$, and thus $\ppp^{(m+n)}\subset\qqq\subset \ppp$.

\nn(iv) We must show $\ppp^{(n)}=\ppp^n\iff\ppp^n$ is $\ppp$-primary. Implication $\implies$ follows from (i). If $\ppp^n$ is $\ppp$-primary, then $\ppp^n=\ppp^n$ is a reduced primary decomposition, and (ii) implies $\ppp^{(n)}=\ppp^n$.
\end{comment}
%\end{comment}

%\begin{comment} 2108031211
\begin{comment}
This is an easy consequence of Exercise~1.18 p.~10 of the book [Section~\ref{ex1.18p10} p.~\pageref{ex1.18p10}], Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} above and the following Lemmas, where $\ppp$ is a prime ideal in a ring $A$:

\begin{lem}\label{413c}
We have $\ppp^n\subset\ppp^{(n)}=\left(\ppp_\ppp^n\right)^{\oo c}=\left(\ppp^n\right)^{\oo{ec}}$ and $\left(\ppp^{(n)}\right)_\ppp=\ppp_\ppp^n$. 
\end{lem}
This is obvious.

\begin{lem}\label{413a}
We have $r\left(\ppp^{(n)}\right)=\ppp$. 
\end{lem}
\begin{proof}
We have $r\left(\ppp^{(n)}\right)=r\left(\left(\ppp_\ppp^n\right)^{\oo c}\right)=\left(r\left(\ppp_\ppp^n\right)\right)^{\oo c}=(\ppp_\ppp)^{\oo c}=\ppp$, the second equality following from Exercise~1.18 p.~10 of the book [Section~\ref{ex1.18p10} p.~\pageref{ex1.18p10}]. 
\end{proof} 

\begin{lem}
We have $r\left(\ppp^{(n_1)}\cdots\ppp^{(n_k)}\right)=\ppp$. 
\end{lem}
\begin{proof}
This follows from Exercise~1.13iii p.~9 of the book and Lemma~\ref{413a} above.
\end{proof}

\begin{lem}\label{413b}
The ideal $\ppp^{(n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^n$. 
\end{lem}
\begin{proof}
We have $(\ppp^{(n)})_\ppp=\ppp_\ppp^{n}\subset\ppp_\ppp$ by Lemma~\ref{413c}. As $\ppp_\ppp$ is maximal, the ideal $\ppp^n_\ppp$ is $\ppp_\ppp$-primary. Using contraction we see that $\ppp^{(n)}$ is $\ppp$-primary. Assuming $\ppp^n\subset\qqq\subset\ppp$ with $\qqq$ a $\ppp$-primary ideal, we get $\ppp^n_\ppp\subset\qqq_\ppp\subset\ppp_\ppp$, and thus $\ppp^{(n)}\subset\qqq\subset\ppp$. 
\end{proof}

\begin{lem}
If $\aaa$ is a decomposable ideal such that $\ppp^n\subset\aaa\subset\ppp^{(n)}$, then $\ppp^{(n)}$ is the $\ppp$-primary component of $\aaa$. 
\end{lem}
\begin{proof}
This follows from Corollary~\ref{ctoc4.11}b p.~\pageref{ctoc4.11} and Lemma~\ref{413b} above.
\end{proof}

Note that there is a typo at the end of the statement of the exercise in the book: Part (iv) should be: $\ppp^{(n)}=\ppp^n\iff\ppp^n$ is $\ppp$-primary.
\end{comment}
%\end{comment}

\subsubsection{Page 56, Exercise~4.14}%

\textbf{Statement.} Let $\aaa$ be a decomposable ideal in a ring $A$ and let $\ppp$ be a maximal element of the set of ideals $(\aaa:x)$, where $x\in A$ and $x\notin\aaa$. Show that $\ppp$ is a prime ideal belonging to $\aaa$.

\nn\textbf{Solution.} By Corollary~\ref{c45} p.~\pageref{c45} above [which is a corollary to the First Uniqueness Theorem, that is to Theorem 4.5 p.~52 of the book], it suffices to show that $(\aaa:x)$ is prime. If not there would be $y,z\in A$ such that 
$$
y\notin(\aaa:x),\quad z\notin(\aaa:x),\quad yz\in(\aaa:x),
$$ 
that is 
$$
xy\notin\aaa,\quad xz\notin\aaa,\quad xyz\in\aaa.
$$ 
This implies 
$$
y\in(\aaa:xz)\supset(\aaa:x)\not\ni y,
$$ 
contradicting the maximality of $(\aaa:x)$. 

\subsubsection{Page 56, Exercise~4.15}%

\textbf{Statement.} Let $\aaa$ be a decomposable ideal in a ring $A$, let $\Sigma$ be an isolated set of prime ideals belonging to $\aaa$, and let $\qqq_\Sigma$ be the intersection of the corresponding primary components. Let $f$ be an element of $A$ such that, for each prime ideal $\ppp$ belonging to $\aaa$, we have $f\in\ppp\iff\ppp\notin\Sigma$, and let $S_f$ be the set of all powers of $f$. Show that $\qqq_\Sigma=S_f(\aaa)=(a:f^n)$ for all large $n$.

\nn\textbf{Solution.} We can assume that $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ is a minimal primary decomposition, and that, setting $\ppp_i:=r(\qqq_i)$, we have $\Sigma=\{\ppp_1,\dots\ppp_m\}$. The equality $\qqq_\Sigma=S_f(\aaa)$ follows from Proposition~4.9 p.~54 of the book [Proposition~\ref{p4.9} p.~\pageref{p4.9}]. Proposition~3.11ii p.~41 of the book [Proposition~\ref{p3.11} p.~\pageref{p3.11}] implies $S_f(\aaa)=\bigcup_{k\ge0}(\aaa:f^k)$. We have 
\begin{equation}\label{afk}
(\aaa:f^k)=(\qqq_1:f^k)\cap\cdots\cap(\qqq_n:f^k).
\end{equation} 
Using Lemma 4.4 p.~51 of the book we see that  

\nn$\bu$ if $1\le i\le m$, then $(\qqq_i:f^k)=\qqq_i$,  

\nn$\bu$ if $m+1\le i\le n$ and $k$ is large enough, then $f^k\in\qqq_i$, and thus $(\qqq_i:f^k)$ $=(1)$.

In view of \eqref{afk} this entails $(\aaa:f^k)=\qqq_\Sigma$ for $k$ large enough.

\subsubsection{Page 56, Exercise~4.16}%

\textbf{Statement.} If $A$ is a ring in which every ideal has a primary decomposition, show that every ring of fractions $S^{-1}A$ has the same property.

\nn\textbf{Solution.} This follows from Proposition~3.11i p.~41 [Proposition~\ref{p3.11} p.~\pageref{p3.11}] and Proposition~4.9 p.~54 of the book [Proposition~\ref{p4.9} p.~\pageref{p4.9}].

\subsubsection{Page 56, Exercise~4.17}%https://math.stackexchange.com/q/2375591/660 - previous version https://docs.google.com/document/d/1jO2WMu4veaXNHTd_D2QJ89QwvbGW_KaqyJPpb02RU4I/edit

\paragraph{Statement.}\label{ex4.17}%

Let $A$ be a ring with the following property.

\nn(L1) For every ideal $\mathfrak a\ne(1)$ in $A$ and every prime ideal $\mathfrak p$, there exists $x\notin\mathfrak p$ such that $S_{\mathfrak p}(\mathfrak a)=(\mathfrak a:x)$, where $S_{\mathfrak p}=A\setminus\mathfrak p$.

Then every ideal in $A$ is an intersection of (possibly infinitely many) primary ideals.

\paragraph{First solution.}%

Let $\aaa'$ be the intersection of all the primary ideals containing a given ideal $\aaa$, and let us assume  
\begin{equation}\label{abs417}
\aaa\subsetneqq\aaa'.
\end{equation} 
It suffices to reach a contradiction.

\begin{df}\label{admquad} 
An \textbf{admissible quadruple} is a quadruple $(\bbb,\ppp,\qqq,x)$ such that 

\nn$\bu\ \bbb$ is an ideal $\ne(1)$ in $A$, 

\nn$\bu\ \mathfrak p$ is a minimal element of the set of prime ideals containing $\bbb$, 

\nn$\bu\ \mathfrak q=S_{\mathfrak p}(\bbb)$, 

\nn$\bu\ x\in A\setminus\ppp$ satisfies $\mathfrak q=(\bbb:x)$. 
\end{df}

\begin{lem}\label{l417}
\emph{(a)} For all $\bbb\ne(1)$ there is an admissible quadruple 
$
(\bbb,\ppp,\qqq,x).
$

\nn\emph{(b)} If $(\bbb,\ppp,\qqq,x)$ is an admissible quadruple, then 

\emph{(b1)} $\mathfrak q$ is $\mathfrak p$-primary, 

\emph{(b2)} $\bbb=\mathfrak q\cap(\bbb+(x))$.
\end{lem}

\begin{proof} 
Part (a) follows from Assumption (L1). Part (b1) follows from Exercise~4.11 p.~56 of the book [see Section~\ref{ex4.11} p.~\pageref{ex4.11} above]. Let us prove (b2). Set $\bbb':=\mathfrak q\cap(\bbb+(x))$. The inclusion $\bbb\subset\bbb'$ is obvious. To prove the other inclusion, let $\beta+ax\in\qqq$ with $\beta\in\bbb,a\in A$. It suffices to show $ax\in\bbb$. Recall that $\qqq=S_{\ppp}(\bbb)=(\bbb:x)$. As $ax\in\qqq$, we have $ax^2\in\bbb$, hence 
$$
a\in(\bbb:x^2)\subset\bigcup_{s\notin\ppp}\ (\bbb:s)=S_{\ppp}(\bbb)=(\bbb:x)
$$ 
by Proposition~3.11ii p.~41 of the book [Proposition~\ref{p3.11} p.~\pageref{p3.11}], and thus $ax\in\bbb$, as desired. 
\end{proof}

Note that we have $\bbb\subset\qqq\subset\ppp\not\ni x$. Let $\kappa$ be a cardinal larger than the cardinality of the power set of $A$, and let $W$ be the set of all ordinals $\le\kappa$. We will define, by induction on $\alpha\in W$, a map 
\begin{equation}\label{eq417a}
\alpha\mapsto(\aaa_\alpha,\ppp_\alpha,\qqq_\alpha,x_\alpha)
\end{equation}
from $W$ to the set of admissible quadruples, such that 

(a) $\aaa_0=\aaa$, 

(b) the map 
\begin{equation}\label{eq417b}
\alpha\mapsto\aaa_\alpha\text{ is increasing,}
\end{equation} 

(c) each ordinal $\alpha\in W$ satisfies 
\begin{equation}\label{eq417c}
\aaa=\aaa_\alpha\cap\bigcap_{\beta<\alpha}\qqq_\beta.
\end{equation}
\begin{df}\label{calpha}
We call \eqref{eq417c} Condition $\oo C(\alpha)$. 
\end{df}

Lemma~\ref{l417}b1 will imply that $\qqq_\alpha$ is primary for all $\alpha\in W$. 

The existence of \eqref{eq417a} satisfying \eqref{eq417b} will give the desired contradiction.

Here is the key point:

\nn\emph{Assume that $(\aaa_\beta,\ppp_\beta,\qqq_\beta,x_\beta)$ has been constructed for $\beta<\alpha$, and that $\aaa_\alpha$ has been defined and satisfies Condition $\oo C(\alpha)$. Then Assumption~\eqref{abs417} and Lemma~\ref{l417}b1 imply $\aaa_\alpha\ne(1)$. In particular there is, by Lemma~\ref{l417}a, an admissible quadruple} $(\aaa_\alpha,\ppp_\alpha,\qqq_\alpha,x_\alpha)$.

We embark on the construction of \eqref{eq417a}.

\nn$\bu$ The case of the zero ordinal. The ideal $\aaa_0$ is the ideal $\aaa$ given in the statement of the exercise, and we choose $\ppp_0,\qqq_0,x_0$ in such a way that $(\aaa_0,\ppp_0,\qqq_0,x_0)$ is admissible. Condition~$\oo C(0)$ holds trivially.

\nn$\bu$ From $\alpha$ to $\alpha+1$. Let $\alpha\in W$ be such that $\alpha+1\in W$, and assume that $(\aaa_\beta,\ppp_\beta,\qqq_\beta,x_\beta)$ has already been constructed for $\beta\le\alpha$ and that Condition $\oo C(\alpha)$ holds. Let $\alpha\in W$. We have 
\begin{equation}\label{210625a}
\aaa\subset\big(\aaa_\alpha+(x_\alpha)\big)\cap\bigcap_{\beta\le\alpha}\qqq_\beta
\end{equation} 
because $\aaa\subset\aaa_\beta\subset(\aaa_\beta:x_\beta)=\qqq_\beta$ for all $\beta\in W$, and Lemma~\ref{l417}b2 implies 
\begin{equation}\label{210625b}
\big(\aaa_\alpha+(x_\alpha)\big)\cap\bigcap_{\beta\le\alpha}\qqq_\beta\subset \big(\aaa_\alpha+(x_\alpha)\big)\cap\qqq_\alpha=\aaa_\alpha.
\end{equation} 
We also have %\begin{equation}\label{210625c}\big(\aaa_\alpha+(x_\alpha)\big)\cap\bigcap_{\beta\le\alpha}\qqq_\beta\subset\aaa\end{equation} because 
\begin{equation}\label{210625c}
\big(\aaa_\alpha+(x_\alpha)\big)\cap\bigcap_{\beta\le\alpha}\qqq_\beta\subset 
\aaa_\alpha\cap\left(\bigcap_{\beta<\alpha}\qqq_\beta\right)\cap\qqq_\alpha=\aaa\cap\qqq_\alpha\subset
\aaa
\end{equation} 
by \eqref{210625b} and $\oo C(\alpha)$. Now \eqref{210625a} and \eqref{210625c} imply 
\begin{equation}\label{210625d}
\big(\aaa_\alpha+(x_\alpha)\big)\cap\bigcap_{\beta\le\alpha}\qqq_\beta=\aaa.
\end{equation}

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 6

By \eqref{210625d}, the ideal $\aaa_{\alpha+1}:=\aaa_\alpha+(x_\alpha)$ satisfies $\oo C(\alpha+1)$. In particular $\aaa_{\alpha+1}\ne(1)$ by Assumption~\eqref{abs417} and Lemma~\ref{l417}b1. We define $\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}$ in such a way that $(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})$ is admissible [see Lemma~\ref{l417}a].% previous version: By the claim, there is an ideal $\aaa_{\alpha+1}$ containing $\aaa_\alpha+(x_\alpha)$ which is maximal subject to the constraint $\oo C(\alpha+1)$. In particular $\aaa_{\alpha+1}\ne(1)$ by Assumption~\eqref{abs417} and Lemma~\ref{l417}b1. We define $\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}$ in such a way that $(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})$ is admissible (Lemma~\ref{l417}a).

\nn$\bu$ The case of a limit ordinal. Assume now that $\gamma\in W$ is a limit ordinal, and set 
$$
\aaa_\gamma:=\sum_{\alpha<\gamma}\aaa_\alpha=\bigcup_{\alpha<\gamma}\aaa_\alpha.
$$ 
We claim that Condition $\oo C(\gamma)$ holds.

\nn Proof of the claim: We must show 
$$
\left(\bigcup_{\alpha<\gamma}\aaa_\alpha\right)\cap\left(\bigcap_{\beta<\gamma}\qqq_\beta\right)=\aaa.
$$ 
Inclusion $\supset$ being clear, it suffices to prove $\subset$. Let $x$ be in the left side. There is an $\alpha<\gamma$ such that 
$$
x\in\aaa_\alpha\cap\bigcap_{\beta<\gamma}\qqq_\beta\subset\aaa_\alpha\cap\bigcap_{\beta<\alpha}\qqq_\beta=\aaa,
$$ 
the equality following from $\oo C(\alpha)$. This proves Condition $\oo C(\gamma)$. 

In particular $\aaa_\gamma\ne(1)$. We define $\ppp_\gamma,\qqq_\gamma,x_\gamma$ in such a way that $(\aaa_\gamma,\ppp_\gamma,\qqq_\gamma,x_\gamma)$ is admissible [Lemma~\ref{l417}a].

Now the map \eqref{eq417a} is defined. The map $\alpha\mapsto\aaa_\alpha$ is clearly increasing. As already indicated, this is a contradiction.

This completes the solution to Exercise~4.17. 

\paragraph{Second solution.}\label{for418}%\subsubsection{Part 2}% previous version https://docs.google.com/document/d/1DnCzzLfgWzv6XqiA-2PiOudOTof99MIeD9ejViIJwUY/edit

The following variant of the above proof will be used to solve Exercise~4.18. 

We stop assuming \eqref{abs417}. 

Let $Q$ be the set of admissible quadruples. We define a map $f:W\to Q\cup\{\varnothing\}$ [note that the union is disjoint] as follows:

\nn$\bu$ We assume $\aaa\ne(1)$ and define $(\aaa_0,\ppp_0,\qqq_0,x_0)$ as before, and we set $f(0):=(\aaa_0,\ppp_0,\qqq_0,x_0)$. 

\nn$\bu$ In the passage from $\alpha$ to $\alpha+1$, we define $f(\alpha+1)$ as follows [assuming that $f(\alpha)$ has already been defined]:

If $f(\alpha)=\varnothing$ we set $f(\alpha+1):=\varnothing$. 

Otherwise there is an ideal $\aaa_{\alpha+1}$ containing $\aaa_\alpha+(x_\alpha)$ which is maximal subject to the constraint $\oo C(\alpha+1)$ [see Definition~\ref{calpha} p.~\pageref{calpha}]. 

If $\aaa_{\alpha+1}\ne(1)$ we define $\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}$ in such a way that $(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})$ is admissible, as before, and we set $f(\alpha+1):=(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})$.  

If $\aaa_{\alpha+1}=(1)$ we set $f(\alpha+1):=\varnothing$.

\nn$\bu$ In the case of a limit ordinal $\gamma$, we define $f(\gamma)$ as follows (assuming that $f(\alpha)$ has already been defined for $\alpha<\gamma$):

If $f(\alpha)=\varnothing$ for some $\alpha<\gamma$ we set $f(\gamma)=\varnothing$.

Otherwise we define $\aaa_\gamma$ as before.

If $\aaa_\gamma\ne(1)$ we define $\ppp_\gamma,\qqq_\gamma,x_\gamma$ in such a way that $(\aaa_\gamma,\ppp_\gamma,\qqq_\gamma,x_\gamma)$ is admissible, as before, and we set $f(\gamma):=(\aaa_{\gamma},\ppp_{\gamma},\qqq_{\gamma},x_{\gamma})$.  

If $\aaa_\gamma=(1)$ we set $f(\gamma)=\varnothing$.

This ends the definition of $f$.

The subset $\{\alpha\in W\ |\ f(\alpha)=\varnothing\}$ of $W$ being nonempty, it has a least element, which we denote by $\zeta$:  
\begin{equation}\label{zeta}
\zeta:=\min\ \{\alpha\in W\ |\ f(\alpha)=\varnothing\},
\end{equation} 
and we get 
\begin{equation}\label{abak}
\aaa=\bigcap_{\alpha<\zeta}\qqq_\alpha.
\end{equation} 
\begin{note}\label{amaa}
The map $\alpha\mapsto\aaa_\alpha$ from the set $\{\alpha\in W\ |\ \alpha\le\zeta\}$ to the set of ideals of $A$ is increasing.
\end{note} 
The following lemma will be used to solve Exercise~4.18. 
\begin{lem}\label{lasker}
The map $n\mapsto\qqq_0\cap\cdots\cap\qqq_n$ from the set $\{n\in\mathbb N\ |\ n<\zeta\}$ to the set of ideals of $A$ is decreasing.
\end{lem}
\begin{proof}
Suppose by contradiction that we have $\qqq_0\cap\cdots\cap\qqq_{n-1}=\qqq_0\cap\cdots\cap\qqq_{n-1}\cap\qqq_n$ for some $0<n<\zeta$. Recall that $\aaa_n$ is maximal for 
\begin{equation}\label{an}
\aaa_n\supset\aaa_{n-1}+(x_{n-1})\text{ and }\aaa=\aaa_n\cap\qqq_0\cap\cdots\cap\qqq_{n-1}.
\end{equation} 
Similarly $\aaa_{n+1}$ is maximal for 
$$
\aaa_{n+1}\supset\aaa_n+(x_n)\text{ and }\aaa=\aaa_{n+1}\cap\qqq_0\cap\cdots\cap\qqq_{n-1}.
$$ 
As $\aaa_{n+1}$ satisfies \eqref{an} and contains $\aaa_n$, these two ideals coincide, in contradiction with Note~\ref{amaa}. 
\end{proof}

\subsubsection{Page 57, Exercise~4.18}%

\paragraph{Statement.}%

Consider the following condition on a ring $A$:

\nn(L2) Given an ideal $\mathfrak a$ and a descending chain $S_1\supset S_2\supset\cdots\supset S_n\supset\cdots$ of multiplicatively closed subsets of $A$, there exists an integer $n$ such that $S_n(\mathfrak a)=S_{n+1}(\mathfrak a)=\cdots$ 

Prove that the following are equivalent:

\nn(i) Every ideal in $A$ has a primary decomposition;

\nn(ii) $A$ satisfies (L1) and (L2).

[See Section~\ref{ex4.17} p.~\pageref{ex4.17} for the definition of (L1).]

\paragraph{Solution.}\phantom0%

\nn(i)$\implies$(L1): Let $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ be a minimal primary decomposition. Set $\ppp_i:=r(\qqq_i)$ and let $\ppp$ be a prime ideal. We can assume that $\ppp_i\subset\ppp$ if and only if $i\le m$. Proposition~4.9 p.~54 of the book [Proposition~\ref{p4.9} p.~\pageref{p4.9}] entails $S_\ppp(\aaa)=\qqq_1\cap\cdots\cap\qqq_m$. For $m+1\le i\le n$ there is an element $x_i$ which is in $\qqq_i$ but not in $\ppp$. Then $x:=x_{m+1}\cdots x_n$ is in $\qqq_{m+1}\cap\cdots\cap\qqq_n$ but not in $\ppp$, and we get 
$$
(\aaa:x)
$$
$$
\begin{matrix}
=&(\qqq_1:x)\cap\cdots\cap(\qqq_m:x)&\cap&(\qqq_{m+1}:x)\cap\cdots\cap(\qqq_n:x)\\ \\ 
=&\qqq_1\cap\cdots\cap\qqq_m&\cap&(1)\cap\cdots\cap(1)
\end{matrix}
$$
$$
=\qqq_1\cap\cdots\cap\qqq_m=S_\ppp(\aaa),
$$ 
the second equality following from Lemma 4.4 p.~51 of the book.

\nn(i)$\implies$(L2): Follows from Proposition~4.9 p.~54 of the book [Proposition~\ref{p4.9} p.~\pageref{p4.9}].

\nn(ii)$\implies$(i): Consider the map $\alpha\mapsto(\aaa_\alpha,\ppp_\alpha,\qqq_\alpha,x_\alpha)$ from $W$ to the set of admissible quadruples defined in Section~\ref{for418} above, and let $\zeta$ be defined as in \eqref{zeta}. 

In view of \eqref{abak} it suffices to show that $\zeta$ is finite. 

Assume by contradiction that $\zeta$ is infinite.

Recall that \eqref{eq417c} p.~\pageref{eq417c} is called Condition $\oo C(\alpha)$, and that $\qqq_\alpha$ is primary for all $\alpha<\zeta$. For the reader's convenience let us rewrite $\oo C(\alpha)$:
$$
\aaa=\aaa_\alpha\cap\bigcap_{\beta<\alpha}\qqq_\beta.
$$ 
This holds for all $\alpha<\zeta$.

Setting $\ppp_n:=r(\qqq_n)$ and $S_n:=S_{\ppp_0}\cap\cdots\cap S_{\ppp_n}$ for $n\in\mathbb N$, we get, in view of $\oo C(n+1)$ and Exercise~4.12i p.~56 of the book, 
$$
S_n(\aaa)=S_n(\aaa_{n+1})\cap S_n(\qqq_0\cap\cdots\cap\qqq_n).
$$ 
We claim $S_n(\aaa_{n+1})=(1)$, and thus $S_n(\aaa)=S_n(\qqq_0\cap\cdots\cap\qqq_n)$.

To prove this it suffices to show $S_n\cap\aaa_{n+1}\ne\varnothing$. Assume by contradiction $S_n\cap\aaa_{n+1}=\varnothing$, that is $\aaa_{n+1}\subset\ppp_0\cup\cdots\cup\ppp_n$. Then Proposition~1.11i p.~8 of the book implies $\aaa_{n+1}\subset\ppp_i$ for some $0\le i\le n$. This yields $x_i\in\aaa_{i+1}\subset\aaa_{n+1}\subset\ppp_i$, which contradicts Definition~\ref{admquad} p.~\pageref{admquad}. This proves the equality $S_n(\aaa_{n+1})=(1)$.

Proposition~4.9 p.~54 of the book [Proposition~\ref{p4.9} p.~\pageref{p4.9}] implies 
$$
S_n(\qqq_0\cap\cdots\cap\qqq_n)=\bigcap_{S_n\cap\ppp_i=\varnothing}\qqq_i=\qqq_0\cap\cdots\cap\qqq_n,
$$ 
and we get 
\begin{equation}\label{sna}
S_n(\aaa)=\qqq_0\cap\cdots\cap\qqq_n.
\end{equation}

Recall that we are assuming that $\zeta$ is infinite and that we only need to derive a contradiction. Since \eqref{sna} holds for all $n\in\mathbb N$, this contradiction is furnished by Condition (L2) and Lemma~\ref{lasker} p.~\pageref{lasker}.

\subsubsection{Page 57, Exercise~4.19}%

\textbf{Statement.}

\nn(a) Let $A$ be a ring and $\mathfrak p$ a prime ideal of $A$. Show that every $\mathfrak p$-primary ideal contains $S_{\mathfrak p}(0)$, the kernel of the canonical homomorphism $A\to A_{\mathfrak p}$.

\nn(b) Suppose that $A$ satisfies the following condition: for every prime ideal $\mathfrak p$, the intersection of all $\mathfrak p$-primary ideals of $A$ is equal to $S_{\mathfrak p}(0)$. (Noetherian rings satisfy this condition: see Chapter~10\footnote{See Corollary 10.21 p.~111 of the book.}.) Let $\mathfrak p_1,\dots,\mathfrak p_n$ be distinct prime ideals, none of which is a minimal prime ideal of $A$. Then there exists an ideal $\mathfrak a$ in $A$ whose associated prime ideals are $\mathfrak p_1,\dots,\mathfrak p_n$.

\nn[Proof of (b) by induction on $n$. The case $n=1$ is trivial (take $\mathfrak a=\mathfrak p_1$). Suppose $n>1$ and let $\mathfrak p_n$ be maximal in the set $\{\mathfrak p_1,\dots,\mathfrak p_n\}$. By the inductive hypothesis there exists an ideal $\mathfrak b$ and a minimal primary decomposition $\mathfrak b=\mathfrak q_1\cap\dots\cap\mathfrak q_{n-1}$, where each $\mathfrak q_i$ is $\mathfrak p_i$-primary. If $\mathfrak b\subset S_{\mathfrak p_n}(0)$ let $\mathfrak p$ be a minimal prime ideal of $A$ contained in $\mathfrak p_n$. Then $S_{\mathfrak p_n}(0)\subset S_{\mathfrak p}(0)$, hence $\mathfrak b\subset S_{\mathfrak p}(0)$. Taking radicals and using Exercise~10, we have $\mathfrak p_1\cap\dots\cap\mathfrak p_{n-1}\subset\mathfrak p$, hence some $\mathfrak p_i\subset \mathfrak p$, hence $\mathfrak p_i=\mathfrak p$ since $\mathfrak p$ is minimal. This is a contradiction since no $\mathfrak p_i$ is minimal. Hence $\mathfrak b\not\subset S_{\mathfrak p_n}(0)$ and therefore\footnote{By the condition in the first sentence of (b).} there exists a $\mathfrak p_n$-primary ideal $\mathfrak q_n$ such that $\mathfrak b\not\subset\mathfrak q_n$. Show that $\mathfrak a=\mathfrak q_1\cap\dots\cap\mathfrak q_n$ has the required properties.]

\nn End of the statement.

\nn\textbf{Solution.}

\nn Proof of (a): If $\qqq$ is $\ppp$-primary, then we have $(0)\subset\qqq_\ppp\subset A_\ppp$, and thus $S_\ppp(0)=(0)^{\oo c}\subset(\qqq_\ppp)^{\oo c}=\qqq\subset A$ [see Section~\ref{prycor} p.~\pageref{prycor} above]. 

\nn Proof of (b): The following argument was explained to me by user withoutfeather over on Mathematics Stackexchange: \href{https://math.stackexchange.com/a/3338211/660}{https://math.stackexchange.com/a/3338211/660}. 

Assume that $\mathfrak{a}=\mathfrak{q}_1\cap\cdots\cap\mathfrak{q}_n$ is \textbf{not} reduced.

Since $\mathfrak{q}_n\not\supset\mathfrak{q}_1\cap\cdots\cap\mathfrak{q}_{n-1}$, there is an index $i$ with $1\leq i\leq n-1$ such that $\mathfrak{q}_i$ contains the intersection of the other $\qqq_j$. We can assume that $i=1$, i.e. $\mathfrak{q}_1\supset\mathfrak{q}_2\cap\cdots\cap\mathfrak{q}_n$. By induction hypothesis, $\mathfrak{q}_1\not\supset\mathfrak{q}_2\cap\cdots\cap\mathfrak{q}_{n-1}$, so there exists 
$$
x\in(\mathfrak{q}_2\cap\cdots\cap\mathfrak{q}_{n-1})\setminus\mathfrak{q}_1.
$$ 
On the other hand, we have $\mathfrak{p}_1=r(\mathfrak{q}_1)\not \supset \mathfrak{q}_n$. Indeed, $\mathfrak{p}_1\supset \mathfrak{q}_n$ would imply $\mathfrak{p}_1\supset \mathfrak{p}_n$ and, since $\mathfrak{p}_n$ is maximal in $\{\mathfrak{p}_1,\dots,\mathfrak{p}_n\}$, we would have $\mathfrak{p}_1=\mathfrak{p}_n$, contradiction. Hence there exists 
$$
y\in\mathfrak{q}_n\setminus\mathfrak{p}_1.
$$ 
Then the product $xy$ is in $\mathfrak{q}_2\cap\cdots\cap\mathfrak{q}_n\subset\mathfrak{q}_1$. But this is impossible since $x$ is not in $\qqq_1$ and $y$ is not in $\ppp_1$. 

\subsubsection{Page 57, Exercise~4.20}%

\textbf{Statement.} Let $M$ be a fixed $A$-module, $N$ a submodule of $M$. The \textbf{radical} of $N$ in $M$ is defined to be
$$
r_M(N)=\{x\in A\ |\ x^qM\subset N\text{ for some }q>0\}.
$$ 
Show that $r_M(N)=r(N:M)=r(\Ann(M/N))$. In particular, $r_M(N)$ is an ideal.

State and prove the formulas for $r_M$ analogous to (1.13).

\nn\textbf{Solution.} Analogue of (ii): $r_A(r_M(N))=r_M(N)$. 

\nn Analogue of (iii): $r_M(N\cap P)=r_M(N)\cap r_M(P)$. 

\nn Analogue of (iv): $r_M(N)=(1)\iff N=M$.

\nn Analogue of (v): $r_A(r_M(N)+r_M(P))\subset r_M(N+P)$. As pointed out by Jeffrey Daniel Kasik Carlson in \href{https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf}{https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf} p.~70, the converse is false: set 
$$
A\ne0,\quad M=A\oplus A,\quad N=A\oplus(0),\quad P=(0)\oplus A.
$$ 
This yields $M=N+P$, so $r_M(N+P)=(1)$, but $r_M(N)=r_M(P)=0$. 

\subsubsection{Page 57, Exercise~4.21}%

\textbf{Statement.} An element $x\in A$ defines an endomorphism $\phi_x$ of $M$, namely $m\mapsto xm$. The element $x$ is said to be a \textbf{zero-divisor} (resp. \textbf{nilpotent}) in $M$ if $\phi_x$ is not injective (resp. is nilpotent). A submodule $Q$ of $M$ is \textbf{primary} in $M$ if $Q\ne M$ and every zero-divisor in $M/Q$ is nilpotent.

Show that if $Q$ is primary in $M$, then $(Q:M)$ is a primary ideal and hence $r_M(Q)$ is a prime ideal $\ppp$. We say that $Q$ is $\ppp$-\textbf{primary} (in $M$).

Prove the analogues of (4.3) and (4.4).

\nn\textbf{Solution.} Analogue of (4.3): In the statement and the proof of (4.3) one can replace each occurrence of $\qqq$ with $Q$ and each occurrence of $r$ with $r_M$.% comment removed https://docs.google.com/document/d/1iHEeT74tVvnD4cKxwB7h1dJYzhqRd9YZpq7cD6BrO90/edit

Analogue of (4.4): For the analogues of (i) and (ii), replace $\qqq$ with $Q$ and $x\in A$ with $x\in M$. I see no analogue of (iii). For the proof of (ii), one can modify the text of the book according to the following table:  
$$
{\renewcommand{\arraystretch}{1.2}
\begin{array}{|c|c|c|c|c|}\hline
y\in(\qqq:x)&xy\in\qqq&x\notin\qqq&\qqq\subset(\qqq:x)\subset\ppp&r(\qqq:x)=\ppp\\ \hline
y\in(Q:x)&yx\in Q&x\notin Q&(Q:M)\subset(Q:x)\subset\ppp&r(Q:x)=\ppp\\ \hline
\end{array}}
$$ 
Continuation of the table:
$$
{\renewcommand{\arraystretch}{1.2}
\begin{array}{|c|c|c|c|}\hline
yz\in(\qqq:x)&xyz\in\qqq&xz\in\qqq&z\in(\qqq:x)\\ \hline
yz\in(Q:x)&yzx\in Q&zx\in Q&z\in(Q:x)\\ \hline
\end{array}}
$$ 

\subsubsection{Page 58, Exercise~4.22}%

\textbf{Statement.} A primary decomposition of $N$ in $M$ is a representation of $N$ as an intersection
$$
N=Q_1\cap\cdots\cap Q_n
$$ 
of primary submodules of $M$; it is a minimal primary decomposition if the ideals $\ppp_i=r_M(Q_i)$ are all distinct and if none of the components $Q_i$ can be omitted from the intersection, that is if $Q_i\not\supset_{j\ne i}Q_i$ ($1\le i\le n$).

Prove the analogue of (4.5), that the prime ideals $\ppp_i$ depend only on $N$ (and $M$). They are called the \textbf{prime ideals belonging to} $N$ in $M$. Show that they are also the prime ideals belonging to 0 in $M/N$.

\nn\textbf{Solution.} Analogue of (4.5): 
$$
{\renewcommand{\arraystretch}{1.2}%
\begin{array}{|c|c|c|c|c|}\hline
\aaa&\qqq_i&r(\qqq_i)&x\in A&x_i\notin\qqq_i\\ \hline 
N&Q_i&r_M(Q_i)&x\in M&x_i\notin Q_i\\ \hline
\end{array}}
$$ 

\subsubsection{Page 58, Exercise~4.23}%

\textbf{Statement.} State and prove the analogues of (4.6)-(4.11) inclusive. (There is no loss of generality in taking $N=0$.)

\nn\textbf{Solution.} Analogues of (4.6)-(4.11), assuming $N=0$: 

\nn$\bu$ (4.6): 
$$
{\renewcommand{\arraystretch}{1.2}%
\begin{array}{|c|c|c|c|}\hline
\aaa\subset A&\ppp\supset\aaa&\ppp\supset\aaa=\bigcap\qqq_i&r(\qqq_i)\\ \hline 
0\subset M&\ppp\supset(0:M)&\ppp\supset(0:M)=\bigcap(Q_i:M)&r(Q_i:M)\\ \hline
\end{array}}
$$ 
$\bu$ (4.7): Replace 

``if the zero ideal is decomposable, the set $D$ of zero-divisors of $A$ is the union of the prime ideals belonging to $0$'' 

\nn with 

``if the zero submodule of $M$ is decomposable, the set $D$ of zero-divisors of $A$ in $M$ is the union of the prime ideals belonging to $0\subset M$''

\nn$\bu$ (4.8): Let $S$ be a multiplicative subset of $A$, let $M$ be an $A$-module and $Q$ a $\ppp$-primary submodule of $M$. 

(i) If $S\cap\ppp\ne\varnothing$, then $S^{-1}Q=S^{-1}M$. Proof: Let $s\in S\cap\ppp$, $t\in S$ and $x\in M$. We get $s^n\in(Q:M)$, that is $s^nM\subset Q$, for some $n$, and thus 
$$
\frac xt=\frac{s^nx}{s^nt}\in S^{-1}Q.
$$ 

(ii) Assume $S\cap\ppp=\varnothing$. The analogue of (4.8ii) is: 

\nn\emph{$S^{-1}Q$ is $S^{-1}\ppp$-primary and its contraction in $M$ is $Q$. Hence primary submodules correspond to primary submodules in the correspondence between submodules in $S^{-1}M$ and contracted submodules in $M$.} 

We can adapt the proof in the book by adding the following three observations: 

(a) For any submodule $N$ of $M$ we have $S^{-1}(N:M)\subset(S^{-1}N:S^{-1}M)$. Proof: straightforward. 

(b) We have $(S^{-1}Q:S^{-1}M)\subset S^{-1}(Q:M)$. Proof: straightforward. 

(c) If $N$ is a contracted submodule $N$ of $M$ such that $S^{-1}N$ is primary, then $N$ is primary. Proof: Note that $sx\in N$ with $s\in S$ and $x\in M$ imply $x\in N$. Indeed, we have 
$$
\frac x1=\frac 1s\frac{sx}1\in S^{-1}N.
$$ 
Now if $a\in A$ and $x\in M\setminus N$ satisfy $ax\in N$, we get $\frac x1\notin S^{-1}N$ and $\frac a1\frac x1=\frac{ax}1\in S^{-1}N$, hence 
$$
\frac{a^n}1S^{-1}M=\left(\frac a1\right)^nS^{-1}M\subset S^{-1}N
$$ 
for some $n$, and thus $a^nM\subset N$. 

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 7

\nn$\bu$ (4.9) [Proposition~\ref{p4.9} p.~\pageref{p4.9}], (4.10) and (4.11): We use the table
$$
{\renewcommand{\arraystretch}{1.2}
\begin{array}{|c|c|c|}\hline
\aaa\subset A&\qqq_i&r(\qqq_i)\\ \hline 
0\subset M&Q_i&r(Q_i:M)\\ \hline
\end{array}}
$$ 

\subsubsection{Primary decomposition of a submodule after Bourbaki}% Bourbaki https://docs.google.com/document/d/15j_JjYfsyrM7Et-PvKQLXjNOYUnEAUVqT7gR0HlbLXA/edit

We follow closely Bourbaki's \textbf{Algèbre commutative}, Chapter~IV. Unless otherwise stated, $A$ is a commutative ring with one and $M$ is an $A$-module. For any element $a$ of $A$ and any $A$-module $M$ write $a_M$ for the map $x\mapsto ax$, $M\to M$

\begin{df}
Let $M$ be an $A$-module. We say that a prime ideal $\ppp$ of $A$ is \textbf{associated} to $M$ if there is an $x\in M$ such that  $\ppp$ is the annihilator of $x$. We write $\Ass(M)$ for the set of those prime ideals of $A$ which are associated to $M$. 
\end{df}

The annihilator of the zero module being the unit ideal, an element $x\in M$ whose annihilator is prime is nonzero. 

\begin{lem}\label{ail0}
Let $\ppp$ be a prime ideal of $A$. Then $\ppp$ is associated to $M$ if and only if $M$ contains a submodule $N$ isomorphic to $A/\ppp$, in which case we can take $N:=Ax$ for any $x\in M$ whose annihilator is $\ppp$. 
\end{lem}
\begin{proof}
This is clear.
\end{proof}

If $M$ is the union of a family $(M_i)_{i\in I}$ of submodules, we clearly have
\begin{equation}\label{ai1}
\Ass(M)=\bigcup_{i\in I}\Ass(M_i).
\end{equation}

\begin{prop}\label{aip1}
For all prime ideal $\ppp$ of $A$ and all nonzero submodule $M$ of $A/\ppp$ we have $\Ass(M)=\{\ppp\}$. 
\end{prop}
\begin{proof}
As $A/\ppp$ is a domain, the annihilator in $A$ of any of its nonzero element is $\ppp$.
\end{proof}

\begin{prop}\label{aip2}
Let $\aaa$ be an ideal of $A$ which is maximal among all ideals of the form $\Ann(x)$, $x\in M\setminus\{0\}$. Then $\aaa$ is prime, and thus $\aaa\in\Ass(M)$.
\end{prop}
\begin{proof}
Let $x$ and $\aaa$ be as above. It suffices to check that $\aaa$ is prime. As $x\ne0$, we have $\aaa\ne(1)$. Let $b,c$ be elements of $A$ such that $bc\in\aaa$ and $c\notin\aaa$. We get $cx\ne0$, $b\in\Ann(cx)$ and $\aaa\subset\Ann(cx)$. As $\aaa$ is maximal, this implies $\Ann(cx)=\aaa$, whence $b\in\aaa$. This shows that $\aaa$ is prime.
\end{proof}
\begin{cor}\label{iac1}
If $A$ is a noetherian ring and $M$ an $A$-module, then the conditions $M=0$ and $\Ass(M)=\varnothing$ are equivalent.
\end{cor}
\begin{proof}
If $M=0$, then $\Ass(M)$ is empty (even if $A$ were not noetherian). If $M\ne0$, the set $S$ of all ideals of the form $\Ann(x)$, $x\in M\setminus\{0\}$, is nonempty and $(1)\notin S$; as $A$ is noetherian, this set has a maximal element; and Proposition~\ref{aip2} gives the desired conclusion.
\end{proof}
\begin{cor} Let $A$ be noetherian, let $a$ be in $A$ and let $M$ be an $A$-module. Then $a_M$ is injective if and only if $a$ belongs to no prime ideal associated to $M$.
\end{cor}
\begin{proof}
If $a\in\ppp\in\Ass(M)$, we have $\ppp=\Ann(x)$ for some $x\in M\setminus\{0\}$, and the equality $ax=0$ shows that $a_M$ is not injective. Conversely, if $ax=0$ for some $x\in M\setminus\{0\}$, we get $Ax\ne0$, whence $\Ass(Ax)\ne\varnothing$ (Corollary~\ref{iac1}). Let $\ppp\in\Ass(Ax)$; we obviously have $\ppp\in\Ass(M)$ and $\ppp=\Ann(bx)$ for some $b\in A$; whence $a\in\ppp$ since $abx=0$. 
\end{proof}
\begin{cor}
The set of all zero-divisors in a noetherian ring $A$ is the union of the ideals $\ppp\in\Ass(A)$.
\end{cor}
\begin{prop}\label{aip3}
If $N$ is a submodule of $M$, we have $\Ass(N)\subset\Ass(M)\subset\Ass(N)\cup\Ass(M/N)$.
\end{prop}
\begin{proof}
The inclusion $\Ass(N)\subset\Ass(M)$ is obvious. Let $\ppp\in\Ass(M)$. By Lemma~\ref{ail0} there is a submodule $E$ of $M$ isomorphic to $A/\ppp$. Set $F:=E\cap N$. If $F=0$, then $E$ is isomorphic to a submodule of $M/N$, and (again by Lemma~\ref{ail0}) $\ppp\in\Ass(M/N)$. If $F\ne0$, the annihilator of any nonzero element of $F$ is $\ppp$ (Proposition~\ref{aip1}), hence $\ppp\in\Ass(N)$.
\end{proof}

\begin{lem}\label{aimyl1}
If $A$ is a noetherian ring, and if $(N_i)_{i\in I}$ is a family of submodules of an $A$-module $M$ such that the intersection of the $\Ass(N_i)$ is empty, then the intersection of the $N_i$ is the zero submodule.
\end{lem}
\begin{proof}
This follows from Corollary~\ref{iac1} and Proposition~\ref{aip3}.
\end{proof}

\begin{cor}\label{aic1}
If $M$ is the direct sum of a family $(M_i)_{i\in I}$ of submodules, then $\Ass(M)$ is the union of the $\Ass(M_i)$.
\end{cor}
\begin{proof}
By \eqref{ai1} we can assume that $I$ is finite. Arguing by induction, we see that it suffices to handle the case $I=\{1,2\}$. But this case follows from Proposition~\ref{aip3}.
\end{proof}

\begin{cor}\label{aimc11}
Let $M$ be an $A$-module and $Q_1,\dots,Q_n$ submodules of $M$. If the intersection of the $Q_i$ is $0$, then $\Ass(M)$ is contained in the union of the $\Ass(Q_i)$, and thus $\Ass(M)$ coincides with the union of the $\Ass(Q_i)$
\end{cor}
\begin{proof}
The canonical map $M\to\bigoplus(M/Q_i)$ being injective, it suffices to apply Proposition~\ref{aip3} and Corollary~\ref{aic1}.
\end{proof}

\begin{prop}\label{aip4}
Given $\Psi\subset\Ass(M)$ there is a submodule $N$ of $M$ such that 
$$
\Ass(N)=\Ass(M)\setminus\Psi\text{ and }\Ass(M/N)=\Psi.
$$ 
\end{prop}
\begin{proof}
Let $\Sigma$ be the set of those submodules $P$ of $M$ such that $\Ass(P)\subset\Ass( M )\setminus\Psi$. By \eqref{ai1} the set $\Sigma$, ordered by inclusion, is inductive; moreover the zero submodule belongs to $\Sigma$, so $\Sigma$ is nonempty. Let $N$ be a maximal element of $\Sigma$. We have $\Ass(N)\subset\Ass( M )\setminus\Psi$. By Proposition~\ref{aip3}, it suffices to prove $\Ass(M/N)\subset\Psi$. Let $\ppp\in\Ass(M/N)$; then, by Lemma~\ref{ail0}, $M/N$ contains a submodule $F/N$ isomorphic to $A/\ppp$. By Propositions \ref{aip1} and \ref{aip3} we have $\Ass(F)\subset\Ass(N)\cup\{\ppp\}$. The maximality of $N$ implies $F\notin\Sigma$, and thus $\ppp\in\Psi$.
\end{proof}

\begin{prop}\label{aimyl2}
If $A$ is a noetherian ring and if $(\Psi_i)_{i\in I}$ is a family of subsets of $\Ass(M)$ whose union is $\Ass(M)$, then there is a family $(N_i)_{i\in I}$ of submodules of $M$ such that $\Ass(M/N_i)=\Psi_i$ for all $i$, and the intersection of the $N_i$ is the zero submodule.
\end{prop}
\begin{proof}
Write $M(\Psi)$ for the submodule denoted by $N$ in the proof of Proposition~\ref{aip4} and apply Lemma~\ref{aimyl1} to the $M(\Psi_i)$.
\end{proof}

\begin{df}
Let $A$ be a noetherian ring. A submodule $N$ of an $A$-module $M$ is \textbf{primary} if $\Ass(M/N)=\{\ppp\}$ for some prime ideal $\ppp$ of $A$, in which case one also says that $N$ is $\ppp$\textbf{-primary}. 
\end{df}

Note that Bourbaki's definition given above is \textbf{not} equivalent to Atiyah and MacDonald's, as shown by the following example.

Let $K$ be a field, and $x$ and $y$ indeterminates. Set $A:=K[[x]]$, $M:=K[y]$, and define an $A$-module structure on $M$ by $(\sum a_nx^n)f:=\sum a_nf^{(n)}$, where $f^{(n)}$ is the $n$-th derivative of $f$. Then the zero submodule of $M$ is primary in Bourbaki's sense but is \textbf{not} an intersection of primary submodules in the sense of Atiyah and MacDonald.

The following consequence of Proposition~\ref{aimyl2} is stated as Theorem 2.2.1 in Somaya Muiny's thesis \href{https://scholarworks.gsu.edu/math_theses/70/}{https://scholarworks.gsu.edu/math\_theses/70/}

\begin{thm}[Somaya Muiny]\label{somaya}
If $M$ is a module over a noetherian ring $A$, then the intersection of its primary submodules is zero. More generally, if $N$ is submodule of an $A$-module $M$, then $N$ is the intersection of the primary submodules of $M$ which contain $N$. In fact, $N$ is the intersection of a family $(M(\ppp))_{\ppp\in\Ass(M/N)}$ of submodules containing $N$ such that each $M(\ppp)/N$ is $\ppp$-primary.
\end{thm}
\begin{proof}
Assuming $N=0$ without lost of generality, we apply Proposition~\ref{aimyl2} to the family $$(\{\ppp\})_{\ppp\in\Ass(M)}.$$ 
\end{proof}

\begin{prop}
Let $A$ be a noetherian ring and $M$ an $A$-module. Then the zero submodule of $M$ is the intersection of a finite family $(Q_1,\dots,Q_n)$ of primary submodules  of $M$ if and only if $\Ass(M)$ is finite, in which case $\Ass(M)$ is the disjoint union of the $\Ass(Q_i)$. There is a similar statement for an arbitrary submodule of $M$ [instead of the zero submodule].
\end{prop}
\begin{proof}
This follows from Corollary~\ref{aimc11} and Theorem~\ref{somaya}.
\end{proof}

\newpage

\section{About Chapter~5}%%%

\subsection{Comments}%%

\subsubsection{Page 61, Corollary 5.9}\label{c5.9}%

Here is a slightly stronger statement: 

\nn\emph{Let $A$ be a subring of a ring $B$ such that $B$ is integral over $A$; let $\qqq,\bbb$ be ideals of $B$ such that $\qqq$ is prime, $\qqq\subset\bbb$ and $\qqq^{\oo c}=\bbb^{\oo c}=\ppp$ say. Then $\qqq=\bbb$.}

\nn Proof. Arguing as in the book, we see that $\ppp_\ppp\subset A_\ppp$ and $\qqq_\ppp\subset B_\ppp$ are maximal, and that we have $\qqq_\ppp\subset\bbb_\ppp\subset B_\ppp$. Proposition~3.11ii p.~41 of the book [Proposition~\ref{p3.11} p.~\pageref{p3.11}] implies $\bbb_\ppp\ne B_\ppp$, and thus $\qqq_\ppp=\bbb_\ppp$. If $b$ is in $\bbb$, we get $b/1=q/s$ for some $q$ in $\qqq$ and some $s$ in $A\setminus\ppp$, then $tb\in\qqq$ for some $t$ in $A\setminus\ppp$, and thus $b\in\qqq$. $\square$

\subsubsection{Page 62, proof of Corollary 5.9}%

Let $A\subset B$ be rings, let $\qqq$ be a prime ideal of $B$ and set $\ppp:=A\cap\qqq$:
$$
\begin{tikzcd}
A\ar[d,"\alpha"']\ar[r,hook]&B\ar[d,"\beta"]\\ 
A_\ppp\ar[r,hook]&B_\ppp.
\end{tikzcd}
$$
Then Corollary 3.4ii p.~39 of the book implies $A_\ppp\cap\qqq_\ppp=\ppp_\ppp$. 

\subsubsection{Page 62, Theorem 5.10}\label{510}%

Let $\bbb$ be an ideal of $B$, let $\aaa$ be its contraction in $A$, and assume $\aaa\subset\ppp$. Then it is easy to see that $\qqq$ can be chosen among the prime ideals of $B$ containing $\bbb$. 

Also note that Corollary 5.8 and Theorem 5.10 imply that an ideal of $A$ is maximal if and only if it is the contraction of a maximal ideal of $B$. 

\subsubsection{Page 62, dim A = dim B}%

\nn\emph{If $A\subset B$ is an integral extension, then we have $\dim A=\dim B$.}

More precisely, we have $\dim A\ge\dim B$ by Corollary 5.9 p.~61 and $\dim A$ $\le$ $\dim B$ by Theorem 5.11 p.~62.

\subsubsection{Page 62, integrally closed domain}%

Here is an example of a domain which is \textbf{not} integrally closed. Let $k$ be a field, let $x$ be an indeterminate and set $A:=k[x^2,x^3]\subset k[x]$. Then $x$ is in the field of fractions of $A$, and is integral over $A$, but is not in $A$.

\subsubsection{Page 62, Proposition~5.12}\label{p5.12}%

Here is a corollary to Proposition~5.12 p.~62:

Let $A$ be a domain and $S$ a multiplicative subset with $0\notin S$. If $A$ is integrally closed, so is $S^{-1}A$.

\subsubsection{Page 63}%

If $A\subset D$ are domains, and if $\aaa$ is an ideal of $A$, then we denote the extension of $\aaa$ in $D$ by $D\,\aaa$, and the integral closure of $\aaa$ in $D$ by $D*\aaa$. 

Lemma 5.14 says
\begin{equation}\label{514}
D*\aaa=r\Big((D*A)\,\aaa\Big).
\end{equation}
In particular $D*\aaa$ is an ideal of $D*A$. 

In the proof of Proposition~5.15, we have the inclusions $\aaa\subset A\subset L$. Let 
$$
x^m+a_1x^{m-1}+\cdots+a_m
$$ 
be the minimal polynomial of $x$ over $K$. Each $a_j$ being in the ideal $(x_1,\dots,x_n)$ of $L*A$ generated by the $x_i$, and each $x_i$ being in the set $L*\aaa$, which is an ideal of $L*A$ by \eqref{514}, we get 
$$
a_j\in(L*\aaa)\cap K=K*\aaa=r\Big((K*A)\,\aaa\Big)=r(A\,\aaa)=r(\aaa)
$$ 
for all $j$ [the second equality following from \eqref{514}].

\subsubsection{Page 64, proof of Theorem 5.16}%

Last line of the first paragraph of the proof: It suffices to show $B_{\qqq_1}\ppp_2\cap A\subset\ppp_2$.

\subsubsection{Page 65}\label{65}%

I would change the sentence

``The conditions of Zorn's lemma are clearly satisfied and therefore the set $\Sigma$ has at least one maximal element''

\nn to 

``Assuming $(A,f)\in\Sigma$, the conditions of Zorn's lemma are clearly satisfied and therefore $\Sigma$ has at least one maximal element $(B,g)\ge(A,f)$''.

\subsubsection{Page 65, Lemma 5.20}\label{L5.20}%

The proof of Lemma 5.20 shows:

\nn\emph{Let $K$ be a field, let $B$ be a local subring of $K$ with maximal ideal $\mmm$, let $x$ be a non-zero element of $K$, let $B[x]$ be the subring of $K$ generated by $x$ over $B$, and let $\mmm[x]$ be the extension of $\mmm$ in $B[x]$. Then either $\mmm[x]\ne B[x]$ or $\mmm[x^{-1}]\ne B[x]$.}

\subsubsection{Page 66, Theorem 5.21}%

The statement of the Theorem is:

\begin{thm}[Theorem 5.21 p.~66]
Let $(B,g)$ be a maximal element of $\Sigma$. Then $B$ is a valuation ring of the field $K$.
\end{thm}

Here is a partial converse:

\begin{prop}\label{521}
Let $(B,g)$ be an element of $\Sigma$ such that $B$ is a valuation ring of $K$ and $\Ker g$ is the maximal ideal of $B$. Then $(B,g)$ is maximal.
\end{prop}

The following Lemma will be handy:

\begin{lem}\label{vrok}
Let $A$ be a valuation ring of a field $K$ with maximal ideal $\mmm$, and let $B$ be a ring satisfying $A\subsetneqq B\subset K$. Then $\mmm B=B$.
\end{lem}

\begin{proof}
If $b$ is in $B\setminus A$, then $b^{-1}$, being a non-unit of $A$, is in $\mmm$, and we get $\mmm B\ni b^{-1}b=1$.
\end{proof}

\begin{proof}[Proof of Proposition~\ref{521}] 
If we had $(B,g)<(C,h)$ for some $(C,h)\in\Sigma$, we would get $C=(\Ker g)C$ by Lemma~\ref{vrok}, and $(\Ker g)C\subset\Ker h$ by assumption. 
\end{proof}

\subsubsection{Page 66, proof of Theorem 5.21}\label{521p}%

The proof shows:

\nn\emph{In the setting of Section~\ref{L5.20} above, let $x$ be a non-zero element of $K$. If $\mmm[x]\ne B[x]$, then there is a maximal ideal $\mmm'$ of $B[x]$ such that $B\cap\mmm'=\mmm$ and $B[x]/\mmm'$ is algebraic over $B/\mmm$. If $\mmm[x^{-1}]\ne B[x^{-1}]$, then there is a maximal ideal $\mmm'$ of $B[x^{-1}]$ such that $B\cap\mmm'=\mmm$ and $B[x]/\mmm'$ is algebraic over $B/\mmm$.}

\subsubsection{Page 66, proof of Corollary 5.22}%

Here is the statement of Corollary 5.22:

\begin{cor}[Corollary 5.22]\label{c522}
Let $A$ be a subring of a field $K$. Then the integral closure $A$ of $A$
in $K$ is the intersection of all the valuation rings of $K$ which contain $A$.
\end{cor}

In the proof given in the book I would change the sentences

``Then the restriction to $A$ of the natural homomorphism $A'\to k'$ defines a homomorphism of $A$ into $\Omega$. By (5.21) this can be extended to some valuation ring $B\supseteq A$.''

\nn to 

``By (5.21) the natural homomorphism $A'\to\Omega$ can be extended to some valuation ring $B\supseteq A'$.'' 

Also, it would be slightly better to change ``let $x\notin\overline A$'' to ``let $x\in K\setminus\overline A$'' on the third line of the proof.

\subsection{Exercises}%%

\subsubsection{Page 67, Exercise~5.1}\label{ex5.1}%

\textbf{Statement.} Let $f:A\to B$ be an integral homomorphism of rings. Show that $f^*:\Spec(B)\to\Spec(A)$ is a closed mapping, i.e. that it maps closed sets to closed sets. (This is a geometrical equivalent of (5.10).)

\nn\textbf{Solution.} Use Exercise~3.21iii p.~47, Proposition~5.6i p.~61 and Theorem 5.10 p.~62 of the book.

\subsubsection{Page 67, Exercise~5.2}\label{ex5.2}%

\textbf{Statement.} Let $A$ be a subring of a ring $B$ such that $B$ is integral over $A$, and let $f:A\to\Omega$ be a homomorphism of $A$ into an algebraically closed field $\Omega$. Show that $f$ can be extended to a homomorphism of $B$ into $\Omega$. [Use (5.10).]

\nn\textbf{Solution.} Set $\ppp:=\oo{Ker}f$ and let $\qqq\subset B$ be given by Theorem~5.10 p.~62. Our problem can be summarized as follows: 
$$
\begin{tikzcd}
A/\ppp\ar[r,tail]\ar[d,tail]&B/\qqq\ar[dl,dashrightarrow]\\ 
\Omega.
\end{tikzcd}
$$ 
Writing $K$ and $L$ for the respective fields of fractions of $A/\ppp$ and $B/\qqq$, our problem becomes  
$$
\begin{tikzcd}
K\ar[r,tail]\ar[d,tail]&L\ar[dl,dashrightarrow]\\ 
\Omega.
\end{tikzcd}
$$ 
As $L/K$ is algebraic and $\Omega$ algebraically closed, this problem has a solution.

\subsubsection{Page 67, Exercise~5.3}\label{ex5.3}%

\textbf{Statement.} Let $f:B\to B'$ be a homomorphism of $A$-algebras, and let $C$ be an $A$-algebra. If $f$ is integral, prove that $f\otimes 1:B\otimes_AC\to B'\otimes_AC$ is integral. [This includes (5.6ii) as a special case.]

\nn\textbf{Solution.} Set $D:=(f\otimes1)(B\otimes_AC)$ and let $E$ be the integral closure of $D$ in $B'\otimes_AC$. We have $1\otimes c\in D\subset E$ for $c\in C$ and it is easy to see that $b'\otimes1\in E$ for $b'\in B'$. Then $E$ contains $b'\otimes c$ for $b'\in B',c\in C$, hence $E$ contains $B'\otimes_AC$.

\nn\textbf{A more general question.} Let $C\leftarrow A\to B\to B'$ be morphisms of rings. In this section tensor products are taken over $A$, and, for any morphism of rings $f:X\to Y$, the notation $\overline{X\ }^Y$ means ``integral closure of $f(X)$ in $Y$''. 

The purpose of this section is to show that the morphism $\overline{B\ }^{B'}\otimes C\to\overline{B\otimes C\ }^{B'\otimes C}$ induced by the natural morphism $\overline{B\ }^{B'}\otimes C\to B'\otimes C$ is not always surjective. 

Let $K$ be a field of characteristic $\ne2$ and $x$ an indeterminate, and set 
$$
A:=K[x^2],\qquad B:=K\left[x^2,x\sqrt{x^2-1}\right],
$$
$$
B':=K\left(x^2,x\sqrt{x^2-1}\right),\qquad C:=K[x].
$$ 
We claim 
$$
B'':=\overline{K\left[x^2,x\sqrt{x^2-1}\right]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)}=K\left[x^2,x\sqrt{x^2-1}\right].
$$ 
Note that the two-element set 
$$
\{1,x\sqrt{x^2-1}\}
$$ 
is a $K[x^2]$-basis of $K[x\sqrt{x^2-1}]$, as well as a $K(x^2)$-basis of $K(x\sqrt{x^2-1})$. Using this fact it is easy to see that $B''\cap K(x^2)=K[x^2]$. To prove the claim, let $u$ be in $B''$. We can write 
$$
u=f(x^2)+x\sqrt{x^2-1}\ g(x^2)
$$ 
with $f(x^2)$, $g(x^2)\in K(x^2)$. It suffices to check that $f(x^2)$ and $g(x^2)$ are in $K[x^2]$, or equivalently, that they are in $B''$. We have $v:=f(x^2)-x\sqrt{x^2-1}\ g(x^2)\in B''$, and we successively see that the following elements of $K(x^2)$ are in $K[x^2]$: 
$$
\frac{u+v}2=f(x^2),
$$ 
$$
uv=f(x^2)^2-x^2(x^2-1)\ g(x^2)^2,
$$ 
$$
x^2(x^2-1)\ g(x^2)^2.
$$ 
As $x^2(x^2-1)$ is square-free in $K[x^2]$, we conclude that $g(x^2)$ is also in $K[x^2]$. This completes the proof of the claim. 

Using the claim we get firstly
$$
\overline{B\ }^{B'}\otimes C=\overline{K\left[x^2,x\sqrt{x^2-1}\right]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)}\otimes K[x]
$$
$$
=K\left[x^2,x\sqrt{x^2-1}\right]\otimes K[x]\simeq K\left[x,x\sqrt{x^2-1}\right],
$$ 
and secondly 
$$ 
\overline{B\otimes C\ }^{B'\otimes C}=\overline{K\left[x^2,x\sqrt{x^2-1}\right]\otimes K[x]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)\otimes K[x]}
$$
$$
\simeq\overline{K\left[x,x\sqrt{x^2-1}\right]\ }^{K\left(x,\sqrt{x^2-1}\right)}\subset K\left(x,\sqrt{x^2-1}\right).
$$ 
The element 
$
\sqrt{x^2-1}\in K\left(x,\sqrt{x^2-1}\right)
$ 
is integral over $K\left[x,x\sqrt{x^2-1}\right]$, but does \textbf{not} belong to this ring.

In fact $K\left[x,\sqrt{x^2-1}\right]$ is integrally closed, and thus Dedekind.% comment removed https://docs.google.com/document/d/1NKkrn0BuWcYpctyKk6r9vilhUgX1kuq2_yuWuMwkFS8/edit

\subsubsection{Page 67, Exercise~5.4}%

\textbf{Statement.} Let $A$ be a subring of a ring $B$ such that $B$ is integral over $A$. Let $\nnn$ be a maximal ideal of $B$ and let $\mmm=\nnn\cap A$ be the corresponding maximal ideal of $A$. Is $B_\nnn$ necessarily integral over $A_\mmm$?

\nn[Consider the subring $k[x^2-1]$ of $k[x]$, where $k$ is a field, and let $\nnn=(x-1)$. Can the element $1/(x+1)$ be integral?]

\nn\textbf{Solution.} The last sentence of the hint should be ``Can the element $1/(x+1)$ be integral over $k[x^2-1]_{(x^2-1)}$?'' 

Note that 
$$
k[x^2-1]_{(x^2-1)}=\left\{\frac{f(x^2-1)}{g(x^2-1)}\ \bigg|\ f,g\in k[t],g(0)\ne0\right\},
$$ 
and, if $1/(x + 1)$ was integral over $k[x^2-1]_{(x^2-1)}$, we would get 
$$
\frac1{(x+1)^n}+\frac{f_1(x^2-1)}{g_1(x^2-1)}\frac1{(x+1)^{n-1}}+\cdots+\frac{f_n(x^2-1)}{g_n(x^2-1)}=0
$$ 
[obvious notation]. Multiplying through by $(x+1)^n$ and setting $x=-1$ yields $1=0$. 

\subsubsection{Page 67, Exercise~5.5}\label{ex5.5}%

\textbf{Statement.} Let $A\subset B$ be rings, $B$ integral over $A$.

\nn(i) If $a\in A$ is a unit in $B$ then it is a unit in $A$.

\nn(ii) The Jacobson radical of $A$ is the contraction of the Jacobson radical of $B$. 

\nn\textbf{Solution.} 

\nn(i) Let $a$ be an element of $A$ which has an inverse in $B$. If $a$ was not a unit of $A$, there would be a prime ideal $\ppp$ of $A$ containing $a$, and, by Theorem~5.10 p.~62 of the book, a prime ideal $\qqq$ of $B$ containing $a$, contradicting the invertibility of $a$ in $B$. 

\nn(ii) In the lines below $\mmm$ and $\nnn$ run respectively over the maximal ideals of $A$ and $B$. It suffices to show $A\cap(\bigcap\nnn)=\bigcap\mmm$, that is $\bigcap(A\cap\nnn)=\bigcap\mmm$. But this follows immediately from the second paragraph of Section~\ref{510} p.~\pageref{510}. 

\subsubsection{Page 67, Exercise~5.6}%

\textbf{Statement.} Let $B_1,\ldots,B_n$ be integral $A$-algebras. Show that $\prod B_i$ is an integral $A$-algebra.

\nn\textbf{Solution.} It suffices to show that $(0,\dots,0,b_i,0,\dots,0)$ is integral over $A$, which is easy. 

\subsubsection{Page 67, Exercise~5.7}% 

\textbf{Statement.} Let $A$ be a subring of a ring $B$, such that the set $B\setminus A$ is closed under multiplication. Show that $A$ is integrally closed in $B$.

\nn\textbf{Solution.} Assume by contradiction that $b\in B\setminus A$ is integral over $A$. We have 
$$
b^n+a_1b^{n-1}+\cdots+a_n=0
$$ 
with $a_i\in A$, $n\ge1$, and we can suppose that $n$ is minimum. Setting 
$$
a':=b^{n-1}+a_1b^{n-2}+\cdots+a_{n-1}
$$
we get $a'b=-a_n\in A$, hence $a'\in A$, and the equality 
$$
b^{n-1}+a_1b^{n-2}+\cdots+a_{n-2}b+(a_{n-1}-a')=0
$$ 
contradicts the minimality of $n$. 

\subsubsection{Page 67, Exercise~5.8}%

\textbf{Statement.} (i) Let $A$ be a subring of an integral domain $B$, and let $C$ be the integral closure of $A$ in $B$. Let $f,g$ be monic polynomials in $B[x]$ such that $fg\in C[x]$. Then $f,g$ are in $C[x]$. [Take a field containing $B$ in which the polynomials $f,g$ split into linear factors: say $f=\prod(x-\xi_i)$, $g=\prod(x-\eta_j)$. Each $\xi_i$, and each $\eta_j$ is a root of $fg$, hence is integral over $C$. Hence the coefficients of $f$ and $g$ are integral over $C$.]

\nn(ii) Prove the same result without assuming that $B$ (or $A$) is an integral domain.

\nn\textbf{Solution.} It suffices to prove (ii). To do this we use the argument in the hint: Take a \textbf{ring} $D$ containing $B$ in which the polynomials $f,g$ split into linear factors: say $f=\prod(x-\xi_i)$, $g=\prod(x-\eta_j)$. Each $\xi_i$, and each $\eta_j$ is a root of $fg$, hence is integral over $C$. Hence the coefficients of $f$ and $g$ are integral over $C$. [As suggested in the book, an obvious argument proves the existence of such a ring $D$ if $B$ is a domain, but this argument does not really use the assumption that $B$ is a domain.]

\subsubsection{Page 68, Exercise~5.9}% 

\textbf{Statement.} Let $A$ be a subring of a ring $B$ and let $C$ be the integral closure of $A$ in $B$. Prove that $C[x]$ is the integral closure of $A[x]$ in $B[x]$. [If $f\in B[x]$ is integral over $A[x]$, then
$$
f^m+g_1f^{m-1}+\cdots+g_m= 0\quad (g_i\in A[x]).
$$ 
Let $r$ be an integer larger than the degrees of $f,g_1,\ldots,g_m$, and let $f_1=
f-x^r$, so that 
$$
(f_1+x^r)^m+g_1\cdot(f_1+x^r)^{m-1}+\cdots+g_m=0
$$
or say
$$
f_1^m+h_1f_1^{m-1}+\cdots+h_m=0
$$ 
with $h_i\in A[x]$ and 
$$
h_m=(x^r)^m+(x^r)^{m-1}g_1+\cdots+g_m\in A[x].
$$ 
Now apply Exercise~8 to the polynomials $-f_1$ and $f_2:=f_1^{m-1}+h_1f_1^{m-2}+\cdots+h_{m-1}$.] [I have made minor changes to the statement in the book.]

\nn\textbf{Solution.} The hint given in the book is complete. Note that, in view of the definition of $r$, the polynomials $-f_1$ and $h_m$ are monic. Since $-f_1f_2=h_m$, the polynomial $f_2$ is also monic.

\subsubsection{Page 68, Exercise~5.10}\label{ex5.10}%

\textbf{Statement.} A ring homomorphism $f:A\to B$ is said to have the \textbf{going-up property} (resp. the \textbf{going-down property}) if the conclusion of the going-up theorem (5.11) (resp. the going-down theorem (5.16)) holds for $B$ and its subring $f(A)$.

Let $f^*:\Spec(B)\to\Spec(A)$ be the mapping associated with $f$. 

\nn(i) Consider the following three statements:

(a) $f^*$ is a closed mapping.

(b)  $f$ has the going-up property.

(c) Let $\qqq$ be any prime ideal of $B$ and let $\ppp=\qqq^{\oo c}$. Then $f^*:\Spec(B/\qqq)\to\Spec(A/\ppp)$ is surjective.

Prove that (a)$\iff$(b)$\implies$(c). (See also Chapter~6, Exercise~11.)

\nn(ii) Consider the following three statements:

(a$'$) $f^*$ is an open mapping.

(b$'$) $f$ has the going-down property.

(c$'$) For any prime ideal $\qqq$ of $B$, if $\ppp=\qqq^{\oo c}$, then $f^*:\Spec(B_\qqq)\to\Spec(A_\ppp)$ is surjective.

Prove that (a$'$)$\iff$(b$'$)$\implies$(c$'$). (See also Chapter~7, Exercise~23.)

\nn[To prove that (a$'$)$\iff$(c$'$), observe that $B_\qqq$ is the direct limit of the rings $B_t$ where $t\in B\setminus\qqq$; hence, by Chapter~3, Exercise~26, we have 
$$
f^*(\Spec(B_\qqq))=\bigcap_tf^*(\Spec(B_t))=\bigcap_tf^*(Y_t).
$$ 
Since $Y_t$ is an open neighborhood of $\qqq$ in $Y$, and since $f^*$ is open, it follows that $f^*(Y_t)$ is an open neighborhood of $\ppp$ in $X$ and therefore contains $\Spec(A_\ppp)$.]

\nn\textbf{Solution.} Let us just note that, firstly, it is easy to show that (a) implies (c), and that (b) and (c) are equivalent, and, secondly, for the phrase ``and therefore contains $\Spec(A_\ppp)$'' at the end of the hint, see Section~\ref{ex3.22} p.~\pageref{ex3.22} above.

\subsubsection{Page 68, Exercise~5.11}\label{ex5.11}%

\textbf{Statement.} Let $f:A\to B$ be a flat homomorphism of rings. Then $f$ has the going-down property. [Chapter~3, Exercise~18.]

\nn\textbf{Hint.} The proof of Theorem 5.16 p.~64 of the book shows that the going-down property for $f:A\to B$ is equivalent to the condition that, for all $\qqq\in\Spec(B)$, the natural map $\Spec(B_\qqq)\to\Spec(A_{\qqq^{\oo c}})$ is surjective. 

\subsubsection{Page 68, Exercise~5.12}\label{5.12}%

\textbf{Statement.} Let $G$ be a finite group of automorphisms of a ring $A$, and let $A^G$ denote the subring of $G$-invariants, that is of all $x\in A$ such that $\sigma(x)=x$ for all $\sigma\in G$. Prove that $A$ is integral over $A^G$. [If $x\in A$, observe that $x$ is a root of the polynomial $\prod_{\sigma\in G}(t-\sigma(x))$.]

Let $S$ be a multiplicatively closed subset of $A$ such that $\sigma(S)\subset S$ for all $\sigma\in G$, and let $S^G=S\cap A^G$. Show that the action of $G$ on $A$ extends to an action on $S^{-1}A$, and that $(S^G)^{-1}A^G\simeq(S^{-1}A)^G$.

\nn\textbf{Hints.} The main point is to show that an invariant fraction is equal to a fraction with invariant numerator and denominator. Let $x=\frac as$ be our fraction [obvious notation]. 

\nn\textbf{Step 1.} Set $
t:=\prod_{\sigma\ne1}\sigma(s)$. The product $st$ is invariant, and we have 
$$
x=\frac{a}{s}=\frac{at}{st}\ .
$$ 
In other words we can assume that the denominator $s$ of our fraction $x=\frac as$ is invariant.

\nn\textbf{Step 2.} For $\sigma\in G$ we have $\frac{\sigma(a)}s=\frac as$, that is $\sigma(a)st_\sigma=ast_\sigma$ for some $t_\sigma\in S$. Arguing as in Step~1 we can assume that the $t_\sigma$ are invariant. 

\nn\emph{Details.} Set $u_\sigma:=\prod_{\tau\ne1}\tau(t_\sigma)$. Then $t_\sigma u_\sigma$ is invariant, and we get $\sigma(a)st_\sigma u_\sigma=ast_\sigma u_\sigma$, and we can indeed assume that the $t_\sigma$ are invariant.

\nn\textbf{Step 3.} By a similar trick we can assume that the $t_\sigma$ are all equal to some $t\in S^G$, and we get $ast=\sigma(a)st=\sigma(ast)$, and thus 
$$
\frac{a}{s}=\frac{ast}{s^2t}\ .
$$ 
\nn\emph{Details.} Setting $t:=\prod_\sigma t_\sigma$ and $v_\sigma:=\prod_{\tau\ne\sigma}t_\tau$, we get $t=t_\sigma v_\sigma$ and 
$$
\sigma(a)st=\sigma(a)st_\sigma v_\sigma=ast_\sigma v_\sigma=ast.
$$ 

\subsubsection{Page 68, Exercise~5.13}%

\textbf{Statement.} In the situation of Exercise~12, let $\ppp$ be a prime ideal of $A^G$, and let $P$ be the set of prime ideals of $A$ whose contraction is $\ppp$. Show that $G$ acts transitively on $P$. In particular, $P$ is finite.

\nn[Let $\ppp_1,\ppp_2\in P$ and let $x\in\ppp_1$. Then $\prod_\sigma\sigma(x)\in\ppp_1\cap A^G=\ppp\subset\ppp_2$, hence $\sigma(x)\in\ppp_2$ for some $\sigma\in G$. Deduce that $\ppp_1$ is contained in $\bigcup_\sigma\sigma(\ppp_2)$, and then apply (1.11) and (5.9).]

\nn\textbf{Solution.} We follow the hint given in the book.

Let $\qqq,\qqq'\in P$ and $a\in\qqq'$. We have  
$$
\prod_\sigma\sigma(a)\in\qqq'\cap A^G=\ppp=\qqq\cap A^G\subset\qqq.
$$ 
Hence there is a $\sigma_a\in G$ such that $\sigma_a(a)\in\qqq$, and thus $a\in\sigma_a^{-1}(\qqq)$. This implies $\qqq'\subset\bigcup_\sigma\sigma(\qqq)$, and thus, by Proposition~\ref{p1.11i} p.~\pageref{p1.11i}, $\qqq'\subset\sigma(\qqq)$ for some $\sigma\in G$. 

It suffices to prove $\qqq'=\sigma(\qqq)$.

As 
$$
\sigma(\qqq)\cap A^G=\sigma\left(\qqq\cap\sigma^{-1}(A^G)\right)=\sigma\left(\qqq\cap A^G\right)=\sigma(\ppp)=\ppp=\qqq'\cap A^G,
$$ 
Corollary 5.9 p.~61 of the book [see Section~\ref{c5.9} p.~\pageref{c5.9}] implies $\qqq'=\sigma(\qqq)$, as was to be shown.

\subsubsection{Page 69, Exercise~5.14}%

\textbf{Statement.} Let $A$ be an integrally closed domain, $K$ its field of fractions and $L$ a finite normal separable extension of $K$. Let $G$ be the Galois group of $L$ over $K$ and let $B$ be the integral closure of $A$ in $L$. Show that $\sigma(B)=B$ for all $\sigma\in G$, and that $A=B^G$.

\nn\textbf{Hints.} We clearly have $\sigma(B)\subset B$ for all $\sigma\in G$, hence $B\subset\sigma^{-1}(B)$ for all $\sigma\in G$, hence $B\subset\sigma(B)$ for all $\sigma\in G$, hence $\sigma(B)=B$ for all $\sigma\in G$. The inclusions $A\subset B^G$ and $B^G\subset L^G\cap B=K\cap B$ are obvious. If $x$ is in $K\cap B$, then $x$ is $K$ and is integral over $A$, hence $x$ is in $A$.

\subsubsection{Page 69, Exercise~5.15}%

\textbf{Statement.} Let $A$ be an integrally closed domain, $K$ its field of fractions and $L$ any finite extension field of $K$, and let $B$ be the integral closure of $A$ in $L$. Show that, if $\ppp$ is any prime ideal of $A$, then the set of prime ideals $\qqq$ of $B$ which contract to $\ppp$ is finite [in other words, that $\Spec(B)\to\Spec(A)$ has finite fibers].

\nn[Reduce to the two cases (a) $L$ separable over $K$ and (b) $L$ purely inseparable over $K$. In case (a), embed $L$ in a finite normal separable extension of $K$, and use Exercises 13 and 14. In case (b), if $\qqq$ is a prime ideal of $B$ such that $\qqq\cap A =\ppp$, show that $\qqq$ is the set of all $x\in B$ such that $x^{p^m}\in\ppp$ for some $m\ge0$, where $p$ is the characteristic of $K$, and hence that $\Spec(B)\to\Spec(A)$ is bijective in this case.]

\nn\textbf{Hints.} (a) $\Spec(B)\to\Spec(A)$ has finite \textbf{nonempty} fibers.

\nn(b) Let $L/K$ be purely inseparable of characteristic $p>0$, and let $\ppp$ be a prime ideal of $A$. By Theorem 5.10 p.~62 of the book, there is a prime ideal $\qqq$ of $B$ lying above $\ppp$. If $b\in B$, $n\in\mathbb N$ and $b^{p^n}\in\ppp$, then $b\in\qqq$. If $x\in\qqq$, then $x^{p^n}\in K$ for some $n\in\mathbb N$, and thus $x^{p^n}\in K\cap\qqq=\ppp$. We conclude that $\qqq$ is the set of those $b\in B$ such that $b^{p^n}\in\ppp$ for some $n\in\mathbb N$ [even if the extension is of infinite degree]. In particular the map $\Spec(B)\to\Spec(A)$ is bijective.

\subsubsection{Page 69, Exercise~5.16, NNT}\label{ex5.16}%

NNT stands for \textbf{Noether's Normalization Theorem}.

The purpose of this section is to review the following closely related statements: Noether's Normalization Theorem, Zariski's Lemma, and the Nullstellensatz. 

Recall the general notation $A_s:=A[s^{-1}]$.%

\paragraph{Noether's Normalization Theorem.}%\label{parnnt}%

\begin{thm}[Noether's Normalization Theorem]\label{thmnnt}
Let $A\subset B$ be an inclusion of nonzero rings such that $B$ a finitely generated $A$-algebra. Then there exist a nonzero element $s$ in $A$, a nonnegative integer $n$, and elements $x_1,\dots,x_n$ in $B_s$ which are algebraically independent over $A_s$, such that $B_s$ is a finitely generated module over $A_s[x_1,\dots,x_n]$. 
\end{thm}
\begin{proof} 
Let $y_1,\dots,y_m\in B$ generate $B$ as an $A$-algebra: $B=A[y_1,\dots,y_m]$. We argue by induction on $m$. If $m=0$ or if the $y_i$ are algebraically independent over $A$, there is nothing to prove.

Thus we can assume that $m\ge1$; that the statement holds with $m$ replaced by $m-1$; and that there is a non-constant polynomial $f\in A[Y_1,\dots,Y_m]$, where the $Y_i$ are indeterminates, such that $f(y_1,\dots,y_m)=0$. 

We claim 

\nn$(\star)$ There exist a nonzero $t$ in $A$ and elements $z_1$, \dots, $z_{m-1}$ in $B$ such that $B_t$ is a finitely generated $A_t[z_1,\dots,z_{m-1}]$-module. 

We start the proof of $(\star)$. 

Let $r$ be an integer larger than the degree of $f$, and, for any monomial $u\in A[Y_1,\dots,Y_m]$ occurring in $f$ (with a nonzero coefficient), write $u'$ for the monomial $u$ \emph{viewed as a polynomial in the ring} 
$$
\bigg(A\left[Y_2-Y_1^r,\dots,Y_m-Y_1^{r^{m-1}}\right]\bigg)[Y_1].
$$ 
If $u=Y_1^{\alpha_1}\cdots Y_m^{\alpha_m}$, then $u'$ is monic of degree $\alpha_1+\alpha_2r+\cdots+\alpha_mr^{m-1}$. This implies that $u'$ is monic, and that we have $\deg(u')\ne\deg(v')$ for any two distinct such monomials $u$ and $v$. 

As a result, there is a nonzero $t$ in $A$, an integer $d\ge1$, and a polynomial 
$$
g\in\bigg(A\left[Y_2-Y_1^r,\dots,Y_m-Y_1^{r^{m-1}}\right]\bigg)[Y_1]
$$ 
of degree less than $d$, such that $f=tY_1^d+g$. 

In particular, $y_1$ is integral over the ring $C:=A_t[z_1,\dots,z_{m-1}]$ with $z_i:=y_{i+1}-y_1^{r^i}$, and $B_t=C[y_1]$ is a finitely generated $C$-module. This proves $(\star)$.

Let us prove the Theorem.

We can assume that $A_t$ is nonzero. By the inductive hypothesis applied to the inclusion 
$$
A_t\subset A_t[z_1,\dots,z_{m-1}],
$$ 
there exist a nonzero element $u$ in $A_t$, a nonnegative integer $n$, and elements $x_1$, \dots, $x_n$ in 
$$
A_t[z_1,\dots,z_{m-1}]_u=(A_t)_u[z_1,\dots,z_{m-1}]
$$ 
which are algebraically independent over $(A_t)_u$, such that $(A_t)_u[z_1,\dots,z_{m-1}]
$ is a finitely generated $(A_t)_u[x_1,\dots,x_n]$-module. 

Now $u=v/t^i$ for some nonzero $v$ in $A$ and some integer $i\ge0$, and we have $(A_t)_u=A_{tv}$. 

Setting $s:=tv$, we see that $s\ne0$, that the elements $x_1,\dots,x_n\in A_s[z_1,\dots,z_{m-1}]$ are algebraically independent over $A_s$, and that $A_s[z_1,\dots,z_{m-1}]$ is a finitely generated $A_s[x_1,\dots,x_n]$-module. 

Recall that $B_t$ is a finitely generated $A_t[z_1,\dots,z_{m-1}]$-module [see $(\star)$]. 

In particular $B_s$ is a finitely generated module over the ring $A_s[z_1,\dots,z_{m-1}]$, ring which is itself, as we have just seen, a finitely generated module over the ring $A_s[x_1,\dots,x_n]$. 

This implies that $B_s$ is a finitely generated $A_s[x_1,\dots,x_n]$-module, as desired.
\end{proof}% https://docs.google.com/document/d/1KsGGeQkmO40nOVK3_LVgBWoxS6DiRJsDygE6UnkFWjc/edit
% https://docs.google.com/document/d/1oTZtahmZAPeNJrbs65b2IzgWHBKkWBjzasbWtsHpWDA/edit old versions
%[Added later: An approach which I find better is expounded in Mel Hochster, Noether's normalization and Hilbert’s Nullstellensatz, \href{http://www.math.lsa.umich.edu/~hochster/615W10/supNoeth.pdf}{http://www.math.lsa.umich.edu/$\sim$hochster/615W10/supNoeth.pdf}\ ]

\paragraph{Zariski's Lemma.}\label{ZL}%

Here is a statement of \textbf{Zariski's Lemma}:

\nn(ZL) \emph{Let $k$ be a field, $A$ a finitely generated $k$-algebra. Let $\mmm$ be a maximal ideal of $A$. Then the field $A/\mmm$ is a finite algebraic extension of $k$. In particular, if $k$ is algebraically closed then $A/\mmm\simeq k$, that is, the natural morphism $k\to A/\mmm$ is an isomorphism.}

In view of Proposition~5.7 p.~61 of the book, Zariski's Lemma follows immediately from Noether's Normalization Theorem. 

Here is an easy consequence of (ZL):

\nn(ZL2) \emph{Set $A:=k[t_1,\dots,t_n]$ where $k$ is an algebraically closed field and the $t_i$ are indeterminates, let $\mmm$ be a maximal ideal of $A$, regard $k$ as a subring of $A$, identify $k$ to $A/\mmm$ via the isomorphism in (ZL), let $\pi:A\to k$ be the canonical projection, and set $x_i:=\pi(t_i)\in k\subset A$, that is $x_i\in k$ and $\pi(x_i)=\pi(t_i)$. Also write $x:=(x_1,\dots,x_n)\in k^n$. Then we have:}

(a) $\pi(f)=f(x)$ \emph{for all $f$ in $A$,}

(b) $A=k[t_1-x_1,\dots,t_n-x_n],$

(c) $\mmm=(t_1-x_1,\dots,t_n-x_n)$.

\begin{proof} 
Since Statement (a) holds for $f=t_i$ and the $t_i$ generate $A$ as a $k$-algebra, it holds in general. Statement (b) is clear. To prove (c) note that we have $\mmm=\{f\in A\ |\ f(x)=0\}=(t_1-x_1,\dots,t_n-x_n)$, the two equalities following respectively from (a) and (b).
\end{proof}

\paragraph{Nullstellensatz.}\label{null}%

Here is a statement of the \textbf{Nullstellensatz} [see Exercise~14 of Chapter~7, Section~\ref{ex7.14} p.~\pageref{ex7.14}]:

\nn(N) \emph{Let $k$ be an algebraically closed field, let $A$ denote the polynomial ring $k[t_1,\dots,t_n]$ and let $\aaa$ be an ideal in $A$. Let $X$ be the variety in $k^n$ defined by the ideal $\aaa$, so that $X$ is the set of all $x=(x_1,\dots,x_n)\in k^n$ such that $f(x)=0$ for all $f\in\aaa$. Let $I(X)$ be the ideal of $X$, i.e. the ideal of all polynomials $g\in A$ such that $g(x)=0$ for all $x\in X$. Then $I(X)=r(\aaa)$.}

\begin{proof} 
The inclusion $r(\aaa)\subset I(X)$ is clear. Let us prove $I(X)\subset r(\aaa)$. 

(ZL2) implies that $I(X)$ is the intersection of all the maximal ideals of $A$ containing $\aaa$. As $r(\aaa)$ is the intersection of all the prime ideals of $A$ containing $\aaa$, we can assume that $\aaa$ is a prime ideal $\ppp$. Then the statement follows immediately from Exercises 5.23 and 5.24 p.~71 of the book. Here is a slightly different argument:

Let $f$ be in $A\setminus\ppp$ and set $A_f:=A[1/f]$.

It suffices to prove the claim below.

\nn\textbf{Claim:} \emph{There is a maximal ideal of $A$ which does not contain} $f$. 

We give two proofs of the claim.

\nn\textbf{Proof 1.} The extension $\ppp^{\oo e}$ of $\ppp$ in $A_f$ being clearly a proper ideal, there is a maximal ideal $\mmm\subset A_f$ containing $\ppp^{\oo e}$. 

Note successively that $f\notin\mmm$; that $\qqq:=\mmm\cap A$ is a prime ideal of $A$ which does not contain $f$; that $A_f/\mmm$ is isomorphic to $k$ by (ZL); and that the monomorphism of $k$-algebras $0\ne A/\qqq\mono A_f/\mmm\simeq k$ implies that $\qqq$ is a maximal ideal of $A$.

\nn\textbf{Proof 2.} By Noether's Normalization Theorem applied to the $k$-algebra $A_f$, there are elements $u_1,\dots,u_m$ of $A_f$ which are algebraically independent over $k$, such that $A_f$ is integral over 
$$
k[u_1,\dots,u_m].
$$ 
By Exercise~5.2 p.~67 of the book [see Section~\ref{ex5.2} p.~\pageref{ex5.2} above] the $k$-algebra morphism 
$$
\varphi:k[u_1,\dots,u_m]\to k
$$ 
which maps $u_i$ to $0$ extends to a $k$-algebra morphism $\Phi:A_f\to k$. As $\Phi(f)\ne0$, we see that $A\cap\oo{Ker}\Phi$ is a maximal ideal of $A$ which does not contain $f$.
\end{proof}%https://docs.google.com/document/d/1YYUDEGhoImy-b_Lx9foGoetelzzXbN1IiNbpo7pXh98/edit comment 180522
%The assumption that $B$ is a domain (instead of an arbitrary ring) is not used. For another approach, see the following reference (already given in Section~\ref{parnnt} p.~\pageref{parnnt}): Mel Hochster, Noether's normalization and Hilbert’s Nullstellensatz, \href{http://www.math.lsa.umich.edu/~hochster/615W10/supNoeth.pdf}{http://www.math.lsa.umich.edu/$\sim$hochster/615W10/supNoeth.pdf}

\subsubsection{Page 69, Exercise~5.17}\label{ex5.17}%

The Weak Nullstellensatz is the statement that the affine algebraic variety attached to a \textbf{proper} ideal of $k[t_1,\ldots,t_n]$ is nonempty. It is \textbf{not} the trivial statement $I(X)\ne(1)\implies X\ne\varnothing$. The Weak Nullstellensatz follows immediately from (ZL2) above [Section~\ref{ZL}].

\subsubsection{Page 70, Exercise~5.18}%\label{ex5.18}%

The purpose of this Exercise~is to give an alternate proof of Zariski's Lemma [Section~\ref{ZL}]. The hint given in the book is fairly complete.

\subsubsection{Page 70, Exercise~5.19}%

The purpose of this exercise is to deduce the result of Exercise~17 from Exercise~18, that is to deduce the Weak Nullstellensatz from Zariski's Lemma. As indicated in Section~\ref{ex5.17} above, the Weak Nullstellensatz follows immediately from (ZL2) [see Section~\ref{ZL}].

\subsubsection{Page 70, Exercise~5.20}%

\textbf{Statement.} Let $A$ be a subring of an integral domain $B$ such that $B$ is finitely generated over $A$. Show that there exists $t\ne0$ in $A$ and elements $y_1,\ldots,y_n$ in $B$, algebraically independent over $A$ and such that $B_t$ is integral over $A[y_1,\ldots,y_n]_t$.

\nn\textbf{Solution.} By Noether's Normalization Theorem [Theorem~\ref{thmnnt} p.~\pageref{thmnnt}] above %as stated in Section~\ref{parnnt} p.~\pageref{parnnt} above, 
there exist a nonzero element $s$ in $A$ and elements $x_1,\dots,x_n$ in $B_s$ which are algebraically independent over $A_s$, such that $B_s$ is a finitely generated module over $A_s[x_1,\dots,x_n]$. There is a power $t$ of $s$ and elements $y_1,\ldots,y_n$ in $B$ such that $x_i=y_i/t$. Then the $y_i$ are algebraically independent over $A$ and we have $B_t=B_s$ and $A[y_1,\ldots,y_n]_t=A_s[x_1,\dots,x_n]$.

\subsubsection{Page 70, Exercise~5.21}\label{ex5.21}%

\textbf{Statement.} Let $A$ be a subring of an integral domain $B$ such that $B$ is finitely generated over $A$. Show that there exists $t\ne0$ in $A$ such that, if $\Omega$ is an algebraically closed field and $f:A\to\Omega$ is a homomorphism for which $f(t)\ne0$, then $f$ can be extended to a homomorphism $B\to\Omega$. [With the notation of Exercise~20, $f$ can be extended first of all to $A[y_1,\ldots,y_n]$, for example by mapping each $y_i$ to $0$; then to $B_t$ (because $f(t)\ne0$), and finally to $B_t$ (by Exercise~2, because $B_t$ is integral over $A[y_1,\ldots,y_n]_t$).]

\nn\textbf{Solution.} Omitted. [The hint is fairly complete.]

Here is a corollary:

\nn\emph{In the setting of the exercise, if $i:A\to B$ denotes the inclusion, then we have $X_t\subset i^*(\Spec(B))$. In particular the interior of $i^*(\Spec(B))$ is nonempty.} 

\nn Proof: given $\ppp\in X_t$ pick an algebraically closed field $\Omega$ containing $A/\ppp$.

\subsubsection{Page 70, Exercise~5.22}\label{ex5.22}%

\textbf{Statement.} Let $A,B$ be as in Exercise~20. If the Jacobson radical of $A$ is zero, then so is the Jacobson radical of $B$.\\ 
\nn[Let $v\ne0$ be an element of $B$. We have to show that there is a maximal ideal of $B$ which does not contain $v$. By applying Exercise~21 to the ring $B_v$ and its subring $A$, we obtain an element $t\ne0$ in $A$. Let $\mmm$ be a maximal ideal of $A$ such that $t\notin\mmm$, and let $k=A/\mmm$. Then the canonical mapping $A\to k$ extends to a homomorphism $g$ of $B_v$ into an algebraic closure $\Omega$ of $k$. Show that $g(v)\ne0$ and that $\oo{Ker}(g)\cap B$ is a maximal ideal of $B$.]

\nn\textbf{Solution.} Note that we have $k\subset g(B)\subset\Omega$. By Proposition~5.7 p.~61 of the book, $g(B)$ is a field.

\subsubsection{Page 71, Exercise~5.23}% 

\textbf{Statement.} Let $A$ be a ring. Show that the following are equivalent:

\nn(i) Every prime ideal in $A$ is an intersection of maximal ideals.

\nn(ii) In every homomorphic image of $A$ the nilradical is equal to the Jacobson radical.

\nn(iii) Every prime ideal in $A$ which is not maximal is equal to the intersection of the prime ideals which contain it strictly.

\nn[The only hard part is (iii)$\implies$(i). Suppose (i) false, then there is a prime ideal which is not an intersection of maximal ideals. Passing to the quotient ring, we may assume that $A$ is an integral domain whose Jacobson radical $\RRR$ is not zero. Let $f$ be a non-zero element of $\RRR$. Then $A_f\ne0$, hence $A_f$ has a maximal ideal, whose contraction in $A$ is a prime ideal $\ppp$ such that $f\notin\ppp$ and which is maximal with respect to this property. Then $\ppp$ is not maximal and is not equal to the intersection of the prime ideals strictly containing $\ppp$.]

A ring $A$ with the three equivalent properties above is called a \textbf{Jacobson ring}.

The hint is fairly complete.

\subsubsection{Page 71, Exercise~5.24}%

\textbf{Statement.} Let $A$ be a Jacobson ring (Exercise~23) and $B$ an $A$-algebra. Show that if $B$ is either (i) integral over $A$ or (ii) finitely generated as an $A$-algebra, then $B$ is Jacobson. [Use Exercise~22 for (ii).]

In particular, every finitely generated ring, and every finitely generated algebra over a field, is a Jacobson ring.

\nn\textbf{Solution.} Part (i). Let us prove 

\nn\emph{If $A\subset B$ is an integral extension of rings and if $A$ is Jacobson, then $B$ is Jacobson.}

\nn Proof. By Proposition~5.6ii p.~61 of the book we can assume that $B$ is a domain. Let $\bbb\subset B$ be the Jacobson radical of $B$. It suffices to prove $\bbb=(0)$. We have $\bbb^{\oo c}=(0)$ by Exercise~5.5ii p.~67 of the book [see Section~\ref{ex5.5} p.~\pageref{ex5.5} above], and the version of Corollary 5.9 p.~61 of the book proved in Section~\ref{c5.9} p.~\pageref{c5.9}, implies $\bbb=(0)$. $\square$

Part (ii) follows from Exercise~5.22 p.~70 of the book [Section~\ref{ex5.22} p.~\pageref{ex5.22} above].

\subsubsection{Page 71, Exercise~5.25}%

\textbf{Statement.} Let $A$ be a ring. Show that the following are equivalent: 

\nn(i) $A$ is a Jacobson ring;

\nn(ii) Every finitely generated $A$-algebra $B$ which is a field is finite over $A$.

\nn[(i)$\implies$(ii). Reduce to the case where $A$ is a subring of $B$, and use Exercise~21. If $s\in A$ is as in Exercise~21, then there exists a maximal ideal $\mmm$ of $A$ not containing $s$, and the homomorphism $A\to A/\mmm=k$ extends to a homomorphism $g$ of $B$ into an algebraic closure of $k$. Since $B$ is a field, $g$ is injective, and $g(B)$ is algebraic over $k$, hence finite algebraic over $k$.

\nn(ii)$\implies$(i). Use criterion (iii) of Exercise~23. Let $\ppp$ be a prime ideal of $A$ which is not maximal, and let $B=A/\ppp$. Let $f$ be a non-zero element of $B$. Then $B_f$ is a finitely generated $A$-algebra. If it is a field it is finite over $B$, hence integral over $B$ and therefore $B$ is a field by (5.7). Hence $B_f$ is not a field and therefore has a non-zero prime ideal, whose contraction in $B$ is a non-zero ideal $\ppp'$ such that $f\notin\ppp'$.]

\nn\textbf{Solution.} The hint is fairly complete. [There is a typo in the book: ``the algebraic closure of $k$'' instead of ``an algebraic closure of $k$''.]

\subsubsection{Page 71, Exercise~5.26}%

The first two sentences are

``Let $X$ be a topological space. A subset of $X$ is \textbf{locally closed} if it is the intersection of an open set and a closed set, or equivalently if it is open in its closure.'' 

Let us prove this equivalence.

Let $U$ be open and $C$ closed. It suffices to show $(\star)\ U\cap C=U\cap\overline{U\cap C}$. 

\nn Proof of $(\star)$. We have:

\nn$\bullet\ U\cap C\subset U\cap\overline{U\cap C}$ because $U\cap C\subset U$ and $U\cap C\subset\overline{U\cap C}$,

\nn$\bullet\ U\cap\overline{U\cap C}\subset U\cap C$ because $\overline{U\cap C}\subset\overline C=C$. $\square$ 

\paragraph{Part 1.}\phantom0

\nn\textbf{Statement.} Show that the three conditions below on a subset $X_0$ of a topological space $X$ are equivalent:

\nn(1) Every non-empty locally closed subset of $X$ meets $X_0$;

\nn(2) For every closed set $C$ in $X$ we have $\overline{X_0\cap C}=C$;

\nn(3) The mapping $U\mapsto X_0\cap U$ of the collection of open sets of $X$ onto the collection of open sets of $X_0$ is bijective.

A subset $X_0$ satisfying these conditions is said to be \textbf{very dense} in $X$. 

\nn\textbf{Solution.} Condition (3) is clearly equivalent to 

\nn(3') The map $C\mapsto X_0\cap C$ from the set of closed subsets of $X$ to the set of closed subsets of $X_0$ is bijective.

This is also equivalent to 

\nn(3'') The map $C\mapsto X_0\cap C$ from the set of closed subsets of $X$ to the set of closed subsets of $X_0$ is injective.

\nn(1)$\implies$(2): If there is a closed subset $C$ of $X$ such that $\overline{X_0\cap C}\ne C$, then $L:=C\setminus\overline{X_0\cap C}$ is  a nonempty locally closed subset satisfying $X_0\cap L=\varnothing$. 

\nn(2)$\implies$(3''): (2) means that $C'\mapsto\overline{C'}$ is a left inverse to the map in (3''). 

\nn(3)$\implies$(1): for $U,V$ open and $V\subset U$ the equality $X_0\cap(U\setminus V)=\varnothing$ implies $X_0\cap U=X_0\cap V$. 

\paragraph{Part 2.}\phantom0

\nn\textbf{Statement.} If $A$ is a ring, show that the following are equivalent:

\nn(i) $A$ is a Jacobson ring;

\nn(ii) The set of maximal ideals of $A$ is very dense in $\Spec(A)$;

\nn(iii) Every locally closed subset of $\Spec(A)$ consisting of a single point is closed.

\nn[(ii) and (iii) are geometrical formulations of conditions (ii) and (iii) of Exercise~23.]

\nn\textbf{Solution.} 

\nn$\bu$ Proof of (i) $\iff$ (ii). 

\nn Hint: Let $M\subset\Spec(A)$ be the set of maximal ideals. In view of Condition~(2) above, it suffices to show that (a) and (b) below are equivalent.

\nn(a) For all ideal $\aaa$ of $A$ we have $\RRR(A/\aaa)\subset\NNN(A/\aaa)$.

\nn(b) For all ideal $\aaa$ of $A$ we have $V(\aaa)\subset\overline{V(\aaa)\cap M}$.

Let $\bbb(\aaa)$ be the intersection of the maximal ideals containing $\aaa$. In fact we have\medskip 

\centerline{(a) $\iff$ $[\bbb(\aaa)\subset r(\aaa)]\ \forall\ \aaa$}\bigskip

\centerline{$\iff$ $[\ppp\supset\aaa\implies\ppp\supset\bbb(\aaa)]\ \forall\ \aaa\ \forall\ \ppp$ $\iff$ (b),}\medskip 

where ``$\forall\ \aaa$'' means ``for all ideal $\aaa$ of $A$'' and ``$\forall\ \ppp$'' means ``for all prime ideal $\ppp$ of $A$''.\medskip 

\nn$\bu$ Proof of (i) $\iff$ (iii). 

It suffices to show that (c) and (d) below are equivalent.

\nn(c) Every non-maximal prime ideal $\ppp$ is the intersection of the strictly larger prime ideals.

\nn(d) If $\ppp$ is a prime ideal and if the singleton $\{\ppp\}$ is locally closed, then $\ppp$ is maximal.

\nn(c)$\implies$(d): Assume by contradiction that the singleton $\{\ppp\}$ is locally closed and $\ppp$ is not maximal, and let $Q$ be the set of all those prime ideals of $A$ which are strictly larger than $\ppp$. We have 
\begin{equation}\label{pppqqq}
\ppp=\bigcap_{\qqq\in Q}\qqq
\end{equation} 
and  
\begin{equation}\label{pppvaaa}
\{\ppp\}=V(\aaa)\setminus V(\bbb)
\end{equation} 
for some ideals $\aaa$ and $\bbb$. Let $\qqq$ be in $Q$. Clearly $\qqq$ contains $\aaa$. Equality~\eqref{pppvaaa} implies that $\qqq$ contains $\bbb$. As $\qqq$ is an arbitrary element of $Q$, \eqref{pppqqq} entails that $\ppp$ contains $\bbb$, contradicting \eqref{pppvaaa}.

\nn(d)$\implies$(c): Let $\ppp$ be a non-maximal prime ideal, and let $\bbb$ be the intersection of those prime ideals which are strictly larger than $\ppp$, and assume by contradiction that $\bbb$ is strictly larger than $\ppp$. Let $L$ be the locally closed subset $V(\ppp)\setminus V(\bbb)$ of $\Spec(A)$. Then $\ppp$ is in $L$, that is $\{\ppp\}\subset L$. Since $\{\ppp\}$ is not locally closed by (d), we have $\{\ppp\}\ne L$, that is $\{\ppp\}\subsetneqq L$. Thus there is a $\qqq$ in $L\setminus\{\ppp\}$, and we get $\qqq\supsetneqq \ppp$ and $\qqq\not\supset\bbb$, and the definition of $\bbb$ implies $\qqq\supset\bbb$, contradiction.

\subsubsection{Page 72, Exercise~5.27}\label{527}% previous version https://docs.google.com/document/d/1pa9JTIG_IbvdERz34Me3c0nSgSFz-lnjuJCYOo1yYrQ/edit

\textbf{Statement.} Let $A,B$ be two local rings. $B$ is said to \textbf{dominate} $A$ if $A$ is a subring of $B$ and the maximal ideal $\mmm$ of $A$ is contained in the maximal ideal $\nnn$ of $B$ [or, equivalently, if $\mmm=\nnn\cap A$]. Let $K$ be a field and let $\Sigma$ be the set of all local subrings of $K$. If $\Sigma$ is ordered by the relation of domination, show that $\Sigma$ has maximal elements and that $A\in\Sigma$ is maximal if and only if $A$ is a valuation ring of $K$. [Use (5.21).]

\nn\textbf{Solution.} For any algebraically closed field $\Omega$ we write $\Phi(K,\Omega)$ for the poset denoted by $\Sigma$ on page 65 of the book [see Section~\ref{65} p.~\pageref{65}]. [More precisely, $\Phi(K,\Omega)$ is the set of of all pairs $(A,f)$, where $A$ is a subring of $K$ and $f$ is a homomorphism of $A$ into $\Omega$, and we endow $\Phi(K,\Omega)$ with the partial order defined in the book.] Let $\Sigma(K)$ be the set of all local subrings of $K$. We equip $\Sigma(K)$ with the domination partial order. We leave it to the reader to check that $\Sigma(K)$ does have maximal elements.

Let $(A,\mmm)$ be in $\Sigma(K)$. It suffices to show that $(A,\mmm)$ is maximal in $\Sigma(K)$ if and only if $A$ is a valuation ring of $K$.

Assume that $A$ is a valuation ring of $K$ and that $(B,\nnn)$ is a maximal element of $\Sigma(K)$ with $(A,\mmm)\le(B,\nnn)$. Then we have $\mmm B\subset\nnn$, and Lemma~\ref{vrok} p.~\pageref{vrok} implies $B=A$. 

Assume now that $(A,\mmm)$ is maximal in $\Sigma(K)$. Let $\Omega$ be an algebraic closure of $A/\mmm$, let $f:A\to\Omega$ the obvious morphism, and let $(B,g)$ be a maximal element of $\Phi(K,\Omega)$ such that $(A,f)\le(B,g)$. As $B$ is a valuation ring of $K$ by Theorem 5.21 p.~66 of the book, it suffices to show $B=A$. Lemma~5.19 p.~65 of the book implies that $B$ is local and that $\Ker g$ is its maximal ideal. As $\mmm=\Ker f\subset\Ker g$, we see that $B$ dominates $A$, and thus that $B=A$, as desired.

\subsubsection{Page 72, Exercise~5.28}\label{528}%

\textbf{Statement.} Let $A$ be an integral domain, $K$ its field of fractions. Show that the following are equivalent:

\nn(1) $A$ is a valuation ring of $K$.

\nn(2) If $\aaa, \bbb$ are any two ideals of $A$, then either $\aaa\subset\bbb$ or $\bbb\subset\aaa$.

Deduce that if $A$ is a valuation ring and $\ppp$ is a prime ideal of $A$, then $A_\ppp$  and $A/\ppp$ are valuation rings of their fields of fractions.

\nn\textbf{Hint.} It suffices to show that the following statements are equivalent:

\nn(a) $A$ is \textbf{not} a valuation ring of $K$,

\nn(b) there are incomparable principal ideals of $A$,

\nn(c) there are incomparable ideals of $A$.

Clearly (b) implies (c). There are $a,b\in A\setminus\{0\}$ such that $\frac ab$ and $\frac ba$ are not in $A$ if and only if the principal ideals $(a)$ and $(b)$ are incomparable. This implies that (a) and (b) are equivalent, and it only remains to show that (c) implies (b). If $\aaa$ and $\bbb$ are incomparable ideals, if $a$ is in $\aaa\setminus\bbb$ and if $b$ is in $\bbb\setminus\aaa$, then the principal ideals $(a)$ and $(b)$ are incomparable.

\subsubsection{Page 72, Exercise~5.29}%

\textbf{Statement.} Let $A$ be a valuation ring of a field $K$. Show that every subring of $K$ which contains $A$ is a local ring of $A$ [i.e. is of the form $A_\ppp$ for some prime ideal $\ppp\subset A$].

\nn\textbf{Solution.} Let $B$ be the unnamed ring in the statement. By Proposition~5.18 (i) and (ii) p.~65 of the book, $B$ is local. Let $\nnn\subset B$ be the maximal ideal and set $\ppp:=A\cap\nnn$. Then we have $A_\ppp=B$. Indeed, the inclusion $A_\ppp\subset B$ is clear. Let $b\in B\setminus A$. It suffices to show $b\in A_\ppp$. We have $b^{-1}\in A\subset B$. As $b^{-1}$ is a unit of $B$, it is not in $\nnn$, and thus not in $\ppp$, hence $b=1/b^{-1}\in A_\ppp$.

\subsubsection{Page 72, Exercise~5.30}%

\textbf{Statement.} Let $A$ be a valuation ring of a field $K$. The group $U$ of units of $A$ is a subgroup of the multiplicative group $K^*$ of $K$.

Let $\Gamma=K^*/U$. If $\xi,\eta\in\Gamma$ are represented by $x,y\in K$, define $\xi\ge\eta$ to mean $xy^{-1} A$. Show that this defines a total ordering on $\Gamma$ which is compatible with the group structure (i.e., $\xi\ge\eta\implies\xi\omega\ge\eta\omega$ for all $\omega\in\Gamma$). In other words, $\Gamma$ is a totally ordered abelian group. It is called the \textbf{value group} of $A$.

Let $v:K^*\to\Gamma$ be the canonical homomorphism. Show that $v(x+y)\ge\min(v(x),v(y))$ for all $x,y\in K^*$ such that $x+y\in K^*$.

\nn\textbf{Hint.} We can assume $v(x)\ge v(y)$, that is $xy^{-1}\in A$. We get $A\ni xy^{-1}+1=(x+y)y^{-1}$, and thus $v(x+y)\ge v(y)=\min(v(x),v(y))$.

\subsubsection{Page 72, Exercise~5.31}\label{ex5.31}%

\textbf{Statement.} Conversely, let $\Gamma$ be a totally ordered abelian group (written additively), and let $K$ be a field. A valuation of $K$ with values in $\Gamma$ is a mapping $v:K^*\to\Gamma$ such that 

\nn(1) $v(xy)=v(x)+v(y)$,

\nn(2) $v(x+y)\ge\min(v(x),v(y))$ or $x+y=0$,

\nn for all $x,y\in K^*$. Show that the set of elements $x\in K$ such that $v(x)\ge0$ if $x\ne0$ is a valuation ring of $K$. This ring is called the valuation ring of $v$, and the subgroup $v(K^*)$ of $\Gamma$ is the \textbf{value group} of $v$.

Thus the concepts of valuation ring and valuation are essentially equivalent.

\nn\textbf{Comments.} There are typos in the statement given in the book. The proof is left to the reader.

\subsubsection{Page 72, About Exercise~5.31}%

Let $J$ be a set; for each $j\in J$ let $A_j$ and $B_j$ be two valuation domains with same value group $G_j$; let $G_{j,\infty}$ be to the totally ordered commutative monoid obtained by adjoining to $G_j$ a largest element, denoted $\infty$, such that $\infty+x=\infty$ for all $x\in G_{j,\infty}$; let $v_j:A_j\to G_{j,\infty}$ and $w_j:B_j\to G_{j,\infty}$ be the respective valuations; let $\aaa_j\subset A_j$ and $\bbb_j\subset B_j$ be ideals such that $v_j(\aaa_j)=w_j(\bbb_j)$ for all $j$, let $A$ and $B$ be the respective products of the $A_j/\aaa_j$ and the $B_j/\bbb_j$.

\begin{prop}
In the above setting, the spectra of $A$ and $B$ are homeomorphic.
\end{prop}

\begin{proof}
The proof will actually give a description of the spectra. 

Let $j$ be in $J$. Let $G_{j,\infty,\ge0}$ be the totally ordered commutative submonoid of nonnegative elements in $G_{j,\infty}$; let $M_j$ be the totally ordered commutative monoid $G_{j,\infty,\ge0}/\!\sim$, where $\sim$ is the congruence defined by $x\sim y$ if and only if $x,y\in v_j(\aaa_j)$; let $M$ be the product of the $M_j$; and let $v:A\to M$ be the map induced by the $v_j$. 

Let $\mathcal I$ be the set of those subsets $I\subset M$ which are upward closed and satisfy $x\land y\in I$ whenever $x,y\in I$. Then $\mathcal I$ has an obvious structure of lattice for which we have $I\land I'=I\cap I'$ and $I\le I'\iff I\subset I'$ for all $I,I'\in\mathcal I$. Let $\mathcal P$ be the sub-poset of $\mathcal I$ formed by the sets $P\in\mathcal I$ such that $x,y\in M\setminus P$ implies $x+y\notin P$.

We leave it to the reader to check that $v$ induces a lattice isomorphism from the lattice of ideals of $A$ to $\mathcal I$, and that $v(\aaa)\in\mathcal P$ if and only if $\aaa$ is prime. This implies the proposition. 
\end{proof}

\subsubsection{Page 72, Exercise~5.32}%

\textbf{Statement.} (a) Let $\Gamma$ be a totally ordered abelian group. A subgroup $\Delta$ of $\Gamma$ is \textbf{isolated} in $\Gamma$ if, whenever $0\le\beta\le\alpha$ and $\alpha\in\Delta$, we have $\beta\in\Delta$. Let $A$ be a valuation ring of a field $K$, with value group $\Gamma$ (Exercise~31; Section~\ref{ex5.31} p.~\pageref{ex5.31}). If $\ppp$ is a prime ideal of $A$, show that $v(A\setminus\ppp)$ is the set of elements $\ge0$ in an isolated subgroup $\Delta$ of $\Gamma$, and that the mapping so defined of $\Spec(A)$ into the set of isolated subgroups of $\Gamma$ is bijective.

\nn(b) If $\ppp$ is a prime ideal of $A$, what are the value groups of the valuation rings $A/\ppp,A_\ppp$?

\nn\textbf{Hints.} (a) For any domain $A$, let $A^*,A^0$, and $Q(A)$ denote respectively the group of units of $A$, the monoid of nonzero elements of $A$, and the field of fractions of $A$. For any totally ordered multiplicative abelian group $G$, let $G^+$ denote the monoid of elements $\ge1$. 

Let $A$ be a valuation domain. Recall that the group $\Gamma(A):=Q(A)^*/A^*$, written additively, is the group of values of $A$, that it is totally ordered, that we have $\Gamma(A)^+=A^0/A^*$, and that the canonical projection $Q(A)^*\to\Gamma(A)$ is designated by $v$.

Let $\ppp$ be a prime ideal of $A$, set $S:=A\setminus\ppp$ and let $\Delta$ be the subgroup of $\Gamma:=\Gamma(A)$ generated by $S/A^*$. If $\langle S\rangle$ is the subgroup of $Q(A)^*$ generated by $S$, then we have $\Delta=\langle S\rangle/A^*$.

Let us show that $\Delta$ is isolated. It suffices to prove that $0<\beta<\alpha$ and $\alpha\in\Delta$ implies $\beta\in\Delta$. Say that $\alpha$ is represented by $s\in S$ and $\beta$ by $b\in A^0$. By assumption we have $sb^{-1}=a\in A$, that is $s=ab$, which implies $b\in S$, that is $\beta\in\Delta$.

The map $\ppp\mapsto\Delta$ is clearly injective. To show that it is surjective let $\Delta$ be an isolated subgroup of $\Gamma$, and set 
$$
\ppp:=\Big(A\setminus v^{-1}(\Delta^+)\Big)\cup\{0\}\subset A.
$$ 
It suffices to verify that $\ppp$ is a prime ideal. Let $a,b\in\ppp$ and let us check that $a+b\in\ppp$. We can assume $a+b\ne0$. If $a+b$ was not in $\ppp$ we would get $v(a+b)\ge\min(v(a),v(b))$, and $a$ or $b$ would not be in $\ppp$ by isolation of $\Delta$. Let $p\in\ppp$ and $a\in A$ and let us check that $ap\in\ppp$. Again we can assume $ap\ne0$, and we get $v(ap)=v(a)+v(p)>v(p)$, which entails $ap\in\ppp$. Finally, if $s,t\notin\ppp$, then $st\notin\ppp$ because $\Delta$ is a subgroup of $\Gamma$.

\nn(b) We claim 
\begin{equation}\label{loc}
\Gamma(A_\ppp)\simeq\frac{\Gamma}{\Delta}
\end{equation}
and 
\begin{equation}\label{quo}
\Gamma(A/\ppp)\simeq\Delta
\end{equation}
[isomorphisms of totally ordered abelian groups].

\nn Proof of \eqref{loc}:
$$
\Gamma(A_\ppp)=Q(A)^*/(A_\ppp)^*=Q(A)^*/\langle S\rangle\simeq\frac{Q(A)^*/A^*}{\langle S\rangle/A^*}=\frac{\Gamma}{\Delta}\ .
$$ 
Proof of \eqref{quo}: Set $\overline A:=A/\ppp$ and, for any $a\in A$, write $\overline a$ for the image of $a$ in $\overline A$. As $\Gamma(\overline A)$ and $\Delta$ are totally ordered abelian groups, it suffices to show 
\begin{equation}\label{mon}
\Gamma(\overline A)^+\simeq\Delta^+\text{ [isomorphism of totally ordered monoids].}
\end{equation}
Proof of \eqref{mon}: We have $\Gamma(\overline A)^+=(\overline A)^0/(\overline A)^*$ and $\Delta^+=S/A^*$. Define the monoid morphism $f:S\to(\overline A)^0$ by $f(s):=\overline s$, and consider the diagram 
$$
\begin{tikzcd}
S\ar[r,"f"]\ar[d,"p"']&(\overline A)^0\ar[d,"q"]\\ 
S/A^*\ar[r,dashrightarrow,"\overline f"']&(\overline A)^0/(\overline A)^*,
\end{tikzcd}
$$ 
where $p$ and $q$ are the canonical projections. We claim that there is an induced morphism $\overline f:S/A^*\to(\overline A)^0/(\overline A)^*$, and that $\overline f$ is bijective. The existence of $\overline f$ and its surjectivity are easy to prove. The injectivity of $\overline f$ follows from the fact that, $A$ being local, any unit of $\overline A$ is the image of a unit of $A$. This proves \eqref{mon}, and thus \eqref{quo}.

\subsubsection{Page 72, Exercise~5.33}%

\textbf{Statement.} Let $\Gamma$ be a totally ordered abelian group. We shall show how to construct a field $K$ and a valuation $v$ of $K$ with $\Gamma$ as value group. Let $k$ be any field and let $A=k[\Gamma]$ be the group algebra of $\Gamma$ over k. By definition, $A$ is freely generated as a $k$-vector space by elements $x_\alpha$ ($\alpha\in\Gamma$) such that $x_\alpha x_\beta= x_{\alpha+\beta}$. Show that $A$ is an integral domain.

If $u=\lambda_1x_{\alpha_1}+\cdots+\lambda_nx_{\alpha_n}$ is any non-zero element of $A$, where the $\lambda_i$, are all $\ne0$ and $\alpha_1<\cdots<\alpha_n$, define $v_0(u)$ to be $\alpha_1$. Show that the mapping $v_0:A-\{0\}\to\Gamma$ satisfies conditions (1) and (2) of Exercise~31 [Section~\ref{ex5.31} p.~\pageref{ex5.31}].

Let $K$ be the field of fractions of $A$. Show that $v_0$ can be uniquely extended to a valuation $v$ of K, and that the value group of $v$ is precisely $\Gamma$.

\nn\textbf{Solution.} Left to the reader.%easy? 5

\subsubsection{Page 73, Exercise~5.34}\label{ex5.34}%

\textbf{Statement.} Let $A$ be a valuation ring and K its field of fractions. Let $f:A\to B$ be a ring homomorphism such that $f^*:\Spec(B)\to\Spec(A)$ is a \textbf{closed} mapping. Then if $g:B\to K$ is any $A$-algebra homomorphism (i.e., if $g\circ f$ is the embedding of $A$ in $K$) we have $g(B)=A$.

\nn[Let $C=g(B)$; obviously $C\supset A$. Let $\nnn$ be a maximal ideal of $C$. Since $f^*$ is closed, $\mmm=\nnn\cap A$ is the maximal ideal of $A$, whence $A_\mmm=A$. Also the local ring $C_\nnn$ dominates $A_\mmm$. Hence by Exercise~27 [Section~\ref{527} p.~\pageref{527}] we have $C_\nnn=A$ and therefore $C=A$.]

\nn\textbf{Hint.} In the hint of the book we must check that $C_\nnn$ dominates $A$, that is $\mmm\subset\nnn_\nnn$. But we have $\mmm=A\cap\nnn\subset\nnn_\nnn$.

\subsubsection{Page 73, Exercise~5.35}%

\textbf{Statement.} From Exercises~1 and 3 [Section~\ref{ex5.1} p.~\pageref{ex5.1} and Section~\ref{ex5.3} p.~\pageref{ex5.3}] it follows that, if $f:A\to B$ is integral and $C$ is any $A$-algebra, then the mapping $(f\otimes1)^*:\Spec(B\otimes_AC)\to\Spec(C)$ is a closed map.

Conversely, suppose that $f:A\to B$ has this property and that $B$ is an integral domain. Then $f$ is integral. [Replacing $A$ by its image in $B$, reduce to the case where $A\subset B$ and $f$ is the injection. Let $K$ be the field of fractions of $B$ and let $A'$ be a valuation ring of $K$ containing $A$. By (5.22) [Corollary~\ref{c522} p.~\pageref{c522}] it is enough to show that $A'$ contains $B$. By hypothesis $\Spec(B\otimes_AA')\to\Spec(A')$ is a closed map. Apply the result of Exercise~34 [Section~\ref{ex5.34}] to the homomorphism $B\otimes_AA'\to K$ defined by $b\otimes a'\mapsto ba'$. It follows that $ba'\in A'$ for all $b\in B$ and all $a'\in A'$; taking $a'=1$, we have what we want.]

Show that the result just proved remains valid if $B$ is a ring with only finitely many minimal prime ideals (e.g., if $B$ is Noetherian). [Let $\ppp_i$ be the minimal prime ideals. Then each composite homomorphism $A\to B\to B/\ppp_i$ is integral, hence $A\to\prod (B/\ppp_i)$ is integral, hence $A\to B/\NNN$ is integral (where $\NNN$ is the nilradical of $B$), hence finally $A\to B$ is integral.]

\nn\textbf{Hints.} Replacing the commutative diagram 
$$
\begin{tikzcd}
A\ar[dr,hook,"i"']\ar[rr,"f"]&&B\ar[dl,"g"]\\ 
&K
\end{tikzcd}
$$ 
implicit in Exercise~5.34 [Section~\ref{ex5.34} p.~\pageref{ex5.34}] with 
$$
\begin{tikzcd}
A'\ar[dr,hook,"f"']\ar[rr]&&B\otimes_AA'\ar[dl]\\ 
&K,
\end{tikzcd}
$$ 
we get $BA'=A'$ [as subrings of $K$], and thus $B\subset A'$.

In the second part of this exercise we can use the fact that the natural morphism $B/\NNN\to\prod_iB/\ppp_i$ is injective.

\newpage

\section{About Chapter~6}%%%

\subsection{Comments}%%

\subsubsection{Jordan-Hölder Theorem}% previous version https://docs.google.com/document/d/169ZLmbrpH7KkKqpxGDO2tkWgE_lWuJEHqSHujOJNo44/edit

The following proof is taken from Jeffrey Daniel Kasik Carlson's text cited at the beginning of the present text. 

Consider an $A$-module $M$ of finite length. Proposition~6.7, stated and proved on p.~77 of the book, says that all composition series of $M$ have the same length, and the book claims (p. 77) that the multiset of isomorphism classes of quotients of successive terms is the same for any choice of composition series. This claim is not proved, but the authors write that the proof is the same as for finite groups. We recall it here. 

Let $A$ be a ring. In this section ``module'' means ``$A$-module''. For any submodule $N$ of any module $M$, we write $\begin{tikzcd}M\ar[r,dash,"a"]&N\end{tikzcd}$ to indicate that $a$ is the isomorphism class of $M/N$. Moreover, if $\alpha$ is the composition series 
$$
\begin{tikzcd}
M=M_0\ar[r,dash,"a_1"]&M_1\ar[r,dash,"a_2"]&\cdots\ar[r,dash,"a_n"]&M_n=0,
\end{tikzcd}
$$
we denote by $\chi(\alpha)$ the element $a_1+\cdots+a_n$ of the free abelian group over the set $\{a_1,\dots,a_n\}$. 

Here is what we want to show: 

If 
$$
\begin{tikzcd}
M=N_0\ar[r,dash,"b_1"]&N_1\ar[r,dash,"b_2"]&\cdots\ar[r,dash,"b_n"]&N_n=0
\end{tikzcd}
$$
is another composition series, denoted $\beta$, for the same module $M$, then we have $\chi(\alpha)=\chi(\beta)$. 

The proof proceeds by induction on the length $\ell(M)$ of $M$. If $\ell(M)=0$ or $1$, we are done. Assume inductively that the result holds for all modules of length less than $n$, and let $\ell(M)=n$. As indicated above, we suppose that $M$ has the two composition series: 
$$
\begin{tikzcd}
&M\ar[dl,dash,"a_1"']\ar[dr,dash,"b_1"]\\ 
M_1\ar[d,dash,"a_2"']&&N_1\ar[d,dash,"b_2"]\\ 
M_2\ar[d,dash,"a_3"']&&N_2\ar[d,dash,"b_3"]\\ 
\vdots\ar[d,dash,"a_n"']&&\vdots\ar[d,dash,"b_n"]\\ 
M_n&&N_n.
\end{tikzcd}
$$ 
Case 1: $M_1=N_1$. We get $a_1=b_1$ and 
$$
\begin{tikzcd}
&M\ar[d,dash,"a_1"']\\ 
&M_1\ar[dl,dash,"a_2"']\ar[dr,dash,"b_2"]\\ 
M_2\ar[d,dash,"a_3"']&&N_2\ar[d,dash,"b_3"]\\ 
\vdots\ar[d,dash,"a_n"']&&\vdots\ar[d,dash,"b_n"]\\ 
M_n&&N_n,
\end{tikzcd}
$$ 
and we are done because the inductive hypotheses yields $a_2+\cdots+a_n=b_2+\cdots+b_n$.

Case 2: $M_1\ne N_1$. Setting $P_2:=M_1\cap N_1$, we get 
$$
\begin{tikzcd}
&M\ar[dl,dash,"a_1"']\ar[dr,dash,"b_1"]\\ 
M_1\ar[d,dash,"a_2"']\ar[dr,dash,"b_1"]&&N_1\ar[d,dash,"b_2"]\ar[dl,dash,"a_1"']\\ 
M_2\ar[d,dash,"a_3"']&P_2\ar[d,dash,"c_3"]&N_2\ar[d,dash,"b_3"]\\ 
M_3\ar[d,dash,"a_4"']&P_3\ar[d,dash,"c_4"]&N_2\ar[d,dash,"b_4"]\\ 
\vdots\ar[d,dash,"a_n"']&\vdots\ar[d,dash,"c_n"]&\vdots\ar[d,dash,"c_n"]\\ 
M_n&P_k&N_n.
\end{tikzcd}
$$ 
The inductive hypotheses implying 
$$
a_2+\cdots+a_n=b_1+c_3+\cdots+c_n
$$ 
and 
$$
a_1+c_3+\cdots+c_n=b_2+\cdots+b_n,
$$ 
we get 
$$
a_1+a_2+\cdots+a_n=a_1+b_1+c_3+\cdots+c_n=b_1+a_1+c_3+\cdots+c_n=b_1+b_2+\cdots+b_n.
$$ 
This completes the proof.

\subsection{Exercises}%%

\subsubsection{Page 78, Exercise~6.1}%

\textbf{Statement.} (i) Let $M$ be a Noetherian A-module and $u:M\to M$ a module homomorphism. If $u$ is surjective, then $u$ is an isomorphism.

\nn(ii) If $M$ is Artinian and $u$ is injective, then again $u$ is an isomorphism.
[For (i), consider the submodules $\oo{Ker}(u^n)$; for (ii), the quotient modules $\oo{Coker}(u^n)$.]

\nn\textbf{Solution.} (i) Note that $M$ is finitely generated by Proposition~6.2 p.~75 of the book [see statement below], and that a surjective endomorphism of a finitely generated module is bijective by Corollary~\ref{notor} p.~\pageref{notor}.

\nn(ii) Left to the reader. [I think ``for (ii), the quotient modules $\oo{Coker}(u^n)$'' should be ``for (ii), the submodules $\oo{Im}(u^n)$''.]

Here is the statement of Proposition~6.2 p.~75 of the book:

\begin{prop}[Proposition~6.2]
$M$ is a Noetherian $A$-module $\iff$ every submodule of $M$ is finitely generated.
\end{prop}

\subsubsection{Page 78, Exercise~6.2}%

\textbf{Statement.} Let $M$ be an $A$-module. If every non-empty set of finitely generated submodules of $M$ has a maximal element, then $M$ is Noetherian.

\nn\textbf{Hint.} Use Proposition~6.2 of the book stated above.

\subsubsection{Page 78, Exercise~6.3}%

\textbf{Statement.} Let $M$ be an $A$-module and let $N_1,N_2$ be submodules of $M$. If $M/N_1$ and $M/N_2$ are Noetherian, so is $M/(N_1\cap N_2)$. Similarly with Artinian in place of Noetherian.

\nn\textbf{Hint.} Consider the exact sequences 
$$
0\to\frac{N_1}{N_1\cap N_2}\to\frac M{N_1\cap N_2}\to\frac M{N_1}\to0
$$ 
and 
$$
0\to\frac{N_1+N_2}{N_2}\to\frac M{N_2}\to\frac M{N_1+N_2}\to0.
$$ 
\nn\textbf{Mild generalization:} If $N_1,\dots,N_k$ are submodules of $M$ such that $M/N_i$ is noetherian for all $i$, then $M/(N_1\cap\cdots\cap N_k)$ is noetherian. 

\subsubsection{Page 78, Exercise~6.4}\label{64}%

\textbf{Statement.} (a) Let $M$ be a Noetherian $A$-module and let $\aaa$ be the annihilator of $M$ in $A$. Prove that $A/\aaa$ is a Noetherian ring.

\nn(b) If we replace ``Noetherian'' by ``Artinian'' in this result, is it still true?

\nn\textbf{Hints.} (a) Use the above generalization and Proposition~6.2 p.~75 of the book.

\nn(b) See Example 3 p.~74 of the book.

\subsubsection{Page 79, Exercise~6.5}\label{ex6.5}%

\textbf{Statement.} A topological space $X$ is said to be \textbf{Noetherian} if the open subsets of $X$ satisfy the ascending chain condition (or, equivalently, the maximal condition). Since closed subsets are complements of open subsets, it comes to the same thing to say that the closed subsets of $X$ satisfy the descending chain condition (or, equivalently, the minimal condition). Show that, if $X$ is Noetherian, then every subspace of $X$ is Noetherian, and that $X$ is quasi-compact.

\nn\textbf{Hints.} To show that every subspace of $X$ is Noetherian one can use the maximal condition for open subsets. To show that $X$ is quasi-compact one can use the maximal condition for the sets of finite unions of open sets occurring in a given open cover.

\subsubsection{Page 79, Exercise~6.6}%

\textbf{Statement.} Prove that the following are equivalent: 

\nn(i) $X$ is Noetherian.

\nn(ii) Every open subspace of $X$ is quasi-compact. 

\nn(iii) Every subspace of $X$ is quasi-compact.


\nn\textbf{Hint.} To show that (ii) implies (i), note that the chain $U_1\subset U_2\subset\cdots$ of open subsets covers the open subset $U_1\cup U_2\cup\cdots$

\subsubsection{Page 79, Exercise~6.7}\label{ex6.7}%

\textbf{Statement.} A Noetherian space is a finite union of irreducible closed subspaces. [Consider the set $\Sigma$ of closed subsets of $X$ which are not finite unions of irreducible closed subspaces.] Hence the set of irreducible components of a Noetherian space is finite.

See Exercises 1.19 and 1.20 p.~13 of the book. 

\nn\textbf{Solution.} This is a copy-and-paste of Jeffrey Daniel Kasik Carlson's solution in\medskip 

\centerline{\href{https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf}{https://spaces.ac.cn/usr/uploads/2017/07/4208763092.pdf}}

Suppose, for a contradiction, that the result is false. Then there is a noetherian space $X$ such that $X$ is an element of the set $\Sigma$ of closed subsets of $X$ that are not unions of finitely many irreducible closed subspaces. Since $\Sigma$ is nonempty and $X$ is noetherian, $\Sigma$ has a minimal element $M$. Since $M$ is not a finite union of irreducible sets, it is not itself an irreducible set. Thus it is reducible, and so a union of two proper closed subspaces $C$ and $D$. But $C$ and $D$ are both finite unions of irreducible closed sets, so $M$ is as well, contradiction.

Recall from Exercise~1.20iii p.~13 of the book that the irreducible components of a space $X$ are the maximal irreducible subsets of $X$, and that they are closed and cover $X$. Since a noetherian space $X$ is a union of finitely many irreducible closed subspaces, it is a fortiori a union of finitely many maximal such, so it is a union of finitely many irreducible components. Let $n$ be the least possible number needed to cover $X$, and let $C_1,\ldots,C_n$ be irreducible components covering $X$. If $C$ is any other irreducible closed set, then $C=\bigcup_{j=1}^n\ (C\cap C_j)$ expresses $C$ as a union of closed subsets; as $C$ is irreducible, $C\subset C_j$ for some $j$. Thus $C_1,\ldots,C_n$ are the only irreducible components of $X$. 

\subsubsection{Page 79, Exercise~6.8}\label{ex6.8}%

\textbf{Statement.} If $A$ is a Noetherian ring then $\Spec(A)$ is a Noetherian topological space. Is the converse true?

\nn\textbf{Hint.} If $V(\aaa_1)\supset V(\aaa_2)\supset\cdots$, with $r(\aaa_i)=\aaa_i$, is a weakly decreasing chain of closed subsets of $X$, then $\aaa_1\subset\aaa_2\subset\cdots$ is a weakly increasing chain of ideals of $A$. 

\subsubsection{Page 79, Exercise~6.9}%

\textbf{Statement.} Deduce from Exercise~6.8 that the set of minimal prime ideals in a Noetherian ring is finite.

\nn\textbf{Hint.} See Exercises 1.20iv p.~13 and 6.7 p.~79 [see Section~\ref{ex6.7} p.~\pageref{ex6.7}] of the book. 

A slightly stronger result holds: If $\Spec(A)$ is noetherian, then the set of minimal prime ideals in $A$ is finite. 

\subsubsection{Page 79, Exercise~6.10}%

\textbf{Statement.} If $M$ is a Noetherian module (over an arbitrary ring $A$) then $\oo{Supp}(M)$ is a closed Noetherian subspace of $\Spec(A)$.

\nn\textbf{Solution.} It suffices to note that $\oo{Supp}(M)=V(\aaa)$ with $\aaa:=\oo{Ann}(M)$ by Exercise~3.19v p.~46 of the book [Section~\ref{ex3.19} p.~\pageref{ex3.19}]; that $V(\aaa)\simeq\Spec(A/\aaa)$; that $A/\aaa$ is noetherian by Exercise~6.4 p.~78 of the book [cf. Section~\ref{64} p.~\pageref{64} above]; and that $\Spec(A/\aaa)$ is noetherian by Exercise~6.8 p.~79 of the book [cf. Section~\ref{ex6.8} p.~\pageref{ex6.8} above].

\subsubsection{Page 79, Exercise~6.11}%

\textbf{Statement.} Let $f:A\to B$ be a ring homomorphism and suppose that $\Spec(B)$ is a Noetherian space (Exercise~5 [Exercise~\ref{ex6.5} p.~\pageref{ex6.5}]). Prove that $f^*:\Spec(B)\to\Spec(A)$ is a closed mapping if and only if $f$ has the going-up property (Chapter~5, Exercise~10). 

\nn\textbf{Solution.} Since it is stated in Exercise~5.10i p.~68 of the book that $f$ has the going-up property if $f^*$ is closed, it suffices to prove the converse. So, assuming that $f$ has the going-up property, let us show that $f^*$ is closed. 

Let $\bbb$ be a radical ideal of $B$, and let $\aaa$ be its contraction in $A$. It suffices to prove $f^*(V(\bbb))=V(\aaa)$. By the previous Exercises, there are $\qqq_1,\dots,\qqq_n\in V(\bbb)$ such that the set of minimal elements of $V(\bbb)$ is $\{\qqq_1,\dots,\qqq_n\}$ and $V(\bbb)=\bigcup_{i=1}^n\ V(\qqq_i)$. Let $\ppp_i$ be the contraction of $\qqq_i$ in $A$. It suffices to prove: 
\begin{equation}\label{611a}
V(\aaa)=\bigcup_{i=1}^n\ V(\ppp_i)
\end{equation} 
and 
\begin{equation}\label{611b}
f^*(V(\qqq_i))=V(\ppp_i)\text{ for all }i.
\end{equation} 
Condition \eqref{611b} follows from the going-up property. To prove \eqref{611a}, let $\ppp$ be in $V(\aaa)$. It is enough to check that $\ppp$ is in $V(\ppp_i)$ for some $i$. We have 
$$
\ppp\supset\aaa=\bbb^{\oo c}=\left(\bigcap\ \qqq_i\right)^{\oo c}=\bigcap\ \ppp_i,
$$ 
and Proposition~\ref{p1.11ii} p.~\pageref{p1.11ii} implies $\ppp\supset\ppp_i$ for some $i$, as was to be shown. 

\subsubsection{Page 79, Exercise~6.12}%

\textbf{Statement.} Let $A$ be a ring such that $\Spec(A)$ is a Noetherian space. Show that the set of prime ideals of $A$ satisfies the ascending chain condition. Is the converse true?

\nn\textbf{Hint.} To show that the converse is not true, let $K$ be a field and $A:=K^{\mathbb N}$ the ring of $K$-valued functions on $\mathbb N$. As $A$ is absolutely flat, its prime ideals are maximal. Hence it suffices to show that there is an ascending chain $\aaa_1<\aaa_2<\cdots$ of radical ideals of $A$. We can set 
$$
\aaa_n:=\{f\in A\ |\ f(k)=0\text{ for all }k>n\}.
$$

\newpage

\section{About Chapter~7}%%%

\subsection{Comments}%%

\subsubsection{Page 80, a remark}%

Here is an example of a descending chain $A_0\supset A_1\supset\cdots$ such that each $A_n$ is noetherian but the intersection is not.

Consider the submonoid $M_n$ of $\mathbb N^2$ defined by 
$$
M_n:=\{a\in\mathbb N^2\ |\ a_2\ge1\ \lor\ a_1\ge n\}\supset M_{n+1},
$$ 
note that we have $M_n\supset M_{n+1}$, and that 
$$
M:=\bigcap_n\ M_n=\{a\in\mathbb N^2\ |\ a_2\ge1\}
$$ 
is \textbf{not} finitely generated. Observe that the finite set 
$$
G_n:=\{(n,0),(n+1,0),\dots,(2n-1,0),(0,1),(1,1),(2,1),\dots,(n-1,1)\}\subset M_n
$$ 
generates $M_n$. 

Here is a picture for $n=3$: The black dots are the points of $G_3$, the white dots are the points on $M_3\setminus G_3$, the crosses are the points in $\mathbb N^2\setminus M_3$.
$$
\begin{matrix}
2&\circ&\circ&\circ&\circ&\circ&\circ&\circ\\ 
1&\bullet&\bullet&\bullet&\circ&\circ&\circ&\circ\\ 
0&\times&\times&\times&\bullet&\bullet&\bullet&\circ\\ 
&0&1&2&3&4&5&6.
\end{matrix}
$$
Let $K$ be a field and $x$ and $y$ indeterminates, and set $A_n:=K[(x^iy^j)_{(i,j)\in G_n}]$, that is, $A_n$ is the sub-$K$-algebra of $K[x,y]$ generated by $\{x^iy^j\ |\ (i,j)\in G_n\}$. Then the $A_n$ satisfy the conditions stated at the beginning of this section.

\subsubsection{Page 81, Hilbert Basis Theorem}%

\begin{thm}\label{hbt}
If $M$ is a noetherian $A$-module and $t$ is an indeterminate, then $M[t]$ is a noetherian $A[t]$-module. In particular, if $A$ is a noetherian ring, then so is $A[t]$.
\end{thm}

\begin{proof}
Assume by contradiction some sub-$A[t]$-module of $A[t]$ is \textbf{not} finite\-ly generated, and let $f_1,f_2,\dots$ be a sequence in $M[t]$ such that the sequence $N_i:=A[t]f_1+\cdots+A[t]f_i$ of sub-$A[t]$-modules of $A[t]$ increases, and $\deg f_i$ is minimum for this condition. Let $x_i\in M$ be the leading coefficient of $f_i$; let $n$ be such that $Ax_1+\cdots+Ax_n$ is the sub-$A$-module of $M$ generated by the $x_i$; let $a_1,\dots,a_n\in A$ satisfy 
$
x_{n+1}=a_1\,x_1+\cdots+a_n\,x_n;
$ 
set $d(i):=\deg f_{n+1}-\deg f_i$, 
$$
g:=\sum_{i=1}^n\,a_i\,t^{d(i)}f_i\in N_n\subset A[t];
$$ 
and observe that $\deg(f_{n+1}-g)$ is less than $\deg f_{n+1}$, which is impossible.
\end{proof}

\subsubsection{Page 82, Proof of Proposition~7.8}% 

Kevin Buzzard writes in \href{https://mathoverflow.net/a/372412/461}{this MathOverflow answer}:

{\footnotesize The following slip on p. 82 was found by Kenny Lau when he was formalising Proposition~7.8 in Lean: In the line 

"Substituting $(1)$ and making repeated use of $(2)$ shows that each element of $C$ is..." 

\noindent there's an implicit induction proof, but the base case where the element is $1$ is not dealt with. This can be fixed in a number of ways, e.g. by adding a new condition 
$$
(0)\qquad1=\sum_i b_i y_i
$$ 
and using the $b_i$ as further generators of $B_0$.} 

Another way of fixing this would be to take $1$ as one of the $y_j$. 

\subsubsection{Page 83, Lemma 7.12}%

The statement of Lemma 7.12, which is is: ``In a Noetherian ring every irreducible ideal is primary'', should be replaced by ``In a Noetherian ring every \textbf{proper} irreducible ideal is primary''.

In the proof, the equalities $xy=0$ and $\oo{Ann}(x^n)=\oo{Ann}(x^{n+1})$ imply $(x^n)\cap(y)=(0)$. Indeed, if $a$ is in $(x^n)\cap(y)$ we have $a=bx^n=cy$ for some $b$ and $c$ in $A$, and thus $bx^{n+1}=cyx=0$. Now $bx^{n+1}=0$ implies $bx^n=0$, that is $a=0$. 

Note that primary ideals in noetherian rings can be reducible: the ideal $(x^2,xy,y^2)$ of $K[x,y]$ [where $K$ is a field, $x$ and $y$ are indeterminates] is $(x,y)$-primary but reducible because $(x,y^2)\cap(y,x^2)=(x^2,xy,y^2)$.%https://docs.google.com/document/d/1YYUDEGhoImy-b_Lx9foGoetelzzXbN1IiNbpo7pXh98/edit comment 180522

Here is a related result:

\nn\emph{The following conditions on a ring $A$ are equivalent:}

\nn(a) \emph{the Krull dimension of $A$ is at most zero,}

\nn(b) \emph{$A/\NNN$ is absolutely flat, where $\NNN$ is the nilradical of $A$,}

\nn(c) \emph{for each $a$ in $A$ the descending chain $(a)\supset(a^2)\supset\cdots$ stabilizes.}

\nn\emph{Proof.} (a)$\implies$(b): We can assume $\NNN=(0)$. Let $a$ be in $A$. It suffices to show $(a)=(a^2)$. Let $\ppp$ be a prime ideal of $A$. Then the nilradical of $A_\ppp$ is $(0)$ and $\ppp_\ppp$ is the only prime ideal of $A_\ppp$. This implies that $A_\ppp$ is a field, and we get successively the equalities 
$$
(a)_\ppp=(a^2)_\ppp,\quad(a)_\ppp/(a^2)_\ppp=(0),\quad((a)/(a^2))_\ppp=(0).
$$ 
As $\ppp$ is an arbitrary prime ideal of $A$, this forces $(a)=(a^2)$.

\nn(b)$\implies$(c): With obvious notation we have $\overline a=\overline a^2\overline b$ for some $b$ in $A$, that is $(a-a^2b)^n=0$ for some $n\ge1$. This is easily seen to imply $a^{n+1}\in(a^n)$ and thus $(a^{n+1})=(a^n)$. 

\nn(c)$\implies$(a): Let $\ppp$ be a prime ideal of $A$ and let $a$ be in $A\setminus\ppp$. We have $a^n(1-ab)=0$ for some $b$ in $A$ and some $n$ in $\mathbb N$. In particular $a^n(1-ab)\in\ppp$, and thus $1-ab\in\ppp$. This implies that $A/\ppp$ is a field, and therefore that $\ppp$ is maximal. $\square$

\subsubsection{Page 83, Theorem 7.13}%

Recall the statement:

\nn\emph{In a Noetherian ring $A$ every ideal has a primary decomposition.}

Let $E$ be a subset of a ring $A$. Recall that, if $A$ is noetherian, we have, by Section~\ref{ex1.8} p.~\pageref{ex1.8} $V(E)=\bigcup_{\ppp\in M}V(\ppp)$, where $M$ is the set of minimal elements of $V(E)$. 

Assume now that $A$ is \textbf{noetherian}. 

Then the set $M$ is finite. As a result, we have

\nn\emph{The topology of $\Spec(A)$ depends only on its poset structure.}

More precisely:

\nn\emph{A subset of $\Spec(A)$ is closed if and only if it is a finite union of subsets of the form $V(\ppp)$ with $\ppp\in\Spec(A)$.}

Equivalently:

\nn\emph{The closed subsets of $\Spec(A)$ are the closures of the finite subsets.}

\subsection{Exercises}%%

\subsubsection{Page 84, Exercise~7.1}%

\textbf{Statement.} Let $A$ be a non-Noetherian ring and let $\Sigma$ be the set of ideals in $A$ which are not finitely generated. Show that $\Sigma$ has maximal elements and that the maximal elements of $\Sigma$ are prime ideals.

Hence a ring in which every prime ideal is finitely generated is Noetherian (I. S. Cohen).

\nn\textbf{Solution.} Following the hint in the book, let $\aaa$ be a maximal element of $\Sigma$. Suppose by contradiction that there exist $x,y\in A$ such that $x\notin\aaa$, $y\notin\aaa$, $xy\in\aaa$. 

There are $s_i\in A$ such that $\aaa+(x)=(s_1,\dots,s_n)$. We have $s_i=b_i+t_ix$ with $b_i\in\aaa$, $t_i\in A$. Putting $\bbb=(b_1,\dots,b_n)\subset\aaa$, we get $\aaa+(x)=\bbb+(x)$. 

We claim $\aaa=\bbb+x\,(\aaa:x)$. 

The inclusion $\bbb+x\,(\aaa:x)\subset\aaa$ is clear. To prove the other inclusion, let $a$ be in $\aaa$ and let us show $a\in\bbb+x\,(\aaa:x)$. We have $a=\sum u_i\,(b_i+t_ix)=b+vx$ with $u_i\in A$, $b\in\bbb$, $v\in A$. This yields $vx=a-b\in\aaa$, and thus $v\in(\aaa:x)$, proving the claim.

Note that $y$ is in $(\aaa:x)$ but not in $\aaa$. This implies that $(\aaa:x)$ is finitely generated, and thus, in view of the claim, that $\aaa$ is finitely generated, contradiction.

\subsubsection{Page 84, Exercise~7.2}\label{ex7.2}%

\textbf{Statement.} Let $A$ be a Noetherian ring and let $f=\sum_{n=0}^\infty a_n\,x^n\in A[[x]]$. Prove that $f$ is nilpotent if and only if each $a_n$ is nilpotent.

\nn\textbf{Solution.} In view of Exercise~1.5ii [Section~\ref{ex1.5} p.~\pageref{ex1.5}] it suffices to show: each $a_i$ nilpotent $\implies f$ nilpotent. We have $a_i\in\NNN$ for all $i$. Recall Corollary~7.15 p.~83 of the book: In a noetherian ring the nilradical is nilpotent. We have $f\in\NNN[[x]]$, hence $f^n\in\NNN^n[[x]]$ for all $n$. Since $\NNN^n=(0)$ for $n$ large enough by Corollary~7.15, we get $f^n=0$ for $n$ large enough.% Left to the reader.

\subsubsection{Page 84, Exercise~7.3}%

\textbf{Statement.} Let $\aaa$ be an irreducible ideal in a ring $A$. Then the following are equivalent: 

\nn(i) $\aaa$ is primary,

\nn(ii) for every multiplicatively closed subset $S$ of $A$ we have $(S^{-1}\aaa)^{\oo c}=(\aaa:s)$ for some $s\in S$,

\nn(iii) for every $x\in A$ the sequence $(\aaa:x^n)$ is stationary.

\nn\textbf{Hints.} 

\nn(i)$\implies$(ii): Use Proposition~4.8 p.~53. [This implication holds even if $\aaa$ is reducible.] 

\nn(ii)$\implies$(iii): Use Proposition~3.11ii p.~41 [Proposition~\ref{p3.11} p.~\pageref{p3.11}]. [This implication also holds even if $\aaa$ is reducible.] [Hint: set $S:=x^{\mathbb N}$.] 

\nn(iii)$\implies$(i): Use the proof of Lemma 7.12 p.~83.

\subsubsection{Page 84, Exercise~7.4}%

\textbf{Statement.} Which of the following rings are Noetherian?

\nn(i) The ring of rational functions of $z$ having no pole on the circle $|z|=1$.

\nn(ii) The ring of power series in $z$ with a positive radius of convergence.

\nn(iii) The ring of power series in $z$ with an infinite radius of convergence.

\nn(iv) The ring of polynomials in $z$ whose first $k$ derivatives vanish at the origin
($k$ being a fixed integer).

\nn(v) The ring of polynomials in $z,w$ all of whose partial derivatives with respect
to $w$ vanish for $z=0$.

In all cases the coefficients are complex numbers.

\nn\textbf{Solution.} Let $A$ be the ring in question.

\nn(i) Hint: we have $A=S^{-1}\mathbb C[z]$ for some multiplicative subset $S$, so $A$ is noetherian.

\nn(ii) Hint: $A$ is a principal ideal domain [the only ideals being the $(z^n)$].

\nn(iii) $A$ is \textbf{not} noetherian. Proof: Set $f(z):=\sin(\pi z)$ and 
$$
f_n(z):=\frac{f(z)}{(z-1)\cdots(z-n)}
$$ 
for $n=1,2,\ldots$ and note that we have $(f_1)<(f_2)<\cdots\subset A$ [details left to the reader].

\nn(iv) We prove a slightly more general result: If $B$ is a noetherian ring and $X$ is an indeterminate, then the ring $A:=B+X^{k+1}B[X]$ is noetherian. Indeed, we have 
$$
A=B[X^{k+1}]+X^{k+2}B[X^{k+1}]+\cdots+X^{2k+2}B[X^{k+1}],
$$ 
so $A$ is a noetherian module over the subring $B[X^{k+1}]$, \emph{a fortiori} a noetherian ring.%https://math.stackexchange.com/a/286269/660

\nn(v) We prove a slightly more general result. Let $B$ be a ring, let $X$ and $Y$ be indeterminates, and set $A:=B[X]+XB[X,Y]$. Then $A$ is a subring of $B[X,Y]$. Claim~1: $A$ is \textbf{not} noetherian. [The case in the book is $B:=\mathbb C$.] Set 
$$
C:=A/(X^2)=B[x,Y]=B[x]+xB[x,Y]=B+xB+xB[Y]=B[x][Y],
$$ 
where $x$ is the image of $X$; in particular $x^2=0$. It suffices to prove: Claim~2: $C$ is \textbf{not} noetherian. It suffices to show that we have $xY^{n+1}\notin(xY,xY^2,\ldots,xY^n)$ in $C$. Otherwise we would get 
$$
xY^{n+1}=b_1xY+b_2xY^2+\cdots+b_nxY^n
$$ 
with $b_i\in B$, contradiction.% https://math.stackexchange.com/q/286151/660 https://math.stackexchange.com/a/63621/660 

\subsubsection{Page 84, Exercise~7.5}%

\textbf{Statement.} Let $A$ be a Noetherian ring, $B$ a finitely generated $A$-algebra, $G$ a finite group of $A$-automorphisms of $B$, and $B^G$ the set of all elements of $B$ which are left fixed by every element of $G$. Show that $B^G$ is a finitely generated $A$-algebra.

\nn\textbf{Hint.} Use Exercise~5.12 p.~68 [see Section~\ref{5.12} p.~\pageref{5.12} above] and Proposition~7.8 p.~81.

\subsubsection{Page 84, Exercise~7.6}%

\textbf{Statement.} If a finitely generated ring is a field $K$, it is a finite field.

\nn\textbf{Hint.} Let $A$ be the prime subring of $K$. Then $A=\mathbb Z$ or $A=\mathbb F_p$ for some prime $p$. Proposition~5.7 p.~61 of the book and Noether Normalization Theorem [Theorem~\ref{thmnnt} p.~\pageref{thmnnt}] %, as stated in Section~\ref{parnnt} p.~\pageref{parnnt}, 
imply that the first case is impossible and that, in the second case, $K$ is a finite degree extension of $\mathbb F_p$.

\subsubsection{Page 85, Exercise~7.7}%

\textbf{Statement.} Let $X$ be an affine algebraic variety given by a family of equations $f_\alpha(t_1,\ldots,t_n)=0$ ($\alpha\in I$) (Chapter~1, Exercise~27 [Section~\ref{ex1.27} p.~\pageref{ex1.27}]). Show that there exists a finite subset $I_0$ of $I$ such that $X$ is given by the equations $f_\alpha(t_1,\ldots,t_n)=0$ for $\alpha\in I_0$.

\nn\textbf{Solution.} Since $k[t_1,\ldots,t_n]$ is noetherian, there is a finite subset $I_0$ of $I$ such that the ideal generated by the $f_\alpha(t_1,\ldots,t_n)$ with $\alpha\in I$ is also generated by the $f_\alpha(t_1,\ldots,t_n)$ with $\alpha\in I_0$. %Left to the reader.

\subsubsection{Page 85, Exercise~7.9}%

\nn\textbf{Hints.} The inclusion 
$$
\aaa_{\mmm_1}\subset\left(\frac{x_0}1,\cdots,\frac{x_t}1\right)
$$ 
holds by the choice of $x_{s+1},\ldots,x_t$. 

The inclusion 
$$
\aaa_{\mmm_{r+1}}\subset\left(\frac{x_0}1,\cdots,\frac{x_t}1\right)
$$ 
holds by the choice of $x_1$ [indeed, $x_1/1$ is a unit of $A_{\mmm_{r+1}}$]. 

If $\mmm$ is a maximal ideal distinct from all the $\mmm_i$, then the inclusion 
$$
\aaa_\mmm\subset\left(\frac{x_0}1,\cdots,\frac{x_t}1\right)
$$ 
holds by the choice of $\mmm_1,\ldots,\mmm_{r+s}$ [indeed, $x_0/1$ is a unit of $A_\mmm$].

\subsubsection{Page 85, Exercise~7.10}%

See Theorem~\ref{hbt} p.~\pageref{hbt} above.

\subsubsection{Page 85, Exercise~7.11}%

\textbf{Statement.} Let $A$ be a ring such that each local ring $A_\ppp$ is Noetherian. Is $A$ necessarily Noetherian?

\nn\textbf{Hints.} See Exercises 2.28 and 3.10ii [cf. Section~\ref{ex3.10} p.~\pageref{ex3.10}] pages 35 and 44 of the book. 

\subsubsection{Page 85, Exercise~7.13}%

\textbf{Statement.} Let $f:A\to B$ be a ring homomorphism of finite type and let $f^*: \Spec(B)\to\Spec(A)$ be the mapping associated with $f$. Show that the fibers of $f^*$ are Noetherian subspaces of $B$. [Typo: it should be ``subspaces of $\Spec(B)$''.]

\nn\textbf{Hint.} Let $\ppp$ be in $\Spec(A)$ and set $k:=A_\ppp/\ppp_\ppp$. By Exercise~3.21iv p.~47 of the book [Section~\ref{321iv} p.~\pageref{321iv} above] and Exercise~6.8 p.~79 of the book [cf. Section~\ref{ex6.8} p.~\pageref{ex6.8} above], it suffices to show that $k\otimes_AB$ is noetherian. To do this, note that there are indeterminates $x_1,\dots,x_n$ such that $B$ is a quotient of $A[x_1,\dots,x_n]$, and conclude that $k\otimes_AB$ is a quotient of $k[x_1,\dots,x_n]$.

\subsubsection{Page 85, Exercise~7.14}\label{ex7.14}%

\textbf{Statement.} Let $k$ be an algebraically closed field, let $A$ denote the polynomial ring $k[t_1,\ldots,t_n]$ and let $\aaa$ be an ideal in $A$. Let $V$ be the variety in $k^n$ defined by the ideal $\aaa$, so that $V$ is the set of all $x=(x_1,\ldots,x_n)\in k^n$ such that $f(x)=0$ for all $f\in\aaa$. Let $I(V)$ be the ideal of $V$, i.e. the ideal of all polynomials $g\in A$ such that $g(x)=0$ for all $x\in V$. Then $I(V)=r(\aaa)$.

\nn\textbf{Solution.} This was proved in Paragraph~\ref{null} p.~\pageref{null}.

\subsubsection{Page 86, Exercise~7.15}%

\textbf{Statement.} Let $A$ be a Noetherian local ring, $\mmm$ its maximal ideal and $k$ its residue field, and let $M$ be a finitely generated $A$-module. Then the following are equivalent:

\nn(i) $M$ is free; 

\nn(ii) $M$ is flat;

\nn(iii) the mapping of $\mmm\otimes M$ into $A\otimes M$ is injective;

\nn(iv) $\Tor_i^A(k,M)=0$.

\nn[To show that (iv) $\implies$ (i), let $x_1,\ldots,x_n$ be elements of $M$ whose images in $M/\mmm M$ form a $k$-basis of this vector space. By (2.8)\footnote{Proposition~2.8 p.~22 of the book says ``Let $A$ be a local ring, $\mmm$ its maximal ideal, $M$ a finitely generated $A$-module, and $x_i$ ($1\le i\le n$) elements of $M$ whose images in $M/\mmm M$ form a basis of this vector space. Then the $x_i$ generate $M$.''}, the $x_i$ generate $M$. Let $F$ be a free $A$-module with basis $e_1,\ldots,e_n$ and define $\phi:F\to M$ by $\phi(e_i)=x_i$. Let $E=\Ker(\phi)$. Then the exact sequence $0\to E\to F\to M\to0$ gives us an exact sequence
$$
0\to k\otimes_AE\to k\otimes_AF\xr{1\otimes\phi}k\otimes_AM\to0.
$$ 
Since $k\otimes F$ and $k\otimes M$ are vector spaces of the same dimension over $k$, it follows that $1\otimes\phi$ is an isomorphism, hence $k\otimes E=0$, hence $E=0$ by Nakayama's Lemma ($E$ is finitely generated because it is a submodule of $F$, and $A$ is Noetherian).]

\nn\textbf{Solution.} Omitted.

\subsubsection{Page 86, Exercise~7.16}\label{ex7.16}%

\textbf{Statement.} Let $A$ be a Noetherian ring, $M$ a finitely generated $A$-module. Then the following are equivalent:

\nn(i) $M$ is a flat $A$-module;

\nn(ii) $M_\ppp$ is a free $A_\ppp$-module, for all prime ideals $\ppp$;

\nn(iii) $M_\mmm$ is a free $A_\mmm$-module, for all maximal ideals $\mmm$.

In other words, flat = locally free. [Use Exercise~15.]

\nn\textbf{Solution.} Omitted.

\subsubsection{Page 86, Exercise~7.17}% 

\textbf{Statement.} Let $A$ be a ring and $M$ a Noetherian $A$-module. Show (by imitating the proofs of (7.11) and (7.12)) that every submodule $N$ of $M$ has a primary decomposition (Chapter~4, Exercises 20-23).

\nn\textbf{Hint.} Let $M$ be a noetherian $A$-module whose zero submodule $0\subset M$ is irreducible. Let us show that $0$ is primary in $M$. 

Let $a$ be an element of $A$ which is a zero-divisor in $M$. It suffices to show that $a$ is nilpotent in $M$. 

The chain of submodules $(0:a)\subset(0:a^2)\subset\cdots$ stabilizes. Say $(0:a^n)=(0:a^{n+1})$. It suffices to show $a^nM=0$. 

Let $x\in M$ satisfy $x\ne0$ and $ax=0$. It is enough to prove $a^nM\cap Ax=0$. 

Let $y$ be in $a^nM\cap Ax=0$. We only need to show $y=0$. 

We have $y=a^nz=bx$ for some $z\in M$ and some $b\in A$, and we get 
$$
ay=a^{n+1}z=abx=bax=0,
$$ 
and thus $0=a^nz=y$. This completes the proof. 

\subsubsection{Page 86, Exercise~7.18}\label{ex7.18}%

\textbf{Statement.} Let $A$ be a Noetherian ring, $\ppp$ a prime ideal of $A$, and $M$ a finitely generated $A$-module. Show that the following are equivalent:

\nn(i) $\ppp$ belongs to $0$ in $M$;

\nn(ii) there exists $x\in M$ such that $\Ann(x)=\ppp$;

\nn(iii) there exists a submodule of $M$ isomorphic to $A/\ppp$.

Deduce that there exists a chain of submodules
$$
0=M_0\subset M_1\subset\cdots\subset M_r=M
$$ 
such that each quotient $M_i/M_{i-1}$ is of the form $A/\ppp_i$ where $\ppp_i$ is a prime ideal of $A$.

\nn\textbf{Solution.} Recall Proposition~7.17 p.~83 of the book:

\begin{prop}[Proposition~7.17]
Let $\aaa\ne(1)$ be an ideal in a Noetherian ring. Then the prime ideals which belong to $\aaa$ are precisely the prime ideals which occur in the set of ideals $(\aaa:x)$ ($x\in A$).
\end{prop}

This proposition and its proof can be generalized to modules according to the following table: 
$$
{\renewcommand{\arraystretch}{1.2}%
\begin{array}{|c|c|c|c|c|c|c|}\hline
\aaa\ne(1)&x\in A&\qqq_i&\ppp_i=r(\qqq_i)&\aaa_i&\ppp_i^m\subset\qqq_i&\aaa_i\cap\ppp_i^m\\ \hline
N\subsetneqq M&x\in M&Q_i&\ppp_i=r(Q_i:M)&N_i&\ppp_i^mM\subset Q_i&N_i\cap\ppp_i^mM\\ \hline
\end{array}}
$$

Here is the generalized proposition:

\begin{prop}
Let $A$ be a noetherian ring, let $N$ be a proper submodule of an $A$-module $M$. Then the prime ideals which belong to $N$ in $M$ are precisely the prime ideals which occur in the set of ideals $(N:x)$ ($x\in M$).
\end{prop}

The generalized proposition yields the equivalence (i)$\iff$(ii). The equivalence (ii)$\iff$(iii) is clear. To prove the existence of the stated chain, the generalized proposition furnishes $M_0$. The same argument with $M$ replaced by $M/M_0$ gives a submodule $M'_1$ of $M/M_0$, and we can let $M_1\subset M$ be the inverse image of $M'_1$. Continuing this way, we get the desired chain after a finite number of steps.

\subsubsection{Page 86, Exercise~7.19}% https://mathoverflow.net/q/12322/461
% version of 200528: https://docs.google.com/document/d/1T-TwxPnyJQv5Y1jqLIEEGUmE__PS3zMhLF3kQFoqZIU/edit
% previous version https://docs.google.com/document/d/1a-63-De-I8iBErGM5vuEuVpkBAJ1fOm2j0ECZIMzeT4/edit?folder=0ADbJLwZkWgt8Uk9PVA

\textbf{Statement.} Let $\aaa$ be an ideal in a Noetherian ring $A$. Let 
$$
\mathfrak{a}=\bigcap_{i=1}^r\mathfrak{b}_i=\bigcap_{j=1}^s\mathfrak{c}_j
$$ 
be two minimal decompositions of $\aaa$ as intersections of irreducible ideals. Prove that $r=s$ and that [possibly after re-indexing the $\ccc_i$] $r(\bbb_i)=r(\ccc_i)$ for all $i$. State and prove an analogous result for modules.

\nn\textbf{Solution.} Our goal is to prove:

\begin{prop}\label{719P1}
(a) Let $A$ be a ring, $M$ an $A$-module and $W$ a submodule. Let 
$$
W=\bigcap_{i=1}^nU_i=\bigcap_{j=1}^mV_j
$$ 
be two minimal decompositions of $W$ as intersections of irreducible submodules. Then $n=m$.

\nn(b) If $M$ is noetherian, we have [possibly after re-indexing the $V_j$] $r(U_i:M)=r(V_i:M)$ for all $i$.
\end{prop}

\paragraph{Proof of Part (a) of Proposition~\ref{719P1}.}%

\begin{lem}\label{719L2}
Let $A$ be a ring, $M$ an $A$-module and let $U_1$, $U_2$, $V_1$,\dots, $V_m$, $W$ be submodules of $M$ such that $U_1$ is irreducible and $W=U_1\cap U_2=V_1\cap\cdots\cap V_m$. Then we have $W=V_i\cap U_2$ for some $i$. 
\end{lem} 

We summarize Lemma~\ref{719L2} by saying that ``we have replaced $U_1$ with $V_i$ in the equality $W=U_1\cap U_2$''. 

Before proving Lemma~\ref{719L2}, we show that it implies Part (a) of Proposition~\ref{719P1}. 

It suffices to derive a contradiction from the assumption $n<m$. Using Lemma~\ref{719L2} repeatedly we get $V_{i_1}\cap\cdots\cap V_{i_n}=V_1\cap\cdots\cap V_m$, in contradiction with the minimality of the right side.

\subparagraph{Proof of Lemma~\ref{719L2}.}%\phantom0%${}$\medskip%
We follow Matthew Emerton: \href{https://mathoverflow.net/q/12322/461}{https://mathoverflow.net/q/12322/461}

We can assume $W=0$. Let $\phi_i:M\to M/U_i$ ($i=1,2$) and $\phi:M\mono M/U_1\times M/U_2$ be the natural morphisms, note that $\phi$ is injective, and set $X_j:=V_j\cap U_2$ for $1\le j\le m$. 

It suffices to show $X_j=0$ for some $j$.

We have $\bigcap X_j\subset\bigcap V_j=0$ and $\phi(X_j)=\phi_1(X_j)\times0$. By injectivity of $\phi$ we also have 
$$
\bigcap\phi(X_j)=\phi\left(\bigcap X_j\right)=0,
$$ 
and thus $\bigcap\phi_1(X_j)=0$. The zero submodule of $M/U_1$ being ir\-re\-ducible, this implies $\phi_1(X_j)=0$, hence $X_j=0$, for some $j$. This proves Lemma~\ref{719L2}.

Part (a) of Proposition~\ref{719P1} has been proved, and it only remains to prove Part~(b).

\paragraph{Proof of Part (b) of Proposition~\ref{719P1}.}%

Recall the setting: $A$ is a ring, $M$ is a noetherian $A$-module, $W$ is a submodule, 
$$
W=\bigcap_{i=1}^nU_i=\bigcap_{j=1}^nV_j
$$ 
are two minimal decompositions of $W$ as intersections of irreducible submodules. We must show that we have [possibly after re-indexing the $V_j$] $r(U_i:M)=r(V_i:M)$ for all $i$.

Irreducible submodules being primary, the sets 
$$
\{r(U_1:M),\dots,r(U_n:M)\}\text{ and }\{r(V_1:M),\dots,r(V_n:M)\}
$$ 
are equal. Denote this set by $P$, write $[n]$ for the set $\{1,\dots,n\}$ and define the maps $f$ and $g$ from $[n]$ to $P$ by $f(i):=r(U_i:M)$ and $g(i):=r(V_i:M)$. It suffices to show that, for all $\ppp\in P$, the fibers $f^{-1}(\ppp)$ and $g^{-1}(\ppp)$ are equipotent. 

Let $I$ be an isolated subset of $P$. The Second Uniqueness Theorem for modules implies 
$$
\bigcap_{i\in f^{-1}(I)}U_i=\bigcap_{i\in g^{-1}(I)}V_i.
$$ 
Then Part (a) of Proposition~\ref{719P1} entails that $f^{-1}(I)$ and $g^{-1}(I)$ are equipotent. In particular, if $\ppp\in P$ is minimal, $f^{-1}(\ppp)$ and $g^{-1}(\ppp)$ have same cardinality, and an obvious induction completes the proof. 

\subsubsection{Page 87, Exercise~7.20}\label{ex7.20}%

\textbf{Statement.} Let $X$ be a topological space and let $\mathcal F$ be the smallest collection of subsets of $X$ which contains all open subsets of $X$ and is closed with respect to the formation of finite intersections and complements.

\nn(i) Show that a subset $E$ of $X$ belongs to $\mathcal F$ if and only if $E$ is a finite union of sets of the form $U\cap C$, where $U$ is open and $C$ is closed.

\nn(ii) Suppose that $X$ is irreducible [see Section~\ref{irr} p.~\pageref{irr} above] and let $E\in\mathcal F$. Show that $E$ is dense in $X$ [i.e., that $\overline E=X$] if and only if $E$ contains a non-empty open set in $X$. 

\nn\textbf{Solution.}

\nn(i) Let $\mathcal F'$ be the set of those subsets $E$ of $X$ such that $E$ is a finite union of sets of the form $U\cap C$, where $U$ is open and $C$ is closed. It suffices to check that, if two sets are in $\mathcal F'$, then so are their respective complements and their intersection. This is straightforward. 

\nn(ii) If $E$ contains a non-empty open set $U$, then $X=\overline E\cup U^*$, where $U^*$ is the complement of $U$, and the irreducibility of $X$ implies $X=\overline E$. Conversely, if $E=(U_1\cap C_1)\cup\cdots\cup(U_n\cap C_n)$ [obvious notation] is dense in $X$, then one of the $U_i\cap C_i$ is already dense in $X$. This implies $C_i=X$ and thus $U_i\subset E$.

\subsubsection{Page 87, Exercise~7.21}\label{ex7.21}%

\textbf{Statement.} Let $X$ be a Noetherian topological space [Chapter~6, Exercise~5 --- see Section~\ref{ex7.20} p.~\pageref{ex7.20} above] and let $E\subset X$. Show that $E\in\mathcal F$ if and only if Condition~$(\star)$ below holds: 

\nn$(\star)$ for each irreducible closed set $X_0\subset X$, either $\overline{E\cap X_0}\ne X_0$ or else $E\cap X_0$ contains a non-empty open subset of $X_0$. 

\nn\textbf{Solution.} Let us denote by $\mathcal F(X)$ the set designated by $\mathcal F$ in Exercise~7.20 [see Section~\ref{ex7.20} p.~\pageref{ex7.20} above]. 

To prove that $E\in\mathcal F(X)$ implies $(\star)$, note that $E\cap X_0\in\mathcal F(X_0)$ if $E\in\mathcal F(X)$ and use Exercise~7.20.% previous version of the end of the section: https://docs.google.com/document/d/1032l7e5aaxVmdV--H-S8kD2aTal5DmKZaZMrcmIkI8M/edit

To prove that $(\star)$ implies $E\in\mathcal F(X)$, we follow the hint, that is, we assume by contradiction that $(\star)$ holds but that $E$ is not in $\mathcal F:=\mathcal F(X)$.

Let $\Sigma$ be the set of all closed subsets $X'$ of $X$ such that $E\cap X'\notin\mathcal F$. 

Then $\Sigma$ is nonempty because $X\in\Sigma$. Let $X_0$ be a minimal element of $\Sigma$. In particular 
\begin{equation}\label{721}
E\cap X_0\notin\mathcal F.
\end{equation}  
The subset $X_0$ is irreducible, for if we had $X_0=C\cup D$ with $C,D$ closed and $\subsetneqq X_0$, we would have $C,D\notin\Sigma$ by minimality of $X_0$, and thus $E\cap C$ and $E\cap D$ would be in $\mathcal F$, which would imply 
$$
\mathcal F\ni(E\cap C)\cup(E\cap D)=E\cap(C\cup D)=E\cap X_0\notin\mathcal F.
$$ 
We claim 
\begin{equation}\label{oex0}
\overline{E\cap X_0}=X_0.
\end{equation}
To prove \eqref{oex0}, assume by contradiction that we have $\overline{E\cap X_0}\subsetneqq X_0$. The minimality of $X_0$ implies 
\begin{equation}\label{eco}
E\cap\overline{E\cap X_0}\in\mathcal F.
\end{equation}
We have $E\cap X_0\subset E\cap\overline{E\cap X_0}$ because $E\cap X_0\subset E$ and $E\cap X_0\subset\overline{E\cap X_0}$. This implies 
$$
E\cap X_0=E\cap\overline{E\cap X_0}.
$$ 
In view of \eqref{721} and \eqref{eco}, this gives the contradiction needed to prove \eqref{oex0}.

Now $(\star)$ implies that there is a nonempty open subset $U$ of $X_0$ such that $U\subset E$. 

We have $U\subsetneqq X_0$ because $U=X_0$ would imply $\mathcal F\ni X_0=E\cap X_0\notin\mathcal F$ by \eqref{721}. 

The set $C:=X_0\setminus U$ is closed in $X$, and we have $X_0=U\sqcup C$ [disjoint union], $U\ne\varnothing\ne C$, and thus $E\cap X_0=(E\cap U)\sqcup(E\cap C)=U\sqcup(E\cap C)$. As $U\ne\varnothing$, we get $E\cap C\subsetneqq E\cap X_0$, and thus $E\cap C\in\mathcal F$ by minimality of $X_0$. Then the above display implies $E\cap X_0\in\mathcal F$, contradicting again \eqref{721}.

\subsubsection{Page 87, Exercise~7.22}\label{ex7.22}%

\textbf{Statement.} Let $X$ be a Noetherian topological space and let $E$ be a subset of $X$. Show that $E$ is open in $X$ if and only if, for each irreducible closed subset $X_0$ in $X$, either $E\cap X_0=\varnothing$ or else $E\cap X_0$ contains a non-empty open subset of $X_0$.

\nn\textbf{Solution.} If $E$ is open in $X$, then the indicated condition holds because $E\cap X_0\ne\varnothing$ implies that $E\cap X_0$ is a non-empty open subset of $X_0$ contained in $E\cap X_0$. 

Assume that $E$ is not open in $X$. Set $F:=X\setminus E$. Then $F$ is not closed. Put 
$$
\Sigma:=\{\ X'\subset X|\ X'\text{ is closed, }F\cap X'\text{ is not closed}\}.
$$ 
In particular $X$ belongs to $\Sigma$. Let $X_0$ be a minimal element of $\Sigma$.

It suffices to show:

\qquad(a) $X_0$ is irreducible,

\qquad(b) $E\cap X_0\ne\varnothing$,

\qquad(c) $E\cap X_0$ contains no non-empty open subset of $X_0$.

\nn Proof of (a): The conditions $X_0=Y_1\cup Y_2$ with $Y_i\subsetneqq X_0$ and $Y_i$ closed would imply $F\cap X_0=(F\cap Y_1)\cup(F\cap Y_2)$ with $F\cap Y_i$ closed and $F\cap X_0$ not closed, which is impossible.

\nn Proof of (b): The equality $E\cap X_0=\varnothing$ would imply $F\cap X_0=X_0$ with $F\cap X_0$ not closed and $X_0$ closed, contradiction.

\nn Proof of (c): Assume $E\cap X_0\supset U\ne\varnothing$ with $U$ open in $X_0$. It suffices to derive a contradiction. Set $X_1:=X_0\setminus U$. We clearly have $X_1\subsetneqq X_0$. 

We claim: $F\cap X_1=F\cap X_0$. 

It is enough to show $F\cap X_0\subset F\cap X_1$. Let $a$ be in $F\cap X_0$. As $a$ cannot be in $U$ [because this would imply $a\in E\cap F=\varnothing$], the point $a$ is in $X_0\setminus U=X_1$, and the claim is proved.

The claim implies $X_1\in\Sigma$, contradicting the minimality of $X_0$. This completes the proof of (c).

\subsubsection{Page 87, Exercise~7.23}\label{ex7.23}%

\textbf{Statement.} Let $A$ be a Noetherian ring, $f:A\to B$ a ring homomorphism of finite type (so that $B$ is Noetherian). Let $X=\Spec(A)$, $Y=\Spec(B)$ and let $f^*:Y\to X$ be the mapping associated with $f$. Then the image under $f^*$ of a constructible subset $E$ of $Y$ is a constructible subset of $X$.

\nn[By Exercise~20 [Section~\ref{ex7.20} p.~\pageref{ex7.20}] it is enough to take $E=U\cap C$ where $U$ is open and $C$ is closed in $Y$; then, replacing $B$ by a homomorphic image, we reduce to the case where $E$ is open in $Y$. Since $Y$ is Noetherian, $E$ is quasi-compact and therefore a finite union of open sets of the form $\Spec(B_g)$. Hence reduce to the case $E=Y$. To show that $f^*(Y)$ is constructible, use the criterion of Exercise~21 [Section~\ref{ex7.21} p.~\pageref{ex7.20}]. Let $X_0$ be an irreducible closed subset of $X$ such that $f^*(Y)\cap X_0$ is dense in $X_0$. We have $f^*(Y)\cap X_0=f^*(f^{*-1}(X_0))$, and $f^{*-1}(X_0)=\Spec((A/\ppp)\otimes_AB)$, where $X_0=\Spec(A/\ppp)$. Hence reduce to the case where $A$ is an integral domain and $f$ is injective. If $Y_1,\ldots,Y_n$ are the irreducible components of $Y$, it is enough to show that some $f^*(Y_j)$ contains a non-empty open set in $X$. So finally we are brought down to the situation in which $A,B$ are integral domains and $f$ is injective (and still of finite type); now use Chapter~5, Exercise~21 [Section~\ref{ex5.21} p.~\pageref{ex7.20}] to complete the proof.]

\nn\textbf{Hints.} The fact that ``$E$ is quasi-compact'' in the hint of the book follows from Exercise~6.6 p.~79 of the book. The phrase ``where $X_0=\Spec(A/\ppp)$'' follows from Section~\ref{irr} p.~\pageref{irr} above. 

Here are some details about various steps:

\nn$\bu$ Restriction to the case when $A$ is a domain and $f$ is injective: We have $X_0=V(\ppp)\simeq\Spec(A/\ppp)$ for some $\ppp\in X$. If $\overline f$ is the natural monomorphism $A/\ppp\to B/\ppp^{\oo e}$, then the diagram below, where the vertical arrows are the obvious homeomorphisms, commutes: 
$$
\begin{tikzcd}
\Spec(B/\ppp^{\oo e})\ar[r,"\overline f^*"]\ar[d,leftrightarrow]&\Spec(A/\ppp)\ar[d,leftrightarrow]\\ 
f^{*-1}(X_0)\ar[r,"f^*"']&X_0.
\end{tikzcd}
$$ 
\nn$\bu$ Restriction to the case when $A$ and $B$ are domains and $f$ is injective: As $X$ is irreducible, at least one of the $f^*(Y_i)$ is dense. We have $Y_i\simeq\Spec(B/\qqq)$ for some $\qqq\in Y$. We can replace $B$ with $B/\qqq$, i.e. we can assume that $B$ is a domain and $f^*(Y)$ is dense, and Exercise~1.21v p.~13 of the book [Section~\ref{ex1.21} p.~\pageref{ex1.21}] implies that $f$ is injective. 

\nn$\bu$ Last step: See Section~\ref{ex5.21} p.~\pageref{ex5.21} above.

\subsubsection{Page 87, Exercise~7.24}\label{ex7.24}%

\textbf{Statement.} With the notation and hypotheses of Exercise~23 [Section~\ref{ex7.23} p.~\pageref{ex7.23}], $f^*$ is an open mapping $\iff$ $f$ has the going-down property (Chapter~5, Exercise~10 [Section~\ref{ex5.10} p.~\pageref{ex5.10}]). [Suppose $f$ has the going-down property. As in Exercise~23 [Section~\ref{ex7.23} p.~\pageref{ex7.23}], reduce to proving that $E=f^*(Y)$ is open in $X$. The going-down property asserts that if $\ppp\in E$ and $\ppp'\subset\ppp$ then $\ppp'\in E$: in other words, that if $X_0$ is an irreducible closed subset of $X$ and $X_0$ meets $E$, then $E\cap X_0$ is dense in $X_0$. By Exercises~20 and 22 [Section~\ref{ex7.20} p.~\pageref{ex7.20} and Section~\ref{ex7.22} p.~\pageref{ex7.22}], $E$ is open in $X$.]

\nn\textbf{Solution.} Let us spell out the last two sentences of the hint.

Let $\ppp_0$ be in $X$, and set $X_0:=V(\ppp_0)$. Assuming that $f$ has the going-down property, we want to show that $E:=f^*(Y)$ is open in $X$. Suppose $E\cap X_0\ne\varnothing$, and thus 
\begin{equation}\label{p0e}
\ppp_0\in E
\end{equation} 
[by the going-down property]. As $E$ is constructible by Exercise~7.23, it suffices, in view of Exercise~7.22, to show that $E\cap X_0$ contains a nonempty open subset of $X_0$, and Exercise~7.20ii [see Section~\ref{ex7.20} p.~\pageref{ex7.20} above] tells us that it is even enough to check the inclusion 
\begin{equation}\label{724}
X_0\subset\overline{E\cap X_0}.
\end{equation} 
Setting $\aaa:=\bigcap_{\ppp\in E\cap X_0}\ppp$, we get $\aaa\subset\ppp_0$ because $\ppp_0\in E\cap X_0$ by \eqref{p0e}, that is 
$$
X_0=V(\ppp_0)\subset V(\aaa)=\overline{E\cap X_0},
$$ 
proving \eqref{724}.

\subsubsection{Page 87, Exercise~7.25}%

\textbf{Statement.} Let $A$ be Noetherian, $f:A \to B$ of finite type and flat (i.e., $B$ is flat as an $A$-module). Then $f^*:\Spec(B)\to\Spec(A)$ is an open mapping. [Exercise~24 and Chapter~5, Exercise~11; Section~\ref{ex7.24} p.~\pageref{ex7.24} and Section~\ref{ex5.11} p.~\pageref{ex5.11}.]

\nn\textbf{Solution.} Omitted. [The hint in the book is fairly complete.]

\subsubsection{Page 88, Exercise~7.26}% K(A)

\textbf{Statement.} Let $A$ be a Noetherian ring and let $F(A)$ denote the set of all isomorphism classes of finitely generated $A$-modules. Let $C$ be the free abelian group generated by $F(A)$. With each short exact sequence $0\to M'\to M\to M''\to0$ of finitely generated $A$-modules we associate the element $(M')-(M)+(M)$ of $C$, where $(M)$ is the isomorphism class of $M$, etc. Let $D$ be the subgroup of $C$ generated by these elements, for all short exact sequences. The quotient group $C/D$ is called the \textbf{Grothendieck group} of $A$, and is denoted by $K(A)$. If $M$ is a finitely generated $A$-module, let $\gamma(M)$, or $\gamma_A(M)$, denote the image of $(M)$ in $K(A)$.

\nn(i) Show that $K(A)$ has the following universal property: for each additive function, $\lambda$ on the class of finitely generated $A$-modules, with values in an abelian group $G$, there exists a unique homomorphism $\lambda_0:K(A)\to G$ such that $\lambda(M)=\lambda_0(\gamma(M))$ for all $M$.

\nn(ii) Show that $K(A)$ is generated by the elements $\gamma(A/\ppp)$, where $\ppp$ is a prime ideal of $A$. [Use Exercise~18, Section~\ref{ex7.18} p.~\pageref{ex7.18}.]

\nn(iii) If $A$ is a field, or more generally if $A$ is a principal ideal domain, then $K(A)\simeq\mathbb Z$.

\nn(iv) Let $f:A\to B$ be a \textbf{finite} ring homomorphism. Show that restriction of scalars gives rise to a homomorphism $f_!:K(B)\to K(A)$ such that $fi(\gamma_B(N))=\gamma_A(N)$ for a $B$-module $N$. If $g:B\to C$ is another finite ring homomorphism, show that $(g\circ f)_!=f_!\circ g_!$.

\nn\textbf{Hints.} (i) Left to the reader.

\nn(ii) In the notation of Exercise~18 Section~\ref{ex7.18} we have 
\begin{align*}
\gamma(M)&=\gamma(A/\ppp_r)+\gamma(M_{r-1}) \\ 
&=\gamma(A/\ppp_r)+\gamma(A/\ppp_{r-1})+\gamma(M_{r-1})\\ 
&\hskip6pt\vdots\\ 
&=\gamma(A/\ppp_r)+\gamma(A/\ppp_{r-1})+\cdots+\gamma(A/\ppp_1).
\end{align*}

\nn(iii) If $\ppp$ is a nonzero prime ideal, we have $0=\gamma(A)-\gamma(A)+\gamma(A/\ppp)=\gamma(A/\ppp)$ in $K(A)$. This shows that $K(A)$ is generated by $\gamma(A)$. Using again the notation of Exercise~18 Section~\ref{ex7.18}, we have a surjective \textbf{rank morphism} $C\to\Z$ which induces by (i) a surjective morphism $K(A)\to\Z$. This implies $K(A)\simeq\Z$.

\nn(iv) Left to the reader.

\subsubsection{Page 88, Exercise~7.27}% K_1(A)

\textbf{Statement.} Let $A$ be a Noetherian ring and let $F_1(A)$ be the set of all isomorphism classes of finitely generated \textbf{flat} $A$-modules. Repeating the construction of Exercise~26 we obtain a group $K_1(A)$. Let $\gamma_1(M)$ denote the image of $(M)$ in $K_1(A)$.

\nn(i) Show that tensor product of modules over $A$ induces a commutative ring structure on $K_1(A)$, such that $\gamma_1(M)\cdot\gamma_1(N)=\gamma_1(M\otimes N)$. The identity element of this ring is $\gamma_1(A)$.

\nn(ii) Show that tensor product induces a $K_1(A)$-module structure on the group $K(A)$, such that $\gamma_1(M)\cdot\gamma(N)=\gamma(M\otimes N)$.

\nn(iii) If $A$ is a (Noetherian) local ring, then $K_1 (A)\simeq\mathbb Z$.

\nn(iv) Let $f:A\to B$ be a ring homomorphism, $B$ being Noetherian. Show that extension of scalars gives rise to a ring homomorphism $f^!:K_1(A)\to K_1(B)$ such that $f^!(\gamma_1(M))=\gamma_1(B\otimes_AM)$. [If $M$ is flat and finitely generated over $A$, then $B\otimes_AM$ is flat and finitely generated over $B$.] If $g:B\to C$ is another ring homomorphism (with $C$ Noetherian), then $(f\circ g)^!=f^!\circ g^!$.

\nn(v) If $f:A\to B$ is a finite ring homomorphism then 
$$
f_!(f^!(x)y)=xf_!(y)
$$ 
for $x\in K_1(A)$, $y\in K(B)$. In other words, regarding $K(B)$ as a $K_1(A)$-module by restriction of scalars, the homomorphism $f^!$ is a $K_1(A)$-module homomorphism.

\textbf{Remark.} Since $F_1(A)$ is a subset of $F(A)$ we have a group homomorphism $\varepsilon:K_1(A)\to K(A)$, given by $\varepsilon(\gamma_1(M))=\gamma(M)$. If the ring $A$ is finite-dimensional and \textbf{regular}, i.e., if all its local rings $A_\ppp$ are regular (Chapter~11) it can be shown that $\varepsilon$ is an isomorphism.

\nn\textbf{Hints.} (i) Hint: use Exercise~2.8i [Section~\ref{ex2.8} p.~\pageref{ex2.8}].

\nn(ii) Left to the reader.

\nn(iii) Hint: use Exercise~7.16 [Section~\ref{ex7.16} p.~\pageref{ex7.16}].

\nn(iv) Left to the reader.

\nn(v) Setting $x=\gamma_{1A}(M),y=\gamma_B(N)$ we get 
$$
f_!(f^!(x)y)=f_!(f^!(\gamma_{1A}(M))\gamma_B(N))=f_!(\gamma_{1B}(B\otimes_AM)\gamma_B(N))=
f_!(\gamma_B(N\otimes_BB\otimes_AM))
$$ 
$$
=f_!(\gamma_B(M\otimes_AN))=\gamma_A(M\otimes_AN)
$$ 
and 
$$
xf_!(y)=\gamma_{1A}(M)f_!(\gamma_B(N))=\gamma_{1A}(M)\gamma_A(N)=\gamma_A(M\otimes_AN).
$$

\newpage

\section{About Chapter~8}%%%

\subsection{Comments}%%

\subsubsection{Theorem~8.5 p.~90}\label{s8.5}%

Recall Theorem~8.5:

\begin{thm}[Theorem~8.5 p.~90 of the book]\label{t8.5}
A ring $A$ is Artin $\iff A$ is Noetherian and $\dim A=0$.
\end{thm}

Theorem~8.5 implies that an Artin ring $A$ is a finite length $A$-module. In particular Propositions 6.7 and 6.8 p.~77 of the book apply to chains of ideals of $A$.

\subsubsection{Proposition~8.6 p. 90}\label{p8.6}%

I suggest the following restatement of Proposition~8.6:

\nn\emph{Let $A$ be a noetherian local ring, $\mmm$ its maximal ideal. Then exactly one of the following two statements is true:}

\nn(i) $\mmm^n\ne\mmm^{n+1}$ \emph{for all $n$ and $A$ is \textbf{not} Artin},

\nn(ii) $\mmm^n=0$ \emph{for some $n$, in which case $A$ is an Artin local ring.}

In particular 
\begin{equation}\label{86}
A\text{ is Artin $\iff\mmm$ is nilpotent.}
\end{equation} 

By Proposition~8.6 p.~90 of the book [Section~\ref{p8.6} p.~\pageref{p8.6}] and Proposition~\ref{p4.2} p.~\pageref{p4.2}, we have:

\nn\emph{Every proper ideal of an Artin local ring is $\mmm$-primary (where $\mmm$ is the maximal ideal).} 

This fact is implicitly used in the proof of Theorem~8.7.

\subsubsection{Theorem~8.7 p. 90}

Recall the statement of the theorem:

\begin{thm}[Theorem~8.7 p.~90 of the book, structure theorem for Artin rings]\label{t8.7}
An Artin ring $A$ is uniquely (up to isomorphism) a finite direct product of Artin local rings.
\end{thm}

It seems to me that the second part of the proof of Theorem~8.7 can be simplified. We must check the essential uniqueness of the decomposition of an Artin ring $A$ as a finite product of Artin local rings $A_i$. But, looking at minimal idempotents, one sees that, if a ring can be decomposed as a product of finitely many local rings, such a decomposition is essentially unique. More precisely, the kernels of the morphisms from the ring to the various factors are exactly those ideals which are maximal among the proper ideals generated by an idempotent.

\subsubsection{Page 91, Proposition~8.8}%

Let $A$ be an Artin local ring with maximal ideal $\mmm$ and consider the condition

$(*)$ there is an $x$ in $\mmm$ such that every ideal of $A$ is of the form $(x^r)$. 

\nn The proof of Proposition~8.8 shows that $(*)$ is equivalent to any of the conditions (i), (ii) or (iii).

\subsection{Exercises}%%

\subsubsection{Page 91, Exercise~8.1}%

\textbf{Statement.} Let $\qqq_1\cap\cdots\cap\qqq_n=(0)$ be a minimal primary decomposition of the zero ideal in a Noetherian ring, and let $\qqq_i$ be $\ppp_i$-primary. Let $\ppp_i^{(r)}$ be the $r$th \textbf{symbolic power} of $\ppp_i$ (Chapter~4, Exercise~13; Section~\ref{ex4.13} p.~\pageref{ex4.13}). Show that for each $i=1,\ldots,n$ there exists an integer $r_i$ such that $\ppp_i^{(r_i)}\subset\qqq_i$.

Suppose $\qqq_i$ is an isolated primary component. Then $A_{\ppp_i}$ is an Artin local ring, hence if $\mmm_i$ is its maximal ideal we have $\mmm_i^r=(0)$ for all sufficiently large $r$, hence $\qqq_i=\ppp_i^{(r)}$ for all large $r$.

If $\qqq_i$ is an embedded primary component, then $A_{\ppp_i}$, is \textbf{not} Artinian, hence the powers $\mmm_i^r$ are all distinct, and so the $\ppp_i^{(r)}$ are all distinct. Hence in the given primary decomposition we can replace $\qqq_i$ by any of the infinite set of $\ppp_i$-primary ideals $\ppp_i^{(r)}$ where $r\ge r_i$ and so there are infinitely many minimal primary decompositions of $(0)$ which differ only in the $\ppp_i$-component.

\nn\textbf{Solution.} Reminder: Proposition 7.14 p.~83 of the book says that, in a noetherian ring, every ideal a contains a power of its radical.

To show that for each $i=1,\ldots,n$ there exists an integer $r_i$ such that $\ppp_i^{(r_i)}\subset\qqq_i$, note that, by Proposition~7.14 [see reminder above] there exists an integer $r_i$ such that $(\ppp_i)_{\ppp_i}^{r_i}\subset(\qqq_i)_{\ppp_i}$, and the inclusion $\ppp_i^{(r_i)}\subset\qqq_i$ follows by contraction.

In the second paragraph, we suppose in addition that $\qqq_i$ is an isolated primary component. By Corollary~\ref{ctoc4.11}a p.~\pageref{ctoc4.11} $\qqq_i$ is the smallest $\ppp_i$-primary ideal. We have just shown that there exists an integer $r$ such that $\ppp_i^{(r)}\subset\qqq_i$. By Exercise~4.13i [Section~\ref{ex4.13} p.~\pageref{ex4.13}] $\ppp_i^{(r)}$ is $\ppp_i$-primary. This implies $\qqq_i=\ppp_i^{(r)}$.%$A_{\ppp_i}$ is an Artin local ring by Theorem~\ref{t8.5} p.~\pageref{t8.5}. 

The claims in the second paragraph, follow from Proposition~8.6 p.~90 of the book [Section~\ref{p8.6} p.~\pageref{p8.6}].

\subsubsection{Page 91, Exercise~8.2}%

\textbf{Statement.} Let $A$ be a Noetherian ring. Prove that the following are equivalent: 

\nn(i) $A$ is Artinian;

\nn(ii) $\Spec(A)$ is discrete and finite; 

\nn(iii) $\Spec(A)$ is discrete.

\nn\textbf{Hint.} Use Exercise~1.22 [Section~\ref{ex1.22} p.~\pageref{ex1.22}], Theorem~\ref{t8.5} p.~\pageref{t8.5} [recall that Theorem~\ref{t8.5} says that a ring $A$ is Artin $\iff A$ is Noetherian and $\dim A=0$] and Theorem~\ref{t8.7} p.~\pageref{t8.7} [recall that Theorem~8.7 is the structure theorem for Artin rings and that it says that an Artin ring $A$ is uniquely (up to isomorphism) a finite direct product of Artin local rings].

\subsubsection{Page 91, Exercise~8.3}%

\textbf{Statement.} Let $k$ be a field and $A$ a finitely generated $k$-algebra. Prove that the following are equivalent:

\nn(i) $A$ is Artinian;

\nn(ii) $A$ is a finite $k$-algebra.

\nn[To prove that (i) $\implies$ (ii), use Theorem~\ref{t8.7} p.~\pageref{t8.7} [recall that Theorem~8.7 is the structure theorem for Artin rings and that it says that an Artin ring $A$ is uniquely (up to isomorphism) a finite direct product of Artin local rings] to reduce to the case where $A$ is an Artin local ring. By the Nullstellensatz, the residue field of $A$ is a finite extension of k. Now use the fact that $A$ is of finite length as an $A$-module. To prove (ii) $\implies$ (i), observe that the ideals of $A$ are $k$-vector subspaces and therefore satisfy d.c.c.]

\nn\textbf{Solution.} Left to the reader. [Recall that Theorem~8.7 is the structure theorem for Artin rings and that it says: ``An Artin ring $A$ is uniquely (up to isomorphism) a finite direct product of Artin local rings.'']

\subsubsection{Page 92, Exercise~8.4}%

\textbf{Statement.} Let $f:A\to B$ be a ring homomorphism of finite type. Consider the following statements:

\nn(i) $f$ is finite;

\nn(ii) the fibres of $f^*$ are discrete subspaces of $\Spec(B)$;

\nn(iii) for each prime ideal $\ppp$ of $A$, the ring $B\otimes_Ak(\ppp)$ is a finite $k(\ppp)$-algebra ($k(\ppp)$ is the residue field of $A_\ppp$);

\nn(iv) the fibres of $f^*$ are finite.

Prove that (i) $\implies$ (ii) $\iff$ (iii) $\implies$ (iv). [Use Exercises 2 and 3.]

If $f$ is integral and the fibres of $f^*$ are finite, is $f$ necessarily finite?

\nn\textbf{Hints.} To prove (i)$\implies$(iii) on can use Section~\ref{res} p.~\pageref{res}, Claim~1 above and the following Lemma:

\begin{lem}
Let $A\to B$ be an integral ring morphism, let $S\subset A$ be a multiplicative subset, and let $\ppp$ be a prime ideal of $A$ disjoint from $S$. Then the induced morphism $S^{-1}A/S^{-1}\ppp\to S^{-1}B/(S^{-1}\ppp)^{\oo e}$ is integral.
\end{lem} 
 
\begin{proof}
By Proposition~5.6ii p.~61 of the book, $S^{-1}A\to S^{-1}B$ is integral. By Proposition~3.11iv p.~41 of the book [Proposition~\ref{p3.11} p.~\pageref{p3.11}], $S^{-1}\ppp$ is prime. By Theorem 5.10 p.~62 of the book, $S^{-1}\ppp$ is contracted. Now the Lemma follows from Proposition~5.6i p.~61 of the book.
\end{proof}

Hint for the last question, which is ``If $f$ is integral and the fibres of $f^*$ are finite, is $f$ necessarily finite?'': Consider the case when $A$ and $B$ are fields. 

Note that $\mathbb Z\to\mathbb Z[\frac12]$ satisfies (ii) but not (i).

\subsubsection{Page 91, Exercise~8.5}%

\textbf{Statement.} In Chapter~5, Exercise~16 [Section~\ref{ex5.16} p.~\pageref{ex5.16}; this is the section about the Noether's Normalization Theorem], show that $X$ is a finite covering of $L$ (i.e., the number of points of $X$ lying over a given point of $L$ is finite and bounded).

\nn\textbf{Solution.} Omitted.% declined

\subsubsection{Page 92, Exercise~8.6}%

\textbf{Statement.} Let $A$ be a Noetherian ring and $\qqq$ a $\ppp$-primary ideal in $A$. Consider chains of primary ideals from $\qqq$ to $\ppp$. Show that all such chains are of finite bounded length, and that all maximal chains have the same length.

\nn\textbf{Hints.} See Section~\ref{s8.5} p.~\pageref{s8.5} above. 

Note that 

\qquad the poset of $\ppp$-primary ideals of $A$ between $\qqq$ and $\ppp$ 

is canonically isomorphic to 

\qquad the poset of $\ppp_\ppp$-primary ideals of $A_\ppp$ containing $\qqq_\ppp$, 

and that the above poset is equal to 

\qquad the poset of proper ideals of $A_\ppp$ containing $\qqq_\ppp$. 

In particular all proper ideals of $A_\ppp$ containing $\qqq_\ppp$ are $\ppp_\ppp$-primary. [This is because all proper ideals of an Artin local ring $(A,\mmm)$ are $\mmm$-primary.]

\newpage

\section{About Chapter~9}%%%

\subsection{Comments}%%

\subsubsection{Page 94, Proposition~9.2}\label{sp9.2}%

Recall Proposition~9.2:

\begin{prop}[Proposition~9.2]\label{p9.2}
Let $A$ be a Noetherian local domain of dimension one, $\mmm$ its maximal ideal, $k=A/\mmm$ its residue field. Then the following are equivalent:

\nn\emph{(i)} $A$ is a discrete valuation ring; 

\nn\emph{(ii)} $A$ is integrally closed;

\nn\emph{(iii)} $\mmm$ is a principal ideal;

\nn\emph{(iv)} $\dim_k(\mmm/\mmm^2)=1$;

\nn\emph{(v)} Every non-zero ideal is a power of $\mmm$;

\nn\emph{(vi)} There exists $x\in A$ such that every non-zero ideal is of the form $(x^n)$, $n\ne0$.
\end{prop}

In the setting of Proposition~9.2, the condition

(v') every non-zero ideal can be written in a unique way as a power of $\mmm$

\nn is equivalent to any of the conditions (i) to (vi). The same holds for

(vi') there exists $x\in A$ such that every non-zero ideal can be written in a unique way as $(x^n)$.

\nn This follows from Statement~(B) in the proof of Proposition~9.2.

\subsubsection{Page 95}%

\nn$\bu$ Proof of the implication (iv)$\implies$(v) in Proposition~9.2 p.~94 [Proposition~\ref{p9.2} p.~\pageref{p9.2}]. It is written: ``from (8.8) (applied to $A/\mmm^n$) it follows that $\aaa$ is a power of $\mmm$''. The fact that $A/\mmm^n$ is Artin follows from Proposition~8.6 p.~90 of the book [see Section~\ref{p8.6} p.~\pageref{p8.6} above].

\nn$\bu$ The proof of the equivalence (ii) $\iff$ (iii) in Theorem 9.3 uses Statement~(B) in the proof of Proposition~9.2 p.~94.

\nn$\bu$ Corollary 9.4. See Section~\ref{sp9.2} above.

\nn$\bu$ The domain $\mathbb Z[-5]$ is Dedekind but does not have unique factorization. The fact that $\mathbb Z[-5]$ does not have unique factorization follows from the fact that $2\cdot3$ and $(1+\sqrt5)(1-\sqrt5)$ are irreducible factorizations of $6$. 

\subsubsection{Page 97, proof of Theorem 9.8}%

The last sentence of the proof of Theorem 9.8 is ``Then $\aaa$ is invertible, hence $\bbb=\aaa_\ppp$ is invertible by (9.7)''. I think the authors meant (9.6). Here are more details: We have $\bbb=\aaa_\ppp$ by Proposition~3.11i p.~41 [Proposition~\ref{p3.11} p.~\pageref{p3.11}] and Proposition~1.17.iii p.~10 [see the proof of Proposition~7. p.~80]. Moreover $\aaa_\ppp$ is invertible by Proposition~9.6 [(i) $\implies$ (ii)].

\subsection{Exercises}%%

\subsubsection{Page 99, Exercise~9.1}%

\textbf{Statement.} Let $A$ be a Dedekind domain, $S$ a multiplicatively closed subset of $A$. Show that $S^{-1}A$ is either a Dedekind domain or the field of fractions of $A$.

Suppose that $S\ne A\setminus\{0\}$, and let $H,H'$ be the ideal class groups of $A$ and $S^{-1}A$ respectively. Show that extension of ideals induces a surjective homomorphism $H\to H'$.

\nn\textbf{Hint.} See Section~\ref{p5.12} p.~\pageref{p5.12} above.

\subsubsection{Page 99, Exercise~9.2}%

\textbf{Statement.} Let $A$ be a Dedekind domain. If $f=a_0+a_1x+\cdots+a_nx^n$ is a polynomial with coefficients in $A$, the \textbf{content} of $f$ is the ideal $c(f)=(a_0,\ldots,a_n)$ in A. Prove \textbf{Gauss's lemma} that $c(fg)=c(f)c(g)$.

\nn[Localize at each maximal ideal.]

\nn\textbf{Hint.} See Exercise~1.2iv p.~11 of the book [Section~\ref{ex1.2} p.~\pageref{ex1.2}]. It suffices to show $c(f)_\mmm c(g)_\mmm\subset c(fg)_\mmm$ for all maximal ideal $\mmm$. 

\subsubsection{Page 99, Exercise~9.3}%

\textbf{Statement.} A valuation ring (other than a field) is Noetherian if and only if it is a discrete valuation ring.

\nn\textbf{Solution.} It is proved on p.~94 of the book that discrete valuation ring are noetherian. Exercise~5.28 p.~72 of the book [Section~\ref{528} p.~\pageref{528}] says that the ideals of a valuation ring are totally ordered. In particular finitely generated ideals are principal. Thus any noetherian valuation ring $A$ is a principal ideal domain. Hence, if $A$ is not a field, then it is of dimension one, and is therefore a discrete valuation ring by Proposition~9.2 p.~94 of the book.

\subsubsection{Page 99, Exercise~9.4}%

\textbf{Statement.} Let $A$ be a local domain which is not a field and in which the maximal ideal $\mmm$ is principal and $\bigcap_{n\ge1}\mmm^n=(0)$. Prove that $A$ is a discrete valuation ring.

\nn\textbf{Hint.} Let $p$ be a generator of $\mmm$. 

There is a unique surjection $w:A\setminus\{0\}\to\mathbb N$ such that $a\in\mmm^{w(a)}\setminus\mmm^{w(a)+1}$ for all $a\in A\setminus\{0\}$. We have $w(ab)=w(a)+w(b)$ for all $a,b\in A\setminus\{0\}$, and $a\in A\setminus\{0\}$ is a unit if and only if $w(a)=0$. Moreover, if $a\in A\setminus\{0\}$, then $a=p^{w(a)}u$ with $u$ a unit.

If $\aaa$ is a nonzero ideal of $A$, and if $n$ is the least nonnegative integer such that $p^n\in\aaa$, then $\aaa=(p^n)$. 

This implies that $A$ is a principal ideal domain, and thus [Proposition~9.2 p.~94 of the book] a Dedekind domain.

\subsubsection{Page 99, Exercise~9.6}% previous version https://docs.google.com/document/d/1-fJd9kFo9QxKoJMaVo409NohFlWdnzTlFu3ZGrDlxZU/edit?folder=0ADbJLwZkWgt8Uk9PVA

\textbf{Statement.} Let $M$ be a finitely-generated torsion module ($T(M)=M$) over a Dedekind domain $A$. Prove that $M$ is uniquely representable as a finite direct sum of modules $A/\ppp_i^{n_i}$, where the $\ppp_i$ are non-zero prime ideals of $A$.

\nn\textbf{Solution.} Let $M$ be a finitely-generated torsion module over the Dedekind domain $A$. Then $M$ has a nonzero annihilator $\aaa$. Let $\aaa=\ppp_1^{n_1}\cdots\ppp_r^{n_r}$ be the prime factorization of $\aaa$, and note that $M$ is a module over the ring $A/\aaa\simeq A/\ppp_1^{n_1}\times\cdots\times A/\ppp_r^{n_r}$. This yields an obvious decomposition $M=M_1\oplus\cdots\oplus M_r$ of $M$, where each $M_i$ is an $A/\ppp_i^{n_i}$-module. 

Thus we can assume $\aaa=\ppp^n$ with $\ppp$ maximal, and it suffices to prove the claim below. 
\begin{claim}\label{ktuple}
There is a unique $k$-tuple $(m_1,\dots,m_k)$ of integers such that $1\le m_1\le\cdots\le m_k\le n$ and $M\simeq A/\ppp^{m_1}\oplus\cdots\oplus A/\ppp^{m_k}$ [isomorphism of $A$-modules]. 
\end{claim}

We leave it to the reader to check that there is a unique pair $(\phi,\psi)$ of $A$-algebra morphisms 
$$
\begin{tikzcd}
A/\ppp^n\ar[r,yshift=0.9ex,"\phi"]&A_\ppp/\ppp_\ppp^n\ar[l,yshift=-0.9ex,"\psi"]
\end{tikzcd}
$$ 
such that 
$$
\phi(a+\ppp^n)=\frac a1+\ppp_\ppp^n\quad\text{and}\quad\psi\left(\frac as+\ppp_\ppp^n\right)=s'a+\ppp^n
$$ 
for all $a\in A$ and all $s,s'\in A\setminus\ppp$ satisfying $ss'-1\in\ppp^n$, and that $\phi$ and $\psi$ are inverse isomorphisms. 

For any $A/\ppp^n$-module $N$ write $N'$ for the the $A$-module $N$ viewed as an $A_\ppp/\ppp_\ppp^n$-module via the formula $ax:=\psi(a)x$ for all $a\in A_\ppp/\ppp_\ppp^n$ and all $x\in N$. Note that $N$ is finitely generated if and only if $N'$ is.  

Going back to our module $M$, note that, $A_\ppp$ being a principal ideal domain and $\ppp_\ppp$ being maximal, there is a unique $k$-tuple $(m_1,\dots,m_k)$ of integers such that 
$
1\le m_1\le\cdots\le m_k\le n
$ 
and 
$$
M'\simeq A_\ppp/\ppp_\ppp^{m_1}\oplus\cdots\oplus A_\ppp/\ppp_\ppp^{m_k}
$$ 
[isomorphism of $A_\ppp$-modules]. As $(A/\ppp^{m_i})'\simeq A_\ppp/\ppp_\ppp^{m_i}$, this implies Claim~\ref{ktuple}. 

\subsubsection{Page 99, Exercise~9.7}%

\textbf{Statement.} Let $A$ be a Dedekind domain and $\aaa\ne0$ an ideal in $A$. Show that every ideal in $A/\aaa$ is principal.

Deduce that every ideal in $A$ can be generated by at most two elements. 

\nn\textbf{Hint.} See the previous exercise. More precisely: it suffices to show that any nontrivial quotient of $A$ is a principal ideal ring, and to deduce from this that, given any nonzero element $x\in\aaa$, there is a $y\in\aaa$ such that $\aaa=(x,y)$. 

\newpage

\section{About Chapter~10}%%%

\subsection{Comments}%%

\subsubsection{Page 102, Completions 1}%

In the first paragraph after the proof of Lemma 10.1, it is written ``Two Cauchy sequences are equivalent if $x_\nu-y_\nu\to0$ in $G$''. Note that a sequence may have several limits. 

In the penultimate paragraph of p.~102 it is claimed that $\widehat f:\widehat G\to\widehat H$ is continuous, but no topologies have been defined on $\widehat G$ and $\widehat H$. It is simpler to fix this problem in the setting considered in the last paragraph of p.~102. We shall use Corollary 10.4 p.~105. Note that, in this corollary, $\widehat G_n$ really means $(G_n)^\wedge$, which can, and will, be viewed as a subgroup of $\widehat G$. 

Then these subgroups do define a topology on $\widehat G$, and the canonical morphism $c:G\to\widehat G$ is continuous and its image is dense. 

Moreover $\widehat f:\widehat G\to\widehat H$ is continuous if $f:G\to H$ is. (Here we assume that the topology of $G$ and $H$ are such that $0$ has a countable fundamental system of neighborhoods.)

\subsubsection{Page 103, Completions 2}%

The penultimate display is 
$$
\widehat G\simeq\varprojlim G/G_n.
$$ 
More precisely, let $\pi_i:G\to G/G_i$ be the canonical projection; let $C\subset G^{\mathbb N}$ be the group of Cauchy sequences [this is indeed easily seen to be a subgroup of $G^{\mathbb N}$]; and note that $x\in G^{\mathbb N}$ is Cauchy if and only if for each $i$ the sequence $j\mapsto\pi_i(x_j)$ is eventually constant, in which case we write $\pi_i(x_\infty)$ for its eventual value. Then there is a unique group morphism $\varphi:C\to\varprojlim G/G_i$ such that $\varphi(x)_i=\pi_i(x_\infty)$ for all $x$ in $C$ and all $i$ in $\mathbb N$, this morphism is an epimorphism, and it induces an isomorphism $\widehat G\xrightarrow\sim\varprojlim G/G_i$. 

\subsubsection{Page 105}%

Even if it is very easy, we give additional details about the proofs of Corollary 10.4 and Proposition~10.5. 

Setting $G':=G_{n_0}$ in Corollary 10.3 yields the exact sequence $0\to\widehat{G_{n_0}}\to\widehat G\to(G/G_{n_0})\ \widehat{}\to0$. Recall that $p:G\to G/G_{n_0}$ is the natural morphism. For $n\ge n_0$ we have $pG_n=0$. This implies $(G/G_{n_0})\ \widehat{}\simeq G/G_{n_0}$ (canonical isomorphism), and thus $\widehat G/\widehat{G_{n_0}}\simeq G/G_{n_0}$, that is, $\widehat G/\widehat{G_n}\simeq G/G_n$ for all $n$. This entails 
$$
\widehat{\widehat G\,}\simeq\widehat G.
$$ 

\subsubsection{Page 109, Proposition~10.15}%

Proposition~10.15 (iii) says 
\begin{equation}\label{1015a}
\aaa^n/\aaa^{n+1}\simeq\hat\aaa^n/\hat\aaa^{n+1}.
\end{equation}
Moreover \eqref{1015a} is derived from 
\begin{equation}\label{1015b}
A/\aaa^n\simeq\hat A^n/\hat\aaa^n,
\end{equation} 
but in the sequel \eqref{1015b} is needed at various places, and it is justified by stating that it follows from \eqref{1015a}. For instance in the proof of Proposition~10.16 it is written

``By (10.15) iii) we have $\hat A/\hat\mmm\simeq A/\mmm$''.

\nn In fact, I think it is better to prove $\hat\aaa^n/\hat\aaa^{n+k}\simeq\aaa^n/\aaa^{n+k}$ directly by noting that we have 
$$
\hat\aaa^n/\hat\aaa^{n+k}\simeq(\aaa^n)^\wedge/(\aaa^{n+k})^\wedge\simeq(\aaa^n/\aaa^{n+k})^\wedge\simeq\aaa^n/\aaa^{n+k},
$$ 
the first isomorphism following from Proposition~10.15 (ii), the second from Corollary 10.3 p.~104, and the third being obvious.

Note that (i), (ii) and the proof of (ii) imply $(\aaa^n)^\wedge=\hat A\,\aaa^n=(\hat A\,\aaa)^n=\hat\aaa^n\simeq\hat A\otimes_A\aaa^n$. In particular, the equality $(\aaa^n)^\wedge=\hat A\,\aaa^n$ shows that 
$$
\boxed{\text{the $\aaa$-topology and the $\hat\aaa$-topology of $\hat A$ coincide.}} 
$$
The $\aaa$-topology is finer than the $\hat\aaa$-topology even if $A$ is not noetherian. 

Note also 
\begin{prop}\label{1015}
Let $A$ be a noetherian ring, $\aaa$ an ideal of $A$ and $M$ a finitely generated $A$-module, and regard $(\aaa M)^\wedge$ as a sub-$A$-module of $\widehat M$. Then the sub-$A$-modules $(\aaa M)^\wedge,\widehat\aaa M$ and $\aaa\widehat M$ of $\widehat M$ coincide and are in fact sub-$\widehat A$-modules of $\widehat M$. Moreover they are isomorphic to $\widehat A\otimes_A\aaa M$. 
\end{prop} 
The proof is the same as that of Proposition~10.15i in the book. 

\subsubsection{Page 110, Corollary 10.19}\label{c10.19}%

Statement in the book:

Let $A$ be a Noetherian ring, $\aaa$ an ideal of $A$ contained in the Jacobson radical and let $M$ be a finitely-generated $A$-module. Then the $\aaa$-topology of $M$ is Hausdorff, i.e. $\bigcap\aaa^nM=0$. 

Here is a slightly stronger statement: 

\emph{Let $A$ be a Noetherian ring and $\aaa$ an ideal of $A$. Then the $\aaa$-topology of $M$ is Hausdorff for all finitely-generated $A$-module $M$, i.e. $\bigcap\aaa^nM=0$, if and only if $\aaa$ is contained in the Jacobson radical.} 

Let us prove that the $\aaa$-topology is not necessarily Hausdorff if $\aaa$ is not contained in the Jacobson radical. Indeed, if $\mmm$ is a maximal ideal not containing $\aaa$, then the $\aaa$-topology of $A/\mmm$ is the coarse topology. 

\subsubsection{Page 111, Corollaries 10.20 and 10.21}%

About the proof of Corollary 10.20: The fact that ``an $\mmm$-primary ideal of $A$ is just any ideal contained between $\mmm$ and some power $\mmm^n$'' has already been stated as Corollary 7.16 p.~83.

About Corollary 10.21: Let $a$ be in $A$. We must show: 

$a\in\qqq$ for all $\ppp$-primary ideal $\qqq$ $\iff$ there is an $s$ in $A\setminus\ppp$ such that $as=0$. 

\begin{proof} 
If $s$ in $A\setminus\ppp$ satisfies $as=0$, and if $\qqq$ is a $\ppp$-primary ideal, then $a$ is in $\qqq$.

If $as\neq0$ for all $s\in A\setminus\ppp$, then $\frac a1\neq0$, and Corollary 10.20 implies that there is a $\ppp$-primary ideal $\qqq$ such that $\frac a1\notin\qqq_\ppp$, and thus $a\notin\qqq$. 
\end{proof}

\subsection{Exercises}%%

\subsubsection{Page 113, Exercise~10.1}%

\textbf{Statement.} Let $\alpha_n:\Z/p\Z\to\Z/p^n\Z$ be the injection of abelian groups given by $\alpha_n(1)=p^{n-1}$, and let $\alpha:\to B$ be the direct sum of all the $\alpha_n$ (where $A$ is a countable direct sum of copies of $\Z/p\Z$, and $B$ is the direct sum of the $\Z/p^n\Z$). Show that the $p$-adic completion of $A$ is just $A$ but that the completion of $A$ for the topology induced from the $p$-adic topology on $B$ is the direct \textbf{product} of the $\Z/p\Z$. Deduce that $p$-adic completion is \textbf{not} a right-exact functor on the category of all $\Z$-modules.

\nn\textbf{Hint.} For any abelian group $G$ write $\widehat G$ for the $p$-adic completion of $G$. 

We claim that 
\begin{equation}\label{nn}
G\mapsto\widehat G\text{ is neither left exact not right exact.}
\end{equation}
Set $C_j:=\mathbb Z/(p^j)$ for $j\ge0$ and $A:=\bigoplus_{j\ge1}C_1$, $B:=\bigoplus_{j\ge1}C_j$. The exact sequences 
$$
0\to C_1\xr{\alpha_j}C_j\xr{\pi_j}C_{j-1}\to0,
$$ 
where $\pi_j$ is the multiplication by $p$ [we use the isomorphism $pC_j\simeq C_{j-1}$ for $j\ge1$], induce an exact sequence 
\begin{equation}\label{abb}
0\to A\xr{\alpha}B\xr{\pi}B\to0.
\end{equation} 
We claim 
\begin{equation}\label{ne}
\widehat A\xr{\widehat\alpha}\widehat B\xr{\widehat\pi}\widehat B\ \text{ is not exact.}
\end{equation} 
This will imply \eqref{nn}. As $\widehat A$ is isomorphic to $A$ [details left to the reader], we can rewrite \eqref{ne} as  
\begin{equation}\label{ne2}
A\xr{\widehat\alpha}\widehat B\xr{\widehat\pi}\widehat B\ \text{ is not exact.}
\end{equation} 
Write $\overline A$ for the completion of $A$ with respect to the filtration induced by the $p$-adic filtration of $B$. We leave it to the reader to check that applying Corollary 10.3 p.~104 of the book to \eqref{abb} yields the exact sequence $0\to\overline A\xr{\alpha'}\widehat B\xr{\widehat\pi}\widehat B\to0$. We have $\overline A\simeq\prod_{j\ge1}C_1$ [details again left to the reader], and thus $A\subsetneqq \overline A$. Setting $a\in\overline A\setminus A$ we get $\alpha'(a)\in\oo{Ker}\widehat\pi\setminus\oo{Im}\widehat\alpha$. This proves \eqref{ne2}, \eqref{ne} and \eqref{nn}.

\subsubsection{Page 114, Exercise~10.2}%

\textbf{Statement.} In Exercise~1, let $A_n=\alpha^{-1}(p^nB)$, and consider the exact sequence 
$$
0\to A_n\to A\to A/A_n\to0.
$$ 
Show that $\varprojlim$ is not right exact, and compute $\varprojlim^1A_n$.

\nn\textbf{Solution.} Omitted.% declined

\subsubsection{Page 114, Exercise~10.3}%

\textbf{Statement.} (a) Let $A$ be a Noetherian ring, $\aaa$ an ideal and $M$ a finitely-generated $A$-module. Using Krull's Theorem and Exercise~14 of Chapter~3, prove that 
$$
\bigcap_{n>0}\aaa^nM=\bigcap_{\mmm\supset\aaa}\Ker(M\to M_\mmm),
$$ 
where $\mmm$ runs over all maximal ideals containing $\aaa$.

\nn(b) Deduce that
$$
\widehat M=0\iff\oo{Supp}(M)\cap V(\aaa)=\varnothing\quad[\text{in }\Spec(A)].
$$
\nn\textbf{Solution.} (a) By Krull's Theorem [Theorem 10.17 p.~110 of the book], we have 
$$
E:=\Ker(M\to\widehat M)=\bigcap\aaa^nM=\bigcup_{a\in\aaa}\oo{Ann}_M(1+a). 
$$ 
Set $F:=\bigcap_{\mmm\supset\aaa}\Ker(M\to M_\mmm)$. We must show $E=F$. The inclusion $E\subset F$ is easy [indeed we have $\oo{Ann}_M(1-a)\subset\aaa^nM$ for $a\in\aaa$ and $n\in\mathbb N$]. To prove $F\subset E$, first note that we have $F_\mmm=0$ if $\mmm\supset\aaa$. By Exercise~3.14 p.~45 of the book [Section~\ref{ex3.14} p.~\pageref{ex3.14}], this implies $F=\aaa F$, hence $F=\aaa^nF\subset\aaa^nM$ for all $n$, hence $F\subset E$. 

\nn(b) Set $\bbb:=\oo{Ann}(M)$. We have 
$$
\widehat M=0\iff M=\aaa M\iff(\exists\ a\in\aaa)\ 1-a\in\bbb\iff\aaa+\bbb=(1)\iff\oo{Supp}(M)\cap V(\aaa)=\varnothing,
$$ 
the successive equivalences being justified as follows:

$\bu$ first equivalence: obvious, 

$\bu$ second equivalence: Corollary~2.5 p.~21 of the book [Corollary~\ref{c2.5} p.~\ref{c2.5}],

$\bu$ third equivalence: obvious,

$\bu$ fourth equivalence: Exercise~3.19v p.~46 of the book [Section~\ref{ex3.19} p.~\pageref{ex3.19}].

\nn Details about the fourth equivalence: By Exercise~3.19v p.~46 of the book we have $\oo{Supp}(M)=V(\bbb)$, hence $\oo{Supp}(M)\cap V(\aaa)=V(\aaa+\bbb)$, hence $\oo{Supp}(M)\cap V(\aaa)=\varnothing\iff\aaa+\bbb=(1)$. 

\subsubsection{Page 114, Exercise~10.4}%

\textbf{Statement.} Let $A$ be a Noetherian ring, $\aaa$ an ideal in $A$, and $\widehat A$ the $\aaa$-adic completion. For any $x\in A$, let $\widehat x$ be the image of $x$ in $\widehat A$. 

\nn(a) Show that\smallskip 

\centerline{$x$ not a zero-divisor in $A\implies\widehat x\ $ not a zero-divisor in $\widehat A$.} 

\nn(b) Does this imply that\smallskip 

\centerline{$A$ is an integral domain $\implies\widehat A\ $ is an integral domain?}

\nn\textbf{Answer to (b):} No. Take $\aaa:=(1)$. 

\subsubsection{Page 114, Exercise~10.5}%

\textbf{Statement.} Let $A$ be a Noetherian ring and let $\aaa,\bbb$ be ideals in $A$. If $M$ is any $A$-module, let $M^\aaa,M^\bbb$ denote its $\aaa$-adic and $\bbb$-adic completions respectively. If $M$ is finitely generated, prove that $(M^\aaa)^\bbb\simeq M^{\aaa+\bbb}$.

\nn\textbf{Hint.} In view of the isomorphism $\widehat A\otimes_AM\simeq\widehat M$, it suffices to show 
\begin{equation}\label{aba+b}
(A^\aaa)^\bbb\simeq A^{\aaa+\bbb}. 
\end{equation} 
Using Proposition~10.2. p.~104 and Proposition~\ref{1015} p.~\pageref{1015}, and writing $L_i$ for $\lim_i$, we have 
$$
(A^\aaa)^\bbb\simeq 
L_j\left(\frac{L_i\frac{A}{\aaa^i}}{\bbb^jL_i\frac{A}{\aaa^i}}\right)\simeq 
L_j\left(\frac{L_i\frac{A}{\aaa^i}}{L_i\bbb^j\frac{A}{\aaa^i}}\right)\simeq 
L_jL_i\left(\frac{\frac{A}{\aaa^i}}{\bbb^j\frac{A}{\aaa^i}}\right)
$$ 
$$
\simeq L_jL_i\left(\frac{A}{\aaa^i+\bbb^j}\right)
\simeq L_n\left(\frac{A}{(\aaa+\bbb)^n}\right)
\simeq A^{\aaa+\bbb}.
$$ 

\subsubsection{Page 114, Exercise~10.6}%

\textbf{Statement.} Let $A$ be a Noetherian ring and $\aaa$ an ideal in $A$. Prove that $\aaa$ is contained in the Jacobson radical of $A$ if and only if every maximal ideal of $A$ is closed for the $\aaa$-topology. (A Noetherian topological ring in which the topology is defined by an ideal contained in the Jacobson radical is called a \textbf{Zariski ring}. Examples are local rings and [by Proposition~10.15iv p.~109 of the book] $\aaa$-adic completions.)

\nn\textbf{Hint.} Let $A$ be a ring, $\aaa$ an ideal, and equip $A$ with the $\aaa$-adic topology. 

Then any ideal containing $\aaa$ is open and closed [because such an ideal is a union of $\aaa$-cosets]. 

Moreover any maximal ideal $\mmm$ not containing $\aaa$ is dense.

To prove this, let us show that any nonempty open subset $U\subset A$ meets $\mmm$. Set $K:=A/\mmm$ and let $\pi:A\to K$ be the canonical projection. It suffices to check that $0\in\pi(U)$. But the $\aaa$-adic topology of $K$ being the codiscrete topology, $\pi(U)$ is the unique nonempty subset of $K$, that is $K$ itself. 

\subsubsection{Page 114, Exercise~10.7}%

\textbf{Statement.} Let $A$ be a Noetherian ring, $\aaa$ an ideal of $A$, and $\widehat A$ the $\aaa$-adic completion. Prove that $\widehat A$ is faithfully flat over $A$ (Chapter~3, Exercise~16; Section~\ref{ex3.16} p.~\pageref{ex3.16}) if and only if $A$ is a Zariski ring (for the $\aaa$-topology). 

\nn[Since $\widehat A$ is flat over $A$, it is enough to show that
$$
M\to\widehat M\text{ injective for all finitely generated }M\iff A\text{ is Zariski;}
$$ 
now use Corollary~10.19 p.~110 (see Section~\ref{c10.19} p.~\pageref{c10.19}) and Exercise~6.]

\nn\textbf{Hint.} Let $\mmm$ be a maximal ideal of $A$. Proposition~10.15i p.~109 of the book implies that the extension $\mmm^{\oo e}$ of $\mmm$ in $\widehat A$ is $\widehat\mmm$, and we get 
$$
\aaa\subset\mmm\implies0\ne(A/\mmm)^{\land}\simeq\widehat A/\widehat\mmm\implies\mmm^{\oo e}\ne(1), 
$$ 
$$
\aaa\not\subset\mmm\implies0=(A/\mmm)^{\land}\simeq\widehat A/\widehat\mmm\implies\mmm^{\oo e}=(1). 
$$

\subsubsection{Page 115, Exercise~10.8}%

\textbf{Statement.} Let $A$ be the local ring of the origin in $\mathbb C^n$ (i.e., the ring of all rational functions $f/g\in\mathbb C(z_1,\ldots,z_n)$ with $g(0)\ne0$), let $B$ be the ring of power series in $z_1,\ldots,z_n$ which converge in some neighborhood of the origin, and let $C$ be the ring of formal power series in $z_1,\ldots,z_n$, so that $A\subset B\subset C$. Show that $B$ is a local ring and that its completion for the maximal ideal topology is $C$. Assuming that $B$ is Noetherian, prove that $B$ is $A$-flat. [Use Chapter~3, Exercise~17 (Section~\ref{ex3.17} p.~\pageref{ex3.17}, %\footnote{Exercise~3.17 says that if $A\subset B\subset C$ are rings, and if $C$ is flat over $A$ and faithfully flat over $B$, then $B$ is flat over $A$.}), 
and Exercise~7 above.]
% Exact statement of Exercise~3.17 Let $A\xr fB\xr gC$ be ring homomorphisms. If $g\circ f$ is flat and $g$ is faithfully flat, then $f$ is flat.

\nn\textbf{Hint.} The proof that $B$ is a local ring and that its completion for the maximal ideal topology is $C$ is left to the reader. Exercise~3.17 says that if $A\subset B\subset C$ are rings, and if $C$ is flat over $A$ and faithfully flat over $B$, then $B$ is flat over $A$. Exercise~7 above implies that $C$ is faithfully flat over $B$. Note that $A$ is also a local ring and that its completion for the maximal ideal topology is also $C$. Then Proposition~10.14 p.~109 of the book [see below] entails that $C$ is flat over $A$.

Here is Proposition~10.14 of the book:
\begin{prop}[Proposition~10.14 p.~109 of the book]\label{p10.14}
If $A$ is a Noetherian ring, $\aaa$ an ideal, $\widehat A$ the $\aaa$-adic completion of $A$, then $\widehat A$ is a flat $A$-algebra.
\end{prop}
%Omitted.% declined

\subsubsection{Page 115, Exercise~10.9, Hensel's Lemma}% previous version: https://docs.google.com/document/d/1YanrmoxAQgW5xqdDAURily0_-s42ncokf8o5edTr_bU/edit

To solve Exercise~10.9 we need only assume that $A$ is complete with respect to some ideal $\mmm$; we do not necessarily need $\mmm$ maximal or $A$ local. To emphasize the fact that $\mmm$ is not necessarily maximal, we denote this ideal by $\aaa$.

We shall prove:

\begin{thm}[Hensel's Lemma]\label{hl}
Let $\aaa$ be an ideal of a ring $A$ such that $A$ is complete for the $\aaa$-adic topology, set $B:=A/\aaa$ and let $\pi:A[x]\to B[x]$ be the natural morphism. Let $F\in A[x]$ be monic of degree $n$, set $f:=\pi(F)$, and assume that $g,h\in B[x]$ are coprime monic polynomials of degrees $r$ and $n-r$ satisfying $f=gh$. Then there are monic lifts $G,H\in A[x]$ of $g,h$ such that $F=GH$. [A \textbf{lift} of a polynomial $u\in B[x]$ is an element of $\pi^{-1}(u)\subset A[x]$.]
\end{thm}

The proof below is stolen from Thomas J. Haines, Lectures on Commutative Algebra \\\href{http://www.math.umd.edu/~tjh/CommAlg.pdf}{http://www.math.umd.edu/$\sim$tjh/CommAlg.pdf}

\begin{proof}
We first define two sequences $G_1,G_2,\ldots$ and $H_1,H_2,\ldots$ of monic lifts in $A[x]$ of $g$ and $h$ as follows. 

The polynomials $G_1$ and $H_1$ are arbitrary monic lifts of $g$ and $h$. We have in particular $F-G_1H_1\in\aaa[x]$. 

Assume that $G_k,H_k\in A[x]$ have already been constructed and satisfy 
$$
F-G_kH_k\in\aaa^k[x].
$$ 
Let $i$ be a nonnegative integer less than $n$. There are $u,v\in B[x]$ such that $x^i=ug+vh$. Let $q,c_i\in B[x]$ satisfy $u=qh+c_i$ and 
$$
\deg c_i<\deg h=n-r.
$$ 
Setting $d_i:=q+v$ we get 
\begin{equation}\label{xicig}
x^i=c_ig+d_ih,
\end{equation} 
as well as $\deg d_ih=\deg(x^i-c_ig)<n$, and thus 
$$
\deg d_i<r.
$$ 
Let $C_i,D_i\in A[x]$ be lifts of the same degree of $c_i$ and $d_i$. We have 
$$
F-G_kH_k=\sum_{i=0}^{n-1}\,\alpha_i\,x^i
$$ 
with $\alpha_i\in\aaa^k$. Then 
$$
G_{k+1}:=G_k+\sum_{i=0}^{n-1}\alpha_iD_i\text{ and }H_{k+1}:=H_k+\sum_{i=0}^{n-1}\alpha_iC_i
$$ 
are monic lifts of $g,h\in B[x]$, and we get 
$$
F-G_{k+1}H_{k+1}=\sum_{i=0}^{n-1}\,\alpha_i\,x^i-\sum_{i=0}^{n-1}\alpha_i\,(C_iG_k+D_iH_k)-\sum_{i,j=0}^{n-1}\alpha_i\alpha_jC_iD_j
$$ 
$$
=\sum_{i=0}^{n-1}\,\alpha_i\,x^i-\sum_{i=0}^{n-1}\alpha_i\,(x^i+E_i)-\sum_{i,j=0}^{n-1}\alpha_i\alpha_jC_iD_j
$$ 
for some $E_i\in\aaa[x]$ --- the last equality following from \eqref{xicig}. This shows that $F-G_{k+1}H_{k+1}$ is in $\aaa^{k+1}[x]$. 

Write $G_{k,i}$ for the coefficient of $x^i$ in $G_k$ and define $H_{k,i}$ similarly. It is easy to see that the sequences $G_{1,i},G_{2,i},\ldots$ and $H_{1,i},H_{2,i},\ldots$ in $A$ are Cauchy, and thus convergent. Let $G_{\infty,i}$ and $H_{\infty,i}$ be their limits. It is not hard to check that the polynomials $G:=\sum G_{\infty,i}\,x^i$ and $H:=\sum H_{\infty,i}\,x^i$ do the job.
\end{proof}

\subsubsection{Page 115, Exercise~10.10}%

\textbf{Statement.} (i) With the notation of Exercise~9, deduce from Hensel's lemma that if $\ov f(x)$ has a simple root $\alpha\in A/\mmm$, then $f(x)$ has a simple root $a\in A$ such that $a=a\bmod\mmm$.

\nn(ii) Show that $2$ is a square in the ring of $7$-adic integers.

\nn(iii) Let $f(x,y)\in k[x,y]$, where $k$ is a field, and assume that $f(0,y)$ has $y=a_0$
as a simple root. Prove that there exists a formal power series $y(x)=\sum_{n=0}^\infty a_nx^n$ such that $f(x,y(x))=0$.

\nn(This gives the ``analytic branch'' of the curve $f=0$ through the point $(0,a_0)$.)

\nn\textbf{Hint.} Part (iii) is a particular case of Part (i):
$$
{\renewcommand{\arraystretch}{1.3}% https://tex.stackexchange.com/a/31704/8816
\begin{array}{|c|c|c|c|c|c|c|c|}\hline
A&\mmm&\overline f(x)&\alpha&f(x)&a&\overline f(\alpha)=0&f(a)=0\\ \hline
k[[x]]&(x)&f(0,y)&a_0&f(x,y)&y(x)&f(0,a_0)=0&f(x,y(x))=0\\ \hline
\end{array}}
$$ 
[The condition that the roots $\alpha,a,a_0$ and $y(x)$ are simple is implicit.] 

\subsubsection{Page 115, Exercise~10.11}%

\nn\textbf{Statment:} Show that the converse of (10.26) is false, even if we assume that $A$ is local and that $\widehat A$ is a finitely-generated $A$-module.

Recall (10.26): If $A$ is a Noetherian ring, $\aaa$ an ideal of $A$, then the $\aaa$-completion $\widehat A$ of $A$ is Noetherian.

\nn\textbf{Hint.} Let $A$ be the ring of germs at $0$ of $C^\infty$ functions from $\mathbb R$ to $\mathbb R$, and $\mmm$ the ideal of those germs which vanish at $0$. Then $\widehat A\simeq\mathbb R[[x]]$ and $A\to\widehat A$ is surjective. Note that $A$ is not noetherian by Corollary 10.18 p.~110 of the book. 

\subsubsection{Page 115, Exercise~10.12}%

\nn\textbf{Statement:} If $A$ is Noetherian, then $B:=A[[x_1,\ldots,x_n]]$ is a faithfully flat $A$-algebra. 

\nn\textbf{Solution.} Using Proposition~10.14 p.~109 of the book [Proposition~\ref{p10.14} p.~\pageref{p10.14}] it is easy to see that $B$ is $A$-flat. Let $\phi:A\to B$ be the inclusion, $\psi:B\to A$ the evaluation at $0$, and $\mmm$ a maximal ideal of $A$. It suffices to show that the extension of $\mmm$ along $\phi$ is a proper ideal of $B$ [see Exercise~3.16iii p.~45 of the book]. If this extension was the unit ideal of $B$, then the extension of $\mmm$ along $\psi\circ\phi$ would be the unit ideal of $A$. But this latter extension is $\mmm$ because $\psi\circ\phi$ is the identity of $A$.

\newpage

\section{About Chapter~11}%%%

\subsection{Comments}%%

\subsubsection{Page 117, definition of d(M)}%

I think it would be more prudent to assume that $M\ne0$, that $A_0$ is Artin, and that $\lambda(M)$ is the length of $M$. 

\subsubsection{Page 118, Proposition~11.3}%

It seems better to assume $xM\ne M$. 

\subsubsection{Page 118, Example following Proposition~11.3}%

We have $P(A,t)=\ell\,(1-t)^s$ where $\ell$ is the length of $A_0$. 

\subsubsection{Page 118, proof of Proposition~11.4}%

\nn$\bu$ The ring $A/\qqq$ is Artin by \eqref{86} p.~\pageref{86}.

\nn$\bu$ The fact below is used on line 5 of the proof of Proposition~11.4:

\emph{A noetherian module over an Artin ring has finite length.}

This follows from Propositions 6.2 p.~75 and 6.8 p.~77.

\subsubsection{Page 119, old d new d}\label{odnd}%

On p. 119 it is claimed that the new $d$ evaluated on $A$ coincides with the old $d$ evaluated on $G_\mmm(A)$, the asserted equality being written $d(A)=d(G_\mmm(A))$. 

We denote the old $d$ by $d_o$ and the new $d$ by $d_\nu$, so that the equality to check becomes 
\begin{equation}\label{dd}
d_o(A)=d_\nu(G_\mmm(A)).
\end{equation}

Note that $d_o(A)$ is defined when $A$ is a noetherian graded ring, and $d_\nu(A)$ is defined when $A$ is a noetherian local ring. By Proposition~10.22 (i) p.~111, $G_\aaa(A)$ is a noetherian graded ring if $A$ is a noetherian ring and $\aaa$ is an ideal of $A$.

As in (1) p. 118 of the book we set $\ell_n:=\ell(A/\mmm^n)$. 

Corollary 11.5 p.~119 says that, for large $n$, the function $n\mapsto\ell_n$ is a polynomial whose degree is $d_\nu(A)$ by definition. 

Corollary 11.2 p.~117 says that, for large $n$, the function $n\mapsto\ell(\mmm^n/\mmm^{n+1})$ is a polynomial whose degree is $d_o(G_\mmm(A))-1$.

Now \eqref{dd} above follows from (1) p. 117 of the book. 

\subsubsection{Page 120, Proposition~11.9}%

We must assume that $x$ is not a unit. 

\subsubsection{Page 120, proof of Proposition~11.10}%

The claim ``$A$ is an Artin ring'' is justified by \eqref{86} p.~\pageref{86}.% removed \subsubsection{Page 121, Proposition~11.13} 200609 https://docs.google.com/document/d/1wmk9iSjs5zn1SCQmjCYw1zpCInFQqlZjtwyaI7T5-xQ/edit

\subsubsection{Page 121, Dimension Theorem}% 

Here is an application of the Dimension Theorem: 

Let $K$ be a field, let $x_1,x_2,\dots$ be indeterminates, and form the $K$-algebra $A:=K[[x_1,x_2,\dots]]$. 

Recall that $A$ can be defined as the set of expressions of the form $\sum_ua_uu$, where $u$ runs over the set monomials in $x_1,x_2,\dots$, and each $a_u$ is in $K$, the addition and multiplication being the obvious ones. 

Then $A$ is a local domain, its maximal ideal $\mathfrak m$ is defined by the condition $a_1=0$, and we claim 
\begin{equation}\label{u1a}
\boxed{A\text{ is not }\mathfrak m\text{-adically complete.}}
\end{equation}
This result is due to Uriya First and to the MathOverflow user dhy. See\\ \href{https://mathoverflow.net/a/308266/461}{https://mathoverflow.net/a/308266/461}. 

We equip $A$ with the $\mmm$-adic topology.

Let $v:\mathbb Z_{>0}\to\mathbb Z_{>1}$ be strictly increasing, assume that, for all $n\in\mathbb Z_{>0}$, the characteristic of $K$ does not divide $v(n)$, and consider the sequence $(s_n)_{n\in\mathbb Z_{>0}}$ defined by $s_n=\sum_{i=1}^nx_i^{v(i)}$. This sequence being clearly Cauchy, it suffices to show that it diverges. To prove this we argue by contradiction and assume that $(s_n)$ has a limit in $A$. It is easy to see that this limit is $\sum_{n>0}x_n^{v(n)}$, and that this element of $A$ is in $\mmm^2$. Thus \eqref{u1a} will follow from 
\begin{equation}\label{u1b}
\sum_{n>0}\ x_n^{v(n)}\notin\mmm^2.
\end{equation} 
Our proof of \eqref{u1b} starts with the following claim.

\nn$(\star)$ {\em Let $k$ and $r$ be positive integers; let $\mathfrak n$ be the maximal ideal of} $B:=K[[x_1,\dots,x_k]]$; \emph{let $a_1,\dots,a_r,b_1,\dots,b_r$ be in $\mathfrak n$; set $f=\sum_{i=1}^ra_ib_i$ and $D_j:=\frac{\partial}{\partial x_j}$ for $1\le j\le k$; and assume that the ideal $(D_1f,\dots,D_kf)\subset B$ is $\mathfrak n$-primary. Then $k\le2r$.}

\nn Proof of $(\star)$. We have 
$$
D_jf=\sum_{i=1}^r\Big((D_ja_i)\ b_i+a_i\ (D_jb_i)\Big). 
$$ 
This implies that $(D_1f,\dots,D_kf)\subset(a_1,\dots,a_r,b_1,\dots,b_r)$, and thus that $(a_1,\dots,a_r,b_1,\dots,b_r)$ is $\mathfrak n$-primary [see Corollary 7.16 p.~83 of the book]. By the Examples pages 118 and 121, and by Corollary 11.19 p.~122 of the book, we have $\dim B=k$. Now the Dimension Theorem entails $k\le2r$, as desired. $\square$

\nn Proof of \eqref{u1b}. Assume by contradiction that we have 
$
\sum_{n>0}\ x_n^{v(n)}=\sum_{i=1}^r\ c_i\,d_i
$ 
with $c_i,d_i\in\mmm$. Let $k$ be an integer $>2r$. Mapping $x_j$ to $0$ for $j>k$ we get 
$$
f:=\sum_{n=1}^k\ x_n^{v(n)}=\sum_{i=1}^r\ a_i\,b_i\in K[[x_1,\dots,x_k]]
$$ 
for some $a_i,b_i\in(x_1,\dots,x_k)\subset K[[x_1,\dots,x_k]]$. As $(D_1f,\dots,D_kf)$ is $(x_1,\dots,x_k)$-primary by Corollary 7.16 p.~83 of the book, this contradicts $(\star)$. $\square$

The case when $K$ is \textbf{finite} is a Bourbaki exercise: Exercice 22c p. 288 in Exercices du \S2 chap. III, \textbf{Algèbre commutative}, Bourbaki, Masson, Paris 1985.

\subsubsection{Page 121, Proposition~11.13 and Corollary 11.16}\label{1116}%

The following statement is implicit in the book. 
\begin{prop}\label{myprop}
If $\ppp$ is a prime ideal of a noetherian ring, then we have 
$$
\text{height }\ppp=\min\big\{n\in\mathbb N\ |\ (\exists\ x_1,\ldots,x_n\in\ppp)\ \ppp\text{ is a minimal prime ideal of }(x_1,\ldots,x_n)\big\}.
$$ 
\end{prop} 
We start with Lemma~\ref{p1113} below. The statement and the proof of this lemma are  almost the same as those of Proposition~11.13 of the book. To make the analogy clearer we have used a notation as close as possible to that of the book; in particular we warn the reader that we have denoted by $\mmm$ a prime ideal which is not necessarily maximal!

\begin{lem}\label{p1113}
Let $A$ be a noetherian ring and $\mmm$ a prime ideal of height $d$. Then there exist $d$ elements $x_1,\ldots,x_d$ of $\mmm$ such that $\mmm$ is a minimal prime ideal of $(x_1,\ldots,x_d)$. 
\end{lem}

\begin{proof}
Construct $x_1,\ldots,x_d$ inductively in such a way that every prime sub-ideal of $\mmm$ containing $(x_1,\ldots,x_d)$ has height $\ge i$, for each $i$. Suppose $i>0$ and $x_1,\ldots,x_{i-1}$ constructed. Let $\ppp_j$ $(1\le j\le s)$ be the minimal prime ideals of $(x_1,\ldots,x_{i-1})$ which are contained in $\mmm$ and have height \textbf{exactly} $i-1$. Since $i-1<d=$ height $\mmm$, we have $\mmm\ne\ppp_j$ $(1\le j\le s)$, hence $\mmm\ne\bigcup_{j=1}^s\ppp_j$ by (1.11). Choose $x_i\in\mmm$, $x_i\notin\bigcup\ppp_j$, and let $\qqq$ be any prime sub-ideal of $\mmm$ containing $(x_1,\ldots,x_i)$. Then $\qqq$ contains some minimal prime ideal of $(x_1,\ldots,x_{i-1})$ contained in $\mmm$. If $\ppp=\ppp_j$ for some $j$, we have $x_i\in\qqq$, $x_i\notin\ppp$, hence $\qqq\supsetneqq \ppp$ and therefore height $\qqq\ge i$; if $\ppp\ne\ppp_j$ $(1\le j\le s)$, then height $\ppp\ge i$, hence height $\qqq\ge i$. Thus every prime ideal of $(x_1,\ldots,x_i)$ contained in $\mmm$ has height $\ge i$. 

If $\ppp$ is a prime ideal of $(x_1,\ldots,x_d)$ contained in $\mmm$, then $\ppp$ has height $\ge d$, hence $\ppp=\mmm$ [for $\ppp\subsetneqq \mmm\implies$ height $\ppp<$ height $\mmm=d$]. 
\end{proof} 

Now Proposition~\ref{myprop} follows from Lemma~\ref{p1113} above and Corollary 11.16 of the book. 

\subsubsection{Page 122}%

\nn$\bu$ Proof of Corollary 11.16. The fact that $(x_1,\dots,x_r)_\ppp$ is $\ppp_\ppp$-primary follows easily from Propositions 4.8 (ii) p~53 and 4.9 p~54 [Proposition~\ref{p4.9} p.~\pageref{p4.9}].

\nn$\bu$ Proof of Proposition~11.20. The $d(?)$ are $d_o(?)$ in the notation of Section~\ref{odnd}.

\subsubsection{Page 123, proof of Theorem 11.22}%

I think ``by (11.20)'' should be ``by (11.21)''.

\subsubsection{Page 125, proof of (11.25)}%

For the last sentence of the proof, see the Examples on p.~121.

\subsection{Exercises}%%

\subsubsection{Page 125, Exercise~11.1}%

\textbf{Statement.} Let $f\in k[x_1,\ldots,x_n]$ be an irreducible polynomial over an algebraically closed field $k$. A point $P$ on the variety $f(x)=0$ is \textbf{non-singular} $\iff$ not all the partial derivatives of $\partial f/\partial x_i$ vanish at $P$. Let $A=k[x_1,\ldots,x_n]/(f)$, and let $\mmm$ be the maximal ideal of $A$ corresponding to the point $P$. Prove that $P$ is non-singular $\iff$ $A_\mmm$ is a regular local ring.

\nn[By Corollary 11.18 p. 122 (see below) we have $\dim A_\mmm=n-1$. Now
$$
\mmm/\mmm^2\simeq(x_1,\ldots,x_n)/(x_1,\ldots,x_n)^2+(f)
$$ 
and has dimension $n-1$ if and only if $f\notin(x_1,\ldots,x_n)^2$.]

\nn\textbf{Hints.} I think the assumption that $f$ is irreducible is unnecessary, and that it suffices to suppose that $f$ is nonzero.

Recall that Corollary 11.18 says: ``Let $A$ be a Noetherian local ring, $x$ an element of $\mmm$ which is not a zero-divisor. Then $\dim A/(x)=\dim A-1$.''.

We can assume $P=0$. We will use the following notation: $X_1,\ldots,X_n$ are indeterminates, $A$ is defined by $A:=k[X_1,\ldots,X_n]/(f)=k[x_1,\ldots,x_n]$ where $x_i$ is the image of $X_i$, we set 
$$
\mmm:=(X_1,\ldots,X_n),\quad\overline\mmm:=(x_1,\ldots,x_n)\simeq\mmm/(f).
$$ 
We have 
\begin{equation}\label{dimam}
\dim A_{\overline\mmm}=n-1
\end{equation}
by Corollary 11.18. We also have 
\begin{equation}\label{fom}
\frac{\overline\mmm}{\overline\mmm^2}=\frac{\mmm/(f)}{(\mmm^2+(f))/(f)}\simeq\frac{\mmm}{\mmm^2+(f)}\ .
\end{equation}
$\bu$ If $f\in\mmm^2$ we get 
$$
\frac{\overline\mmm}{\overline\mmm^2}\simeq\frac{\mmm}{\mmm^2}\simeq k^n
$$ 
by \eqref{fom}, and $A_{\overline\mmm}$ is singular by \eqref{dimam}. 

\nn$\bu$ If $f\not\in\mmm^2$ we have 
$
n-1=\dim A_{\overline\mmm}\le\dim_k\overline\mmm/\overline\mmm^2\le n-1
$ 
by \eqref{dimam}, Corollary~11.15 p.~121 of the book and \eqref{fom}, so that $A_{\overline\mmm}$ is regular in this case. [Corollary~11.15 says: ``$\dim A\le\dim_k(\mmm/\mmm^2)$.]

We conclude that $A_{\overline\mmm}$ is regular if and only if $f\not\in\mmm^2$. It remains to check that $0$ is non-singular if and only if $f\not\in\mmm^2$, or, in other words, that $\frac{\partial f}{\partial X_i}(0)\ne0$ for some $i$ if and only if $f\not\in\mmm^2$. But this follows from that fact that $\frac{\partial f}{\partial X_i}(0)$ is the coefficient of $X_i$ in $f$. 

\subsubsection{Page 125, Exercise~11.2}%

\textbf{Statement.} In (11.21) assume that $A$ is complete. Prove that the homomorphism $k[[t_1,\ldots,t_d]]\to A$ given by $t_i\mapsto x_i$ ($i=1,\ldots,d$) is injective and that $A$ is a finitely-generated module over $k[[t_1,\ldots,t_d]]$.

Recall (11.21): If $(A,\mmm)$ is a noetherian local ring and $k\subset A$ a field mapping isomorphically onto $A/\mmm$, and if $x_1,\ldots,x_d$ is a system of parameters, then $x_1,\ldots,x_d$ are algebraically independent over $k$.

\nn\textbf{Solution.} Let $\qqq$ be the $\mmm$-primary ideal $(x_1,\ldots,x_d)$, set 
$$
\nnn:=(t_1,\ldots,t_d)\subset B_0:=k[t_1,\ldots,t_d],\quad B:=k[[t_1,\ldots,t_d]],
$$ 
and let $\phi:B_0\to A$ be the obvious morphism mapping $t_i$ to $x_i$. The $\nnn$-topology, the $\qqq$-topology and the $\mmm$-topology coincide on $A$ [see proof of Proposition~11.6 p.~119]. In particular $\phi$ extends uniquely to a continuous morphism $\psi:B\to A$. Let us show that $\psi$ is injective. Let 
$$
0\ne b:=\sum c_\alpha t_1^{\alpha_1}\cdots t_d^{\alpha_d}
$$ 
be in $B$ and assume by contradiction $\psi(b)=0$. Write $b=b_n+b_{n+1}+\cdots$ with $b_i$ homogeneous of degree $i$ and $b_n\ne0$. Set $a_i:=\phi(b_i)$. We get $a_n\in\qqq^{n+1}$, and Proposition~11.20 p.~122 of the book implies $b_n=0$, contradiction. 

Let us show that $A$ is a finitely generated $B$-module. By Proposition~10.24 p.~112 of the book, it suffices to show that $G_\nnn(A)=G_\qqq(A)$ is a finitely generated $G_\nnn(B)$-module, where $\nnn$ is the maximal ideal of $B$. Note that $G_\nnn(B)$ is a sub-$G_\nnn(B)$-module of $G_\qqq(A)$, the quotient being 
$$
\frac{A/\qqq}{A/\mmm}=\frac{A/\qqq}k\ ,
$$ 
which a finite dimensional $k$-vector space, and \emph{a fortiori} a finitely generated $G_\nnn(B)$-module. 

\subsubsection{Page 126, Exercise~11.3}\label{113}%

\textbf{Statement.} Extend (11.25) to non-algebraically-closed fields.

Recall (11.25): For any irreducible variety $V$ over $K$ the local dimension of $V$ at any point is equal to $\dim V$.

\nn\textbf{Solution.} Let $K$ be a field and $A$ a finitely generated $K$-algebra. By Noether's Normalization Theorem [Theorem~\ref{thmnnt} p.~\pageref{thmnnt}], %[see Section~\ref{parnnt} p.~\pageref{parnnt}], 
the Krull dimension $n$ of $A$ is finite, and there are $n$ elements of $A$ which are algebraically independent over $K$. 

\nn Claim: Any $n+1$ elements of $A$ are algebraically dependent over $K$.

\nn Proof. If $A$ is a domain, we are done because Noether's Normalization Theorem implies that $n$ is the transcendence degree of the field of fractions of $A$ over $K$. If $A$ is not a domain, we can argue as follows. 

Assume by contradiction that the elements $x_1,\ldots,x_{n+1}$ of $A$ are algebraically independent over $K$. Set $B:=K[x_1,\ldots,x_{n+1}]\subset A$ and $S:=B\setminus\{0\}$. This is a multiplicative subset of $A$ which does not contain $0$. Thus there is a prime ideal $\ppp$ of $A$ which is disjoint from $S$, and $B$ imbeds into the domain $A/\ppp$, whose Krull dimension is at most $n$. This contradicts the first part of the argument.

% comment removed https://docs.google.com/document/d/1e5EGybYATuzRFl6V2MD2Bfkw6ESUFFAvB4Pu2RvwVTU/edit comment 8

\subsubsection{Page 126, Exercise~11.4}%

The purpose of the exercise is to prove:

\begin{thm}[Nagata]
There are noetherian domains of infinite dimension.
\end{thm}

We sketch a proof [which will give explicit examples]. 

Let $\mathbb N=\bigsqcup_{i\in\mathbb N}N_i$ be a partition of $\mathbb N$ such that each $N_i$ is finite and nonempty, let $K$ be a field, let $A$ be the $K$-algebra $K[x_0,x_1,\dots]$, where the $x_i$ are indeterminates, for each $i\in\mathbb N$ let $\ppp_i$ be the ideal of $A$ generated by the $x_j$ with $j\in N_i$, and let $S\subset A$ be the complement of the union of the $\ppp_i$. Clearly the $\ppp_i$ are prime and $S$ is a multiplicative subset of $A$. Set $B:=S^{-1}A$. 

Our main goal is to prove 
$$
\text{(a) $B$ is noetherian.} 
$$ 
\paragraph{Reduction to Statements (d) and (e).}

By Exercise~7.9 p.~85 of the book, it suffices to show 

\nn(b) For each maximal ideal $\mmm$ of $B$, the local ring $B_\mmm$ is noetherian.

\nn(c) For each $b\ne0$ in $B$, the set of maximal ideals of $B$ which contain $b$ is
finite.

We claim 

\nn(d) If $\aaa$ is an ideal of $A$ contained in the union of the $\ppp_i$, then $\aaa$ is contained in some $\ppp_i$.

Statement (d) will imply that the maximal ideals of $B$ are the $S^{-1}\ppp_i$, and thus, (d) will imply (c). Statement (d) will also reduce (b) to 

\nn(e) For each $i$ the local ring $B_{S^{-1}\ppp_i}$ is noetherian.

To summarize, it suffices to prove (d) and (e). 

\paragraph{Proof of (d).}

Recall Statement (d):

\nn(d) If $\aaa$ is an ideal of $A$ contained in the union of the $\ppp_i$, then $\aaa$ is contained in some $\ppp_i$.

To prove (d) we shall implicitly use the following easy fact: 

\begin{note}\label{monid}
Let $\bbb$ be an ideal of $A$. Then $\bbb$ is generated by monomials if and only if it has the following property:

A polynomial $f\in A$ is in $\bbb$ if and only if all the monomials occurring in $f$ are in $\bbb$.
\end{note}

\nn Proof of (d). Assume by contradiction that $\aaa$ is contained in the union of the $\ppp_i$, but is contained in no $\ppp_i$. Let $0\ne f\in\aaa$. 

There is an $n\in\mathbb N$ such that no monomial occurring in $f$ is in $\ppp_{n+1}\cup\ppp_{n+2}\cup\cdots$. In particular 

\qquad(A) $f\notin\ppp_{n+1}\cup\ppp_{n+2}\cup\cdots$. 

We claim that there is a $g\in\aaa$ such that 

\qquad(B) $g\notin\ppp_0\cup\cdots\cup\ppp_n$, 

\qquad(C) $g$ has no monomial in common with $f$.

In view of (A) the claim will imply that $f+g$ is in $\aaa$ but not in any of the $\ppp_i$, contradiction [this contradiction will complete the proof of (d)].
 
By Proposition~\ref{p1.11i} p.~\pageref{p1.11i} there is an $h\in\aaa$ such that $h\notin\ppp_0\cup\cdots\cup\ppp_n$. If $j$ is in $N_{n+1}$, then $g:=x_jh$ will satisfy (B) and (C). This proves the claim, and completes the proof of (d).% two comments removed 200604 https://docs.google.com/document/d/16c7gN3h-T8ln0GyEAGtBOUHPk3HX2yPGAh08XTJ2aY0/edit

\paragraph{Proof of (e).}

It only remains to prove Statement (e), which we recall:

\nn(e) For each $i$ the local ring $B_{S^{-1}\ppp_i}$ is noetherian.

We change the setting as follows [letting again $K$ be a field]. Let $x_1,\ldots,x_n$ and $y_1,y_2,\ldots$ be indeterminates, denote by $x$ the sequence $(x_1,\ldots,x_n)$ of indeterminates, and by $y$ the sequence $(y_1,y_2,\ldots)$ of indeterminates. Let $K[x,y]$ be the polynomial $K$-algebra over all the above indeterminates. We claim 

\nn(g) The equality 
$$
K[x,y]_{(x_1,\ldots,x_n)}=\Big(\big(K(y)\big)[x]\Big)_{(x_1,\ldots,x_n)}
$$ 
holds as an equality between subrings of $K(x,y)$. In particular this ring is noetherian. 

We leave the proof of (g) to the reader. Clearly (g) implies (e). 

\subsubsection{Page 126, Exercise~11.6}\label{ex11.6}% previous version https://docs.google.com/document/d/1pXphjmJVG5y2JSIiE6W0ZBNaBsdVPPTXytsjLOLYc7g/edit

\textbf{Statement.} Let $A$ be a ring [not necessarily Noetherian]. Prove that 
$$
1+\dim A\le\dim A[x]\le1+2\dim A.
$$

\nn\textbf{Solution.} We denote the Krull dimension of any ring $A$ by $\dim A$ and the height of any prime ideal $\ppp$ by $h(\ppp)$. If we have a ring morphism $A\to B$ and a prime ideal $\qqq_i$ of $B$, we write $\ppp_i^{\oo c}$ for $(\ppp_i)^{\oo c}$.  

\nn\emph{Proof of the inequality} $\dim A[x]\ge1+\dim A$: If 
$
\ppp_0\subsetneqq \dots\subsetneqq \ppp_n
$ 
is a chain of prime ideals in $A$, then 
$$
\ppp_0[x]\subsetneqq \dots\subsetneqq \ppp_n[x]\subsetneqq \ppp_n+(x)
$$ 
is chain of prime ideals in $A[x]$ [see Exercise~4.7 p.~55 of the book --- see Section~\ref{ex4.7} p.~\pageref{ex4.7} --- and Lemma~\ref{fiberx} p.~\pageref{fiberx} above]. $\square$ 

\nn\emph{Proof of the inequality} $\dim A[x]\le1+2\dim A$: This inequality follows immediately from Lemma~\ref{fiberx} p.~\pageref{fiberx} above.

\subsubsection{Page 126, Exercise~11.7}% previous version https://docs.google.com/document/d/1oRILzwsOL6hxY74xil7pEj_bwa9k4-yieyVTCva3ev8/edit

\textbf{Statement.} Let $A$ be a Noetherian ring. Then
\begin{equation}\label{dax}
\dim A[x]=1+\dim A,
\end{equation}
and hence, by induction on $n$,
$$
\dim A[x_1,\ldots,x_n]=n+\dim A.
$$ 
\nn\textbf{Hint.} [This is the hint given in the book.] Let $\ppp$ be a prime ideal of height $m$ in $A$. Then there exist $a_1,\ldots,a_m\in\ppp$ such that $\ppp$ is a minimal prime ideal belonging to the ideal $\aaa=(a_1,\ldots,a_m)$. By Exercise~7 of Chapter~4, the ideal $\ppp[x]$ is a minimal prime ideal of $\aaa[x]$ and therefore the height $\ppp[x]$ is $\le m$. On the other hand, a chain of prime ideals 
$$
\ppp_0\subsetneqq \ppp_1\subsetneqq \cdots\subsetneqq \ppp_m=\ppp
$$ 
gives rise to a chain 
$$
\ppp_0[x]\subsetneqq \ppp_1[x]\subsetneqq \cdots\subsetneqq \ppp_m[x]=\ppp[x],
$$ 
hence the height of $\ppp$ is $\ge m$. Hence the height of $\ppp[x]$ is equal to the height of $\ppp$. Now use the argument of Exercise~6. 

\nn\textbf{Solution.} As in the previous section, we denote the Krull dimension of any ring $A$ by $\dim A$ and the height of any prime ideal $\ppp$ by $h(\ppp)$. We follow the hint of the book, and we shall use the following obvious fact: 

\begin{note}\label{116a}
If $\ppp_0\subsetneqq\cdots\subsetneqq\ppp_n$ is a chain of prime ideals, then $h(\ppp_n)\ge n+h(\ppp_0)$. 
\end{note}% version of 200604: https://docs.google.com/document/d/1Rnin3Ze0BD0GlcO3ZuP3MYOB9KdXi3YwBM34lHKbVqc/edit

The existence of $a_1,\ldots,a_m$ results from Lemma~\ref{p1113} p.~\pageref{p1113} above. The phrase ``and therefore the height $\ppp[x]$ is $\le m$'' follows from Corollary 11.16 page 121 of the book. As explained in the hint, this implies  
\begin{equation}\label{hpx}
h(\ppp[x])=h(\ppp).
\end{equation} 

In view of Section~\ref{ex11.6} above p.~\pageref{ex11.6}, \eqref{dax} reduces to $
\dim A[x]\le1+\dim A$. We can assume $\dim A<\infty$. Set $n:=\dim A$ and let $ \ppp_0\subsetneqq \cdots\subsetneqq \ppp_{n+2}$ be a chain of prime ideals in $A[x]$ of length $n+2$. 

It suffices to derive a contradiction from this assumption. 

The above chain contracting to a chain of length at most $n$ in $A$, there are indices $i$ such that $\ppp_i^{\oo c}=\ppp_{i+1}^{\oo c}$. Let $i$ be the largest such index. We have $\ppp_i=\ppp_i^{\oo c}[x]$ by Lemma~\ref{fiberx} p.~\pageref{fiberx} above, and 
\begin{equation}\label{hppp}
h(\ppp_i^{\oo c})=h(\ppp_i^{\oo c}[x])=h(\ppp_i)\ge i,
\end{equation} 
the first equality following from \eqref{hpx} and the inequality following from Note~\ref{116a}. Then we get 
$$
h(\ppp_{n+2}^{\oo c})\ge n+1-i+h(\ppp_i^{\oo c})\ge n+1-i+i=n+1,
$$ 
the inequalities following respectively from Note~\ref{116a} and Display~\eqref{hppp}. This contradicts the definition of $n$, proving \eqref{dax}.% comment removed 200604 https://docs.google.com/document/d/1CTfGlVXmTDizq5LSn3m3ynlqnceyC_rfiCRLziiYAQ4/edit

\end{document}
