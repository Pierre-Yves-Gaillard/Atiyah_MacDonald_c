% Atiyah_MacDonald_c_tex
% !TEX encoding = UTF-8 Unicode
% https://docs.google.com/document/d/1AW4qMXoarPW1L1Nxbgy4bODorWEpE6_Gdd35sFJKyew/edit
% https://github.com/Pierre-Yves-Gaillard/Atiyah_MacDonald_c/edit/master/Atiyah_MacDonald_c.tex
% version a of 20180208 https://docs.google.com/document/d/1p2ri2Mu-zyF7-Gk1eeJ4f0OinG0BPXZEAsljF3af2zs/edit
%\documentclass[12pt]{article}%\documentclass{article}
\documentclass[parskip=half,fontsize=12pt]{scrartcl}%\documentclass[parskip=full]{scrartcl}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsmath,amsthm} 
\usepackage[papersize={400pt,520pt},margin=15pt]{geometry}% e-readers
%\usepackage{geometry}% normal
%\usepackage[margin=15pt]{geometry} old
%\usepackage[papersize={4.5in,6in},margin=0.5cm]{geometry} old
%\usepackage[parfill]{parskip}%https://tex.stackexchange.com/questions/133003/using-the-parskip-package-i-find-the-space-between-subtitles-ugly
\usepackage[pdfusetitle]{hyperref}
\usepackage{datetime}
\usepackage[osf]{Baskervaldx} % oldstyle figures
%\usepackage{Baskervaldx}
\usepackage[baskervaldx]{newtxmath}
\usepackage{tikz-cd}
\usepackage{comment}
%\pagestyle{empty}
%\newcommand{\nn}{\newcommand}
\newcommand{\oo}{\operatorname}\newcommand{\ooo}{\operatorname*}
\newcommand{\mf}{\mathfrak}
\newcommand{\aaa}{\mf a}
\newcommand{\bbb}{\mf b}
\newcommand{\mmm}{\mf m}
\newcommand{\ppp}{\mf p}
\newcommand{\qqq}{\mf q}
\newcommand{\bu}{\bullet}
\newcommand{\ds}{\displaystyle}
\newcommand{\epi}{\twoheadrightarrow}
\newcommand{\incl}{\hookrightarrow}
\newcommand{\Ker}{\operatorname{Ker}}\newcommand{\Coker}{\operatorname{Coker}}
\newcommand{\mono}{\rightarrowtail}
\newcommand{\Spec}{\operatorname{Spec}}\newcommand{\Sp}{\operatorname{Spec}}
\newcommand{\Tor}{\operatorname{Tor}}
\newcommand{\xr}{\xrightarrow}
%\newcommand{\todo}{To do: }%\newcommand{\up}{Unsolved problem: }
%\newcommand{\nt}{\newtheorem}
\newtheorem{thm}{Theorem}%[section]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{df}[thm]{Definition}
\newtheorem{exo}[thm]{Exercise}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{note}[thm]{Note}
\newtheorem{qn}[thm]{Question}
\newtheorem{rk}[thm]{Remark}
%\addtolength{\parskip}{.2\baselineskip}
\title{About Atiyah and MacDonald's Book}
\author{Pierre-Yves Gaillard}
\date{\today,\currenttime}

\begin{document}%\ar[r,yshift=0.9ex]\ar[r,yshift=-0.9ex]%\ar[r,yshift=4pt]\large%{\oo c}

%\large

\maketitle\tableofcontents

This text is available at 

\href{http://www.iecl.univ-lorraine.fr/~Pierre-Yves.Gaillard/DIVERS/Atiyah_MacDonald_c/}{https://goo.gl/S9ykSu}\quad\href{https://github.com/Pierre-Yves-Gaillard/Atiyah_MacDonald_c/blob/master/Atiyah_MacDonald_c.tex}{https://goo.gl/8FNDcf}\quad\href{https://docs.google.com/document/d/1AW4qMXoarPW1L1Nxbgy4bODorWEpE6_Gdd35sFJKyew/edit?usp=sharing}{https://goo.gl/w26ZGZ}

Atiyah and MacDonald's book referred to in the title is of course the famous \textbf{Introduction to Commutative Algebra}.

Here are some links:

$\bu$ Errata \href{https://mathoverflow.net/q/42241/461}{https://mathoverflow.net/q/42241/461}

$\bu$ \href{https://sites.google.com/view/mathlife1}{https://sites.google.com/view/mathlife1}

$\bu$ Jeffrey Daniel Kasik Carlson \href{https://goo.gl/WEfMG7}{https://goo.gl/WEfMG7}

$\bu$ Thomas J. Haines, Lectures on Commutative Algebra, 

\href{http://www.math.umd.edu/~tjh/CommAlg.pdf}{http://www.math.umd.edu/$\sim$tjh/CommAlg.pdf}

$\bu$ Shengtian Yang 

\href{http://arxiv.codlab.net/book/note-am-ica/note-am-ica_0.1.2.pdf}{\small http://arxiv.codlab.net/book/note-am-ica/note-am-ica\_0.1.2.pdf}

\href{http://www.yangst.codlab.net}{http://www.yangst.codlab.net}

$\bu$ Yongwei Yao

\href{http://www2.gsu.edu/~matyxy/math831/}{http://www2.gsu.edu/$\sim$matyxy/math831/}

\href{http://www2.gsu.edu/~matyxy/math831/math831.html}{http://www2.gsu.edu/$\sim$matyxy/math831/math831.html}

%$\bu$ Takumi Murayama \href{http://www2.gsu.edu/~matyxy/math831/math831.html}{http://www2.gsu.edu/$\sim$matyxy/math831/math831.html}

$\bu$ Boocher \href{http://www.maths.ed.ac.uk/~aboocher/math/AMnotes.pdf}{\small http://www.maths.ed.ac.uk/$\sim$aboocher/math/AMnotes.pdf}

$\bu$ Allen Altman and Steven Kleinman %Flores \href{http://www.math.ku.edu/~zflores/mathematics.html}{http://www.math.ku.edu/$\sim$zflores/mathematics.html}

\href{http://web.mit.edu/18.705/www/13Ed.pdf}{http://web.mit.edu/18.705/www/13Ed.pdf}

\href{http://web.mit.edu/18.705/www/}{http://web.mit.edu/18.705/www/}

$\bu$ Wiki \href{http://am-solutions.wikispaces.com}{http://am-solutions.wikispaces.com}

\section{About Chapter 1}

\subsection{Page 6}%

\begin{note}\label{ef}
The intersection and the product of the empty family of ideals is the unit ideal.
\end{note}

It is written

\emph{In the ring $\mathbb Z$, $\cap$ and + are distributive over each other. This is not the case in general.}

Here is an example: In the ring $K[X,Y]$, where $K$ is a field and $X$ and $Y$ are indeterminates, we have 
$$
(X+Y)\cap\Big((X)+(Y)\Big)\not\subset\Big((X+Y)\cap (X)\Big)+\Big((X+Y)\cap (Y)\Big).
$$

\subsection{Page 7, Proposition 1.10}%

\textbf{Chinese Remainder Theorem.} \emph{Let $A$ be a commutative ring and $\aaa_1,\dots,\aaa_n$ ideals such that $\aaa_i+\aaa_j=A$ for $i\not=j$. Then the natural morphism from $A$ to the product of the $A/\aaa_i$ is surjective. Moreover the intersection of the $\aaa_i$ coincides with their product.}

\begin{proof} 
We have
\begin{equation}\label{crt}
A=\aaa_1+\aaa_2\cdots\aaa_n.
\end{equation}
Indeed, this can be checked either by multiplying together the equalities $A=\aaa_1+\aaa_i$ for $i=2,\dots,n$, or by noting that a prime ideal containing a product of ideals contains one of the factors. Then \eqref{crt} implies the existence of an $a_1$ in $A$ such that
$$
a_1\equiv1\bmod\aaa_1,\quad a_1\equiv0\bmod \aaa_i\ \forall\ i > 1.
$$
Similarly we can find elements $a_i$ in $A$ such that $a_i\equiv\delta_{ij}\bmod \aaa_j$ (Kronecker delta). This proves the first claim.

Let $\aaa$ be the intersection of the $\aaa_i$. Multiplying \eqref{crt} by $\aaa$ we get
$$
\aaa=
\aaa_1\aaa+
\aaa\aaa_2\cdots\aaa_n\subset
\aaa_1\ (\aaa_2\cap\cdots \cap \aaa_n)\subset \aaa.
$$
This gives the second claim, directly for $n=2$, by induction for $n>2$. 
\end{proof}

\subsection{Page 8}%

$\bu$ \textbf{Proposition 1.11i, Prime Avoidance}%

The following is taken from Wikipedia:

\href{https://en.wikipedia.org/wiki/Prime_avoidance_lemma}{https://en.wikipedia.org/wiki/Prime\_avoidance\_lemma}

\emph{Let $A$ be a commutative ring and $S$ a multiplicatively closed additive subgroup of $A$. Let $\mf a_1,\dots,\mf a_n$, $n\ge1$ be ideals such that $\mf a_i$ is prime for $i\ge3$. If $S$ is not contained in any $\mf a_i$, then $S$ is not contained in their union.}

\begin{proof} 
We argue by induction on $n$. It suffices to find an element $s$ that is in $S$ and not in $\mf a_i$ for any $i$. 

1. The case $n=1$ is trivial. 

2. Suppose $n\ge2$. For each $i$ choose $s_i$ in $S\setminus\bigcup_{j \ne i}\mf a_j$, this set being nonempty by inductive hypothesis. We can assume $s_i \in \mf a_i$ for all $i$; otherwise, some $s_i$ avoids all the $\mf a_j$'s and we are done. 

Claim: the element $s:=s_1\cdots s_{n-1}+s_n$ is in $S$ but not in $\mf a_i$ for any $i$. 

2.1. If $s$ is in $\mf a_i$ for some $i\le n-1$, then $s_n$ is in $\mf a_i$, a contradiction. 

2.2. If $s$ is in $\mf a_n$, then $s_1\cdots s_{n-1}$ is in $\mf a_n$. 

2.2.1. If $n$ is 2, we get $s_1\in \mf a_2$, a contradiction.

2.2.2. If $n>2$ then, since $\mf a_n$ is prime, there is an $i$ less than $n$ such that $s_i$ is in $\mf a_n$, a contradiction.

This proves the claim, and thus the statement. 
\end{proof}

Here is a version which is slightly weaker but sufficient for our purpose:

\emph{Let $A$ be a commutative ring, let $\mf a$ be an ideal, and let $\ppp_1,\dots,\ppp_n,n\ge1$ be prime ideals. If $\mf a$ is not contained in any $\ppp_i$, then $\mf a$ is not contained in their union.}

\begin{proof} 
We can assume that $n\ge2$ and that there are elements $a_1,\dots,a_n$ in $\mf a$ such that 
$$
a_i\in\ppp_i\setminus\bigcup_{j \ne i}\ppp_j.
$$ 
Then $a:=a_1\cdots a_{n-1}+a_n$ is in $\mf a$ but not in $\ppp_i$ for any $i$.
\end{proof}

%About the proof of Part (ii) of Proposition 1.11 p.~8, if a prime ideal contains the intersection of a finite family of ideals, then it contains the product of this family, and thus one of the factors.

$\bu$ \textbf{Proposition 1.11ii}%

Note that $\ppp$ is prime $\iff$
$$
\ppp\supset\mf a\mf b\quad\implies\quad\ppp\supset\mf a\quad\text{or}\quad\ppp\supset\mf b.
$$

$\bu$ \textbf{Quotient ideal}%

We have 
$$
\mf a\subset\mf a',\ \mf b'\subset\mf b\ \implies\ (\mf a:\mf b)\subset(\mf a':\mf b'),
$$ 
$$
(1:\mf b)=(1)=(\mf a:0),\quad(\mf a:1)=\mf a.
$$

$\bu$ \textbf{Exercise 1.12i}%

To show that the inclusion $\mf a\subset(\mf a:\mf b)$ is strict in general, let $A$ be nonzero and set $\mf a=\mf b=(0)$.

$\bu$ \textbf{Exercise 1.12ii}%

To show that the inclusion $(\mf a\!:\!\mf b)\,\mf b\subset(\mf a:\mf b)$ is strict in general, let $A$ be nonzero and set $\mf a=(1),\ \mf b=(0)$.

\subsection{Page 9, extended ideal}%

If $f:A\to B$ is a morphism of rings and $\mf a$ is an ideal of $A$, then we can define $\mf a^{\oo e}$ by the formula
$$
\mf a^{\oo e}:=\sum_{\alpha\in\mf a}\ (f(\alpha)).
$$

\subsection{Page 10, Exercise 1.18, Part 1}%

Let $K$ be a field and let $X$ and $Y$ be indeterminates. If $\mf a$ is an ideal of $K[X,Y]$, we denote by $x$ and $y$ the images of $X$ and $Y$ in $K[X,Y]/\mf a$.

$\bu$ Let us show that the inclusion $(\mf a_1\cap\mf a_2)^{\oo e}\subset\mf a_1^{\oo e}\cap\mf a_2^{\oo e}$ is strict in general. Set (with obvious notation) 
$$
A:=K[X,Y]/(X^2,XY,Y^2),\quad B:=K[X]/(X^2),
$$ 
$$
f:A\to B,\quad f(x):=x,\quad f(\,y):=0,
$$ 
$$
\mf a_1:=(x),\quad\mf a_2:=(x-y).
$$

$\bu$ Let us show that the inclusion $\mf b_1^{\oo c}+\mf b_2^{\oo c}\subset(\mf b_1+\mf b_2)^{\oo c}$ is strict in general. Set (with obvious notation) 
$$
A:=K[X]/(X^2),\quad B:=K[X,Y]/(X^2,XY,Y^2),
$$ 
$$
f:A\to B,\quad f(x):=x,
$$ 
$$
\mf b_1:=(\,y),\quad\mf b_2:=(x-y).
$$

$\bu$ Let us show that the inclusion $\mf b_1^{\oo c}\mf b_2^{\oo c}\subset(\mf b_1\mf b_2)^{\oo c}$ is strict in general. Set $A:=K[XY]$, $B:=K[X,Y]$, and let $f:A\to B$ be the inclusion. Then we have 
$$
(X)^{\oo c}(Y)^{\oo c}=(X^2Y^2),\quad(XY)^{\oo c}=(XY).
$$

$\bu$ Let us show that the inclusion $(\mf a_1:\mf a_2)^{\oo e}\subset(\mf a_1^{\oo e}:\mf a_2^{\oo e})$ is strict in general. Set $A:=K[X]$, $B:=K[X,Y]/(XY)$, $f(X):=x$. Then we have 
$$
y\in((0)^{\oo e}:(X)^{\oo e})=((0):(X)^{\oo e}),
$$ 
$$y\notin(0)=(0)^{\oo e}=((0):(X))^{\oo e}.$$

$\bu$ Let us show that the inclusion $(\mf b_1:\mf b_2)^{\oo c}\subset(\mf b_1^{\oo c}:\mf b_2^{\oo c})$ is strict in general. Set $A:=K$, $B:=K[X]$, $\mf b_1:=(0)$, $\mf b_2:=(X)$. Then we have 
$$
1\in(\mf b_1^{\oo c}:\mf b_2^{\oo c})\setminus(\mf b_1:\mf b_2)^{\oo c}.
$$
$\bu$ Let us show that the inclusion $r(\mf a)^{\oo e}\subset r(\mf a^{\oo e})$ is strict in general. Set $A:=K[X^2]$, $B:=K[X]$, $\mf a:=(X^2)$. Then we have 
$$
X\in r(\mf a^{\oo e})\setminus r(\mf a)^{\oo e}.
$$

\subsection{Page 10, Exercise 1.18, Part 2}%

We have 
$$
\left(\sum\mf a_i\right)^{\oo e}=\sum\mf a_i^{\oo e},\quad\left(\sum\mf b_i\right)^{\oo c}\supset\sum\mf b_i^{\oo c},
$$
$$
\left(\bigcap\mf a_i\right)^{\oo e}\subset\bigcap\mf a_i^{\oo e},\quad\left(\bigcap\mf b_i\right)^{\oo c}=\bigcap\mf b_i^{\oo c}.
$$

We prove the first of these four statements, leaving the others to the reader. We have 
$$
\left(\sum\mf a_i\right)^{\oo e}=\sum_{\alpha\in\sum\mf a_i}(f(\alpha)),\quad\sum\mf a_i^{\oo e}=\sum_i\sum_{\alpha_i\in\mf a_i}(f(\alpha_i)).
$$ 
The inclusion $\supset$ is clear. Let's prove the inclusion $\subset$. Let $\alpha$ be in $\sum\mf a_i$. This means that $\alpha$ is of the form $\sum\alpha_i$ with $\alpha_i\in\mf a_i$, $\alpha_i=0$ for almost all $i$. This yields 
$$
f(\alpha)=\sum_if(\alpha_i)\in\sum_i\sum_{\alpha_i\in\mf a_i}(f(\alpha_i))=\sum\mf a_i^{\oo e}.
$$ 

\subsection{Page 10, Exercise 1.18, Part 3}%

$\bu$ Let us prove that $C$ is closed under quotients. 

For $\aaa,\bbb\in C$ we have
$$
(\aaa:\bbb)\subset(\aaa:\bbb)^{\oo{ec}}\subset(\aaa^{\oo e}:\bbb^{\oo e})^{\oo c}\subset(\aaa^{\oo{ec}}:\bbb^{\oo{ec}})=(\aaa:\bbb).
$$ 
Indeed, the first inclusion follows from Proposition 1.17 p.~10, whereas the second and third inclusions follow from Exercise 1.18 p.~10. 

$\bu$ Exercise 1.1. If $x$ is nilpotent, then $\sum_{n\ge0}x^n$ is the inverse of $1-x$. If $u$ is a unit and $x$ is nilpotent, then $u+x=u\,(1+x/u)$ is a unit.

\subsection{Page 11, Exercise 1.2iii}%

This will follow from Exercise 1.3iii.

%\subsection{Page 11, Exercise 1.2iv}%

%See \href{https://goo.gl/sbszfj}{https://goo.gl/sbszfj}

\subsection{Page 11, Exercise 1.3i and 1.3ii}%

Prove both statements by induction on the number of indeterminates, starting with Exercise 1.3ii.

\subsection{Page 11, Exercise 1.3iii}%

Let $f\in A[x_1,\dots,x_n]$ be a nonzero zero divisor. We must show that there is a nonzero $b$ in $A$ such that $bf=0$. We equip the monomials with the graded lexicographic order, see 

\href{https://en.wikipedia.org/wiki/Monomial_order}{https://en.wikipedia.org/wiki/Monomial\_order}

We denote the multi-degree of $g\in A[x_1,\dots,x_n]$ by $\deg g$. Put 
$$
f=a_0+\cdots+a_\alpha x^\alpha,
$$ 
where $\alpha$ is the multi-degree of $f$. Let 
$$
g=b_0+\cdots+b_\beta x^\beta\in A[x_1,\dots,x_n]
$$ 
be a nonzero polynomial of least multi-degree $\beta$ such that 
\begin{equation}\label{1}
fg=0.
\end{equation}
It suffices to prove 
\begin{equation}\label{2}
\beta=0.
\end{equation}
For this it suffices to prove
\begin{equation}\label{3}
a_\gamma g=0\ \forall\ \gamma.
\end{equation}
Assume \eqref3 is false, and let $\gamma$ be the largest multi-index satisfying $a_\gamma g\neq0$. Then \eqref1 implies $a_\gamma b_\beta=0$ and thus $\deg a_\gamma g<\beta$. As $f\cdot(a_\gamma g)=0$, this entails $a_\gamma g=0$, a contradiction. This proves \eqref3 and thus \eqref2.

\subsection{Page 11, Exercise 1.4}%

We must show that the Jacobson radical of $A[x]$ coincides with its nilradical. Let $f$ be in the Jacobson radical of $A[x]$. It suffices to show that $f$ is nilpotent. By Proposition~1.9 p.~6 of the book, $1-xf$ is a unit. Exercise 1.2i p.~11 implies that the coefficients of $f$ are nilpotent, and Exercise 1.2ii implies that $f$ itself is nilpotent.

\subsection{Page 11, Exercise 1.5ii}%

Here is an example of a non-nilpotent formal power series all of whose coefficients are nilpotent. Put $B:=\mathbb Z[y_2,y_3,\dots]$ where $y_2,y_3,\dots$ are indeterminates. Let $\aaa$ be the ideal of $B$ generated by the $y_i^i$ for $i\ge2$ and the $y_iy_j$ for $i\neq j$. Let $a_i$ be the image of $y_i$ in $A:=B/\aaa$. It is easy to see that $a_i^{i-1}\neq0$. Then $f:=a_2x^2+a_3x^3+\cdots$ satisfies 
$$
f^n=\sum_{i>n}a_i^nx^{in}\neq0.
$$

\subsection{Page 11, Exercise 1.5iii}%

Other wording: $\mf R(A[[x]])=\mf R(A)+(x)$.

\subsection{Page 11, Exercise 1.5iv}

Let $\mf m$ be a maximal ideal of $A[[x]]$. We must show that $\mf m^{\oo c}$ is maximal and that $\mf m=\mf m^{\oo c}+(x)$.

(a) $x\in\mf m$. Proof: $1-xf\in A[[x]]^\times$ by (i).

(b) $A[[x]]=A+\mf m$. Proof: $A[[x]]=A+(x)\overset{(\text a)}\subset A+\mf m$.

(c) $A/\mf m^{\oo c}\simeq A[[x]]/\mf m$. Proof: 
$$
A/\mf m^{\oo c}=A/(A\cap\mf m)\simeq(A+\mf m)/\mf m\overset{(\text b)}=A[[x]]/\mf m.
$$ 
Then (c) implies that $\mf m^{\oo c}$ is maximal.

(d) $\mf m=\mf m^{\oo c}+(x)$. Proof: If $f=a_0+xg\in\mf m$, then $a_0\in\mf m^{\oo c}$ by (a).

\subsection{Page 11, Exercise 1.5v}%

In the next few lines, $A^*$ shall designate the set of prime ideals of the ring $A$, and $f^*:B^*\to A^*$ shall denote the map induced by the ring morphism $f:A\to B$. 

We must show that $A[[x]]^*\to A^*$ is surjective.

If 
$$
A\xrightarrow fB\xrightarrow gC
$$ 
are ring morphisms and if $(g\circ f)^*:C^*\to A^*$ is surjective, then so is $f^*:B^*\to A^*$. We solve Exercise 1.5v by applying this observation to the natural morphisms $A\to A[[x]]\to A$, whose composition is the identity of $A$.

\subsection{Page 11, Exercise 1.11iii}%

Let $A$ be boolean, and let us show that any finitely generated $\aaa$ ideal is principal. We can assume $\aaa=(x,y)$. Then $z:=x+y-xy\in\aaa$ satisfies $xz=x,yz=y$, and we get $\aaa=(z)$.

\subsection{Page 11, Exercise 1.12}%

A local ring $A$ contains no idempotents $\neq0,1$. A ring containing such an idempotent is a product of two nonzero rings, and, thus, cannot be local. Other argument: %If $A$ is local and $a\in A$ is not a unit, then $a\in\mathfrak R$, and $1-a$ is a unit. 
Let $e\in A$ be idempotent. If $e$ is a unit, then $e=e^{-1}e^2=e^{-1}e=1$. If $e$ is not a unit, then $e\in\mathfrak R$, and $1-e$ is a unit (by Proposition~1.9 p.~6 of the book) and an idempotent, and thus equal to $1$, hence $e=0$.

\subsection{Page 11, Exercise 1.13}%

In the notation of the exercise, let us show $\aaa\neq(1)$. 

Given $f_1,\dots,f_n\in\Sigma$, set $x_i:=x_{f_i}$ for $i=1,\dots,n$. Assuming $\aaa=(1)$ by contradiction, we can choose $f_1,\dots,f_n$ as above in such a way that there are $g_i(x_1,\dots,x_n)$ in $K[x_1,\dots,x_n]$ such that 
$$
\sum_{i=1}^n g_i(x_1,\dots,x_n)f_i(x_i)=1.
$$ 
Letting $L$ be an extension of $K$ in which each $f_i$ has a root $\alpha_i$, we get the equality $0=1$ in $L$ be evaluating the above display at $(\alpha_1,\dots,\alpha_n)$.

\subsection{Page 12, Exercise 1.14}\label{114}%

More precisely, for each $\mf a\in\Sigma$ there is a maximal element $\mf b\in\Sigma$ such that $\mf a\subset\mf b$.

\subsection{Page 13, Exercise 1.21iii}%

It seems better to prove first the equality 
$$
\overline S=V(\mf a),\quad \mf a:=\bigcap_{\ppp\in S}\ \ppp
$$ 
for $S\subset\oo{Spec}(A)$.

\subsection{Page 13, Exercise 1.22, (i) implies (iii)}%

We have $X=V(\aaa)\sqcup V(\bbb)$. This implies $\aaa+\bbb=(1)$ and $\aaa\cap\bbb\subset\mf N$. There are $a\in\aaa$ and $b\in\bbb$ such that $a+b=1$, and thus $(a^n)+(b^n)=(1)$ and $a^nb^n=0$ for some $n$, and we have $e+f=1$ and $ef=0$ for some $e\in(a^n)$ and some $f\in(b^n)$. This gives $e-e^2=ef=0$, and thus $e^2=e$. Similarly $f^2=f$.

\subsection{Page 14, Exercise 1.23}%

Part (i): In fact we have $X=X_f\sqcup X_{1-f}$ for all $f$ in $A$.

Part (iv): If $f\in\ppp\setminus\mf q$ then $\ppp\in X_{1-f}$ and $\mf q\in X_f$.

\subsection{Page 14, Exercise 1.25}%

The following observation can be used in the solution to Exercise 1.25.

Let $a$ and $b$ be elements of a boolean ring $A$. We claim
\begin{equation}\label{125a}
(a)=(b)\iff a=b.
\end{equation} 
In words: In a boolean ring, any principal ideal has a unique generator. Let us first show 
\begin{equation}\label{125b}
a\in(b)\iff ab=a.
\end{equation}
Assume $a\in(b)$, that is $a=bc$ for some $c$, and thus $ab=b^2c=bc=a$. The other implication is trivial. This proves \eqref{125b}. To prove the non-obvious implication in \eqref{125a}, assume $(a)=(b)$, that is $a\in(b)$ and $b\in(a)$. By \eqref{125b} this gives $a=ab=b$. $\square$

Note that \eqref{125a} implies $X_f=X_g\iff f=g$.

Note also the following: Let $A$ be a boolean ring. Then the map $a\mapsto(a)$ is a bijection from $A$ to the set $P$ of principal ideals of $A$. Moreover 

$\bullet\ P$ is a sublattice of the lattice of ideals of $A$, 

$\bullet\  P$ is the lattice attached to $A$,

$\bullet$ we have $(a)+(b)=(a+b+ab),\ (a)\cap(b)=(ab)$.

\subsection{Page 16, Exercise 1.28}%

We assume that our field $k$ is \emph{infinite} (but not necessarily algebraically closed). We shall prove that, in the setting of the exercise, there are inverse bijections 
$$
\begin{tikzcd}
\text{Hom}(X,Y)\ar[r,yshift=4pt,"F"]&\text{Hom}(P(Y),P(X))\ar[l,yshift=-4pt,"G"],
\end{tikzcd}
$$ 
where the first $\text{Hom}$ is the set of regular morphisms from$X$ to $Y$ and the second $\text{Hom}$ is the set of $k$-algebra morphisms from $P(Y)$ to $P(X)$. We shall use the following notation:
$$
t=(t_1,\dots,t_n),\ u=(u_1,\dots,u_m),\ x=(x_1,\dots,x_n),%\ y=(y_1,\dots,y_m),
$$ 
where the $t_i$ and $u_j$ are indeterminates, and the $x_i$ %and $y_j$ 
are in $k$.

$\bullet$ Definition of $F$. Let $\varphi:X\to Y$ be regular, that is, $\varphi$ is induced by a polynomial map $\widetilde\varphi:k^n\to k^m$. Define the $k$-algebra morphism 
$$
\widetilde\Phi:k[u]\to k[t]
$$ 
by 
$$
\widetilde\Phi(g):=g\circ \widetilde\varphi.
$$ 
It is easy to see that $\widetilde\Phi$ induces a $k$-algebra morphism $\Phi:P(Y)\to P(X)$ which does not depend on the choice of $\widetilde\varphi$. Set $F(\varphi):=\Phi$, that is 
$$
\widetilde{F(\varphi)}(g):=g\circ\widetilde\varphi.
$$ 

$\bullet$ Definition of $G$. Let $\Phi:P(Y)\to P(X)$ be a $k$-algebra morphism. Then $\Phi$ lifts to a $k$-algebra morphism $\widetilde\Phi:k[u]\to k[t]$. Define the polynomial map $\widetilde\varphi:k^n\to k^m$ by 
$$
u_i(\widetilde\varphi(x)):=\widetilde\Phi(u_i)(x).
$$ 
%Clearly $\widetilde\varphi$ is polynomial. 
Let $g\in k[u]$ and $x\in k^n$, and let us show 
$$%\begin{equation}\label{128}
g\left(\widetilde\Phi(u_1)(x),\dots,\widetilde\Phi(u_m)(x)\right)=\widetilde\Phi(g)(x).
$$%\end{equation} 
It suffices to prove this for $g=u_i$, which is straightforward. 

Let $x$ be in $X$ and let us show that $\widetilde\varphi(x)$ is in $Y$. Let $g$ be in $I(Y)$. It suffices to check $g(\widetilde\varphi(x))=0$. But we have 
$$
g\left(\widetilde\varphi(x)\right)=g\left(\widetilde\Phi(u_1)(x),\dots,\widetilde\Phi(u_m)(x)\right)=\widetilde\Phi(g)(x)=0.
$$ 
Thus $\widetilde\varphi$ induces a regular map $\varphi:X\to Y$. It is straightforward to verify that $\varphi$ does not depend on the choice of $\widetilde\Phi$. Set $G(\Phi):=\varphi$, that is 
$$
\widetilde{G(\Phi)}(x):=\left(\widetilde\Phi(u_1)(x),\dots,\widetilde\Phi(u_m)(x)\right).
$$ 
Finally, it is straightforward to check $G(F(\varphi))=\varphi$ and $F(G(\Phi))=\Phi$.

\section{About Chapter 2}%%

\subsection{Page 21, Proposition 2.4}\label{24}%

Proposition 2.4 reads:

\emph{Let $M$ be a finitely generated $A$-module, let $\mf a$ be an ideal of $A$, and let $\phi$ be an $A$-module endomorphism of $M$ such that $\phi(M)\subseteq\mf a M$. Then $\phi$ satisfies an equation of the form
$$
\phi^n+a_1\,\phi^{n-1}+\cdots+a_n=0
$$ 
where the $a_i$ are in $\mf a$.}

Strictly speaking, this makes no sense because $\phi$ and the $a_i$ belong to different rings. We suggest the following restatement:

\emph{Let $M$ be a finitely generated $A$-module, let $\mf a$ be an ideal of $A$, let $\phi$ be an $A$-module endomorphism of $M$ such that $\phi(M)\subseteq\mf a M$, and let $\psi:A\to\oo{End}_A(M)$ be the natural morphism. Then $\phi$ satisfies an equation of the form
$$
\phi^n+\psi(a_1)\,\phi^{n-1}+\cdots+\psi(a_n)=0
$$ 
where the $a_i$ are in $\mf a$.}

[We have used the symbol $\subseteq$ above to make the quote accurate, but in general we denote inclusions by $\subset$.]

Another fix would be to equip $\operatorname{End}_A(M)$ with its natural $A$-module structure and change the display to 
$$
\phi^n+a_1\,\phi^{n-1}+\cdots+a_n\,\phi^0=0.
$$

If $\phi=\psi(\,y)$ for some $y$ in $A$ we get 
\begin{equation}\label{2124}
\psi(\,y^n+a_1\,y^{n-1}+\cdots+a_n)=0.
\end{equation}
This yields the following:

\emph{If $yM\subset\mf aM$ for some $y$ in $A$, then there is an $x$ in $A$ such that $xM=0$ and $x\equiv y^n\pmod{\mf a}$ for some $n$.}

Corollary 2.5 reads:

\emph{Let $M$ be a finitely generated $A$-module and let $\mf a$ be an ideal of $A$ such that $\mf aM=M$. Then there exists $x\equiv1\pmod{\mf a}$ such that $xM=0$.}

The proof reads:

Take $\phi=$ identity, $x=1+a_1+\cdots+a_n$ in (2.4).

I suggest the following restatement of the proof:

Since $\phi=$ identity, we can take $y=1$ in \eqref{2124}. This gives 
$$
\psi(1+a_1+\cdots+a_n)=0,
$$ 
and we can set $x:=1+a_1+\cdots+a_n$.

Note that Corollary 2.5 can also be stated as follows:

\emph{Let $M$ be a finitely generated $A$-module and let $\mf a$ be an ideal of $A$ such that $\mf aM=M$. Then there exists $\alpha\in\mf a$ such that $\alpha m=m$ for all $m\in M$.}

In other words, we go from $\mf aM=M$ to $\alpha m=m$.

Let us rewrite the proof of Proposition 2.4 to turn it into a proof of the corrected statement:%with as few changes as possible:

Let $x_1,\dots,x_n$ be a set of generators of $M$. Then each $\phi(x_i)\in\mf aM$, so that we have say $\phi(x_i)=\sum_{j=1}^na_{ij}x_j\ (1\le i\le n; a_{ij}\in\mf a)$, i.e., 
$$
\sum_{j=1}^n\ (\delta_{ij}\phi-\psi(a_{ij}))\ x_j=0
$$ 
where $\delta_{ij}$ is the Kronecker delta. Set $b_{ij}:=\delta_{ij}\phi-\psi(a_{ij})$, and let us regard the matrix $(b_{ij})$ as a matrix with entries in the subring $B$ of $\text{End}_A(M)$ generated by $\psi(A)$ and $\phi$, subring which is clearly commutative. Letting $(c_{ij})$ be the adjoint of $(b_{ij})$, we get 
$$
0=\sum_jc_{ij}\sum_kb_{jk}x_k=\sum_{j,k}c_{ij}b_{jk}x_k=\sum_k\left(\sum_jc_{ij}b_{jk}\right)x_k
$$ 
$$
=\sum_k\delta_{ik}\det(b_{j\ell})\,x_k=\det(b_{j\ell})\,x_i.
$$ %By multiplying on the left by the adjoint $(c_{ij})$ of $(b_{ij})$ 
It follows that $\det(b_{j\ell})$ annihilates each $x_i$, hence is the zero endomorphism of $M$. Expanding out the determinant, we have an equation of the required form.

(The underlying reasoning is that we consider the natural morphism from the ring of $n$ by $n$ matrices with entries in $B$ to the endomorphism ring of the $A$-module $M^n$.)

\subsection{Page 23, proof of Proposition 2.9 (i)}%

Let's prove: $\overline v$ injective $\implies$ $v$ surjective. If $\phi:M''\to M''/\oo{Im}(v)$ is the canonical projection, we get 
$$
0=\phi\circ v=\overline v(\phi)\ \implies\ \phi=0\ \implies\ v\text{ surjective.}
$$

\subsection{Page 24, vanishing tensors}\label{vt}%

Permanent tag: vanten.

This is taken from Lemma 10, Chapter 1, Section 2, Subsection 11, page 41 in Nicolas Bourbaki, \textbf{Algèbre commutative: Chapitres 1 à 4}, Masson, Paris 1985:

\emph{Let $A$ be a (non necessarily commutative) associative ring with $1$, let $M$ be a right $A$-module, let $N$ be a left $A$-module, let 
$$
(\,y_i)_{i\in I}\subset N
$$ 
be a generating family, let 
$$
(\,x_i)_{i\in I}\subset M
$$ 
be a finitely supported family, and assume 
$$
\sum_{i\in I}x_i\otimes y_i=0
$$ 
in $M\otimes_AN$. Then there is a finite set $J$ and there are finitely supported families 
$$
(x'_j)_{j\in J}\subset M,\quad(a_{ij})_{i\in I,j\in J}\subset A
$$ 
such that 
$$
\sum_{j\in J} x'_ja_{ij}=x_i
$$ 
for all $i$ and 
$$
\sum_{i\in I}a_{ij}y_i=0
$$ 
for all $j$.}

\begin{proof} 
Let $F$ be the free left $A$-module whose basis is the family of symbols $(\,e_i)_{i\in I}$, and consider the exact sequence 
$$
0\to R\xrightarrow\iota F\xrightarrow\varphi N\to 0
$$ 
where $\varphi$ is defined by $\varphi(e_i)=y_i$. It induces the exact sequence 
$$
M\otimes_AR\xrightarrow{\iota'}M\otimes_AF\xrightarrow{\varphi'}M\otimes_AN\to 0,
$$ 
and we get successively
$$
\varphi'\left(\sum_{i\in I}x_i\otimes e_i\right)=\sum_{i\in I}x_i\otimes y_i=0,
$$ 
$$
\sum_{i\in I}x_i\otimes e_i=\iota'\left(\sum_{j\in J}x'_j\otimes r_j\right)=\sum_{j\in J}x'_j\otimes\iota(r_j)
$$ 
where $J$ is a finite set, where $x'_j$ is in $M$ and where $r_j$ is in $R$, 
$$
\iota(r_j)=\sum_{i\in I}a_{ij}e_i
$$ 
for some finitely supported family $(a_{ij})_{i\in I,j\in J}\subset A$, 
$$
\sum_{i\in I}x_i\otimes e_i=\sum_{j\in J}x'_j\otimes\iota(r_j)=\sum_{j\in J} x'_j\otimes\sum_{i\in I}a_{ij}e_i
$$
$$
=\sum_{i\in I}\sum_{j\in J} x'_j\otimes a_{ij}e_i=\sum_{i\in I}\left(\sum_{j\in J}x'_ja_{ij}\right)\otimes e_i,
$$ 
$$
x_i=\sum_{j\in J}x'_ja_{ij},
$$ 
$$
0=\varphi(\iota(r_j))=\sum_{i\in I}a_{ij}y_i.
$$ 
\end{proof}

In the same spirit, we have:

\emph{Let $A$ be a (non necessarily commutative) associative ring with $1$; let $I$ be a set; let $J$ be a finite set; let 
$$
A^{\oplus I}\xrightarrow\phi A^{\oplus J}\xrightarrow\psi N\to0
$$ 
be an exact sequence of left $A$-modules; let $\phi$ be given by 
$$
\phi(e_i)=\sum_ja_{ij}f_j,
$$ 
where $(e_i)$ and $(f_j)$ are the obvious canonical bases; for $j$ in $J$ set $v_j:=\psi(f_j)\in N$; let $M$ be a right $A$-module; let $u$ in $M^{\oplus J}$ satisfy $\sum u_j\otimes v_j=0$ in $M\otimes_AN$. Then there is a $w$ in $M^{\oplus I}$ such that 
$$
\sum_iw_ia_{ij}=u_j
$$ 
for all $j$.}

\begin{proof} 
Applying $M\otimes_A-\ $ to the above exact sequence we get the exact sequence 
$$
M^{\oplus I}\xrightarrow{\phi'}M^{\oplus J}\xrightarrow{\psi'}M\otimes_AN\to0
$$ 
and $\psi'(u)=0$. Thus there is a $w$ in $M^{\oplus I}$ such that $\phi'(w)=u$, and it's easy to see that this $w$ does the job. 
\end{proof}

\subsection{Page 27, contracted ideals}\label{27}%

If $A\to B$ is a morphism, then an ideal $\mf a$ of $A$ is contracted if and only if the natural map $A/\mf a\to B\otimes_A A/\mf a$ is injective. In particular, if a proper ideal $\mf a$ is contracted, we have $B\otimes_A A/\mf a\ne0$. Indeed, $B\otimes_A A/\mf a\simeq B/\mf a^{\oo e}$ and $\oo{Ker}(A/\mf a\to B\otimes_A A/\mf a)\simeq\mf a^{\oo{ec}}/\mf a$. %(Compare with Section~\ref{43b} p.~\pageref{43b}.)

\subsection{Page 29, Proposition 2.19}%

I don't understand the proof that (ii) implies (i). Here is another argument.

We start by proving (ii)$\iff$(iii) as in the book. Then we prove (iii)$\implies$(i) as follows:

Let $P\xr fQ\xr gR$ be exact, let $Q\xr{g'}g(Q)$ and $g(Q)\xr iR$ be the obvious maps, and let $T$ be the functor $N\otimes_A-$. We must show that 
$$
T(P)\xr{T(f)}T(Q)\xr{T(g)}T(R)
$$ 
is exact. The sequences 
$$
P\xr fQ\xr{g'}g(Q)\to0,\quad0\to g(Q)\xr{i'}R,
$$ 
$$
T(P)\xr{T(f)}T(Q)\xr{T(g')}T(g(Q))\to0,\quad0\to T(g(Q))\xr{T(i')}T(R),
$$ 
being exact, we get 
$$
\Ker(T(g))=\Ker(T(i)\circ T(g'))=\oo{Im}(T(f)).
$$

\subsection{Page 32, Exercise 2.11}%

We solve the last part of Exercise 2.11. We claim that if $f:A^m\to A^n$ is an $A$-linear injection, then $m\le n$. 

Suppose for the sake of contradiction that there are positive integers $i,j$ and an $A$-linear injection $f:A^{i+j}\to A^i$. 

Set $k:=i+j$ and define $g:A^k\to A^k$ by $g(x,y):=(f(x,y),0)$ for $x\in A^i$, $j\in A^j$. Note that $g$ is injective. By Proposition~2.4 p.~21 of the book (see Section~\ref{24} p.~\pageref{24} above) there is a monic polynomial $P\in A[x]$ such that there is an $a$ in $A$ with 
\begin{equation}\label{211}
gP(g)=a\oo{id}_{A^k}.
\end{equation} 
We can assume that the degree of $P$ is minimal for this condition. In particular $P(g)$ is nonzero. Evaluating \eqref{211} on $(0,y)$, $y\in A^j$, gives $ay=0$. As $y$ is arbitrary, this implies $a=0$, and thus $gP(g)=0$, and the injectivity of $g$ yields $P(g)=0$, a contradiction.

\subsection{Page 33, Exercise 2.15}%\varinjlim

The proof of the following statements is left to the reader.

\emph{There is a unique equivalence relation $\sim$ on the disjoint union $M'$ of the $M_i$ such that, for any $x\in M_i$ and any $y$ in $M_j$, we have $x\sim y$ if and only if there is a $k\ge i,j$ with $\mu_{ki}(x)=\mu_{kj}(\,y)$.}

[I denote by $\mu_{ki}$ what the book denotes by $\mu_{ik}$.]

Then $M'/\sim$ is a direct limit of the $M_i$ in the category of sets. 

Let $p:M'\to M'/\sim$ be the canonical projection. 

There is a unique structure of $A$-module on $M'/\sim$ such that 

$\bullet\ ap(x)=p(ax)$ for all $i$ in $I$, all $x$ in $M_i$ and all $a$ in $A$, 

$\bullet\ p(x)+p(\,y)=p(\mu_{ki}(x)+\mu_{kj}(\,y))$ for all $k\ge i,j$ in $I$, all $x$ in $M_i$ and all $y$ in $M_j$. 

The quotient $M'/\sim$ is a direct limit of the $M_i$ also in the category of $A$-modules.

\subsection{Page 33, Exercise 2.20}%

Assume we have an inductive system $(M_i)$ of $A$-modules indexed by a category  $I$, that is, for each object $i$ of $I$ we have an $A$-module $M_i$, and for each morphism $f:d(f)\to c(f)$ in $I$ we have an $A$-linear map $M_f:M_{c(f)}\to M_{d(f)}$. 

Define the morphisms $u$ and $v$ by the commutative diagram
$$
\begin{tikzcd}
M_{d(f)}\ar[d,"\alpha_{f}"']\ar[r,equal]&M_{d(f)}\ar[d,"\beta_{d(f)}"]\\ 
\ds\bigoplus_gM_{d(g)}\ar[r,yshift=0.9ex,"u"]\ar[r,yshift=-0.9ex,"v"']&\ds\bigoplus_iM_i\\ 
M_{d(f)}\ar[u,"\alpha_{f}"]\ar[r,"M_f"']&M_{c(f),}\ar[u,"\beta_{c(f)}"']
\end{tikzcd}
$$ 
where the $\alpha_f$ and the $\beta_i$ are the coprojections. 

We claim that the cokernel of $u-v$ is a colimit of our system, or equivalently, that the middle row of the commutative diagram 
$$
\begin{tikzcd}
M_{d(f)}\ar[d,"\alpha_{f}"']\ar[r,equal]&M_{d(f)}\ar[d,"\beta_{d(f)}"]\\ 
\ds\bigoplus_gM_{d(g)}\ar[r,"u-v"]&\ds\bigoplus_iM_i\ar[r]&\ds\ooo{colim}_iM_i\ar[r]&0\\ 
M_{d(f)}\ar[u,"\alpha_{f}"]\ar[r,"M_f"']&M_{c(f)}\ar[u,"\beta_{c(f)}"']
\end{tikzcd}
$$ 
is exact. 

The proof is left to the reader.

As a result, to prove that the tensor product commutes with colimits, it suffices to check that it commutes with direct sums. 

To do so, let $M$ be an $A$-module, let $(N_i)$ be a family of $A$-module, and define the morphisms $f$ and $g$ by the commutative diagram 
$$
\begin{tikzcd} 
\bigoplus_i(M\otimes N_i)\ar[r,yshift=0.9ex,"f"]\ar[r,leftarrow,yshift=-0.9ex,"g"']& M\otimes\left(\bigoplus_iN_i\right)\\ 
M\otimes N_i\ar[u,"\beta_i"]\ar[r,equal]&M\otimes N_i,\ar[u,"1\otimes\alpha_i"']
\end{tikzcd}
$$ 
the tensor products being taken over $A$.

We leave it to the reader to check that $f$ and $g$ are inverse isomorphisms.

\subsection{Page 34, Exercise 2.25, first solution}\label{s225a}%

Recall the statement of Exercise 2.25:

\begin{exo}[Exercise 2.25]\label{e225}
Let $0\to N'\to N\to N''\to0$ be an exact sequence, with $N''$ flat. Then $N'$ is flat if and only if $N$ is flat.
\end{exo}

Here is a solution to Exercise 2.25 which does \emph{not} use the Tor functor. Of course, the solution using the Tor functor (and assuming the Tor functor and some of its basic properties are known) is much simpler. In the next section (Section~\ref{sol2} p.~\pageref{sol2}) we give a proof which includes a definition of the Tor functor.

The proof below follows closely the proof of Proposition 1.2.5.5 in Bourbaki's \textbf{Algèbre commutative}.

In this section, the ground ring is denoted by $R$, not by $A$.

\subsubsection{Part 1: The Snake Lemma}\label{ssl}

Let 
\begin{equation}\label{b10}
\begin{tikzcd}
A\ar[d,"\alpha"]\ar[r,"u"]&B\ar[d,"\beta"]\ar[r,"v"]&C\ar[d,"\gamma"]\\ 
A'\ar[r,"u'"']&B'\ar[r,"v'"']&C'
\end{tikzcd}
\end{equation}
be a commutative diagram of $R$-modules with exact rows. 

\begin{lem}\label{b1i}
If $\gamma$ is injective, we have 
$$
\oo{Im}(\beta)\cap\oo{Im}(u')=\oo{Im}(u'\circ\alpha)=\oo{Im}(\beta\circ u).
$$
\end{lem}

\begin{proof}
We clearly have 
$$
\oo{Im}(u'\circ\alpha)=\oo{Im}(\beta\circ u)\subset\oo{Im}(\beta)\cap\oo{Im}(u').
$$ 
Conversely, let $b'\in\oo{Im}(\beta)\cap\oo{Im}(u')$. There is a $b\in B$ such that $b'=\beta(b)$. As $v'\circ u'=0$, we have 
$$
0=v'(b')=v'(\beta(b))=\gamma(v(b)),
$$ 
whence $v(b)=0$ since $\gamma$ is injective. The first row of \eqref{b10} being exact, there is an $a\in A$ such that $b=u(a)$, whence $b'=\beta(u(a))$.
\end{proof}

\begin{lem}\label{b1ii}
If $\alpha$ is surjective, we have 
$$
\oo{Ker}(\beta)+\oo{Im}(u)=\oo{Ker}(v'\circ\beta)=\oo{Ker}(\gamma\circ v).
$$
\end{lem}

\begin{proof}
As $v\circ u=0$ and $v'\circ u'=0$, it is clear that 
$$
\oo{Ker}(\beta)+\oo{Im}(u)\subset\oo{Ker}(v'\circ\beta)=\oo{Ker}(\gamma\circ v).
$$ 
Conversely, let $b\in\oo{Ker}(v'\circ\beta)$. Then $\beta(b)\in\oo{Ker}(v')$, and there is a $a'\in A'$ such that $u'(a')=\beta(b)$ since the bottom row of \eqref{b10} is exact. As $\alpha$ is surjective, there is an $a\in A$ such that $\alpha(a)=a'$, whence 
$$
\beta(b)=u'(\alpha(a))=\beta(u(a));
$$ 
this implies that $b-u(a)$ is in in $\oo{Ker}(\beta)$.
\end{proof}

We extend the commutative diagram \eqref{b10} as follows:
\begin{equation}\label{b10x}
\begin{tikzcd}
\oo{Ker}(\alpha)\ar[d]\ar[r,"u_1"]&\oo{Ker}(\beta)\ar[d,"j"]\ar[r,"v_1"]&\oo{Ker}(\gamma)\ar[d,"k"]\\ 
A\ar[d,"\alpha"]\ar[r,"u"]&B\ar[d,"\beta"]\ar[r,"v"]&C\ar[d,"\gamma"]\\ 
A'\ar[d,"p"]\ar[r,"u'"]&B'\ar[d,"q"]\ar[r,"v'"]&C'\ar[d]\\ 
\oo{Coker}(\alpha)\ar[r,"u_2"]&\oo{Coker}(\beta)\ar[r,"v_2"]&\oo{Coker}(\gamma),
\end{tikzcd}
\end{equation} 
the new maps being the natural ones.

Recall that we are working under the assumption that the second and third rows of \eqref{b10x} are exact.

\begin{lem}\label{b2i}
The sequence 
$$
\oo{Ker}(\alpha)\xr{u_1}\oo{Ker}(\beta)\xr{v_1}\oo{Ker}(\gamma)
$$ 
is a complex. Moreover, if $u'$ is injective, this complex is exact.
\end{lem}
 
\begin{proof}
The first claim is clear. We have 
$$
\oo{Ker}(v_1)=\oo{Ker}(\beta)\cap\oo{Ker}(v)=\oo{Ker}(\beta)\cap\oo{Im}(u)=\oo{Im}(j)\cap\oo{Im}(u).
$$ 
Assume that $u'$ is injective. As Lemma~\ref{b1i} implies 
$$
\oo{Im}(j)\cap\oo{Im}(u)=\oo{Im}(j\circ u_1)=\oo{Im}(u_1),
$$ 
we get $\oo{Ker}(v_1)=\oo{Im}(u_1)$.
\end{proof}

\begin{lem}\label{b2ii}
The sequence 
$$
\oo{Coker}(\alpha)\xr{u_2}\oo{Coker}(\beta)\xr{v_2}\oo{Coker}(\gamma)
$$ 
is a complex. Moreover, if $v$ is surjective, this complex is exact.
\end{lem}

\begin{proof}
As $u_2$ and $v_2$ are obtained from $u$ and $v$ by taking quotients, it is clear that $v_1\circ u_2=0$. Suppose $v$ is surjective; $q$ and $p$ being surjective, we get, in view of the assumptions and Lemma~\ref{b1ii},
$$
\oo{Ker}(v_2) = q(\oo{Ker}(v_2\circ q))= q(\oo{Ker}(v')+\oo{Im}(\beta))=q(\oo{Ker}(v'))
$$ 
$$
=q(\oo{Im}(u'))=\oo{Im}(q\circ u')=\oo{Im}(u_2\circ p)=\oo{Im}(u_2).
$$ 
(Lemma~\ref{b1ii} is used to prove the second equality.)
\end{proof} 

\begin{lem}[Snake Lemma]\label{lsl}
Assume that $u'$ is injective and that $v$ is surjective. Then the correspondance (see Bourbaki's \textbf{Théorie des ensembles}, Section II.3) 
$$
\delta:=p\circ u'^{-1}\circ\beta\circ v^{-1}\circ k
$$ 
is an $R$-linear map. On other words, there is a unique $R$-linear map $\delta:\oo{Ker}(\gamma)\to\oo{Coker}(\alpha)$ having the following property: if $c\in\oo{Ker}(\gamma),b\in B$ and $a'\in A'$ satisfy $v(b)=k(c)$ and $u'(a')= \beta(b)$, then we have $\delta(c)=p(a')$. Moreover the sequence 
%$$\oo{Ker}(\alpha)\xr{u_1}\oo{Ker}(\beta)\xr{v_1}\oo{Ker}(\gamma)\xr \delta\oo{Coker}(\alpha)\xr{u_2}\oo{Coker}(\beta)\xr{v_2}\oo{Coker}(\gamma)$$ 
$$
\begin{tikzcd}
\Ker(\alpha)\ar["u_1"]{r}&\Ker(\beta)\ar["v_1"]{r}&\Ker(\gamma)\ar["\delta"']{ddll}\\ \\ 
\Coker(\alpha)\ar["u_2"']{r}&\Coker(\beta)\ar["v_2"']{r}&\Coker(\gamma).
\end{tikzcd}
$$ 
is exact.
\end{lem}

The name ``Snake Lemma'' comes from the fact that the above exact sequence can be displayed as 
$$%https://tex.stackexchange.com/a/82774/8816
\begin{tikzcd}
  \Ker(\alpha) \ar["u_1"]{r} & \Ker(\beta) \ar["v_1"]{r}
             \ar[draw=none]{d}[name=X, anchor=center]{}
    & \Ker(\gamma) \ar[rounded corners,
            to path={ -- ([xshift=2ex]\tikztostart.east)
                      |- (X.center) \tikztonodes
                      -| ([xshift=-2ex]\tikztotarget.west)
                      -- (\tikztotarget)}]{dll}[at end]{} \\      
  \Coker(\alpha) \ar["u_2"]{r} & \Coker(\beta) \ar["v_2"]{r} & \Coker(\gamma).
\end{tikzcd}
$$

\begin{proof} (a) The correspondance $\delta$ is a map: For $c\in\oo{Ker}(\gamma)$ there is a $b\in B$ such that $v(b)=k(c)$ because $v$ is surjective; moreover, we have $v'(\beta(b))=\gamma(k(c))=0$, and thus there is a unique $a'\in A'$ such that $u'(a')=\beta(b)$ because $u'$ is injective. Let us show that the element $p(a')\in\oo{Coker}(\alpha)$ does not depend on the choice of the element $b\in B$ such that $v(b)=k(c)$. Indeed, if $b^*\in B$ is another element such that $v(b^*)=k(c)$, we have $b^*=b+u(a)$ where $a\in A$; let us show that if $a'^*\in A'$ is such that $u'(a'^*)=\beta(b^*)$ we have $a'^*=a'+\alpha(a)$; indeed we have 
$$
u'(a'+\alpha(a))=u'(a')+u'(\alpha(a))=\beta(b)+\beta(u(a))
$$ 
$$
=\beta(b+u(a))=\beta(b^*)=u'(a'^*),
$$ 
and the injectivity of $u'$ implies $a'+\alpha(a)=a'^*$. Finally, we conclude that $p(a'^*)=p(a')+p(\alpha(a))=p(a')$. We can thus set $\delta(c)=p(a')$ and we have defined a map $\delta:\oo{Ker}(\gamma)\to\oo{Coker}(\alpha)$.

(b) Linearity of $\delta$: If $c_1,c_2$ are in $\oo{Ker}(\gamma)$ and $c=c_1+c_2$, pick $b_1$ and $b_2$ in $B$ such that $v(b_1)=k(c_1)$ and $v(b_2)=k(c_2)$, and define $b\in B$ by $b:=b_1+b_2$; it is then obvious that $\delta(c)=\delta(c_1)+\delta(c_2)$. We prove similarly that $\delta(rc)=r\delta(c)$ for $r\in R$.

(c) Exactness at $\oo{Ker}(\beta)$ and $\oo{Coker}(\beta)$: Follows from Lemmas \ref{b2i} and \ref{b2ii} respectively.

(d) Equality $\delta\circ v_1=0$: Suppose that $c=v_1(\overline b)$ with $\overline b\in\oo{Ker}(\beta)$; we then take for $b\in B$ the element $j(\overline b)$. As $\beta(j(\overline b))=0$, we see that $\delta(c)=0$, hence $\delta\circ v_1=0$. 

(e) Exactness at $\oo{Ker}(\gamma)$: Suppose that $\delta(c)=0$. It suffices to show that we have $c=v_1(b^*)$ for some $b^*\in\oo{Ker}(\beta)$. Defining $b$ and $a'$ as in (a), we get $p(a')=\delta(c)=0$. Thus there is an $a$ in $A$ such that $a'=\alpha(a)$, %In the notation of (a) we have $a'=\alpha(a)$ with $a\in A$, 
and we get 
$$
\beta(b)=u'(a')= u'(\alpha(a))= \beta(u(a)),
$$ 
that is, $\beta(b-u(a))=0$. The element $b-u(a)$ is thus of the form $j(b^*)$ for some $b^*\in\oo{Ker}(\beta)$. It is enough to show $c=v_1(b^*)$. We have 
$$
k(c)=v(b)= v(u(a)+j(b^*))=v(j(b^*))=k(v_1(b^*)).
$$ 
The injectivity of $k$ yields $c=v_1(b^*)$, as desired.

(f) Equality $u_2\circ\delta=0$: We have (still with the notation of (a)) 
$$
u_2(\delta(c))=u_2(p(a'))=q(u'(a'))=q(\beta(b))=0.
$$ 
%hence $u_2\circ\delta=0$. 

(g) Exactness at $\oo{Coker}(\alpha)$: Suppose that an element $p(a')$ in $\oo{Coker}(\alpha)$ (with $a'\in A'$) satisfies $u_2(p(a'))=0$. It suffices to prove $p(a')=\delta(c)$ for some $c\in\oo{Ker}(\gamma)$. We have $q(u'(a'))=0$, and thus $u'(a')=\beta(b)$ for some $b\in B$; as $v'(u'(a')))=0$, we get $v'(\beta(b))=0$, thus $\gamma(v(b))=0$, that is $v(b)=k(c)$ for some $c\in\oo{Ker}(\gamma)$, and we obtain the sought-for equality $p(a')=\delta(c)$ by definition of $\delta$.%which shows that \eqref{eb2iii} is exact at $\oo{Coker}(\alpha)$.
\end{proof}
%\begin{lem}\label{bc1i}If $u',\alpha$ and $\gamma$ are injective, then $\beta$ is injective.\end{lem}\begin{proof}This follows from Lemma~\ref{b2i}: indeed we have $\oo{Ker}(\alpha)=0$ and $\oo{Ker}(\gamma)=0$, hence $\oo{Ker}(\beta)=0$.\end{proof}

\subsubsection{Part 2}

\begin{lem}\label{b254}
If $M$ is a flat $R$-module, if 
$$
0\to M_1\to M_2\to M\to0
$$ 
is an exact sequence of $R$-modules, and if $N$ is an $R$-module, then the sequence 
$$
0\to M_1\otimes_RN\to M_2\otimes_RN\to M\otimes_RN\to0
$$ 
is exact.
\end{lem}

\begin{proof}
Let 
$$
0\to P\to F\to N\to 0
$$ 
be an exact sequence of $R$-modules such that $F$ is free, and form the diagram
$$
\begin{tikzcd}
&M_1\otimes P\ar[d]\ar[r]&M_2\otimes P\ar[d,"f"]\ar[r]&M\otimes P\ar[d,"g"]\ar[r]&0\\ 
0\ar[r]&M_1\otimes F\ar[d]\ar[r]&M_2\otimes F\ar[d]\ar[r]&M\otimes F\\ 
&M_1\otimes N\ar[d]\ar[r]&M_2\otimes N\ar[d]\\ 
&0&0
\end{tikzcd}
$$ 
where the tensor products are taken over $R$, and where the maps are the natural ones. This diagram is clearly commutative and exact. By the Snake Lemma (Lemma~\ref{lsl}) there is an exact sequence  
$$
\oo{Ker}(f)\to\oo{Ker}(g)\to M_1\otimes N\to M_2\otimes N.
$$ 
As $M$ is flat, $g$ is injective. Thus $M_1\otimes N\to M_2\otimes N$ is also injective. 
\end{proof}

Clearly the following lemma implies Exercise~2.25 (stated as Exercise~\ref{e225} p.~\pageref{e225}).

\begin{lem}
Let $0\to M'\to M\to M''\to0$ be an exact sequence of $R$-modules with $M''$ flat. Then $M'$ if flat if and only if $M$ is flat.
\end{lem}

\begin{proof}
Let $N'\to N$ be a monomorphism of $R$-modules and form the commutative diagram 
$$
\begin{tikzcd}
&&&0\ar[d]\\ 
0\ar[r]&M'\otimes N'\ar[d,"\alpha"]\ar[r,"f"]&M\otimes N'\ar[d,"\beta"]\ar[r]&M''\otimes N'\ar[d,"\gamma"]\ar[r]&0\\ 
0\ar[r]&M'\otimes N\ar[r,"g"]&M\otimes N\ar[r]&M''\otimes N\ar[r]&0,
\end{tikzcd}
$$ 
the maps being the natural ones. The diagram is exact by flatness of $M''$ and Lemma~\ref{b254}.

Assume that $M$ is flat. Then $\beta$ is injective, and so is $\beta\circ f=g\circ\alpha$. This shows that $\alpha$ is injective, and thus that $M'$ is flat.

Assume that $M'$ is flat. Then $\alpha$ is injective, and Lemma~\ref{b2i} implies that $\beta$ is injective, and thus that $M$ is flat.
\end{proof}

\subsection{Page 34, Exercise 2.25, second solution}\label{sol2}% doc snake0: https://docs.google.com/document/d/1gTyvvgy4XYRi04V_LI47nxX0mYQvRyn57lMmjo59hlM/edit

In Section~\ref{s225a} p.~\pageref{s225a} above we gave a solution to Exercise 2.25 p.~34 of the book which doesn't use the Tor functor. The purpose of the present section is to give a solution which \emph{does} use the Tor functor, but does \emph{not} assume this functor to be known. We'll follow Bourbaki's \textbf{Algèbre homologique}.

We return to the notation $A$ for a commutative ring with one. \emph{Module} stands for $A$-\emph{module}. 

We already stated Exercise 2.25 as Exercise~\ref{e225} p.~\pageref{e225} above, but for the reader's convenience we restate it:

\begin{exo}[Exercise 2.25]\label{e225b}
Let $0\to N'\to N\to N''\to0$ be an exact sequence, with $N''$ flat. Then $N'$ is flat if and only if $N$ is flat.
\end{exo}

%We refer the reader to Bourbaki's \textbf{Théorie des ensembles}, II.3 for the notion of \emph{correspondance} from a set to another set.

%%%
\begin{comment}
\subsection{The Snake Lemma}%

Let 
\begin{equation}\label{sl1}
\begin{tikzcd}
&M\ar["u"]{r}\ar["f"]{d}&N\ar["v"]{r}\ar["g"]{d}&P\ar["h"]{d}\ar{r}&0\\ 
0\ar{r}&M'\ar["u'"']{r}&N'\ar["v'"']{r}&P'
\end{tikzcd}
\end{equation} 
be a commutative diagram of modules with exact rows.

\begin{lem}[Snake Lemma]\label{sl2}
The commutative diagram \eqref{sl1} can be extended to 
$$
\begin{tikzcd}
&\Ker(f)\ar["u_1"]{r}\ar["i"]{d}&\Ker(g)\ar["v_1"]{r}\ar["j"]{d}&\Ker(h)\ar["k"]{d}\\ 
&M\ar["u"]{r}\ar["f"]{d}&N\ar["v"]{r}\ar["g"]{d}&P\ar["h"]{d}\ar{r}&0\\ 
0\ar{r}&M'\ar["u'"']{r}\ar["p"]{d}&N'\ar["v'"']{r}\ar["q"]{d}&P'\ar["r"]{d}\\ 
&\Coker(f)\ar["u_2"']{r}&\Coker(g)\ar["v_2"']{r}&\Coker(h),
\end{tikzcd}
$$ 
where the arrows are the natural ones. Moreover the correspondance 
$$
d:=p\circ u'^{-1}\circ g\circ v^{-1}\circ k
$$ 
is an $A$-linear map, and we have an exact sequence
$$
\begin{tikzcd}
\Ker(f)\ar["u_1"]{r}&\Ker(g)\ar["v_1"]{r}&\Ker(h)\ar["d"']{ddll}\\ \\ 
\Coker(f)\ar["u_2"']{r}&\Coker(g)\ar["v_2"']{r}&\Coker(h).
\end{tikzcd}
$$ 
\end{lem}

\begin{proof}Omitted.\end{proof}

The name ``Snake Lemma'' comes from the fact that the above exact sequence can be displayed as 
$$%https://tex.stackexchange.com/a/82774/8816
\begin{tikzcd}
  \Ker(f) \ar["u_1"]{r} & \Ker(g) \ar["v_1"]{r}
             \ar[draw=none]{d}[name=X, anchor=center]{}
    & \Ker(h) \ar[rounded corners,
            to path={ -- ([xshift=2ex]\tikztostart.east)
                      |- (X.center) \tikztonodes
                      -| ([xshift=-2ex]\tikztotarget.west)
                      -- (\tikztotarget)}]{dll}[at end]{} \\      
  \Coker(f) \ar["u_2"]{r} & \Coker(g) \ar["v_2"]{r} & \Coker(h).
\end{tikzcd}
$$
\end{comment}
%%%

\subsubsection{Complexes}%

A \emph{graded module} is a module $C$ equipped with a family $(C_n)_{n\in\mathbb Z}$ of submodules such that $C=\bigoplus_{n\in\mathbb Z}C_n$. 

A \emph{degree $k$ morphism} from a graded module $C$ to a graded module $D$ is an $A$-linear map $f:C\to D$ such that $f(C_n)\subset D_{n+k}$ for all $n$. 

A \emph{complex} is a graded module $C=\bigoplus_{n\in\mathbb Z}C_n$ equipped with a degree $-1$ endomorphism $d$, called the \emph{differential} of $C$, such that $d\circ d=0$. 

A \emph{morphism} from a complex $C$ to a complex $D$ is degree $0$ morphism $C\to D$ which commutes with the differentials. 

The identity of $C$ is a morphism of complexes, and the composition of two morphisms of complexes is a morphism of complexes. 

If $C$ is a complex the kernel of $d$ is denoted $Z(C)$ and the image of $d$ is denoted $B(C)$. 

We have $B(C)\subset Z(C)$, and we set $H(C):=Z(C)/B(C)$. 

The modules $Z(C),B(C)$ and $H(C)$ are graded is an obvious way, and are respectively called the submodule of \emph{cycles}, the submodule of \emph{boundaries}, and the \emph{homology} of $C$.

%A morphism of complexes $f:C\to D$ induces in an obvious way a degree $0$ morphism of graded modules $H(f):H(C)\to H(D)$. 

%If $H(f)$ is bijective, $f$ is called a \emph{homologism}.

\subsubsection{The homology long exact sequence}\label{hles}% 

Let $0\to C'\xr uC\xr vC''\to0$ be a short exact sequence of complexes. We get a commutative diagram 
$$
\begin{tikzcd}
&0\ar{d}&0\ar{d}&0\ar{d}\\ 
&H_n(C')\ar["u_1"]{r}\ar["i"]{d}&H_n(C)\ar["v_1"]{r}\ar["j"]{d}&H_n(C'')\ar["k"]{d}\\ 
&\ds\frac{C'_n}{B_n(C')}\ar["u"]{r}\ar["f"]{d}&\ds\frac{C_n}{B_n(C)}\ar["v"]{r}\ar["g"]{d}&\ds\frac{C''_n}{B_n(C'')}\ar["h"]{d}\ar{r}&0\\ 
0\ar{r}&Z_{n-1}(C')\ar["u'"']{r}\ar["p"]{d}&Z_{n-1}(C)\ar["v'"']{r}\ar["q"]{d}&Z_{n-1}(C'')\ar["r"]{d}\\ 
&H_{n-1}(C')\ar["u_2"']{r}\ar{d}&H_{n-1}(C)\ar["v_2"']{r}\ar{d}&H_{n-1}(C'')\ar{d}\\ 
&0&0&0
\end{tikzcd}
$$ 
with exact rows and columns. By the Snake Lemma (Lemma~\ref{lsl} p.~\pageref{lsl}) we get a ``bi-infinite'' exact sequence 
$$
\cdots\to H_{n+1}(C'')\to H_n(C')\to H_n(C)\to H_n(C'')\to H_{n-1}(C')\to\cdots
$$ 
called the \emph{homology long exact sequence.}

%\subsection{Homotopy}Let $C$ and $D$ be two complexes and $f$ and $g$ be two morphisms from $C$ to $D$. A \emph{homotopy from $f$ to $g$} is a degree $1$ morphism $s:D\to C$ such that $g-f=d\circ s+s\circ d$. If such a homotopy $s$ exists we say that $f$ and $g$ are \emph{homotopic}. One easily checks that this is an equivalence relation, and that we have $H(f)=H(g)$ if $f$ and $g$ are homotopic.

\subsubsection{The canonical free resolution}

Let $M$ be an $A$-module. 

Set $F_0(M):=A^{(M)}$, that is, $F_0(M)$ is the free $A$-module with basis $M$. 

We have a natural epimorphism $F_0(M)\to M$. Let $Z$ be its kernel and set $F_1(M):=F_0(Z)$. 

We have again a natural epimorphism $F_1(M)\to Z$. Let $Y$ be its kernel and set $F_2(M):=F_0(Y)$. 

As before we get a natural epimorphism $F_2(M)\to Y$. 

This gives a complex $F_2(M)\to F_1(M)\to F_0(M)\to M\to0$ which is exact at $F_1(M)$, $F_0(M)$ and $M$. 

Iterating we get an infinite exact sequence  
$$
\cdots\to F_n(M)\to F_{n-1}(M)\to\cdots\to F_1(M)\to F_0(M)\to M\to0.
$$ 
We say that the complex $F(M)$, that is the complex 
$$
\cdots\to F_n(M)\to F_{n-1}(M)\to\cdots\to F_1(M)\to F_0(M),
$$ 
is \emph{the canonical free resolution of} $M$. 

We clearly have $H_0(F(M))\simeq M$ and $H_n(F(M))=0$ for $n\ge1$.

\subsubsection{The Tor functor}

In the above notation, let $N$ be an $A$-module. Note that $F(M)\otimes_AN$ is in a natural way a complex of $A$-modules. We set 
$$
\Tor^A(M,N):=H(F(M)\otimes_AN).
$$ 
This graded $A$-module vanishes in negative degree. 

If $N$ is flat, then $\Tor^A_n(M,N)=0$ for all $n\ge1$.

It is easy to check the canonical isomorphism $\Tor^A_0(M,N)\simeq M\otimes_AN$.

Let $0\to N'\to N\to N''\to0$ be an exact sequence of $A$-modules. It is easy to see that $0\to F(M)\otimes_AN'\to F(M)\otimes_AN\to F(M)\otimes_AN''\to0$ is an exact sequence of complexes of $A$-modules. By Section~\ref{hles} we get a long exact sequence 
$$
\begin{matrix}
\cdots&\to&\Tor^A_2(M,N)&\to&\Tor^A_2(M,N'')&\to\\ \\ 
\Tor^A_1(M,N')&\to&\Tor^A_1(M,N)&\to&\Tor^A_1(M,N'')&\to\\ \\ 
M\otimes_AN'&\to&M\otimes_AN&\to&M\otimes_AN''&\to\\ \\ 
0.
\end{matrix}
$$ 
In particular 

$M$ \emph{is flat if and only if $\ \Tor^A_1(M,N'')=0$ for all $N''$ --- in which case we have $\Tor^A_n(M,N'')=0$ for all $n\ge1$ and all $N''$.}

Now Exercise 2.25 (see Exercise~\ref{e225b} above) follows from the above statement and the above long exact sequence.

\subsection{Page 35, Exercise 2.26}\label{35}%

The goal is to show: 

\emph{If $M\otimes\aaa\to M\otimes A$ is injective for all finitely generated ideal $\aaa$, then $M$ is flat.}

Here is the sketch of a solution (following Bourbaki's \textbf{Algèbre commutative}).

Given $A$-modules $M$ and $N$ we say that $M$ is $N$\textbf{-flat} if for all submodule $N'$ of $N$ the natural morphism $M\otimes N'\to M\otimes N$ is injective. (Here and in the sequel ``$\otimes$'' means ``$\otimes_A$''.) 

(a) If $M\otimes N'\to M\otimes N$ is injective for \emph{all finitely generated} submodule $N'$ of $N$, then $M$ is $N$-flat.

\begin{proof} 
Let $N''$ be an arbitrary submodule of $N$, let $t''=\sum x_i\otimes y_i$ in $M\otimes N''$ (with $x_i\in M,y_i\in N''$) be such that the tensor $t=\sum x_i\otimes y_i$ in $M\otimes N$ vanishes. It suffices to show $t''=0$. Let $N'$ be the submodule of $N''$ generated by the $y_i$. By assumption the tensor $t'=\sum x_i\otimes y_i$ of $M\otimes N'$ vanishes. As $t'\mapsto t''$, this implies $t''=0$. 
\end{proof}

(b) If $M$ is $N$-flat and if $P$ is a submodule or a quotient of $N$, then $M$ is $P$-flat.%, then so are the submodules and the quotients of $N$. 

\begin{proof} 
The case of the submodules is left to the reader. Let 
$$
0\to R\xrightarrow iN\xrightarrow pQ\to0
$$ 
be exact, and let us show that $M$ is $Q$-flat. Let $Q'$ be a submodule of $Q$, and set $N':=p^{-1}(Q')$. We get a commutative diagram with exact rows
$$
\begin{tikzcd}
0\ar[r]&R\ar[d,"r"]\ar[r,"i'"]&N'\ar[d,"n"]\ar[r,"p'"]& Q'\ar[d,"q"]\ar[r]&0\\ 
0\ar[r]&R\ar[r,"i"']&N\ar[r,"p"']& Q\ar[r]&0
\end{tikzcd}
$$ 
where $r$ is the identity of $R$, and the maps $i',p',n$ and $q$ are the obvious ones. Letting $S\mapsto\overline S$ be the ``functor'' $M\otimes-$ we obtain the commutative diagram with exact rows
$$
\begin{tikzcd}
\overline R\ar[d,"\overline r"]\ar[r,"\overline{i'}"]&\overline{N'}\ar[d,"\overline n"]\ar[r,"\overline{p'}"]& \overline{Q'}\ar[d,"\overline q"]\ar[r]&0\\ 
\overline R\ar[r,"\overline i"']&\overline N\ar[r,"\overline p"']& \overline Q\ar[r]&0
\end{tikzcd}
$$ 
where $\overline r$ is the identity of $\overline R$. As $\overline n$ is injective, so is $\overline q$. 
\end{proof}

(c) If $N=\bigoplus_{i\in I}N_i$ is the direct sum of a family of submodules, and if $M$ is $N_i$-flat for each $i$, then $M$ is $N$-flat.%The direct sum of a family of $M$-flat modules is $M$-flat. 

\begin{proof} 
Let $(N_i)_{i\in I}$ be our family. 

$\bu$ First assume $I=\{1,2\}$. We prove the result by considering the \emph{split} exact sequence 
$$
0\to N_1\xrightarrow i N_1\oplus N_2\xrightarrow pN_2\to0.
$$ 
%The details are left to the reader. 
\begin{proof}
Let $N'$ be a submodule of $N$, set $N'_1:=N'\cap N_1$, let $N'_2$ be the image of $N'$ in $N_2$, and let 
$$
\begin{tikzcd}
0\ar[r]&N'_1\ar[d,"f_1"]\ar[r,"i'"]&N'\ar[d,"f"]\ar[r,"p'"]&N'_2\ar[d,"f_2"]\ar[r]&0\\ 
0\ar[r]&N_1\ar[r,"i"']&N\ar[r,"p"']&N_2\ar[r]&0
\end{tikzcd}
$$  
be the obvious commutative diagram with exact rows. Letting $S\mapsto\overline S$ be the ``functor'' $M\otimes-$ we obtain the commutative diagram with exact rows
$$
\begin{tikzcd}
\overline{N'_1}\ar[d,"\overline{f_1}"]\ar[r,"\overline{i'}"]&\overline{N'}\ar[d,"\overline f"]\ar[r,"\overline{p'}"]& \overline{N'_2}\ar[d,"\overline{f_2}"]\\ 
\overline{N_1}\ar[r,"\overline i"']&\overline N\ar[r,"\overline p"']& \overline{N_2}.
\end{tikzcd}
$$ 
It is easy to see that $\overline{f_1},\overline{f_2}$ and $\overline i$ are injective, and that this implies that $\overline f$ is also injective.
\end{proof}

$\bu$ Second assume that $I$ is finite. We prove the statement by induction.

$\bu$ Third assume that $I$ is arbitrary, and let $N'$ be a finitely generated submodule of $N=\bigoplus_{i\in I}N_i$. Then there is a finite subset $J$ of $I$ such that $N'\subset\bigoplus_{j\in J}N_j$, and we have 
$$
N=\left(\bigoplus_{j\in J}N_j\right)\oplus\left(\bigoplus_{i\in I\setminus J}N_i\right). 
$$ 
We leave the rest of the proof to the reader.

(d) If $M\otimes\aaa\to M\otimes A$ is injective for all finitely generated ideal $\aaa$, then $M$ is flat.

We leave again the proof to the reader. 
\end{proof}

\subsection{Page 35, flat modules}%

Taken from Chapter 1, Section 2, Subsection 11 in Nicolas Bourbaki, \textbf{Algèbre commutative: Chapitres 1 à 4}, Masson, Paris 1985:

\emph{Let $A$ be a (non necessarily commutative) associative ring with $1$, let $M$ be a right $A$-module, and let $N$ be a left $A$-module. Then $M$ is $N$-flat (see \S\ref{35}) if and only if the following condition holds:}

\emph{For all finite families $(x_i)\subset M,(y_i)\subset N$ such that $\sum x_i\otimes y_i=0$ there are finite families $(a_{ij})\subset A$ and $(x'_j)\subset M$ such that $\sum_jx'_ja_{ij}=x_i$ for all $i$ and $\sum_ia_{ij}y_i=0$ for all $j$.}

\emph{Proof.} This follows easily from \S\ref{vt}. $\square$

We also have:

\emph{Let $A$ be a (non necessarily commutative) associative ring with $1$ and $M$ a right $A$-module. Then $M$ is flat if and only if the following condition holds:}

\emph{For all finite families $(x_i)\subset M,(a_i)\subset A$ such that $\sum x_ia_i=0$ there are finite families $(a'_{ij})\subset A$ and $(x'_j)\subset M$ such that $\sum_jx'_ja'_{ij}=x_i$ for all $i$ and $\sum_ia'_{ij}a_i=0$ for all $j$.}

\emph{Proof.} We set $N:=A$ in the previous statement and use \S\ref{35}(d). $\square$

There is also a statement and a proof of this result in the Stacks Project; see the tag \href{http://stacks.math.columbia.edu/tag/00HK}{http://stacks.math.columbia.edu/tag/00HK}

\subsection{Page 35, Exercise 2.27, (i) implies (ii)}\label{227}%

Recall the statement: 

A ring $A$ is \emph{absolutely flat} if every $A$-module is flat. Prove that the following are equivalent:

(i) $A$ is absolutely flat.

(ii) Every principal ideal is idempotent.

(iii) Every finitely generated ideal is a direct summand of $A$.

To show that (i) implies (ii), let $x$ be in $A$ and consider the obvious diagram
$$
(x)\otimes A\to(x)\otimes A/(x)\to A\otimes A/(x)\to A/(x). 
$$ 
(We again write $\otimes$ for $\otimes_A$.) The first map is surjective, the second map is injective by flatness of $A/(x)$, the third map is bijective and the composition vanishes. This implies $(x)\otimes A/(x)=0$. The sequence 
$$
0\to(x)\otimes(x)\to(x)\otimes A\to(x)\otimes A/(x)\to0
$$ 
is exact by flatness of $(x)$. But this sequence can also be written as 
$$
0\to(x)\otimes(x)\to(x)\to0\to0.
$$ 
This proves that $(x)=(x^2)$, and thus that (i) implies (ii). $\square$

The argument given in the book show that (i), (ii) and (iii) are also equivalent to

(iv) Every finitely generated ideal is generated by an idempotent,

and also to 

(v) For all $a$ in $A$ there is an $x$ in $A$ such that $a=a^2x$.

\subsection{Page 35, Exercise 2.28}\label{228}%

An absolutely flat local ring is a field: Let $(A,\mf m)$ be our local ring and let $\mu$ be in $\mf m$. It suffices to show $\mu=0$. If we had $\mu\ne0$, we would get $(\mu)=(e)$ for some nonzero idempotent $e$ (see end of Section \ref{227} above). Then $e\in\mf m=\mf R$ would imply that $f:=1-e$ is a unit, hence $f=f^2$ entails $f=1$ and thus $e=0$, a contradiction. 

\section{About Chapter 3}%%

\subsection{Page 37}%

Recall that $f:A\to S^{-1}A$ is the canonical morphism.

It is written:

"Conversely, these three conditions determine the ring $S^{-1}A$ up to isomorphism. Precisely:

\textbf{Corollary 3.2.} \emph{If $g:A\to B$ is a ring homomorphism such that}

(i) $s\in S\implies g(s)$ \emph{is a unit in} $B$;

(ii) $g(a)=0\implies as=0$ \emph{for some} $s\in S$;

iii) \emph{Every element of $B$ is of the form} $g(a)g(s)^{-1}$.

\emph{Then there is a unique isomorphism $h:S^{-1}A\to B$ such that} $g=h\circ f$."

The following wording would be slightly better:

Conversely, these three conditions determine the ring $S^{-1}A$ up to unique isomorphism. Precisely:

\textbf{Corollary 3.2.} \emph{If $g:A\to B$ is a ring homomorphism such that}

(i) $s\in S\implies g(s)$ \emph{is a unit in} $B$;

(ii) $g(a)=0\implies as=0$ \emph{for some} $s\in S$;

iii) \emph{Every element of $B$ is of the form} $g(a)g(s)^{-1}$.

\emph{Then there is a unique morphism $h:S^{-1}A\to B$ such that $g=h\circ f$. Moreover this morphism is an isomorphism.}

\subsection{Page 39, Proposition 3.4}%

It is easy to see that we have 
$$
S^{-1}\sum M_i=\sum S^{-1}M_i.
$$ 
It is also easy to see that we have 
$$
S^{-1}\bigcap M_i\ \subset\ \bigcap S^{-1}M_i.
$$ 
But the converse inclusion 
$$
\bigcap S^{-1}M_i\ \subset\ S^{-1}\bigcap M_i
$$ 
is not true in general. Here is a counterexample. Let $K$ be a field and $X$ an indeterminate. Setting $A:=K[X]$, $S:=K[X]\setminus\{0\}$ we get 
$$
\bigcap_n S^{-1}(X^n)=K(X),\quad S^{-1}\bigcap_n(X^n)=(0).
$$

\subsection{Pp 39-40, Propositions 3.5 and 3.7}%

The natural $A$-linear map $f:M\to S^{-1}M$ has the following universal property:

For all $A$-linear map $g:M\to N$ from $M$ to an $S^{-1}A$-module $N$ such that $sm=0$ for some $s$ in $S$ and some $m$ in $m$ implies $g(m)=0$ there is a unique $S^{-1}A$-linear map $h:S^{-1}M\to N$ such that $g=h\circ f$.

Using this universal property one can describe explicitly the respective inverses of the isomorphisms in Propositions 3.5 and 3.7.

\subsection{P. 38, Proposition 3.5}%

In the notation of Proposition 3.5 p.~38 we have:

\emph{If $1\otimes x=0$ in $S^{-1}A\otimes_AM$ then we have $sx=0$ for some} $s\in S$.

\emph{Proof.} We have $1\otimes x=0$ in $N\otimes_AM$ where $N$ is some finitely generated sub-$A$-module of $S^{-1}A$. For any $s\in S$ set $A/s:=\{a/s\ |\ a\in A\}$; this is also a sub-$A$-module of $S^{-1}A$. Then $N\subset A/s$ for some $s$, and we have $1\otimes x=0$ in $A/s\otimes_AM$. Defining $f:A\to A/s$ by $f(a):=a/s$ and letting $B$ be the kernel of $f$, and $g:M\to A/s\otimes_AN$ the map induced by $f$, we get exact sequences 
$$
B\otimes_AM\to M\xr gA/s\otimes_AM\to0
$$ 
and 
$$
0\to BM\to M\xr gA/s\otimes_AM\to0.
$$ 
We have $g(sx)=0$ and thus $sx=\sum_{i=1}^nb_ix_i$ with $b_i\in B$ and $x_i\in M$. As $b_i/s=0$ in $S^{-1}A$ there is a $t\in S$ such that $tb_i=0$ for all $i$. This gives $tsx=0.\ \square$

\subsection{P. 40, Proposition 3.9}\label{re}%

Here is a mild generalization:

\emph{The complex of $A$-modules $M\xr fN\xr g P$ is exact if and only if the complex} 
$$
M_{\mf m}\xr{f_{\mf m}}N_{\mf m}\xr{g_{\mf m}}P_{\mf m}
$$ 
\emph{is exact for all maximal ideal $\mf m$ of} $A$.
\begin{proof}
Use the isomorphism 
$$
\oo{Ker}(g_{\mf m})/\oo{Im}(f_{\mf m})\simeq(\oo{Ker}(g)/\oo{Im}(f))_{\mf m}
$$ 
and Proposition 3.8 of the book.
\end{proof}

\subsection{Pp 41-42, proof of Proposition 3.11}%

\subsubsection{Part (ii)}

$\bu $ Here is a more detailed proof of the statement 

\emph{If $\mf a$ is an ideal in $A$, then $\mf a^{\oo{ec}}=\bigcup_{s\in S}\ (\mf a:s)$}.

We have 

$x\in\mf a^{\oo{ec}}=(S^{-1}\mf a)^{\oo c}$

$\ds\iff\frac{x}{1}=\frac{a}{s'}$ for some $a\in\mf a,s'\in S$ 

$\iff(xs'-a)t'=0$ for some $a\in\mf a$ and some $s',t'\in S$ 

$\iff xst\in\mf a$ for some $s,t\in S$

$\iff xs\in\mf a$ for some $s\in S$

$\iff x\in\bigcup_{s\in S}\ (\mf a:s)$.

To prove 

$xst\in\mf a$ for some $s,t\in S$ $\implies$ $(xs'-a)t'=0$ for some $a\in\mf a$ and some $s',t'\in S$

we set $a:=xst$, $s':=st$, $t':=1$.%\bigskip%\hrule\bigskip\textbf{Comment.} 

$\bu$ A particular case of the statement 

\emph{$\mf a^{\oo e}=(1)$ if and only if $\mf a$ meets $S$}

is 

\emph{$(0)^{\oo e}=(1)$ if and only if $\ 0\in S$,}

that is 
\begin{equation}\label{s-1a}
S^{-1}A=0\iff\ 0\in S
\end{equation}
(It is easy to prove this particular case directly.)

\subsubsection{Part (iv)}\label{prcor}%

Set $X:=\Sp(A),Y:=\Sp(S^{-1}A)$ and let $c:Y\to X$ be the contraction map. In view of Proposition 1.17iii p.~10 of the book, it suffices to show:
$$
c(Y)=\{\ppp\in X\ |\ \ppp\cap S=\varnothing\}
$$ 
and 
$$
\ppp\in c(Y)\implies S^{-1}\ppp\in X.
$$ 
The conclusion is that 

\emph{the contraction and extension maps are inverse inclusion preserving bijections between $Y$ and $c(Y)$.} 

\begin{comment}
\emph{Let $U$ be the set of prime ideals of $A$ disjoint from $S$ and $V$ the set of prime ideals of $S^{-1}A$. Then the maps $U\to V$, $\ppp\mapsto S^{-1}\ppp$ and $V\to U$, $\qqq\mapsto \qqq^{\oo c}$ are well-defined inverse bijections.} 

\emph{Proof.}

$\mf q\in V\implies\mf q^{\oo c}\in U$: It suffices to check that $\mf q^{\oo c}$ is disjoint from $S$. If $s$ is in $S\cap\mf q^{\oo c}$, then $s/1$ is in $\mf q$, which is impossible since $s/1$ is a unit.

$\ppp\in U\implies\ppp^{\oo e}\in V$: As written in the book, ``if $\ppp$ is a prime ideal in $A$, then $A/\ppp$ is an integral domain; if $\overline S$ is the image of $S$ in $A/\ppp$, we have $S^{-1}A/S^{-1}\ppp\simeq\overline S^{-1}(A/\ppp)$ which is either $0$ or else is contained in the field of fractions of $A/\ppp$ and is therefore an integral domain, and therefore $\overline S^{-1}(A/\ppp)$ is either prime or is the unit ideal; by i) the latter possibility occurs if and only if $\ppp$ meets $S$.'' Instead of ``by i)'', I would say ``by \eqref{s-1a}''.

$\ppp^{\oo{ec}}=\ppp$ for $\ppp\in U$: It suffices to show $\ppp^{\oo{ec}}\subset\ppp$. Let $s$ be in $S$. In view of Proposition 3.11 (ii), it suffices to show $(\ppp:s)\subset\ppp$, which is easy.

$\mf q^{\oo{ce}}=\mf q$ for $\mf q\in V$: This is a particular case of Part (i). $\square$
\end{comment}

\subsection{Page 43, Proposition 3.14}%

The inclusion 
$$
S^{-1}\oo{Ann}M\subset\oo{Ann}S^{-1}M
$$ 
holds even is $M$ is not finitely generated. Here is a counterexample to the reverse inclusion:

Let $K$ be a field and $X$ an indeterminate. Set 
$$
A:=K[X],\quad S:=K[X]\setminus\{0\},\quad M:=\bigoplus A/(X^n).
$$ 
We get $\oo{Ann}M=(0)$, $S^{-1}M=0$, $\oo{Ann}S^{-1}M=(1)$. 

\subsection{Page 43, Proposition 3.16}%\label{43b}

Compare with Exercise 3.21iv p. 47 of the book Section~\ref{321iv} p.~\pageref{321iv} below.

\subsection{Proof of Proposition 3.16}

The commutative diagram
$$
\begin{tikzcd}
\kern-22pt\ppp<A\ar[d,"\alpha"']\ar[r,"f"]&B>\ppp B\ar[d,"\beta"]\kern-30pt\\ 
\kern-22pt\ppp_\ppp<A_\ppp\ar[r,"f_\ppp"']&B_\ppp>\mf m\supset\ppp B_\ppp\kern-66pt.
\end{tikzcd}
$$ 
might help. Note that we have $f_\ppp^{-1}(\mf m)=\ppp_\ppp$.

%https://docs.google.com/document/d/1YYUDEGhoImy-b_Lx9foGoetelzzXbN1IiNbpo7pXh98/edit {comment} 180522

\subsection{Strengthening of Proposition 3.16}\label{43}

Proposition 3.16 can also be stated as follows:

\emph{Let $A\to B$ be a morphism of commutative rings, let $\aaa$ be a contracted ideal in $A$, and let $\Sigma$ be the set of those ideals in $B$ which contract to $\aaa$. (In particular $\Sigma$ is nonempty.) Order $\Sigma$ by inclusion. Then we have}

(a) \emph{$\aaa^{\oo e}$ is the least element of $\Sigma$, or, equivalently, $\aaa^{\oo e}$ is the intersection of all the elements of $\Sigma$,}

(b) \emph{$\Sigma$ has one, or more, maximal elements,}

(c) \emph{if $\ \aaa$ is prime, then any maximal element of $\Sigma$ is also prime.}

The proofs of these statements are straightforward and elementary. We'll prove (c), the proofs of (a) and (b) being similar and left to the reader.

To prove (c), let $\mf q$ be a maximal element of $\Sigma$. Assume by contradiction that $\mf q$ is not prime. Then there are ideals $\mf{b,b}'$ in $B$ such that $\mf q\not\supset\mf b$, $\mf q\not\supset\mf b'$, $\mf q\supset\mf{bb}'$. Replacing $\mf b$ and $\mf b'$ with $\mf b+\mf q$ and $\mf b'+\mf q$, we can assume that $\mf q$ is a proper sub-ideal of $\bbb$ and $\bbb'$. By maximality of $\mf q$, the prime ideal $\aaa$ is a proper sub-ideal of $\bbb^{\oo c}$ and $\bbb'^{\oo c}$. By Exercise 1.18 p.~10 we also have 
$$
\bbb^{\oo c}\bbb'^{\oo c}\subset(\mf{bb}')^{\oo c}\subset\mf q^{\oo c}=\aaa,
$$ 
in contradiction with the primality of $\aaa$.

\subsection{Related result}\label{res}

Here is a related result:

\emph{$\ppp$ is the contraction of a prime ideal if and only if $A_\ppp/\ppp_\ppp\otimes_AB\ne0$.}

Indeed we have 
$$
(A_\ppp/\ppp_\ppp)\otimes_AB\simeq(A/\ppp)_\ppp\otimes_AB\simeq(A/\ppp)_\ppp\otimes_{A/\ppp}A/\ppp\otimes_AB
$$ 
$$
\simeq(A/\ppp)_\ppp\otimes_{A/\ppp}B/\ppp B\simeq(B/\ppp B)_\ppp=\big(B/\ppp^{\oo e}\big)_\ppp,
$$ 
$$
\big(B/\ppp^{\oo e}\big)_\ppp=0\iff\frac11=\frac01\text{ in }\big(B/\ppp^{\oo e}\big)_\ppp\iff\exists\ s\in A\setminus\ppp\ |\ f(s)\in\ppp^{\oo e},
%\big(B/\ppp^{\oo e}\big)_\ppp=0\iff\frac11=\frac01\text{ in }B/\ppp^{\oo e}\iff\exists\ s\in A\setminus\ppp\ |\ f(s)\in\ppp^{\oo e},
$$ 
$$
\iff\exists\ s\in\ppp^{\oo{ec}}\setminus\ppp\iff\ppp^{\oo{ec}}\ne\ppp.
$$ 
Note that the above statement follows also from Exercise 3.21iv p.~47 of the book.

\subsection{Page 44, Exercise 3.6}%

We leave to the reader the proof of the fact that $\Sigma$ has maximal elements. Note that 

$(\star)$ $S\in\Sigma\implies A\setminus S$ contains a prime ideal of $A$.

Let $\ppp$ be a minimal prime ideal of $A$. Then $S:=A\setminus\ppp$ is in $\Sigma$. Let $T$ be an element of $\Sigma$ which contains $S$. By $(\star)$ there is a prime ideal $\qqq$ contained in $A\setminus T\subset A\setminus S=\ppp$. This implies $\qqq=\ppp$, and thus $T=S$. This shows that $S$ is a maximal element of $\Sigma$. 

Let $S$ be a maximal element of $\Sigma$. By $(\star)$ there is a prime ideal $\ppp$ of $A$ contained in $A\setminus S$. As $A\setminus\ppp$ is in $\Sigma$ we have $S=A\setminus\ppp$, and $\ppp$ is clearly prime.

%Hint: Let $S$ be in $\Sigma$. Then $S$ is a maximal element of $\Sigma$ if and only if for all $a$ in $A\setminus S$ there is an $s$ in $S$ such that $as$ is nilpotent. Moreover, if $S$ is a maximal element of $\Sigma$, and if $a$ and $b$ are in $A\setminus S$, then so is $a+b$.% Hint: Let $S$ be in $\Sigma$. Then $S$ is a maximal element of $\Sigma$ if and only if for all $a$ in $A\setminus S$ there is an $n$ in $\mathbb N$ and an $s$ in $S$ such that $a^ns=0$. Moreover, if $S$ is a maximal element of $\Sigma$ and if $a$ and $b$ are in $A\setminus S$, then so is $a-b$.

\subsection{Page 44, Exercise 3.7}%

Hint 1: Let $S$ be a multiplicative set and $\aaa$ an ideal disjoint from $S$, and let $\Sigma$ be the set of ideals of $A$ which are disjoint from $S$. Then $\Sigma$ has maximal elements, and any maximal element of $\Sigma$ is prime.

Hint 2: If $S=1+\aaa$, then $\overline S$ is the complement of the union of the maximal ideals containing $\aaa$.

\subsection{Page 44, Exercise 3.8}%

Implication (v)$\implies$(i). Let $\ppp$ be a prime ideal of $A$ disjoint from $S$. By Proposition 3.9 p.~40 of the book, it suffices to show that the natural map 
$$
\psi:(S^{-1}A)_{S^{-1}\ppp}\to(T^{-1}A)_{S^{-1}\ppp}
$$ 
is bijective. 

The element $r/s\in S^{-1}A$ is not in $S^{-1}\ppp$ if and only if $r$ is not in $\ppp$. In particular an element of $(S^{-1}A)_{S^{-1}\ppp}$ is of the form 
$$
\frac{a/s}{r/s'}
$$ 
with $a\in A, r\in A\setminus\ppp$ and $s,s'\in S$.

Injectivity of $\psi$: If 
$$
\frac{a/s}{r/s'}=0
$$ 
in $(T^{-1}A)_{S^{-1}\ppp}$, then there is an $r'\in A\setminus\ppp$ and an $s''\in S$ such that the element 
$$
\frac{a}{s}\frac{r'}{s''}=\frac{ar'}{ss''}
$$ 
is equal to zero in $T^{-1}A$, and there is a $t\in T$ such that $ar't=0$. Then $t$ is not in $\ppp$, and we get % the element %we get 
$$
\frac{a/s}{r/s'}=\frac{ar't/s}{rr't/s'}=0
$$ 
%vanishes 
in $S^{-1}A$.

Surjectivity of $\psi$: An element of $(T^{-1}A)_{S^{-1}\ppp}$ is of the form 
$$
\frac{a/t}{r/s}
$$ 
with $a\in A,t\in T,r\in A\setminus\ppp, s\in S$, and we have 
$$
\frac{a/t}{r/s}=\frac{a/1}{rt/s}\ .
$$ 
We see that $rt$ is not in $\ppp$, and thus 
$$
\frac{a/t}{r/s}=\psi\left(\frac{a/1}{rt/s}\right).
$$

\subsection{Page 44, Exercise 3.9}%

See Section \ref{114} p.~\pageref{114}. --- Actually there are two proofs of the fact that the set of zero-divisors  is a union of prime ideals: one is Exercise 1.14 p.~12, the other is Exercise 3.7 p.~44.

$\bu$ To show that a minimal prime ideal $\ppp$ consists of zero-divisors, set $S:=A\setminus\ppp$. Then $S$ is a maximal element of $\Sigma$. It suffices to prove $S_0\subset S$. But otherwise we would have $ss_0=0$ with $s\in S$, $s_0\in S_0$, and $s_0$ would be a zero-divisor.

$\bu$ (ii) Assume that $a/s\in S_0^{-1}A$ is neither a unit nor a zero-divisor. We have $a\notin S_0$. Then there is a nonzero $b$ in $A$ with $ab=0$, and we get $\frac as\frac b1=0$, hence $\frac b1=0$, that is $bt=0$ for some $t\in S_0$. This implies $b=0$, a contradiction.

\subsection{Page 44, Exercise 3.10i}%

$$a=a^2x\implies\frac{a^2}{s^2}\frac{sx}1=\frac{ax^2s}{s^2}=\frac as\ .$$ 

\subsection{Page 44, Exercise 3.10ii}\label{310ii}%

Recall the statement: 

\emph{$A$ is absolutely flat $\iff$ $A_\mmm$ is a field for each maximal ideal $\mmm$.}

Equivalent statements: 

$A$ \emph{is absolutely flat if and only if for all maximal ideal $\mf m$ of $A$ we have} $\mf m_{\mf m}=(0)$.

$A$ \emph{is absolutely flat if and only if for all $\mu\in\mf m\subset A$ with $\mf m$ maximal, there is an $s\in A\setminus\mf m$ such that} $s\mu=0$.

Here is a proof: If $A$ is absolutely flat, then so is $A_{\mf m}$ by Part (i) of the same Exercise, and $A_{\mf m}$ is a field by Exercise 2.28 p.~35 of the book (see Section~\ref{228} p.~\pageref{228} above). Conversely, assume that $A_{\mf m}$ is a field for each maximal ideal $\mf m$ of $A$, and let $a$ be in $A$. We have $(a^2)_{\mf m}=(a)_{\mf m}$ for all maximal $\mf m$, and thus $(a^2)=(a)$. This shows that $A$ is absolutely flat by Exercise 2.27 p.~35 of the book ((ii) implies (i)).

\subsection{Page 44, Exercise 3.11}%

Recall the statement:

\emph{Let $A$ be a ring. Prove that the following are equivalent:}

(i) $A/\mf N$ \emph{is absolutely flat ($\mf N$ being the nilradical of $A$).}

(ii) \emph{Every prime ideal of $A$ is maximal.}

(iii)  $\Spec(A)$ \emph{is a T1-space (i.e., every subset consisting of a single point is closed).}

(iv) $\Spec(A)$ \emph{is Hausdorff.}

\emph{If these conditions are satisfied, show that $\Spec(A)$ is compact and totally disconnected (i.e. the only connected subsets of $\Spec(A)$ are those consisting of a single point).}

The equivalence (ii)$\iff$(iii) is clear, as well as the implication (iv)$\implies$(ii).

(ii)$\implies$(iv): We assume that each prime ideal of $A$ is maximal and we show that $X=\oo{Spec}(A)$ is Hausdorff. Let $x$ and $y$ be two distinct points of $X$. 

Claim: %For all $x,y\in X$, $x\ne y$, 
there are elements $a\in\ppp_y\setminus\ppp_x$, $b\in\ppp_x\setminus\ppp_y$ such that $ab=0$.

The claim implying that $X_a$ and $X_b$ are disjoint open neighborhoods of $x$ and $y$ respectively, it suffices to prove the claim.

%Proof of the claim. 
Assume the claim is false. Then $S:=(A\setminus\ppp_x)(A\setminus\ppp_y)$ is a multiplicatively closed subset avoiding $0$, hence $S^{-1}A$ is not the zero ring, hence there is a maximal ideal $\mf m$ in $S^{-1}A$. The contraction $\mmm^{\oo c}$ of $\mmm$ in $A$ is a prime ideal contained in $A\setminus S\subset\ppp_x$ (because $A\setminus\ppp_x\subset S$). Similarly we have $\mmm^{\oo c}\subset\ppp_y$, and thus $\mmm^{\oo c}\subset\ppp_x\cap\ppp_y$, %whose contraction in $A$ is a prime ideal contained in $\ppp_x\cap\ppp_y$, 
a contradiction. $\square$

At this point we know that (ii), (iii) and (iv) are equivalent.

Introduce the following notation: For any ideal $\mf a$ of any ring $R$ write $\overline\aaa$ for the image of $\mf a$ in $\overline R:=R/\mf N(R)$, and define $\overline r\in\overline R$ for $r\in R$ similarly.

(i)$\implies$(ii): Let $A/\mathfrak N$ be absolutely flat and assume by contradiction that there is a prime ideal $\ppp$ strictly contained in a maximal ideal $\mf m$. Let us denote this situation by $\ppp<\mf m$. Then we get firstly $\overline\ppp<\overline\mmm$ with $\overline\ppp$ prime and $\overline\mmm$ maximal, and secondly $\overline\ppp_{\overline\mmm}<\overline\mmm_{\overline\mmm}$ with $\overline\ppp_{\overline\mmm}$ prime and $\overline\mmm_{\overline\mmm}$ maximal. But Exercise 3.10ii p.~44 of the book (see Section~\ref{310ii} above) implies $\overline\mmm_{\overline\mmm}=(\overline0)$. $\square$

\begin{comment}
(i)$\implies$(iv): We assume that $A/\mathfrak N$ is absolutely flat and we show that $X$ is Hausdorff. For any ideal $\mf a$ of any ring $R$ write $\overline\aaa$ for the image of $\mf a$ in $\overline R:=R/\mf N(R)$, and define $\overline r\in\overline R$ for $r\in R$ similarly. ??? $\square$
\end{comment}

(ii)$\implies$(i): We assume that the prime ideals of $A$ are maximal and we show that $A/\mathfrak N$ is absolutely flat. Let $\mmm$ be a maximal ideal of $A$. By Section~\ref{310ii} above it suffices to show $\overline\mmm_{\overline\mmm}=(0)$. But we have 
$$
\overline\mmm_{\overline\mmm}=\mf N\left(\overline A_{\overline\mmm}\right)=\mf N\left(\overline A\right)_{\overline\mmm}=(0),
$$ 
the second equality following from Corollary 3.12 p.~42 of the book. $\square$

\begin{comment}
Let $\mu\in\mf m\subset A$ with $\mf m$ maximal. By Section~\ref{310ii} p.~\pageref{310ii} above, it suffices to show that, in the above notation, we have %there is an $s\in A\setminus\mf m$ such that 
$\overline\mu=\overline0$. By Corollary 3.12 p.~42 of the book, this is equivalent to showing that %there is an $s\in A\setminus\mf m$ such that 
the element $\mu/1$ of $A_\mmm$ is nilpotent, which is clear since $\mf m$ is a minimal prime ideal of $A$ (and thus $\mmm_\mmm$ is the nilradical of $A_\mmm$). $\square$
\end{comment}

Proof that $X$ is totally disconnected: Let $x$ and $y$ be two different points of $X$. We saw that there is an $a\in A$ such that $x\in X_a$ and $y\notin X_a$ (see above claim). As $X$ is Hausdorff and $X_a$ is compact, $X_a$ is closed, that is open and closed, and so is its complement $V(a)$, which contains $y.\ \square$

Here is a related result:

\emph{The following conditions on a ring $A$ are equivalent:}

(a) \emph{the Krull dimension of $A$ is at most zero,}

(b) \emph{$A/\mf n$ is absolutely flat, where $\mf n$ is the nilradical of $A$,}

(c) \emph{for each $a$ in $A$ the descending chain $(a)\supset(a^2)\supset\cdots$ stabilizes.}

\emph{Proof.} In view of Exercise 3.11 p. 44 of the book, it suffices to prove (b)$\implies$(c)$\implies$(a). %(a)$\implies$(b): We can assume $\mf n=(0)$. Let $a$ be in $A$. It suffices to show $(a)=(a^2)$. Let $\ppp$ be a prime ideal of $A$. Then the nilradical of $A_\ppp$ is $(0)$ and $\ppp_\ppp$ is the only prime ideal of $A_\ppp$. This implies that $A_\ppp$ is a field, and we get successively the equalities $$(a)_\ppp=(a^2)_\ppp,\quad(a)_\ppp/(a^2)_\ppp=(0),\quad((a)/(a^2))_\ppp=(0).$$ As $\ppp$ is an arbitrary prime ideal of $A$, this forces $(a)=(a^2)$.

(b)$\implies$(c): With obvious notation we have $\overline a=\overline a^2\overline b$ for some $b$ in $A$, that is $(a-a^2b)^n=0$ for some $n\ge1$. This is easily seen to imply $a^n\in(a^{n+1})$ and thus $(a^{n+1})=(a^n)$. 

(c)$\implies$(a): Let $\ppp$ be a prime ideal of $A$ and let $a$ be in $A\setminus\ppp$. We have $a^n(1-ab)=0$ for some $b$ in $A$ and some $n$ in $\mathbb N$. In particular $a^n(1-ab)\in\ppp$, and thus $1-ab\in\ppp$. This implies that $A/\ppp$ is a field, and therefore that $\ppp$ is maximal. $\square$

\subsection{Page 45, Exercise 3.14}%\label{321iv}

Let $\mf m$ be a maximal ideal of $A/\mf a$. It suffices to show $(M/\mf aM)_\mmm=0$. Letting $\mf m^{\oo c}$ be the contraction of $\mf m$ in $A$, we get 
$$
(M/\mf aM)_\mmm\simeq(M/\mf aM)_{\mf m^{\oo c}}\simeq M_{\mf m^{\oo c}}/(\mf aM)_{\mf m^{\oo c}}=0.
$$ 

%\subsection{Page 45, Exercise 3.15}%\label{321iv}

%See Lemma \ref{b254} p. \pageref{b254} above.

\subsection{Page 46, Exercise 3.19vi}%

Use Proposition 3.7 p. 40 of the book.

\subsection{Page 46, Exercise 3.20}%\label{321iv}

Counterexample to the converse of (ii): $B:=k$ a field, $A:=k[\varepsilon]$ with $\varepsilon^2=0$, $f:k[\varepsilon]\to k$ the canonical projection. 

\subsection{Page 47, Exercise 3.21iv}\label{321iv}%

In fact $f^{*-1}(\ppp)$ is the set of those prime ideals $\qqq$ of $B$ which satisfy 
$$
\ppp^{\oo{e}}\subset\qqq\subset B\setminus f(S),
$$ 
where $S:=A\setminus\ppp$. Equip $f^{*-1}(\ppp)\subset\Spec(B)$ with the induced topology. Then the closed subsets of $f^{*-1}(\ppp)$ are given by the conditions 
$$
\bbb\subset\qqq\subset B\setminus f(S),
$$ 
where $\bbb$ is an ideal of $B$ containing $\ppp^{\oo{e}}$ and avoiding $S$. In particular $f^{*-1}(\ppp)$ is naturally homeomorphic to $\Spec((B/\ppp^{\oo{e}})_\ppp)$.

We also give the commutative diagram
$$
\begin{tikzcd}
(B_\ppp/\ppp B_\ppp)^*\ar[d,"\overline{f_\ppp}^*"]\ar[r]&(B_\ppp)^*\ar[d,"(f_\ppp)^*"]\ar[r]& B^*\ar[d,"f^*"]\\ 
(A_\ppp/\ppp_\ppp)^*\ar[r]&(A_\ppp)^*\ar[r]& A^*,
\end{tikzcd}
$$ 
where $R^*$ stands for $\oo{Spec}(R)$, and recall the isomorphism 
$$
(A_\ppp/\ppp_\ppp)\otimes_AB\simeq B_\ppp/\ppp B_\ppp
$$ 
proved in Section~\ref{res} p.~\pageref{res}.
%chain of isomorphisms $$(A_\ppp/\ppp_\ppp)\otimes_AB\simeq(A/\ppp)_\ppp\otimes_AB\simeq(A/\ppp)_\ppp\otimes_{A/\ppp}A/\ppp\otimes_AB$$ $$\simeq(A/\ppp)_\ppp\otimes_{A/\ppp}B/\ppp B\simeq(B/\ppp B)_\ppp.$$ (See Section~\ref{res} p.~\pageref{res} for a minor variant of the above calculation.)

\subsection{Page 47, Exercise 3.23}%\label{321iv}%

It's simpler to proceed as follows:

For $f\in A$ put 
$$
S(f):=A\ \setminus\ \bigcup_{\ppp\notni f}\ \ppp,
$$ 
where it is understood that $\ppp$ is in $X$. Note that $S(f)$ is a multiplicatively closed set depending only on $X_f$, not on $f$. Finally put 
$$
A(X_f):=S(f)^{-1}A.
$$ 
Here is a mild generalization: 

For each radical ideal $\mf a$ of $A$ put 
$$
S_{\mf a}:=A\ \setminus\ \bigcup_{\ppp\not\supset\mf a}\ \ppp.
$$ 
This is multiplicatively closed. For $\mf a\subset\mf b$ we have a natural morphism $S_{\mf b}^{-1}A\to S_{\mf a}^{-1}A$. We also have a canonical isomorphism 
$$
\varinjlim_{\mf a\not\subset\ppp}S_{\mf a}^{-1}A\simeq A_\ppp.
$$

\subsection{Page 47, Exercise 3.24}%

Denote the natural morphism $A\to A_{f_i}$ by $a\mapsto a_{|i}$, and the natural morphism $A_{f_i}\to A_{f_if_j}$ by $a_i\mapsto a_{i|j}$. 

Step 1: $I=\{1,\dots,n\}$. Consider the diagram 
$$
0\to A\xr\alpha\prod_{i\in I}A_{f_i}\xr\beta\prod_{i,j\in I}A_{f_if_j}
$$ 
defined by $\alpha(a):=(a_{|i})$ and $\beta((a_i)):=((a_{i|j}-a_{j|i}))$. This is clearly a complex. It suffices to show that it is exact. By Section~\ref{re} p.~\pageref{re}, we can assume that $A$ is local. Let $\mf m$ be its maximal ideal. As the $f_i$ generate the unit ideal, one of them is a unit, so that we can assume $f_1=1$. It is easy to see that $\alpha$ is injective. Assuming $\beta((a_i))=0$, it is straightforward to check that $(a_i)$ is equal to $\alpha(a_1)$. This solves the exercise in the case $I=\{1,\dots,n\}$.

Step 2: $I$ arbitrary. Let $(s_i)$ be a family such that $s_i\in A_{f_i}$ for all $i$ and $s_{i|j}=s_{j|i}$ for all $i,j$. There are $i_1,\dots,i_n$ such that $(f_{i_1},\dots,f_{i_n})=(1)$ and, by Step~1, there is an $s\in A$ such that $s_{|i_k}=s_{i_k}$ for $1\le k\le n$. Let $i_{n+1}$ be in $I$. There is again a $t\in A$ such that $t_{|i_k}=s_{i_k}$ for $1\le k\le n+1$. By uniqueness we get $t=s$. As $i_{n+1}$ was arbitrary, we have $s_{|i}=s_i$ for all $i$. This proves the existence of a solution to our problem. The uniqueness is clear.

\subsection{Page 48, Exercise 3.25}%

For the hint see Exercise 3.21iv p. 47 of the book and Section~\ref{res} p.~\pageref{res} above.

\subsection{Page 48, Exercise 3.26}%

For the hint see Exercise 3.21iv p. 47 of the book and Section~\ref{res} p.~\pageref{res} above.

\section{About Chapter 4}%%

\subsection{Contracted primary ideals}\label{cpi}%

Section~\ref{43} p.~\pageref{43} prompts the question: Is a contracted primary ideal the contraction of a primary ideal? We show that the answer is negative.

Let $K$ be a field and set $A:=K[\varepsilon]$ with $\varepsilon^2=0$ but $\varepsilon\ne0$. Note that $(0)\subset A$ is primary. We will define a ring $B$ which contains $A$. Then $(0)\subset A$ will be a contracted primary ideal, and we will show that $(0)\subset A$ is not the contraction of a primary ideal of $B$. 

We define $B$ by 
$$
B=K[X,Y_1,Y_2,\dots]/\mathfrak b=K[x,y_1,y_2,\dots]
$$ 
(obvious notation) with 
$$
\mathfrak b=(X^2Y_1)+\sum_{i\ge2}(X^nY_n-XY_1),
$$
and we embed $A$ in $B$ by setting $\varepsilon:=xy_1$. We get $\varepsilon x=0$ and $\varepsilon=x^ny_n$ for all $n\ge1$; in particular $\varepsilon\in(x^n)$ for all $n\ge1$.

We claim that we have $XY_1\notin\mathfrak b$, or, equivalently, $\varepsilon\ne0$.

Proof of the claim: Assume by contradiction 
$$
XY_1\in(X^2Y_1,X^2Y_2-XY_1,\dots,X^nY_n-XY_1).
$$ 
Dividing by $X$ we get 
$$
Y_1\in(XY_1,XY_2-Y_1,X^2Y_3-Y_1,\dots,X^{n-2}Y_{n-1}-Y_1,X^{n-1}Y_n-Y_1).
$$ 
Setting $Y_i:=X^{n-i}Y_n$ for $1\le i\le n-1$ we get $X^{n-1}Y_n\in(X^nY_n)$, which is false. 

The above proof was explained to me by an anonymous user, whose user name is user26857, of the Mathematics Stackexchange forum; see 

\href{https://math.stackexchange.com/q/2389114/660}{https://math.stackexchange.com/q/2389114/660}

We prove that $(0)\subset A$ is not the contraction of a primary ideal of $B$.

Let $\mathfrak q$ be a primary ideal of $B$. If we had $\varepsilon\notin\mathfrak q$ and $x^n\notin\mathfrak q$ for all $n\ge1$, then $x$ would be a non nilpotent zero divisor in $B/\mathfrak q$, contradicting the assumption that $\mathfrak q$ is primary. Thus we have $x^n\in\mathfrak q$ for some $n\ge1$, or $\varepsilon\in\mathfrak q$. But, since $\varepsilon\in(x^n)$, we get $\varepsilon\in\mathfrak q$ in both cases, and $\mathfrak q$ contracts to $(1)$ instead of contracting to $(0)$.

\subsection{Page 50}\label{contrpry}%

Just before Proposition 4.1: In fact, the contraction of a $\ppp$-primary ideal is a $\ppp^{\oo c}$-primary ideal.

\subsection{Page 52, Corollary to Theorem 4.5}%%

\begin{cor}\label{c45}
In the notation of Theorem 4.5, we have:

(a) If $(\aaa:x)$ is prime, then $(\aaa:x)$ $=\ppp_i$ for some $i$.

(b) If $1\le i\ne j\le n$, then $\ppp_i\ne\ppp_j$.
\end{cor}

\subsection{Page 52, Proof of Theorem 4.5}%

The following statement, occurring in the proof of Theorem 4.5, is often used in the sequel of the book:

{\em In the setting of Theorem 4.5 we have} 
\begin{equation}\label{45}
r(\mf a:x)=\bigcap_{x\notin\mf q_j}\ppp_j.
\end{equation}
(See Note~\ref{ef} p.~\pageref{ef}). Here are more details. Still in the setting and notation of Theorem 4.5, for $x$ in $A$ set $J(x):=\{j\ |\ x\notin\mf q_j\}$. Then $(\mf q_j:x)$ is $\ppp_j$-primary for $j\in J(x)$, and we have 
$$
(\mf a:x)=\bigcap_{j\in J(x)}(\mf q_j:x).
$$ 
In particular, we have $J(x_i)=\{i\}$, and thus 
$$
(\mf a:x_i)=(\mf q_i:x_i),\quad r(\mf a:x_i)=\ppp_i.
$$

\subsection{Page 52, Corollary to Proposition 4.6}%

\begin{note}\label{fmme}
If $\mf a$ is decomposable, then the set of prime ideals containing $\mf a$ has only finitely many minimal elements.
\end{note}

\subsection{Page 53, decomposable ideals}\label{di}%

The purpose of this section is to prove the following statement:

\emph{An ideal having only finitely many minimal primes is not necessarily decomposable.}

The following is due to user26857 of Mathematics Stackexchange.\bigskip\bigskip

\hrule\bigskip

Taken from\\ https://math.stackexchange.com/a/207468/660:

In order to find an ideal which doesn't have a primary decomposition, the following construction is useful. Let $R$ be a commutative ring and $M$ an $R$-module. On the set $A=R\times M$ one defines the following two algebraic operations:
$$
(a,x)+(b,y)=(a+b,x+y)
$$
$$
(a,x)(b,y)=(ab,ay+bx).
$$
With these two operations $A$ becomes a commutative ring with $(1,0)$ as unit element. ($A$
is called the \emph{idealization} of the $R$-module $M$ or the \emph{trivial extension} of $R$ by $M$.)

Let's list some important properties of this ring:

1. $\{0\}\times M$ is an ideal of $A$ isomorphic to $M$ (as $R$-modules) and there is a ono-to-one correspondence between the ideals of $R$ and the ideals of $A$ containing $\{0\}\times M$, the ideal $\mf a\subset R$ corresponding to $\mf a\times M\subset A$.

2. $A$ is a Noetherian ring if and only if $R$ is Noetherian and $M$ is finitely generated.

3. All prime (maximal) ideals of $A$ have the form $\ppp\times M$, where $\ppp$ is a prime (maximal) ideal of $R$.

4. If $R$ is an integral domain and $M$ is divisible, then all the ideals of $A$ have the form $\mf a\times M$ with $\mf a$ ideal of $R$, or $\{0\}\times N$ with $N$ submodule of $M$.\bigskip\bigskip

\hrule\bigskip%

Taken from\\ https://math.stackexchange.com/a/1679116/660:\bigskip

\begin{note}%\label{nice}
If $A$ is the idealization of the $\mathbb Z$-module $\mathbb Q$, then the primary ideals of $A$ are  

$\bullet\quad p^n\mathbb Z\times\mathbb Q$ with $p$ prime, $n\ge1$, 

$\bullet\quad\{0\}\times\mathbb Q$,

$\bullet\quad\{0\}\times\{0\}$. 

Moreover $\{0\}\times\mathbb Q$ is the only minimal prime of $\{0\}\times\mathbb Z$, and $\{0\}\times\mathbb Z$ has no primary decomposition (see Note~\ref{fmme}).
\end{note}\bigskip
%Then $\mf a:=\{0\}\times\mathbb Z$ has only one minimal prime $\{0\}\times\mathbb Q$ and $\mf a$ has no primary decomposition.\bigskip%https://math.stackexchange.com/a/1679116/660

\hrule\bigskip

\subsection{Page 53, proof of Proposition 4.8.ii}\label{prycor}%\label{contrpry}

Using the notation of Section~\ref{prcor} p.~\pageref{prcor} and taking Section~\ref{contrpry} p.~\pageref{contrpry} into account, we set 
$$
X':=\{\qqq\ |\ \qqq\text{ primary ideal of }A\},
$$ 
$$
Y':=\{\qqq\ |\ \qqq\text{ primary ideal of }S^{-1}A\}.
$$ 
We then have a contraction map $c:Y'\to X'$ compatible with radicals. We check that  
$$
c(Y')=\{\qqq\in X'\ |\ r(\qqq)\in c(Y)\}
$$ 
and that 
$$
\qqq\in c(Y')\implies S^{-1}\qqq\in X',
$$ 
and we see the following facts: 

\emph{The contraction and extension maps are inverse inclusion preserving bijections compatible with radicals between $Y'$ and $c(Y')$.} 

\emph{Moreover, a primary ideal of $A$ is contracted if and only if its radical is disjoint from $S$.}

In particular, if $\ppp$ is a minimal prime ideal, then the kernel of the natural morphism $A\to A_\ppp$ is a minimal \emph{primary} ideal.

\begin{comment}
We have 
$$
\mf q^{\text{ec}}=\bigcup_{s\in S}\ (\mf q:s)=\mf q
$$ 
by Proposition 3.11ii p.~41 and Lemma 4.4iii p.~51, and 
$$
r(\mf q^{\text e})=r(S^{-1}\mf q)=S^{-1}r(\mf q)=S^{-1}\ppp
$$ 
by Proposition 3.11v p.~42.
\end{comment}

\subsection{Page 54, Theorem 4.10}%\label{410}%

Here is a corollary to Theorem 4.10 (see also Proposition 1.11ii p.~8 of the book):

\begin{cor}\label{410}
Let $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ be a reduced primary decomposition.

(a) If $\ppp_i:=r(\qqq_i)$ is isolated, then $\qqq_i$ is the smallest $\ppp_i$-primary ideal containing $\aaa$.%\end{cor}\begin{cor}\label{413}

(b) If $r(\aaa)=\ppp$ for some prime ideal $\ppp$, then $\ppp$ is the only isolated prime ideal of $\aaa$, and the corresponding primary component is the smallest $\ppp$-primary ideal containing $\aaa$.
\end{cor}

\subsection{Page 55, Exercise 4.5}%

Let $\aaa$ be an ideal of $A:=K[x,y,z]$. Then $\aaa$ is generated by monomials if and only if it has the following property:

A polynomial $f\in A$ is in $\aaa$ if and only if all the monomials occurring in $f$ are in $\aaa$.

In particular, if two ideals are generated by monomials, so is their intersection.

\subsection{Page 55, Exercise 4.6}%

Claim: any prime ideal is contained in a \emph{unique} maximal ideal.

Proof: Using Urysohn's Lemma it is easy to see that, given distinct points $x$ and $y$ in $X$ and denoting by $\mmm_x$ and $\mmm_y$ the corresponding maximal ideals, there are $f,g\in C(X)$ such that $fg=0$, $f\in\mmm_x\setminus\mmm_y$, $g\in\mmm_y\setminus\mmm_x$. 

The claim implies that there are infinitely many minimal prime ideals.

%Using Urysohn's Lemma it is easy to see that any prime ideal is contained in a \emph{unique} maximal ideal. This implies that there are infinitely many minimal prime ideals.

\subsection{Page 55, Exercise 4.7}\label{5547}%

Part iii: Use Exercises 1.18 p.~10 and 1.2ii p.~11. Note that we have (by Exercise 1.2ii p.~11)
\begin{equation}\label{rax}
r(\aaa[x])=r(\aaa)[x]
\end{equation}
(obvious notation).

\begin{comment}
Part iv: We claim: %$(\aaa\cap\bbb)[x]=\aaa[x]\cap\bbb[x]$ (obvious notation).
\begin{equation}\label{acbx}
(\aaa\cap\bbb)[x]=\aaa[x]\cap\bbb[x]
\end{equation}
(obvious notation).

Proof: The diagram 
$$
\begin{tikzcd}
0\ar[r]&(\aaa\cap\bbb)[x]\ar[d]\ar[r]&(\aaa\oplus\bbb)[x]\ar[d]\ar[r]&(\aaa+\bbb)[x]\ar[d]\ar[r]&0\\ 
0\ar[r]&\aaa[x]\cap\bbb[x]\ar[r]&\aaa[x]\oplus\bbb[x]\ar[r]&\aaa[x]+\bbb[x]\ar[r]&0
\end{tikzcd}
$$ 
(where the arrows are the obvious ones) commutes, the rows are exact, the second vertical arrow is clearly an isomorphism, and the third vertical arrow is an isomorphism by Exercises 1.18 p.~10. Thus the first vertical arrow is also an isomorphism. But by its (implicit) definition this arrow is an inclusion. Being surjective, it is actually an equality. $\square$

Then Part iv follows from \eqref{acbx} and Part iii.
\end{comment}

Part v: We clearly have 
\begin{equation}\label{asb}
\aaa\subset\bbb\iff\aaa[x]\subset\bbb[x]
\end{equation}
(obvious notation), and Part v follows from \eqref{asb}, Part iv and Proposition 4.6 p.~52 of the book.

\subsection{Page 55, Exercise 4.8}%

Use Section \ref{5547} and the following easy fact:

Let $A$ be a ring and $x$ an indeterminate.

%If $\aaa$ and $\bbb$ are ideals of $A$, then $(\aaa+\bbb)[x]=\aaa[x]+\bbb[x]$ (Exercise 1.18 p.~10 of the book).

For $a$ in $A$ we have $(aA)[x]=a(A[x])$. (In fact for any overring $B$ of $A$ we have $(aA)^{\oo e}=aB$.) %Let $a$ be in $A$, write $(a)_A$ for the ideal of $A$ generated by $a$, and $(a)_{A[x]}$ for the ideal of $A[x]$ generated by $a$. Then we have $(a)_A[x]=(a)_{A[x]}$.

\subsection{Page 55, Exercise 4.9}%

%\subsubsection{} 
$\bu$ Let $a,b\in A$ and $\ppp\in\oo{Spec}(A)$ be such that $a\in\ppp$ and $\ppp$ is minimal over $(0:b)$.

\textbf{Claim 1:} $a$ is zero-divisor.

\emph{Proof of Claim 1.} Assume by contradiction that $a$ is not a zero-divisor. Obviously $b\ne0$ and $a\notin(0:b)$. Let $s$ be in $A\setminus\ppp$ and $n$ be in $\mathbb N$. 

\textbf{Claim 2:} $a^ns\notin(0:b)$.

\emph{Proof of Claim 2.} Assume by contradiction that $a^ns\in(0:b)$. We can suppose that $n$ is minimum for this condition. In particular $n\ge2$. We have $a(a^{n-1}sb)=a^nsb=0$. As $a$ is not a zero-divisor, this implies $a^{n-1}sb=0$, that is $a^{n-1}s\in(0:b)$, in contradicition with the minimality of $n$. $\square$

Set $T:=\{\ a^ns|\ n\in\mathbb N,s\in A\setminus\ppp\}$. Claim~2 implies that $T$ is disjoint from $(0:b)$. Then there is a prime ideal $\qqq$ which contains $(0:b)$ and is disjoint from $T$, and we have $A\setminus\ppp\subset T\subset A\setminus\qqq$, that is $(0:b)\subset\qqq\subset\ppp$. By minimality of $\ppp$ over $(0:b)$ this forces $\qqq=\ppp$, and thus $a\in\ppp\cap T=\qqq\cap T=\varnothing$, a contradiction. This completes the proof of Claim~1. $\square$ 

$\bu$ \textbf{Proof of the inclusion $D(S^{-1}A)\subset D(A)\cap\Sp(S^{-1}A)$: }

Let $\ppp$ be a prime ideal of $A$ disjoint from $S$. It suffices to show $\ppp\in D(A)$. Note that $S^{-1}\ppp$ is minimal over $(0:\frac as)$ for some $a\in A$ and some $s\in S$ such that $\frac as$ is a zero-divisor. It suffices to show that $a$ is a zero-divisor and that $\ppp$ is minimal over $(0:a)$. It is easy to prove that $a$ is a zero-divisor. It remains to verify that $\ppp$ is minimal over $(0:a)$.

\textbf{Claim 3:} $(0:a)\subset\ppp$.

\emph{Proof of Claim 3.} Let $b\in A$ satisfy $ab=0$. It is enough to check $b\in\ppp$. We have $\frac as\frac b1=0$, hence $\frac b1\in(0:\frac as)\subset S^{-1}\ppp$, and thus $b\in\ppp$. $\square$

Assume by contradiction that there is a prime ideal $\qqq$ such that $(0:a)\subset\qqq<\ppp$. 

\textbf{Claim 4:} $(0:\frac as)\subset S^{-1}\qqq$.

\emph{Proof of Claim 4.} Assuming $\frac bt\frac as=0$ (obvious notation), we get $abu$ for some $u\in S$, hence $bu\in\qqq$, hence $b\in\qqq$, and thus $\frac bt\in S^{-1}\qqq$. $\square$ 

We get $(0:\frac as)\subset S^{-1}\qqq<S^{-1}\ppp$, contradicting the minimality of $S^{-1}\ppp$ over $(0:\frac as)$. %$\ppp$ over $(0:a)$. 
$\square$

$\bu$ Let $(0)=\qqq_1\cap\cdots\cap\qqq_n$ be a reduced decomposition and set $\ppp_i:=r(\qqq_i)$. We have 
$$
D(A)\subset\{\ppp_1,\dots,\ppp_n\}.
$$ 
\emph{Proof.} Let $\ppp$ be in $D(A)$. Then $\ppp$ is minimal over $(0:a)$ for some $a\in A$. By \eqref{45} p.~\pageref{45} we have 
$$
r(0:a)=\bigcap_{\qqq_i\ni a}\ppp_i\subset\ppp.
$$ 
In particular $a\in\qqq_i$ for some $i$, and we get 
$$
\ppp\supset\prod_{\qqq_i\ni a}\ppp_i,
$$ 
hence $\ppp\supset\ppp_i$ for some $i$, and thus $\ppp=\ppp_i$ for some $i$. $\square$

\subsection{Page 55, Exercise 4.10}%\label{e410}%

Note that $S_\ppp(0)=(0)^{\oo c}$, where the contraction is taken with respect to $A\to A_\ppp$. We also have 
$$
S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)
$$ 
and $r((0)^{\oo c})=r(0)^{\oo c}$.

(i) We have 
$$
S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)\subset\ppp.
$$
(ii) We must show that $\ppp$ is minimal if and only if $r(0)^{\oo c}=\ppp$. 

If $\ppp$ is minimal we have $r(0)=\ppp_\ppp$ and thus $r(0)^{\oo c}=\ppp$. 

If $\ppp$ is \emph{not} minimal, there is a prime ideal $\ppp'$ such that $\ppp'<\ppp$, and we get $r(0)\subset\ppp'_\ppp<\ppp_\ppp$, hence $r(0)^{\oo c}\subset\ppp'<\ppp$ and thus $r(0)^{\oo c}\ne\ppp$.

(iii) For $\ppp\supset\ppp'$ we have 
$$
S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)\subset\bigcup_{s'\in A\setminus\ppp'}(0:s')\subset S_{\ppp'}(0).
$$
(iv) We must show 
$$
\bigcap_{\ppp\in D(A)}S_\ppp(0)=(0).
$$ 
Let $0\ne a\in A$. There is a prime ideal $\ppp$ which is minimal over $(0:a)$. In particular $\ppp\in D(A)$. Then 
$$
a\in S_\ppp(0)=\bigcup_{s\in A\setminus\ppp}(0:s)
$$ 
would imply $as=0$ for some $s\in A\setminus\ppp$, and thus $s\in(0:a)\subset\ppp$, a contradiction.

\subsection{Page 56, Exercise 4.11}\label{411}%

(a) If $\ppp$ is a minimal prime ideal of a ring $A$, show that $S_\ppp(0)$ (Exercise 10) is the smallest $\ppp$-primary ideal.

The ideal $\ppp_\ppp$, being the unique prime ideal of $A_\ppp$, coincides with the nilradical: $\ppp_\ppp=r(0)$. Proposition 4.2 p.~51 of the book implies that $(0)$ is $\ppp_\ppp$-primary, and is thus the smallest $\ppp_\ppp$-primary ideal of $A_\ppp$. As $\ppp_\ppp$ contracts to $\ppp$, Section~\ref{prycor} p.~\pageref{prycor} above entails that $S_\ppp(0)=(0)^{\oo c}$ is the smallest $\ppp$-primary ideal of $A$. %By Exercise 4.10ii p.~55 of the book (see Section~\ref{e410} above), we have $r(S_\ppp(0))=\ppp$, and thus $r(S_\ppp(0)_\ppp)=\ppp_\ppp$ (Proposition 3.11v p.~42 of the book).  Proposition 4.2 p.~51 of the book implies then that $S_\ppp(0)_\ppp$, and Section~\ref{prycor} p.~\pageref{prycor} above entails that ???This follows from Proposition 4.2 p.~51 %and 4.8 p.~53 of the book and Section~\ref{prycor} p.~\pageref{prycor}.

(b) Let $\aaa$ be the intersection of the ideals $S_\ppp(0)$ as  $\ppp$ runs through the minimal prime ideals of $A$. Show that $\aaa$ is contained in the nilradical of $A$.

This follows from Exercise 4.10i p. 55.

(c) Suppose that the zero ideal is decomposable. Prove that $\aaa=(0)$ if and only if every prime ideal of $(0)$ is isolated.

Let 
$$
(0)=\qqq_1\cap\cdots\cap\qqq_n
$$ 
be a reduced decomposition. We can assume that there is an $m$ such that $1\le m\le n$ and $\ppp_i:=r(\qqq_i)$ is isolated if and only if $i\le m$. Theorem 4.10 p.~54 of the book and (a) above imply  
$$
(0)=S_{\ppp_1}(0)\cap\cdots\cap S_{\ppp_m}(0)\cap\qqq_{m+1}\cap\cdots\cap\qqq_n
$$ 
$$
=\aaa\cap\qqq_{m+1}\cap\cdots\cap\qqq_n,
$$ 
and we must show $\aaa=0\iff m=n$. Implication $\Longleftarrow$ is clear. Conversely if $\aaa=0$, then $m=n$ because the decomposition is reduced.

\subsection{Page 56, Exercise 4.12}%

Follows from statements 1.18, 3.11ii, 3.11v and 4.9 in the book.

\subsection{Page 56, Exercise 4.13}%

Note that $(\ppp^{(n)})_\ppp=\ppp_\ppp^n$.

(i) Let us show that $\ppp^{(n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^n$. We have $(\ppp^{(n)})_\ppp=\ppp_\ppp^n\subset\ppp_\ppp$. As $\ppp_\ppp$ is maximal, the ideal $(\ppp^{(n)})_\ppp$ is $\ppp_\ppp$-primary. Using contraction we see that $\ppp^{(n)}$ is $\ppp$-primary. If we had $\ppp^n\subset\qqq<\ppp$ with $\qqq$ a $\ppp$-primary ideal, localization would give $\ppp_\ppp^n\subset\qqq_\ppp<\ppp_\ppp^n$.

(ii) In view of Corollary~\ref{410} p.~\pageref{410} it suffices to check that $\ppp^{(n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^n$. We just did that in (i) above.

(iii) In view of Corollary~\ref{410} p.~\pageref{410} it suffices to check that $\ppp^{(m+n)}$ is the smallest $\ppp$-primary ideal containing $\ppp^{(m)}\ppp^{(n)}$. The argument is the same as in (ii).

(iv) There is a typo in the book. It should be: 
$$
\ppp^{(n)}=\ppp^n\iff\ppp^n\text{ is }\ppp\text{-primary.}
$$ 
This follows from what we proved in (i).

\subsection{Page 56, Exercise 4.14}%

By Corollary~\ref{c45} p.~\pageref{c45} above (which is a corollary to the first uniqueness theorem, that is to Theorem 4.5 p.~52 of the book), it suffices to show that $\ppp$ is prime, which is not hard.

\subsection{Page 56, Exercise 4.15}%

We can assume that $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ is a minimal primary decomposition, and that, setting $\ppp_i:=r(\qqq_i)$, we have $\Sigma=\{\ppp_1,\dots\ppp_m\}$. The equality $\qqq_\Sigma=S_f(\aaa)$ follows from Proposition 4.9 p.~54 of the book. Proposition 3.11ii p.~41 of the book implies $S_f(\aaa)=\bigcup_{k\ge0}(\aaa:f^k)$. We have 
\begin{equation}\label{afk}
(\aaa:f^k)=(\qqq_1:f^k)\cap\cdots\cap(\qqq_n:f^k).
\end{equation} 
Using Lemma 4.4 p.~51 we see that  

$\bu$ if $1\le i\le m$, then $(\qqq_i:f^k)=\qqq_i$,  

$\bu$ if $m+1\le i\le n$ and $k$ is large enough, then $f^k\in\qqq_i$, and thus $(\qqq_i:f^k)$ $=(1)$.

In view of \eqref{afk} this entails $(\aaa:f^k)=\qqq_\Sigma$ for $k$ large enough.

\subsection{Page 56, Exercise 4.16}%

Follows from Proposition 3.11i p.~41 and Proposition 4.9 p.~54.

\subsection{Page 56, Exercise 4.17}%https://math.stackexchange.com/q/2375591/660 - previous version https://docs.google.com/document/d/1jO2WMu4veaXNHTd_D2QJ89QwvbGW_KaqyJPpb02RU4I/edit

\subsubsection{Statement}\label{417}%Here is the statement of the exercise:

Let $A$ be a ring with the following property.

(L1) For every ideal $\mathfrak a\ne(1)$ in $A$ and every prime ideal $\mathfrak p$, there exists $x\notin\mathfrak p$ such that $S_{\mathfrak p}(\mathfrak a)=(\mathfrak a:x)$, where $S_{\mathfrak p}=A\setminus\mathfrak p$.

Then every ideal in $A$ is an intersection of (possibly infinitely many) primary ideals.

\subsubsection{First solution}%

Let $\aaa'$ be the intersection of all the primary ideals containing $\aaa$, and let's assume  
\begin{equation}\label{abs417}
\aaa<\aaa'.
\end{equation} 
It suffices to reach a contradiction.

\begin{df} 
An \emph{admissible quadruple} is a quadruple $(\bbb,\ppp,\qqq,x)$ such that 

$\bu\ \bbb$ is an ideal $\ne(1)$ in $A$, 

$\bu\ \mathfrak p$ is a minimal element of the set of prime ideals containing $\bbb$, 

$\bu\ \mathfrak q:=S_{\mathfrak p}(\bbb)$, 

$\bu\ x\in A\setminus\ppp$ satisfies $\mathfrak q=(\bbb:x)$. 
\end{df}

\begin{lem}\label{l417}
 \emph{(a)} For all $\bbb\ne(1)$ there is an admissible quadruple $(\bbb,\ppp,\qqq,x)$.

\emph{(b)} If $(\bbb,\ppp,\qqq,x)$ is an admissible quadruple, then 

\emph{(b1)} $\mathfrak q$ is $\mathfrak p$-primary, 

\emph{(b2)} $\bbb=\mathfrak q\cap(\bbb+(x))$.
\end{lem}

\begin{proof}
Part (a) follows from Assumption (L1). Part (b1) follows from Exercise 4.11 p.~56 of the book (see Section~\ref{411} p.~\pageref{411} above). Let's prove (b2). Set $\bbb':=\mathfrak q\cap(\bbb+(x))$. The inclusion $\bbb\subset\bbb'$ is obvious. To prove the other inclusion, let $\beta+ax\in\qqq$ with $\beta\in\bbb,a\in A$. It suffices to show $ax\in\bbb$. Recall that $\qqq=S_{\ppp}(\bbb)=(\bbb:x)$. As $ax\in\qqq$, we have $ax^2\in\bbb$, hence 
$$
a\in(\bbb:x^2)\subset\bigcup_{s\notin\ppp}\ (\bbb:s)=S_{\ppp}(\bbb)=(\bbb:x)
$$ 
by Proposition 3.11ii p.~41 of the book, and thus $ax\in\bbb$, as desired. 
\end{proof}

Note that we have 
$$
\bbb\subset\qqq\subset\ppp\not\ni x.
$$
Let $\kappa$ be a cardinal larger than the cardinality of $A$, and let $W$ be the set of all ordinals $\le\kappa$. We will define, by induction on $\alpha\in W$, a map 
\begin{equation}\label{e417a}
\alpha\mapsto(\aaa_\alpha,\ppp_\alpha,\qqq_\alpha,x_\alpha)
\end{equation}
from $W$ to the set of admissible quadruples, such that 

(a) $\aaa_0=\aaa$, 

(b) the map 
\begin{equation}\label{e417b}
\alpha\mapsto\aaa_\alpha\text{ is increasing,}
\end{equation} 
(c) each ordinal $\alpha\in W$ satisfies 
\begin{equation}\label{e417c}
\aaa=\aaa_\alpha\cap\bigcap_{\beta<\alpha}\qqq_\beta.
\end{equation}
\begin{df}\label{calpha}
We call \eqref{e417c} Condition $\oo C(\alpha)$. 
\end{df}

Lemma~\ref{l417}b1 will imply that $\qqq_\alpha$ is primary for all $\alpha\in W$. 

The existence of \eqref{e417a} satisfying \eqref{e417b} will give the desired contradiction.

Here is the key point:

\emph{Assume that $(\aaa_\beta,\ppp_\beta,\qqq_\beta,x_\beta)$ has been constructed for $\beta<\alpha$, and that $\aaa_\alpha$ has been defined and satisfies Condition $\oo C(\alpha)$. Then Assumption~\eqref{abs417} and Lemma~\ref{l417}b1 imply $\aaa_\alpha\ne(1)$. In particular there is, by Lemma~\ref{l417}a, an admissible quadruple} $(\aaa_\alpha,\ppp_\alpha,\qqq_\alpha,x_\alpha)$.

We embark on the construction of \eqref{e417a}.

$\bu$ The case of the zero ordinal. The ideal $\aaa_0$ is the ideal $\aaa$ given in the statement of the exercise, and we choose $\ppp_0,\qqq_0,x_0$ in such a way that $(\aaa_0,\ppp_0,\qqq_0,x_0)$ is admissible. Condition~$\oo C(0)$ holds trivially.

$\bu$ From $\alpha$ to $\alpha+1$. Let $\alpha\in W$ be such that $\alpha+1\in W$, and assume that $(\aaa_\beta,\ppp_\beta,\qqq_\beta,x_\beta)$ has already been constructed for $\beta\le\alpha$ and that Condition $\oo C(\alpha)$ holds. 

We claim: 
$$
(\aaa_\alpha+(x_\alpha))\cap\bigcap_{\beta\le\alpha}\qqq_\beta=\aaa.
$$ 
Proof of the claim: It suffices to prove the inclusion $\subset$. In view of Condition $\oo C(\alpha)$, it even suffices to prove 
$$
(\aaa_\alpha+(x_\alpha))\cap\bigcap_{\beta\le\alpha}\qqq_\beta\subset\aaa_\alpha.
$$ 
But we have 
$$
(\aaa_\alpha+(x_\alpha))\cap\bigcap_{\beta\le\alpha}\qqq_\beta\subset(\aaa_\alpha+(x_\alpha))\cap\qqq_\alpha=\aaa_\alpha.
$$ 
by Lemma~\ref{l417}b2. $\square$

By the claim, the ideal $\aaa_{\alpha+1}:=\aaa_\alpha+(x_\alpha)$ satisfies $\oo C(\alpha+1)$. In particular $\aaa_{\alpha+1}\ne(1)$ by Assumption~\eqref{abs417} and Lemma~\ref{l417}b1. We define $\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}$ in such a way that $(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})$ is admissible (see Lemma~\ref{l417}a).

% previous version: By the claim, there is an ideal $\aaa_{\alpha+1}$ containing $\aaa_\alpha+(x_\alpha)$ which is maximal subject to the constraint $\oo C(\alpha+1)$. In particular $\aaa_{\alpha+1}\ne(1)$ by Assumption~\eqref{abs417} and Lemma~\ref{l417}b1. We define $\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}$ in such a way that $(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})$ is admissible (Lemma~\ref{l417}a).

$\bu$ The case of a limit ordinal. Assume now that $\gamma\in W$ is a limit ordinal, and set 
$$
\aaa_\gamma:=\sum_{\alpha<\gamma}\aaa_\alpha=\bigcup_{\alpha<\gamma}\aaa_\alpha.
$$ 
We claim that Condition $\oo C(\gamma)$ holds.

Proof of the claim: We must show 
$$
\left(\bigcup_{\alpha<\gamma}\aaa_\alpha\right)\cap\left(\bigcap_{\beta<\gamma}\qqq_\beta\right)=\aaa.
$$ 
Inclusion $\supset$ being clear, it suffices to prove $\subset$. Let $x$ be in the left side. There is an $\alpha<\gamma$ such that 
$$
x\in\aaa_\alpha\cap\bigcap_{\beta<\gamma}\qqq_\beta\subset\aaa_\alpha\cap\bigcap_{\beta<\alpha}\qqq_\beta=\aaa.
$$ 
This proves Condition $\oo C(\gamma)$. 

In particular $\aaa_\gamma\ne(1)$. We define $\ppp_\gamma,\qqq_\gamma,x_\gamma$ in such a way that $(\aaa_\gamma,\ppp_\gamma,\qqq_\gamma,x_\gamma)$ is admissible (Lemma~\ref{l417}a).

Now the map \eqref{e417a} is defined. The map $\alpha\mapsto\aaa_\alpha$ is clearly increasing. As already indicated, this is a contradiction.

This completes the solution to Exercise 4.17. %The following variant will be used to solve Exercise 4.18.

\subsubsection{Second solution}\label{for418}%\subsection{Part 2}% previous version https://docs.google.com/document/d/1DnCzzLfgWzv6XqiA-2PiOudOTof99MIeD9ejViIJwUY/edit

The following variant of the above proof will be used to solve Exercise 4.18. %Here is a variant of the above proof.

We stop assuming \eqref{abs417}. 

Let $Q$ be the set of admissible quadruples. We define a map 
$$
f:W\to Q\cup\{\varnothing\}
$$ 
(note that the union is disjoint) as follows:

$\bu$ We assume $\aaa\ne(1)$ and define $(\aaa_0,\ppp_0,\qqq_0,x_0)$ as before, and we set 
$$
f(0):=(\aaa_0,\ppp_0,\qqq_0,x_0).
$$
$\bu$ In the passage from $\alpha$ to $\alpha+1$, we define $f(\alpha+1)$ as follows (assuming that $f(\alpha)$ has already been defined):

If $f(\alpha)=\varnothing$ we set $f(\alpha+1):=\varnothing$. 

Otherwise there is an ideal $\aaa_{\alpha+1}$ containing $\aaa_\alpha+(x_\alpha)$ which is maximal subject to the constraint $\oo C(\alpha+1)$ (see Definition~\ref{calpha} p.~\pageref{calpha}). 

If $\aaa_{\alpha+1}\ne(1)$ we define $\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}$ in such a way that 
$$
(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1})
$$ 
is admissible, as before, and we set 
$$
f(\alpha+1):=(\aaa_{\alpha+1},\ppp_{\alpha+1},\qqq_{\alpha+1},x_{\alpha+1}).
$$ 

If $\aaa_{\alpha+1}=(1)$ we set $f(\alpha+1):=\varnothing$.

$\bu$ In the case of a limit ordinal $\gamma$, we define $f(\gamma)$ as follows (assuming that $f(\alpha)$ has already been defined for $\alpha<\gamma$):

If $f(\alpha)=\varnothing$ for some $\alpha<\gamma$ we set $f(\gamma)=\varnothing$.

Otherwise we define $\aaa_\gamma$ as before.

If $\aaa_\gamma\ne(1)$ we define $\ppp_\gamma,\qqq_\gamma,x_\gamma$ in such a way that $(\aaa_\gamma,\ppp_\gamma,\qqq_\gamma,x_\gamma)$ is admissible, as before, and we set 
$$
f(\gamma):=(\aaa_{\gamma},\ppp_{\gamma},\qqq_{\gamma},x_{\gamma}).
$$ 

If $\aaa_\gamma=(1)$ we set $f(\gamma)=\varnothing$.

This ends the definition of $f$.

Then there is a least $\zeta\in W$ such that $f(\zeta)=\varnothing$, and we get 
\begin{equation}\label{abak}
\aaa=\bigcap_{\alpha<\zeta}\qqq_\alpha.
\end{equation} 
\begin{note}\label{amaa}
The map $\alpha\mapsto\aaa_\alpha$ from the set $\{\alpha\in W\ |\ \alpha\le\zeta\}$ to the set of ideals of $A$ is increasing.
\end{note} 
The following lemma will be used to solve Exercise 4.18. 
\begin{lem}\label{lasker}
The map $n\mapsto\qqq_0\cap\cdots\cap\qqq_n$ from the set $\{n\in\mathbb N\ |\ n<\zeta\}$ to the set of ideals of $A$ is decreasing.
\end{lem}
\begin{proof}
Suppose by contradiction that we have 
$$
\qqq_0\cap\cdots\cap\qqq_{n-1}=\qqq_0\cap\cdots\cap\qqq_{n-1}\cap\qqq_n
$$ 
for some $n<\zeta$. Recall that $\aaa_n$ is maximal for 
\begin{equation}\label{an}
\aaa_n\supset\aaa_{n-1}+(x_{n-1})\text{ and }\aaa=\aaa_n\cap\qqq_0\cap\cdots\cap\qqq_{n-1}.
\end{equation} 
Similarly $\aaa_{n+1}$ is maximal for 
$$%\begin{equation}\label{anp}
\aaa_{n+1}\supset\aaa_n+(x_n)\text{ and }\aaa=\aaa_{n+1}\cap\qqq_0\cap\cdots\cap\qqq_{n-1}.
$$%\end{equation} 
As $\aaa_{n+1}$ satisfies \eqref{an} and contains $\aaa_n$, these two ideals coincide, in contradiction with Note~\ref{amaa}. 
\end{proof}

\subsection{Page 57, Exercise 4.18}%%

\subsubsection{Statement}%

Consider the following condition on a ring $A$:

(L2) Given an ideal $\mathfrak a$ and a descending chain 
$$
S_1\supset S_2\supset\cdots\supset S_n\supset\cdots
$$ 
of multiplicatively closed subsets of $A$, there exists an integer $n$ such that $S_n(\mathfrak a)=S_{n+1}(\mathfrak a)=\cdots$. %[Here $X\supset Y$ means that $Y$ is a (not necessarily proper) subset of $X$.]

Prove that the following are equivalent:

(i) Every ideal in $A$ has a primary decomposition;

(ii) A satisfies (L1) and (L2).

[See Section~\ref{417} p.~\pageref{417} for the definition of (L1).]

\subsubsection{Solution}%

(i)$\implies$(L1): Let $\aaa=\qqq_1\cap\cdots\cap\qqq_n$ be a minimal primary decomposition. Set $\ppp_i:=r(\qqq_i)$ and let $\ppp$ be a prime ideal. We can assume that $\ppp_i\subset\ppp$ if and only if $i\le m$. Proposition 4.9 p.~54 of the book entails $S_\ppp(\aaa)=\qqq_1\cap\cdots\cap\qqq_m$. For $m+1\le i\le n$ there is an element $x_i$ which is in $\qqq_i$ but not in $\ppp$. Then $x:=x_{m+1}\cdots x_n$ is in $\qqq_{m+1}\cap\cdots\cap\qqq_n$ but not in $\ppp$, and we get 
$$
(\aaa:x)
$$
$$
\begin{matrix}
=&(\qqq_1:x)\cap\cdots\cap(\qqq_m:x)&\cap&(\qqq_{m+1}:x)\cap\cdots\cap(\qqq_n:x)\\ \\ 
=&\qqq_1\cap\cdots\cap\qqq_m&\cap&(1)\cap\cdots\cap(1)
\end{matrix}
$$
$$
=\qqq_1\cap\cdots\cap\qqq_m=S_\ppp(\aaa),
$$ 
the second equality following from Lemma 4.4 p.~51 of the book.

(i)$\implies$(L2): Follows from Proposition 4.9 p.~54 of the book.

(ii)$\implies$(i): %I haven't been able to prove that. Here is what I've done so far:
Consider the map 
$$
\alpha\mapsto(\aaa_\alpha,\ppp_\alpha,\qqq_\alpha,x_\alpha)
$$
from $W$ to the set of admissible quadruples defined in Section~\ref{for418} above, and let $\zeta$ be defined as in \eqref{abak}. 

It suffices to show that $\zeta$ in finite. 

Assume by contradiction that $\zeta$ is infinite.

Recall that \eqref{e417c} is called Condition $\oo C(\alpha)$, and that $\qqq_\alpha$ is primary for all $\alpha<\zeta$. For the reader's convenience let's rewrite $\oo C(\alpha)$:
$$
\aaa=\aaa_\alpha\cap\bigcap_{\beta<\alpha}\qqq_\beta.
$$ 
This holds for all $\alpha<\zeta$.

Setting $S_n:=S_{\ppp_0}\cap\cdots\cap S_{\ppp_n}$ for $n\in\mathbb N$, we get, in view of $\oo C(n+1)$ and Exercise 4.12i p.~56 of the book,
$$
S_n(\aaa)=S_n(\aaa_{n+1})\cap S_n(\qqq_0\cap\cdots\cap\qqq_n).
$$ 
We claim $S_n(\aaa_{n+1})=(1)$, and thus $S_n(\aaa)=S_n(\qqq_0\cap\cdots\cap\qqq_n)$.

To prove this it suffices to show $S_n\cap\aaa_{n+1}\ne\varnothing$. Assume by contradiction $S_n\cap\aaa_{n+1}=\varnothing$, that is $\aaa_{n+1}\subset\ppp_0\cup\cdots\cup\ppp_n$. Then Proposition 1.11i p.~8 of the book implies $\aaa_{n+1}\subset\ppp_i$ for some $0\le i\le n$. This yields $x_i\in\aaa_{i+1}\subset\aaa_{n+1}\subset\ppp_i$, a contradiction. This proves the equality $S_n(\aaa_{n+1})=(1)$.

Proposition 4.9 p.~54 of the book implies 
$$
S_n(\qqq_0\cap\cdots\cap\qqq_n)=\bigcap_{S_n\cap\ppp_i=\varnothing}\qqq_i=\qqq_0\cap\cdots\cap\qqq_n,
$$ 
and we get
$$
S_n(\aaa)=\qqq_0\cap\cdots\cap\qqq_n.
$$ 
Now (L2) and Lemma~\ref{lasker} give the desired contradiction.
%\label{lasker}
%The map $n\mapsto S_n(\aaa)$ taking only finitely many values by Assumption (L2),%Proposition 4.9 p.~54 of the book, %there is an $n\in\mathbb N$ such that 
%By Assumption (L2) there is an $n\in\mathbb N$ such that $$\aaa=\qqq_0\cap\cdots\cap\qqq_n\cap\bigcap_{\omega\le\alpha<\zeta}\qqq_\alpha.$$ Of course if there are only finitely many ordinals between $\omega$ and $\zeta$, the proof is complete; but if there are infinitely many such ordinals, I'm stuck...
%For all $\alpha\le\kappa$ set $$\bbb_\alpha:=\bigcap_{\beta<\alpha}\qqq_\beta.$$ Then (L2) implies that there is some $n\in\mathbb N$ such that $\bbb_\alpha=\bbb_n$ for $n\le\alpha\le\kappa$. (???!!!) (We assume, with no loss of generality, that $\kappa$ is infinite.) Now \eqref{abak} implies $\aaa=\bbb_\kappa=\bbb_n$, showing that $\aaa$ admits a primary decomposition.

\subsection{Page 57, Exercise 4.19}%\label{310ii}%

Statement:

Let $A$ be a ring and $\mathfrak p$ a prime ideal of $A$. Show that every $\mathfrak p$-primary ideal contains $S_{\mathfrak p}(0)$, the kernel of the canonical homomorphism $A\to A_{\mathfrak p}$.

Suppose that $A$ satisfies the following condition: for every prime ideal $\mathfrak p$, the intersection of all $\mathfrak p$-primary ideals of $A$ is equal to $S_{\mathfrak p}(0)$. (Noetherian rings satisfy this condition: see Chapter 10\footnote{See Corollary 10.21 p.~111 of the book.}.) Let $\mathfrak p_1,\dots,\mathfrak p_n$ be distinct prime ideals, none of which is a minimal prime ideal of $A$. Then there exists an ideal $\mathfrak a$ in $A$ whose associated prime ideals are $\mathfrak p_1,\dots,\mathfrak p_n$.

[Proof by induction on $n$. The case $n=1$ is trivial (take $\mathfrak a=\mathfrak p_1$). Suppose $n>1$ and let $\mathfrak p_n$ be maximal in the set $\{\mathfrak p_1,\dots,\mathfrak p_n\}$. By the inductive hypothesis there exists an ideal $\mathfrak b$ and a minimal primary decomposition $\mathfrak b=\mathfrak q_1\cap\dots\cap\mathfrak q_{n-1}$, where each $\mathfrak q_i$ is $\mathfrak p_i$-primary. If $\mathfrak b\subset S_{\mathfrak p_n}(0)$ let $\mathfrak p$ be a minimal prime ideal of $A$ contained in $\mathfrak p_n$. Then $S_{\mathfrak p_n}(0)\subset S_{\mathfrak p}(0)$, hence $\mathfrak b\subset S_{\mathfrak p}(0)$. Taking radicals and using Exercise 10, we have $\mathfrak p_1\cap\dots\cap\mathfrak p_{n-1}\subset\mathfrak p$, hence some $\mathfrak p_i\subset \mathfrak p$, hence $\mathfrak p_i=\mathfrak p$ since $\mathfrak p$ is minimal. This is a contradiction since no $\mathfrak p_i$ is minimal. Hence $\mathfrak b\not\subset S_{\mathfrak p}(0)$ and therefore there exists a $\mathfrak p_n$-primary ideal $\mathfrak q_n$ such that $\mathfrak b\not\subset\mathfrak q_n$. Show that $\mathfrak a=\mathfrak q_1\cap\dots\cap\mathfrak q_n$ has the required properties.]

End of the statement.

The following argument was explained to me by user withoutfeather over on Mathematics Stackexchange: 

\href{https://math.stackexchange.com/a/3338211/660}{https://math.stackexchange.com/a/3338211/660}

Assume that $\mathfrak{a}=\mathfrak{q}_1\cap \cdots \cap \mathfrak{q}_n$ is \textbf{not} reduced. %a minimal primary decomposition. 

Since $\mathfrak{q}_n\not \supset \mathfrak{q}_1\cap \cdots \cap \mathfrak{q}_n$, there is an index $i$ with $1\leq i\leq n-1$ such that $\mathfrak{q}_i$ contains the intersection of the other $\qqq_j$. We can assume that $i=1$, i.e. 
$$
\mathfrak{q}_1\supset \mathfrak{q}_2\cap \cdots \cap\mathfrak{q}_n.
$$ 
By induction hypothesis, $\mathfrak{q}_1\not \supset \mathfrak{q}_2\cap \cdots \cap\mathfrak{q}_{n-1}$, so there exists 
$$
x\in(\mathfrak{q}_2\cap \cdots \cap\mathfrak{q}_{n-1})\setminus\mathfrak{q}_1.
$$ 
On the other hand, we have $\mathfrak{p}_1=r(\mathfrak{q}_1)\not \supset \mathfrak{q}_n$. Indeed, $\mathfrak{p}_1\supset \mathfrak{q}_n$ would imply $\mathfrak{p}_1\supset \mathfrak{p}_n$ and, since $\mathfrak{p}_n$ is maximal in $\{\mathfrak{p}_1,\dots,\mathfrak{p}_n\}$, we would have $\mathfrak{p}_1=\mathfrak{p}_n$, a contradiction. Hence there exists 
$$
y\in\mathfrak{q}_n\setminus\mathfrak{p}_1.
$$ 
%$y\in\mathfrak{q}_n$ such that $y\notin\mathfrak{p}_1$.
Then the product $xy$ is in $\mathfrak{q}_2\cap \cdots \cap \mathfrak{q}_n\subset\mathfrak{q}_1$. But this is impossible since $x$ is not in $\ppp_1$ and $y$ is not in $\qqq_1$. %Since $\mathfrak{q}_1$ is $\mathfrak{p}_1$-primary, so either $x\in \mathfrak{q}_1$ or $y\in \mathfrak{p}_1$. But by construction of $x$ and $y$, this is not the case.

\section{About Chapter 5}%%%

\subsection{Page 61, Corollary 5.9}\label{59}%

Here is a slightly stronger statement: 

\emph{Let $A$ be a subring of a ring $B$ such that $B$ is integral over $A$; let $\mf q,\mf b$ be ideals of $B$ such that $\mf q$ is prime, $\mf q\subset\mf b$ and $\mf q^{\oo c}=\mf b^{\oo c}=\ppp$ say. Then $\mf q=\mf b$.}

Proof. Arguing as in the book, we see that $\ppp_\ppp\subset A_\ppp$ and $\mf q_\ppp\subset B_\ppp$ are maximal, and that we have $\mf q_\ppp\subset\mf b_\ppp\subset B_\ppp$. Proposition 3.11ii p.~41 of the book implies $\mf b_\ppp\ne B_\ppp$, and thus $\mf q_\ppp=\mf b_\ppp$. If $b$ is in $\mf b$, we get $b/1=q/s$ for some $q$ in $\mf q$ and some $s$ in $A\setminus\ppp$, then $tb\in\mf q$ for some $t$ in $A\setminus\ppp$, and thus $b\in\mf q$.

\subsection{Page 62, proof of Corollary 5.9}%

Let $A\subset B$ be rings, let $\mf q$ be a prime ideal of $B$ and set $\ppp:=A\cap\mf q$:
$$
\begin{tikzcd}
A\ar[d,"\alpha"']\ar[r,hook]&B\ar[d,"\beta"]\\ 
A_\ppp\ar[r,hook]&B_\ppp.
\end{tikzcd}
$$
Then Corollary 3.4ii p.~39 of the book implies $A_\ppp\cap\mf q_\ppp=\ppp_\ppp$.
%We claim $A_\ppp\cap\mf q_\ppp=\ppp_\ppp$. Set $S:=A\setminus\ppp$. As $S\cap\mf q=S\cap A\cap\mf q=S\cap\ppp=\varnothing$, we see that $\mf q_\ppp$ is prime, and it suffices to show $\ppp_\ppp\subset\mf q_\ppp$, which is clear.

\subsection{Page 62, Theorem 5.10}%

Let $\mf b$ be an ideal of $B$, let $\mf a$ be its contraction in $A$, and assume $\mf a\subset\ppp$. Then it is easy to see that $\mf q$ can be chosen among the prime ideals of $B$ containing $\mf b$.

\subsection{Page 62, dim A = dim B}%

\emph{If $A\subset B$ is an integral extension, then we have $\dim A=\dim B$.}

More precisely, we have $\dim A\ge\dim B$ by Corollary 5.9 p.~61 and $\dim A$ $\le$ $\dim B$ by Theorem 5.11 p.~62.

\subsection{Page 62, integrally closed domain}%

Here is an example of a domain which is \emph{not} integrally closed. Let $k$ be a field, let $X$ be an indeterminate and set $A:=k[X^2,X^3]\subset k[X]$. Then $X$ is in the field of fractions of $A$, and is integral over $A$, but is not in $A$.

\subsection{Page 63}%

If $A\subset D$ are domains, and if $\mf a$ is an ideal of $A$, then we denote the extension of $\mf a$ in $D$ by $D\,\mf a$, and the integral closure of $\mf a$ in $D$ by $D*\mf a$. 

Lemma 5.14 says
\begin{equation}\label{514}
D*\mf a=r\Big((D*A)\,\mf a\Big).
\end{equation}
In particular $D*\mf a$ is an ideal of $D*A$. 

In the proof of Proposition 5.15, we have the inclusions $\mf a\subset A\subset L$. Let 
$$
X^m+a_1X^{m-1}+\cdots+a_m
$$ 
be the minimal polynomial of $x$ over $K$. Each $a_j$ being in the ideal $(x_1,\dots,x_n)$ of $L*A$ generated by the $x_i$, and each $x_i$ being in the set $L*\mf a$, which is an ideal of $L*A$ by \eqref{514}, we get 
$$
a_j\in(L*\mf a)\cap K=K*\mf a=r\Big((K*A)\,\mf a\Big)=r(A\,\mf a)=r(\mf a)
$$ 
for all $j$ (the second equality following from \eqref{514}).

\subsection{Page 64, proof of Theorem 5.16}%

Last line of the first paragraph of the proof: It suffices to show $B_{\mf q_1}\ppp_2\cap A\subset\ppp_2$.

\subsection{Page 65}%

Sentence

The conditions of Zorn's lemma are clearly satisfied and therefore the set $\Sigma$ has at least one maximal element.

I would change this to 

Assuming the set $\Sigma$ is nonempty, the conditions of Zorn's lemma are clearly satisfied and therefore $\Sigma$ has at least one maximal element.

\subsection{Page 66, proof of Corollary 5.22}%

Sentences

Then the restriction to $A$ of the natural homomorphism $A'\to k'$ defines a homomorphism of $A$ into $\Omega$. By (5.21) this can be extended to some valuation ring $B\supseteq A$.

I would change this to 

Then the restriction to $A$ of the natural homomorphism $A'\to k'$ defines a homomorphism of $A'$ into $\Omega$. By (5.21) this can be extended to some valuation ring $B\supseteq A'$.

Also, it would be slightly better to change ``let $x\notin\overline A$'' to ``let $x\in K\setminus\overline A$'' on the third line of the proof.%\bigskip

\subsection{Page 67, Exercise 5.2}\label{67}%

Set $\ppp:=\oo{Ker}f$ and let $\mf q\subset B$ be given by Theorem 5.10 p.~62. Our problem can be summarized as follows: 
$$
\begin{tikzcd}
A/\ppp\ar[r,tail]\ar[d,tail]&B/\mf q\ar[dl,dashrightarrow]\\ 
\Omega.
\end{tikzcd}
$$ 
Writing $K$ and $L$ for the respective fields of fractions of $A/\ppp$ and $B/\mf q$, our problem becomes  
$$
\begin{tikzcd}
K\ar[r,tail]\ar[d,tail]&L\ar[dl,dashrightarrow]\\ 
\Omega.
\end{tikzcd}
$$ 
As $L/K$ is algebraic and $\Omega$ algebraically closed, this problem has a solution.

\subsection{Page 67, Exercise 5.3}%

\subsubsection{Solution}

Set $D:=(f\otimes1)(B\otimes_AC)$ and let $E$ be the integral closure of $D$ in $B'\otimes_AC$. We have $1\otimes c\in D\subset E$ for $c\in C$ and it is easy to see that $b'\otimes1\in E$ for $b'\in B'$. Then $E$ contains $b'\otimes c$ for $b'\in B',c\in C$, hence $E$ contains $B'\otimes_AC$.

\subsubsection{A more general question}%\label{53}

Let $C\leftarrow A\to B\to B'$ be morphisms of rings. In this section tensor products are taken over $A$, and $\overline{X\ }^Y$ means ``integral closure of $X$ in $Y$''. 

The purpose of this section is to show that the morphism 
$$
\overline{B\ }^{B'}\otimes C\to\overline{B\otimes C\ }^{B'\otimes C}
$$ 
induced by the natural morphism $\overline{B\ }^{B'}\otimes C\to B'\otimes C$ is not always surjective. 

Let $K$ be a field of characteristic $\ne2$ and $x$ an indeterminate, and set 
$$
A:=K[x^2],\qquad B:=K\left[x^2,x\sqrt{x^2-1}\right],
$$
$$
B':=K\left(x^2,x\sqrt{x^2-1}\right),\qquad C:=K[x].
$$ 
We claim 
$$
B'':=\overline{K\left[x^2,x\sqrt{x^2-1}\right]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)}=K\left[x^2,x\sqrt{x^2-1}\right].
$$ 
Note that 
$$
B''\cap K(x^2)=K[x^2].
$$ 
%$$B''=\overline{K\left[x^2\right]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)}.$$
To prove the claim, let $u$ be in $B''$. We can write 
$$
u=f(x^2)+x\sqrt{x^2-1}\ g(x^2)
$$ 
with $f(x^2),g(x^2)\in K(x^2)$. It suffices to check that $f(x^2)$ and $g(x^2)$ are in $K[x^2]$, or equivalently, that they are in $B''$. We have 
$$
v:=f(x^2)-x\sqrt{x^2-1}\ g(x^2)\in B'',
$$ 
and we successively see that the following elements of $K(x^2)$ are in $K[x^2]$: 
$$
\frac{u+v}2=f(x^2),
$$ 
$$
uv=f(x^2)^2-x^2(x^2-1)\ g(x^2)^2,
$$ 
$$
x^2(x^2-1)\ g(x^2)^2.
$$ 
As $x^2(x^2-1)$ is square-free in $K[x^2]$, we conclude that $g(x^2)$ is also in $K[x^2]$. This completes the proof of the claim. 

Using the claim we get firstly
$$
\overline{B\ }^{B'}\otimes C=\overline{K\left[x^2,x\sqrt{x^2-1}\right]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)}\otimes K[x]
$$
$$
=K\left[x^2,x\sqrt{x^2-1}\right]\otimes K[x]\simeq K\left[x,x\sqrt{x^2-1}\right],
$$ 
and secondly 
$$ 
\overline{B\otimes C\ }^{B'\otimes C}=\overline{K\left[x^2,x\sqrt{x^2-1}\right]\otimes K[x]\ }^{K\left(x^2,x\sqrt{x^2-1}\right)\otimes K[x]}
$$
$$
\simeq\overline{K\left[x,x\sqrt{x^2-1}\right]\ }^{K\left(x,\sqrt{x^2-1}\right)}\subset K\left(x,\sqrt{x^2-1}\right).
$$ 
The element 
$$
\sqrt{x^2-1}\in K\left(x,\sqrt{x^2-1}\right)
$$ 
is integral over $K\left[x,x\sqrt{x^2-1}\right]$, but does \emph{not} belong to this ring.

In fact $K\left[x,\sqrt{x^2-1}\right]$ is integrally closed, and thus Dedekind.

\begin{comment}
For any morphism of rings $g:A_1\to A_2$ write $\oo{IC}_{A_2}(A_1)$ for the integral closure of $A_1$ in $A_2$. Then we have, in the setting of Exercise 5.3, 
$$
\oo{IC}_{B'\otimes C}(B\otimes C)=(i\otimes1)(\oo{IC}_{B'}(B)\otimes C),
$$ 
where the tensor products are taken over $A$ and the morphism $i$ is the inclusion of $\oo{IC}_{B'}(B)$ into $B'$.

In particular, if $\phi:A\to B$ is a morphism of rings and $x$ an indeterminate, then we get 
$$
\oo{IC}_{B[x]}(A[x])=\oo{IC}_B(A)[x].
$$ 
Indeed we have $A[x]=A\otimes_{\mathbb Z}\mathbb Z[x]$, and similarly for $B$.
\end{comment}

\subsection{Page 67, Exercise 5.6}%

It suffices to show that $(0,\dots,0,b_i,0,\dots,0)$ is integral over $A$, which is easy.

\subsection{Page 68, Exercise 5.10}%

It is easy to show that (a) implies (c), and that (b) and (c) are eqivalent.

\subsection{Page 69, Exercise 5.16, NNT}\label{nnt}%

NNT stands for Noether Normalization Theorem.

The purpose of this section is to review the following closely related statements: Noether's Normalization Theorem, Zariski's Lemma, the Weak Nullstellensatz and the Nullstellensatz.

\textbf{\Large Noether Normalization Theorem}

Before proceeding, it might be useful to spell out a fact which is proved but, it seems to me, not stated explicitly in the book:

$(\star)$ \emph{Let $A\subset B$ be rings such that $B$ is finitely generated as an $A$-algebra. Then $B$ is finitely generated as an $A$-module if and only if it is integral over $A$.}

Recall the general notation $A_s:=A[s^{-1}]$.%

\textbf{Noether Normalization Theorem.} \emph{Let $A\subset B$ be an inclusion of nonzero rings such that $B$ a finitely generated $A$-algebra. Then there exist a nonzero element $s$ in $A$, a nonnegative integer $n$, and elements $x_1,\dots,x_n$ in $B_s$ which are algebraically independent over $A_s$, such that $B_s$ is a finitely generated module over} 
$$
A_s[x_1,\dots,x_n].
$$ 
\begin{proof} 
Let $y_1,\dots,y_m\in B$. Assume that $B=A[\,y_1,\dots,y_m]$. We argue by induction on $m$. If $m=0$ or if the $y_i$ are algebraically independent over $A$, there is nothing to prove, so that we can assume that $m\ge1$, that the statement holds with $m$ replaced by $m-1$, and that there is a non-constant polynomial $f\in A[Y_1,\dots,Y_m]$, where the $Y_i$ are indeterminates, such that $f(\,y_1,\dots,y_m)=0$. Let $r$ be an integer larger than the degree of $f$. 

We claim that there is a nonzero $t$ in $A$ such that $B_t$ is finitely generated as a module over 
$$
C:=A_t\left[\,y_2-y_1^r,\dots,y_m-y_1^{r^{m-1}}\right].
$$ 
It suffices to show that $B_t$ is integral over $C$. As $B_t=C[\,y_1]$, it is enough to prove that $y_1$ is integral over $C$. In fact, we only need to check that 

$(\star)$ There is a nonzero $t$ in $A$, an integer $d\ge1$, and a 
$$
g\in\bigg(A\left[Y_2-Y_1^r,\dots,Y_m-Y_1^{r^{m-1}}\right]\bigg)[Y_1]
$$ 
of degree less than $d$, such that $f=tY_1^d+g$. 

If, for any monomial $u\in A[Y_1,\dots,Y_m]$ occurring in $f$ (with a nonzero coefficient), we denote by $u'$ the monomial $u$ \emph{viewed as a polynomial in the ring} 
$$
\bigg(A\left[Y_2-Y_1^r,\dots,Y_m-Y_1^{r^{m-1}}\right]\bigg)[Y_1],
$$ 
then $(\star)$ follows immediately from 

$(\star\star)$ The polynomial $u'$ is monic. Moreover, if $u$ and $v$ are two distinct such monomials, then we have $\deg(u')\ne\deg(v')$.

In fact, if $u=Y_1^{\alpha_1}\cdots Y_m^{\alpha_m}$, then $u'$ is monic of degree 
$$
\alpha_1+\alpha_2r+\cdots+\alpha_mr^{m-1}.
$$ 
So, we have proved that there exist a nonzero $t$ in $A$ and elements $z_1$, \dots, $z_{m-1}$ in $B$ such that $B_t$ is a finitely generated $A_t[z_1,\dots,z_{m-1}]$-module. 

We can assume that $A_t$ is nonzero. By the inductive hypothesis applied to the inclusion 
$$
A_t\subset A_t[z_1,\dots,z_{m-1}],
$$ 
there exist a nonzero element $u$ in $A_t$, a nonnegative integer $n$, and elements $x_1$, \dots, $x_n$ in 
$$
A_t[z_1,\dots,z_{m-1}]_u=(A_t)_u[z_1,\dots,z_{m-1}]
$$ 
which are algebraically independent over $(A_t)_u$, such that 
$$
(A_t)_u[z_1,\dots,z_{m-1}]
$$ 
is a finitely generated $(A_t)_u[x_1,\dots,x_n]$-module. Now $u=v/t^i$ for some nonzero $v$ in $A$ and some integer $i\ge0$, and we have $(A_t)_u=A_{tv}$. Setting $s:=tv$, we see that $s\ne0$, and we get elements $x_1$, \dots, $x_n$ in 
$
A_s[z_1,\dots,z_{m-1}]
$ 
which are algebraically independent over $A_s$, such that 
$
A_s[z_1,\dots,z_{m-1}]
$ 
is a finitely generated $A_s[x_1,\dots,x_n]$-module. Recall that $B_t$ is a finitely generated $A_t[z_1,\dots,z_{m-1}]$-module. Therefore $B_s$ is a finitely generated $A_s[z_1,\dots,z_{m-1}]$-module, which is itself, as we have just seen, a finitely generated $A_s[x_1,\dots,x_n]$-module. This implies that $B_s$ is a finitely generated $A_s[x_1,\dots,x_n]$-module,  as desired.
\end{proof} 
% https://docs.google.com/document/d/1oTZtahmZAPeNJrbs65b2IzgWHBKkWBjzasbWtsHpWDA/edit old versions
%[Added later: An approach which I find better is expounded in Mel Hochster, Noether normalization and Hilbert’s Nullstellensatz, \href{http://www.math.lsa.umich.edu/~hochster/615W10/supNoeth.pdf}{http://www.math.lsa.umich.edu/$\sim$hochster/615W10/supNoeth.pdf}\ ]

Here is a statement of Zariski's Lemma:

(ZL)\emph{Let $k$ be a field, $A$ a finitely generated $k$-algebra. Let $\mf m$ be a maximal ideal of $A$. Then the field $A/\mf m$ is a finite algebraic extension of $k$. In particular, if $k$ is algebraically closed then $A/\mf m\simeq k$, that is, the natural morphism $k\to A/\mf m$ is an isomorphism.}

In view of Proposition 5.7 p.~61 of the book, Zariski's Lemma follows immediately from Noether's Normalization Theorem. %In view of Proposition 5.7 p.~61 of the book, Zariski's \- Lemma follows immediately from Noether's Normalization Theorem.

Here is an easy consequence of (ZL):

(ZL2) \emph{Set $A:=k[t_1,\dots,t_n]$ where $k$ is an algebraically closed field and the $t_i$ are indeterminates, let $\mf m$ be a maximal ideal of $A$, let} 
$$
k\xrightarrow\iota A\xrightarrow{\pi}A/\mf m
$$ 
\emph{be the canonical morphisms, and set $x_i:=(\pi\circ\iota)^{-1}(\pi(t_i))$ (recall that $\pi\circ\iota$ is bijective). Then we have} 
$$
\mf m=(t_1-x_1,\dots,t_n-x_n)
$$ 
\emph{and} 
$$
(\pi\circ\iota)^{-1}(\pi(f))=f(x)
$$ 
\emph{(with $x:=(x_1,\dots,x_n)$) for all $f$ in $A$. In particular} 
$$
\mf m=\{f\in A\ |\ f(x)=0\}.
$$

The detailed proof of (ZL2) is left to the reader.

The Nullstellensatz is stated in Exercise 14 of Chapter 7 as follows:

(N) \emph{Let $k$ be an algebraically closed field, let $A$ denote the polynomial ring $k[t_1,\dots,t_n]$ and let $\mf a$ be an ideal in $A$. Let V be the variety in $k^n$ defined by the ideal $\mf a$, so that $V$ is the set of all $x=(x_1,\dots,x_n)\in k^n$ such that $f(x)=0$ for all $f\in\mf a$. Let $I(V)$ be the ideal of $V$, i.e. the ideal of all polynomials $g\in A$ such that $g(x)=0$ for all $x\in V$. Then $I(V)=r(\mf a)$.}

\begin{proof} 
The inclusion $r(\mf a)\subset I(V)$ is clear. Let's prove $I(V)\subset r(\mf a)$. 

(ZL2) implies that $I(V)$ is the intersection of all the maximal ideals of $A$ containing $\mf a$. As $r(\mf a)$ is the intersection of all the prime ideals of $A$ containing $\mf a$, we can assume that $\mf a$ is a prime ideal $\ppp$. Then the statement follows immediately from Exercises 5.23 and 5.24 p.~71 of the book. Here is a slightly different argument:

Let $f$ be in $A\setminus\ppp$ and set $A_f:=A[1/f]$.

It suffices to prove the claim below.

Claim: There is a maximal ideal of $A$ which doesn't contain $f$. 

We give two proofs of the claim.

Proof 1. The extension $\ppp^{\oo e}$ of $\ppp$ in $A_f$ being clearly a proper ideal, there is a maximal ideal $\mf m\subset A_f$ containing $\ppp^{\oo e}$. 

Note successively that $f\notin\mf m$; that $\mf q:=\mf m\cap A$ is a prime ideal of $A$ which doesn't contain $f$; that $A_f/\mf m$ is isomorphic to $k$ by (ZL); and that the monomorphism of $k$-algebras $0\ne A/\mf q\mono A_f/\mf m\simeq k$ implies that $\mf q$ is a maximal ideal of $A$.

Proof 2. By Noether Normalization Theorem applied to the $k$-algebra $A_f$, there are elements $u_1,\dots,u_m$ of $A_f$ which are algebraically independent over $k$, such that $A_f$ is integral over $k[u_1,\dots,u_m]$. By Exercise 5.2 %Theorem 5.10 
p.~67 of the book (see Section~\ref{67} p.~\pageref{67} above) the $k$-algebra morphism $\varphi:k[u_1,\dots,u_m]\to k$ which maps $u_i$ to $0$ extends to a $k$-algebra morphism $\Phi:A_f\to k$. As $\Phi(f)\ne0$, we see that $A\cap\oo{Ker}\Phi$ is a maximal ideal of $A$ which doesn't contain $f$.
\end{proof}
%https://docs.google.com/document/d/1YYUDEGhoImy-b_Lx9foGoetelzzXbN1IiNbpo7pXh98/edit {comment} 180522
%The assumption that $B$ is a domain (instead of an arbitrary ring) is not used. For another approach, see the following reference (already given in Section~\ref{nnt} p.~\pageref{nnt}): Mel Hochster, Noether normalization and Hilbert’s Nullstellensatz, \href{http://www.math.lsa.umich.edu/~hochster/615W10/supNoeth.pdf}{http://www.math.lsa.umich.edu/$\sim$hochster/615W10/supNoeth.pdf}

\subsection{Page 69, Exercise 5.17}%

%As observed by the Mathematics Stackexchange user Kato here \href{https://math.stackexchange.com/q/2808775/660}{https://math.stackexchange.com/q/2808775/660} t
The Weak Nullstellensatz is the statement
$$
\mf a\ne(1)\implies V(\mf a)\ne\varnothing.
$$ 
It is \emph{not} the trivial statement 
$$
I(X)\ne(1)\implies X\ne\varnothing.
$$

\subsection{Page 70, Exercise 5.22}% 

We have $k\subset g(B)\subset\Omega$. By Proposition 5.7 p.~71 of the book, $g(B)$ is a field.

\subsection{Page 71, Exercise 5.24}%

Here is a partial solution. Let's prove 

\emph{If $A\subset B$ is an integral extension of rings and if $A$ is Jacobson, then $B$ is Jacobson.}

Proof. By Theorem 5.10 p.~62 of the book we can assume that $B$ is a domain. Let $\mf b\subset B$ be the Jacobson radical of $B$. It suffices to prove $\mf b=(0)$.

Claim: $\mf b^{\oo c}=(0)$. 

Proof of the claim. By contradiction let $0\ne a\in\mf b^{\oo c}$, and let $\mf m$ be a maximal ideal of $A$ avoiding $a$. By Theorem 5.10 p.~62 of the book, there is a prime ideal $\mf n$ of $B$ such sitting above $\mf m$. Then $\mf n$ is maximal by Corollary 5.8 p.~61 of the book, and $a\in\mf n\cap A=\mf m$, a contradiction.

In view of the version of Corollary 5.9 p.~61 of the book proved in Section~\ref{59} p.~\pageref{59}, the claim implies $\mf b=(0)$.

\section{About Chapter 6}%%

\subsection{Jordan-Hölder Theorem}%

The following proof is taken from Jeffrey Daniel Kasik Carlson's text cited at the beginning of the present text. 

Consider an $A$-module $M$ of finite length. Proposition 6.7 p.~77 of the book says that all composition series of $M$ have the same length, and the book claims (p. 77) that the multiset of isomorphism classes of quotients of successive terms is the same for any choice of composition series. The proof, it goes on, is the same as for finite groups. We recall it here.

The proof proceeds by induction on the length $\ell(M)$ of $M$. If $\ell(M)=0$ or $1$, we are done. Assume inductively that the result holds for all modules of length $n$, and let $\ell(M)=n+1$. Assume $M$ has the two composition series 
$$
M=M_0>M_1>\cdots>M_{n+1}=0,\quad M=N_0>N_1>\cdots>N_{n+1}=0.
$$
If $M_1=N_1$, then by the inductive hypotheses the multisets 
$$
S=\{[M_i/M_{i+1}]\}_{i=1}^n\text{ and }T=\{[N_i/N_{i+1}]\}_{i=1}^n
$$ 
of quotients are equal, so, since $M/M_1=M/N_1$, the quotient multisets of the two composition series for $M$ are equal.

If $M_1\ne N_1$, let $P_1:=M_1\cap N_1$. Note that $M_1<M_1+N_1\subset M$, so, since $M/M_1$ was assumed simple, $M_1+N_1=M$. Now 
$$
M_1/P_1 = M_1/(M_1\cap N_1)\simeq(M_1+N_1)/N_1=M/N_1
$$ 
by the second isomorphism theorem (Proposition 2.1.ii p.~19 of the book), and this quotient is simple. Symmetrically, $N_1/P_1\simeq M/M_1$. By the proof of Proposition 6.7 p.~77 of the book, $\ell(P_1)\le\ell(M_1)=n$ is finite, so $P_1$ has a composition series $P_1>P_2>\cdots>P_p=0$. Write $U$ for the quotient multiset. Then $M_1>P_1>\cdots>P_p=0$ is a composition series for $M_1$. Since $\ell(M_1)=n$, we have $p = n$, and by the induction hypothesis, the multiset  
$$
\{[M_1/P_1]\}\cup U =\{[M/N_1]\}\cup U
$$ 
is the same as the multiset $S=\{[M_i/M_{i+1}]\}_{i=1}^n$. Then the quotient multiset for the $M_i$ composition series of $M$ is 
$$
\{[M/M_1]\}\cup S=\{[M/M_1],[M/N_1]\}\cup U.
$$ 
Similarly $N_1>P_1>\cdots>P_p=0$ is a composition series for $N_1$ with quotient multiset $\{[N_1/P_1]\}\cup U=\{[M/M_1]\}\cup U$, by inductive assumption equal to the multiset 
$$
T:=\{[N_i/N_{i+1}]\}_{i=1}^n.
$$ 
Then the $N_i$ composition series for $M$ yields the quotient multiset 
$$
\{[M/N_1]\}\cup T=\{[M/N_1],[M/M_1]\}\cup U
$$ 
as well.

\section{About Chapter 7}%%

\subsection{Page 80, a remark}%

Here is an example of a descending chain $A_0\supset A_1\supset\cdots$ such that each $A_n$ is noetherian but the intersection is not.

Consider the submonoid $M_n$ of $\mathbb N^2$ defined by 
$$
M_n:=\{a\in\mathbb N^2\ |\ a_2\ge1\ \lor\ a_1\ge n\}\supset M_{n+1},
$$ 
note that we have $M_n\supset M_{n+1}$, and that 
$$
M:=\bigcap_n\ M_n=\{a\in\mathbb N^2\ |\ a_2\ge1\}
$$ 
is \emph{not} finitely generated. Observe that the finite set 
$$
G_n:=\{(n,0),(n+1,0),\dots,(2n-1,0),(0,1),(1,1),(2,1),\dots,(n-1,1)\}\subset M_n
$$ 
generates $M_n$. 

Here is a picture for $n=3$: The black dots are the points of $G_3$, the white dots are the points on $M_3\setminus G_3$, the crosses are the points in $\mathbb N^2\setminus M_3$.
$$
\begin{matrix}
2&\circ&\circ&\circ&\circ&\circ&\circ&\circ\\ 
1&\bullet&\bullet&\bullet&\circ&\circ&\circ&\circ\\ 
0&\times&\times&\times&\bullet&\bullet&\bullet&\circ\\ 
&0&1&2&3&4&5&6.
\end{matrix}
$$
Let $K$ be a field and $x$ and $y$ indeterminates, and set  
$$
A_n:=K\left[(x^iy^j)_{(i,j)\in G_n}\right],
$$ 
that is, $A_n$ is the sub-$K$-algebra of $K[x,y]$ generated by 
$$
\{x^iy^j\ |\ (i,j)\in G_n\}.
$$ 
Then the $A_n$ satisfy the conditions stated at the beginning of this section.

\subsection{Page 81, proof of Hilbert Basis Theorem}%

Here is a (well known) shorter proof:

Assume by contradiction some ideal %$I$ 
of $A[X]$ is \textbf{not} finitely generated, and let $f_1,f_2,\dots$ be a sequence in $A[X]$ such that the sequence $(f_1,\dots,f_i)$ of ideals of $A[X]$ increases, and $\deg f_i$ is minimum for this condition. Let $a_i$ be the leading coefficient of $f_i$; let $n$ be such that $(a_1,\dots,a_n)$ is the ideal of $A$ generated by the $a_i$; let $b_1,\dots,b_n\in A$ satisfy 
$$
a_{n+1}=a_1\,b_1+\cdots+a_n\,b_n;
$$ 
set $d(i):=\deg f_{n+1}-\deg f_i$, 
$$
g:=\sum_{i=1}^n\,X^{d(i)}\,b_i\,f_i;
$$ 
and observe that $\deg(f_{n+1}-g)$ is less than $\deg f_{n+1}$, which is impossible.

\subsection{Page 83, proof of Lemma 7.12}%

The equalities $xy=0$ and $\oo{Ann}(x^n)=\oo{Ann}(x^{n+1})$ imply $(x^n)\cap(\,y)=(0)$. Indeed, if $a$ is in $(x^n)\cap(\,y)$ we have $a=bx^n=cy$ for some $b$ and $c$ in $A$, and thus $bx^{n+1}=cyx=0$. Now $bx^{n+1}=0$ implies $bx^n=0$, that is $a=0$. 

%https://docs.google.com/document/d/1YYUDEGhoImy-b_Lx9foGoetelzzXbN1IiNbpo7pXh98/edit {comment} 180522
%\subsection{Page 89, Proposition 8.1}%\label{dt}%

Here is a related result:

\emph{The following conditions on a ring $A$ are equivalent:}

(a) \emph{the Krull dimension of $A$ is at most zero,}

(b) \emph{$A/\mf n$ is absolutely flat, where $\mf n$ is the nilradical of $A$,}

(c) \emph{for each $a$ in $A$ the descending chain $(a)\supset(a^2)\supset\cdots$ stabilizes.}

\emph{Proof.} (a)$\implies$(b): We can assume $\mf n=(0)$. Let $a$ be in $A$. It suffices to show $(a)=(a^2)$. Let $\ppp$ be a prime ideal of $A$. Then the nilradical of $A_\ppp$ is $(0)$ and $\ppp_\ppp$ is the only prime ideal of $A_\ppp$. This implies that $A_\ppp$ is a field, and we get successively the equalities 
$$
(a)_\ppp=(a^2)_\ppp,\quad(a)_\ppp/(a^2)_\ppp=(0),\quad((a)/(a^2))_\ppp=(0).
$$ 
As $\ppp$ is an arbitrary prime ideal of $A$, this forces $(a)=(a^2)$.

(b)$\implies$(c): With obvious notation we have $\overline a=\overline a^2\overline b$ for some $b$ in $A$, that is $(a-a^2b)^n=0$ for some $n\ge1$. This is easily seen to imply $a^{n+1}\in(a^n)$ and thus $(a^{n+1})=(a^n)$. 

(c)$\implies$(a): Let $\ppp$ be a prime ideal of $A$ and let $a$ be in $A\setminus\ppp$. We have $a^n(1-ab)=0$ for some $b$ in $A$ and some $n$ in $\mathbb N$. In particular $a^n(1-ab)\in\ppp$, and thus $1-ab\in\ppp$. This implies that $A/\ppp$ is a field, and therefore that $\ppp$ is maximal. $\square$

\section{About Chapter 8}%%

\subsection{Page 90}\label{90}%

$\bu$ About Proposition 8.6. I suggest the following restatement of Proposition 8.6:

\emph{Let $A$ be a Noetherian local ring, $\mf m$ its maximal ideal. Then exactly one of the following two statements is true:}

(i) $\mf m^n\ne\mf m^{n+1}$ \emph{for all $n$ and $A$ is \emph{not} Artin};

(ii) $\mf m^n=0$ \emph{for some $n$, in which case $A$ is an Artin local ring.}

In particular 
\begin{equation}\label{86}
A\text{ is Artin $\iff\mf m$ is nilpotent.}
\end{equation}%Indeed, if $A$ is Artin, then, as observed before Proposition 8.6, $\mf m$ is the nilradical of $A$, and Proposition 8.5 p.~89 implies that $\mf m$ is nilpotent. 

$\bu$ By Proposition 8.6 and Proposition 4.2 p.~51, we have:

\emph{Every proper ideal of an Artin local ring is $\mf m$-primary (where $\mf m$ is the maximal ideal).} 

This fact is implicitly used in the proof of Theorem 8.7.

$\bu$ It seems to me that the second part of the proof of Theorem 8.7 can be simplified. We must check the essential uniqueness of the decomposition of an Artin ring $A$ as a finite product of Artin local rings $A_i$. But, looking at minimal idempotents, one sees that, if a ring can be decomposed as a product of finitely many local rings, such a decomposition is essentially unique. More precisely, the kernels of the morphisms from the ring to the various factors are exactly those ideals which are maximal among the proper ideals generated by an idempotent. %To do this it suffices to observe that the kernels of the canonical projections $A\to A_i$ are precisely the minimal primary ideals of $A$.%%, for each minimal primary ideal $\mathfrak q$ of $A$, there is a unique $i$ such that $\mathfrak q$ is the kernel of the canonical projection onto $A_i$.

\subsection{Page 91, Proposition 8.8}\label{88}%

Let $A$ be an Artin local ring with maximal ideal $\mf m$ and consider the condition

$(*)$ there is an $x$ in $\mf m$ such that every ideal of $A$ is of the form $(x^r)$. 

The proof of Proposition 8.8 shows that $(*)$ is equivalent to any of the conditions (i), (ii) or (iii).

\section{About Chapter 9}%%

\subsection{Page 94, Proposition 9.2}\label{92}%

In the setting of Proposition 9.2, the condition

(v') every non-zero ideal can be written in a unique way as a power of $\mf m$

 is equivalent to any of the conditions (i) to (vi). The same holds for

(vi') there exists $x\in A$ such that every non-zero ideal can be written in a unique way as $(x^n)$.

This follows from Statement (B) in the proof of Proposition 9.2.

\subsection{Page 95}%

$\bu$ Proof of the implication (iv) $\implies$ (v) in Proposition 9.2 p.~94. It is written: ``from (8.8) (applied to $A/\mf m^n$) it follows that $\mf a$ is a power of $\mf m$''. The fact that $A/\mf m^n$ is Artin follows from Proposition 8.6 p.~90 of the book (see Section~\ref{90} p.~\pageref{90} above). %Actually it is better to use the version of (8.8) given in Section~\ref{88} above.

$\bu$ The proof of the equivalence (ii) $\iff$ (iii) in Theorem 9.3 uses Statement (B) in the proof of Proposition 9.2 p.~94.

$\bu$ Corollary 9.4. See Section~\ref{92} above.

$\bu$ The domain $\mathbb Z[-5]$ is Dedekind but doesn't have unique factorization. %The fact that $\mathbb Z[-5]$ is Dedekind follows from Theorem 5.15 p.~63 and Theorem 9.5 p.~96.???
The fact that $\mathbb Z[-5]$ doesn't have unique factorization follows from the fact that $2\cdot3$ and $$\left(1+\sqrt5\right)\left(1-\sqrt5\right)$$ are irreducible factorizations of $6$.%Indeed, it is easy to check that $2\cdot3$ and $$\left(1+\sqrt5\right)\left(1-\sqrt5\right)$$ are irreducible factorizations of $6$.

\subsection{Page 97, proof of Theorem 9.8}%

The last sentence of the proof of Theorem 9.8 is ``Then $\mf a$ is invertible, hence $\mf b=\mf a_\ppp$ is invertible by (9.7)''. I think the authors meant (9.6). Here are more details: We have $\mf b=\mf a_\ppp$ by Proposition 3.11i p.~41 and Proposition 1.17.iii p.~10 (see the proof of Proposition 7. p.~80). Moreover $\mf a_\ppp$ is invertible by Proposition 9.6 ((i) $\implies$ (ii)).

\section{About Chapter 10}%%

\subsection{Page 102, Completions 1}%

In the first paragraph after the proof of Lemma 10.1, it is written ``Two Cauchy sequences are equivalent if $x_\nu-y_\nu\to0$ in $G$''. Note that a sequence may have several limits.%The correct condition is ``the image of $x_\nu-y_\nu$ in $G/H$ tends to $0$, where $H$ is the intersection of all neighborhoods of $0$ in $G$''.

In the penultimate paragraph of p.~102 it is claimed that $\widehat f:\widehat G\to\widehat H$ is continuous, but no topologies have been defined on $\widehat G$ and $\widehat H$. It is simpler to fix this problem in the setting considered in the last paragraph of p.~102. We shall use Corollary 10.4 p.~105. Note that, in this corollary, $\widehat G_n$ really means $(G_n)^\wedge$, which can, and will, be viewed as a subgroup of $\widehat G$. 

Then these subgroups do define a topology on $\widehat G$, and the canonical morphism $c:G\to\widehat G$ is continuous and its image is dense. 

Moreover $\widehat f:\widehat G\to\widehat H$ is continuous if $f:G\to H$ is. (Here we assume that the topology of $G$ and $H$ are such that $0$ has a countable fundamental system of neighborhoods.)

%Finally, for each continuous morphism $f:G\to H$, where $H$ is complete, there is a unique continuous morphism $g:\widehat G\to H$ such that $g\circ c=f$.

\subsection{Page 103, Completions 2}%

The penultimate display is 
$$
\widehat G\simeq\varprojlim G/G_n.
$$ 
More precisely, let $\pi_i:G\to G/G_i$ be the canonical projection; let $C\subset G^{\mathbb N}$ be the group of Cauchy sequences (this is indeed easily seen to be a subgroup of $G^{\mathbb N}$); and note that $x\in G^{\mathbb N}$ is Cauchy if and only if for each $i$ the sequence $j\mapsto\pi_i(x_j)$ is eventually constant, in which case we write $\pi_i(x_\infty)$ for its eventual value. Then there is a unique group morphism 
$$
\varphi:C\to\varprojlim G/G_i
$$ 
such that $\varphi(x)_i=\pi_i(x_\infty)$ for all $x$ in $C$ and all $i$ in $\mathbb N$, this morphism is an epimorphism, and it induces an isomorphism 
$$
\widehat G\xrightarrow\sim\varprojlim G/G_i.
$$ %The proof is left to the reader.%We sketch the proof of the surjectivity of $\varphi$ and leave the rest of the proof to the reader. \dots Let $\xi$ be in $\widehat G$. 

\subsection{Page 105}%

Even if it is very easy, we give additional details about the proofs of Corollary 10.4 and Proposition 10.5. 

%In Corollary 10.3 we set $G':=G_{n_0}$. We get the exact sequence 
Setting $G':=G_{n_0}$ in Corollary 10.3 yields the exact sequence
$$
0\to\widehat{G_{n_0}}\to\widehat G\to(G/G_{n_0})\ \widehat{}\to0.
$$ 
Recall that $p:G\to G/G_{n_0}$ is the natural morphism. For $n\ge n_0$ we have $pG_n=0$. This implies $(G/G_{n_0})\ \widehat{}\simeq G/G_{n_0}$ (canonical isomorphism), and thus 
$$
\widehat G/\widehat{G_{n_0}}\simeq G/G_{n_0},
$$ 
that is, $\widehat G/\widehat{G_n}\simeq G/G_n$ for all $n$. This entails $\widehat{\widehat G\,}\simeq\widehat G$.

\subsection{Page 109, Proposition 10.15}%

Proposition 10.15 (iii) says 
\begin{equation}\label{1015a}
\mf a^n/\mf a^{n+1}\simeq\hat{\mf a}^n/\hat{\mf a}^{n+1}.
\end{equation}
Moreover \eqref{1015a} is derived from 
\begin{equation}\label{1015b}
A/\mf a^n\simeq\hat A^n/\hat{\mf a}^n,
\end{equation} 
but in the sequel \eqref{1015b} is needed at various places, and it is justified by stating that it follows from \eqref{1015a}. For instance in the proof of Proposition 10.16 it is written

``By (10.15) iii) we have $\hat A/\hat\mmm\simeq A/\mf m$''.

In fact, I think it's better to prove $\hat{\mf a}^n/\hat{\mf a}^{n+k}\simeq\mf a^n/\mf a^{n+k}$ directly by noting that we have 
$$
\hat{\mf a}^n/\hat{\mf a}^{n+k}\simeq(\mf a^n)^\wedge/(\mf a^{n+k})^\wedge\simeq(\mf a^n/\mf a^{n+k})^\wedge\simeq\mf a^n/\mf a^{n+k},
$$ 
the first isomorphism following from Proposition 10.15 (ii), the second from Corollary 10.3 p.~104, and the third being obvious.

Note that (i), (ii) and the proof of (ii) imply  
$$
(\mf a^n)^\wedge=\hat A\,\mf a^n=(\hat A\,\mf a)^n=\hat{\mf a}^n\simeq\hat A\otimes_A\mf a^n.
$$ 
In particular, the equality $(\mf a^n)^\wedge=\hat A\,\mf a^n$ shows that 
$$
\boxed{\text{the $\mf a$-topology and the $\hat{\mf a}$-topology of $\hat A$ coincide.}} 
$$
The $\mf a$-topology is finer than the $\hat{\mf a}$-topology even if $A$ is not noetherian.

\subsection{Page 111, Corollaries 10.20 and 10.21}%

About the proof of Corollary 10.20: The fact that ``an $\mf m$-primary ideal of $A$ is just any ideal contained between $\mf m$ and some power $\mf m^n$'' has already been stated as Corollary 7.16 p.~83.

About Corollary 10.21: Let $a$ be in $A$. We must show: 

$a\in\mf q$ for all $\ppp$-primary ideal $\mf q$ $\iff$ there is an $s$ in $A\setminus\ppp$ such that $as=0$. 

\begin{proof} 
If $s$ in $A\setminus\ppp$ satifies $as=0$, and if $\mf q$ is a $\ppp$-primary ideal, then $a$ is in $\mf q$.

If $as\neq0$ for all $s\in A\setminus\ppp$, then $\frac a1\neq0$, and Corollary 10.20 implies that there is a $\ppp$-primary ideal $\mf q$ such that $\frac a1\notin\mf q_\ppp$, and thus $a\notin\mf q$. 
\end{proof}

\section{About Chapter 11}%%

\subsection{Page 118, proof of Proposition 11.4}%\label{odnd}

$\bu$ The ring $A/\mf q$ is Artin by \eqref{86} p.~\pageref{86}.

$\bu$ The fact below is used on line 5 of the proof of Proposition 11.4:

\emph{A noetherian module over an Artin ring has finite length.}

This follows from Propositions 6.2 p.~75 and 6.8 p.~77.

\subsection{Page 119, old d new d}\label{odnd}%

On p. 119 it is claimed that the new $d$ evaluated on $A$ coincides with the old $d$ evaluated on $G_\mmm(A)$, the asserted equality being written $d(A)=d(G_\mmm(A))$. 

We denote the old $d$ by $d_o$ and the new $d$ by $d_\nu$, so that the equality to check becomes 
\begin{equation}\label{dd}
d_o(A)=d_\nu(G_\mmm(A)).
\end{equation}

Note that $d_o(A)$ is defined when $A$ is a noetherian graded ring, and $d_\nu(A)$ is defined when $A$ is a noetherian local ring. By Proposition 10.22 (i) p.~111, $G_{\mf a}(A)$ is a noetherian graded ring if $A$ is a noetherian ring and $\mf a$ is an ideal of $A$.

As in (1) p. 118 of the book we set $\ell_n:=\ell(A/\mf m^n)$. 

Corollary 11.5 p.~119 says that, for large $n$, the function $n\mapsto\ell_n$ is a polynomial whose degree is $d_\nu(A)$ by definition. 

Corollary 11.2 p.~117 says that, for large $n$, the function $n\mapsto\ell(\mf m^n/\mf m^{n+1})$ is a polynomial whose degree is $d_o(G_\mmm(A))-1$.

Now \eqref{dd} follows from (1) p. 117.

\subsection{Page 120, proof of Proposition 11.10}%

The claim ``$A$ is an Artin ring'' is justified by \eqref{86} p.~\pageref{86}.

\subsection{Page 121, Dimension Theorem}\label{dt}%

Here is an application of the Dimension Theorem: 

Let $K$ be a field, let $x_1,x_2,\dots$ be indeterminates, and form the $K$-algebra  $A:=K[[x_1,x_2,\dots]]$. 

Recall that $A$ can be defined as the set of expressions of the form $\sum_ua_uu$, where $u$ runs over the set monomials in $x_1,x_2,\dots$, and each $a_u$ is in $K$, the addition and multiplication being the obvious ones. 

Then $A$ is a local domain, its maximal ideal $\mathfrak m$ is defined by the condition $a_1=0$, and we claim 
\begin{equation}\label{u1a}
\boxed{A\text{ is not }\mathfrak m\text{-adically complete.}}
\end{equation}
This result is due to Uriya First and to the MathOverflow user dhy. See \\ %\smallskip

\centerline{\href{https://mathoverflow.net/a/308266/461}{https://mathoverflow.net/a/308266/461}}

We equip $A$ with the $\mf m$-adic topology.

Let $v:\mathbb Z_{>0}\to\mathbb Z_{>1}$ be strictly increasing, assume that, for all $n\in\mathbb Z_{>0}$, the characteristic of $K$ does not divide $v(n)$, and consider the sequence $(s_n)_{n\in\mathbb Z_{>0}}$ defined by $s_n=\sum_{i=1}^nx_i^{v(i)}$. This sequence being clearly Cauchy, it suffices to show that it diverges. To prove this we argue by contradiction and assume that $(s_n)$ has a limit in $A$. It is easy to see that this limit is $\sum_{n>0}x_n^{v(n)}$, and that this element of $A$ is in $\mf m^2$. Thus \eqref{u1a} will follow from 
\begin{equation}\label{u1b}
\sum_{n>0}\ x_n^{v(n)}\notin\mf m^2.
\end{equation} 
Our proof of \eqref{u1b} starts with the following claim.

%\textbf{Claim.}
$(\star)$ {\em Let $k$ and $r$ be positive integers; let $\mathfrak n$ be the maximal ideal of} 
$$
B:=K[[x_1,\dots,x_k]];
$$ 

{\em let $a_1,\dots,a_r,b_1,\dots,b_r$ be in $\mathfrak n$; set $f=\sum_{i=1}^ra_ib_i$ and $D_j:=\frac{\partial}{\partial x_j}$ for $1\le j\le k$; and assume that the ideal $(D_1f,\dots,D_kf)\subset B$ is $\mathfrak n$-primary. Then $k\le2r$.}

Proof of $(\star)$. We have 
$$
D_jf=\sum_{i=1}^r\Big((D_ja_i)\ b_i+a_i\ (D_jb_i)\Big). 
$$ 
This implies that 
$$
(D_1f,\dots,D_kf)\subset(a_1,\dots,a_r,b_1,\dots,b_r),
$$ 
and thus that $(a_1,\dots,a_r,b_1,\dots,b_r)$ is $\mathfrak n$-primary (see Corollary 7.16 p.~83 of the book). By the Examples pages 118 and 121, and by Corollary 11.19 p.~122 of the book, we have $\dim B=k$. Now the Dimension Theorem entails $k\le2r$, as desired. $\square$

Proof of \eqref{u1b}. Assume by contradiction that we have 
$$
\sum_{n>0}\ x_n^{v(n)}=\sum_{i=1}^r\ c_i\,d_i
$$ 
with $c_i,d_i\in\mf m$. Let $k$ be an integer $>2r$. Mapping $x_j$ to $0$ for $j>k$ we get 
$$
f:=\sum_{n=1}^k\ x_n^{v(n)}=\sum_{i=1}^r\ a_i\,b_i\in K[[x_1,\dots,x_k]]
$$ 
for some $a_i,b_i\in(x_1,\dots,x_k)\subset K[[x_1,\dots,x_k]]$. As $(D_1f,\dots,D_kf)$ is $(x_1,\dots,x_k)$-primary by Corollary 7.16 p.~83 of the book, this contradicts $(\star)$. $\square$

The case when $K$ is \emph{finite} is a Bourbaki exercise: Exercice 22c p. 288 in Exercices du \S2 chap. III, \textbf{Algèbre commutative}, Bourbaki, Masson, Paris 1985.

\subsection{Page 122}%

$\bu$ Proof of Corollary 11.16. The fact that $(x_1,\dots,x_r)_\ppp$ is $\ppp_\ppp$-primary follows easily from Propositions 4.8 (ii) p~53 and 4.9 p~54.

$\bu$ Proof of Proposition 11.20. The $d(?)$ are $d_o(?)$ in the notation of Section~\ref{odnd}.

\subsection{Page 123, proof of Theorem 11.22}%

I think ``by (11.20)'' should be ``by (11.21)''.

\subsection{Page 125, proof of (11.25)}%

For the last sentence of the proof, see the Examples on p.~121.

\subsection{Page 126}%% previous version https://docs.google.com/document/d/1pXphjmJVG5y2JSIiE6W0ZBNaBsdVPPTXytsjLOLYc7g/edit

We denote the Krull dimension of the ring $A$ by $\dim A$ and the height of the prime ideal $\ppp$ by $h(\ppp)$. If $\ppp$ and $\mf q$ are prime ideals of a ring $B$, we write $\ppp<\mf q$ instead of 
$$
\ppp\underset\ne\subset\mf q,
$$ 
and $\ppp_i^{\oo c}$ instead of $(\ppp_i)^{\oo c}$. 

We'll freely use the following obvious fact:

($\star$) \emph{If $\ppp_0<\cdots<\ppp_n$ is a chain of prime ideals, then} $h(\ppp_n)\ge n+h(\ppp_0)$. 

We'll also use the following fact which occurs in the hint to Exercise 11.6 p.~126 of the book:

($\star\star$) \emph{If $f:A\to A[x]$ is the natural embedding, then the fiber of} 
$$
f^*:\oo{Spec}(A[x])\to\oo{Spec}(A)
$$ 
\emph{over a prime ideal $\ppp$ of $A$ is order isomorphic to the spectrum of} 
$$
k\otimes_AA[x]\simeq k[x],
$$ 
\emph{where $k$ is the residue field at} $\ppp$.

\subsection{Exercise 11.6}%

For Exercise 3.21iv p.~47 of the book see Section~\ref{321iv} p.~\pageref{321iv} above. 

For Exercise 4.7 p.~55 of the book see Section~\ref{5547} p.~\pageref{5547} above.

\emph{Proof of the inequality} $\dim A[x]\ge1+\dim A$: If 
$
\ppp_0<\dots<\ppp_n
$ 
is a chain of prime ideals in $A$, then 
$$
\ppp_0[x]<\dots<\ppp_n[x]<(\ppp,x)
$$ 
is chain of prime ideals in $A[x].\ \square$

\emph{Proof of the inequality} $\dim A[x]\le1+2\dim A$: Statement ($\star\star$) above implies that, for any chain $\ppp_0<\ppp_1<\ppp_2$ of prime ideals in $A[x]$, we have:

$\bullet$ if $\ppp_0^{\oo c}=\ppp_1^{\oo c}$ then $\ppp_0=\ppp_0^{\oo c}[x]$ and $\ppp_1^{\oo c}<\ppp_2^{\oo c}$,

$\bullet$ if $\ppp_1^{\oo c}=\ppp_2^{\oo c}$ then $\ppp_1=\ppp_1^{\oo c}[x]$ and $\ppp_0^{\oo c}<\ppp_1^{\oo c}$.

This implies that a chain of length $\ell$ in $A[x]$ contracts to a chain of length at least $\lfloor\ell/2\rfloor$ in $A$. Hence 
$$
\left\lfloor\frac{\dim A[x]}2\right\rfloor\le\dim A,
$$ 
that is,
$$
\frac{\dim A[x]}2\le\frac12+\dim A.\ \square
$$

\subsection{Exercise 11.7}%

$\bullet$ Second sentence of the hint: see Proposition 11.13 p.~121 of the book. 

$\bullet$ Inequality $\oo{height }\ppp[x]\le m$: see Corollary 11.16 p.~121 of the book.

$\bullet$ Inequality $\dim A[x]\le1+\dim A$ (last sentence of the hint). 

%We denote the height of the prime ideal $\ppp$ by $h(\ppp)$.

%We give two proofs of the inequality $\dim A[x]\le1+\dim A$.

\emph{Proof.} We can assume $\dim A<\infty$. Set $n:=\dim A$ and let 
$ 
\ppp_0<\cdots<\ppp_{n+2}
$ 
be a chain of prime ideals in $A[x]$ of length $n+2$. It suffices to derive a contradiction from this assumption. 

The above chain contracting to a chain of length at most $n$ in $A$, there are indices $i$ such that $\ppp_i^{\oo c}=\ppp_{i+1}^{\oo c}$. Let $i$ be the largest such index. We have $\ppp_i=\ppp_i^{\oo c}[x]$ by ($\star\star$), and $h(\ppp_i^{\oo c})=h(\ppp_i)\ge i$ by ($\star$). Using again ($\star$) we get  
%and $\ppp_i=\ppp_i^{\oo c}[x]$ by ($\star$), and thus $h(\ppp_i^{\oo c})=h(\ppp_i)\ge i$. This implies
$$
h(\ppp_{n+2}^{\oo c})\ge n+1-i+h(\ppp_i^{\oo c})\ge n+1,
$$ 
which is impossible. $\square$

\section{Questions}%%

Let $A$ be a ring, and let $M,N,P$ be $A$-modules.

%\begin{qn}Assume $M\otimes_AN=0$ and $N\ne0$. Is there a nonzero \emph{finitely generated} $A$-module $P$ such that $M\otimes_AP=0\ $?\end{qn}

%\begin{qn}$A$ has only finitely many minimal primes $\implies\ (0)$ is decomposable\ ?\end{qn}

\begin{qn}
Consider the following conditions on a ring $A$:

\begin{enumerate}
\item\label{noe} $A$ is noetherian.
\item\label{dec} Each ideal of $A$ is decomposable.
\item\label{fmm} Each ideal of $A$ has only finitely many minimal primes over it.
\item\label{ip} Each irreducible ideal of $A$ is primary.
\item\label{fii} Each ideal of $A$ is a finite intersection of irreducible ideals.
\end{enumerate}

It is well known that item~\ref{noe} implies items \ref{dec}, \ref{fmm}, \ref{ip} and \ref{fii}.%It is well known that item \ref{noe} implies item \ref{dec}, item \ref{fmm}, item \ref{ip} and item \ref{fii}. 

What are the implications between these conditions?
\end{qn}

The ideal would be to find a ring which satisfies items \ref{dec}, \ref{fmm}, \ref{ip} and \ref{fii}, but not item \ref{noe}.%The ideal would be to find a ring which satisfies item \ref{dec}, item \ref{fmm}, item \ref{ip} and item \ref{fii}, but not item \ref{noe}.

[About items \ref{fmm} and \ref{dec}, see Section~\ref{di} p.~\pageref{di}.]

About item \ref{ip}: There are rings in which $(0)$ is irreducible but not primary: see 

\href{https://mathoverflow.net/q/185739/461}{https://mathoverflow.net/q/185739/461}. 

In fact, the following statement is easy to check. Let $A$ be a domain which is not a field, let $K$ be its field of fractions, form the $A$-module $B:=A\oplus K/A$ and define a multiplication on $B$ by $$(a,\alpha)(b,\beta)=(ab,a\beta+b\alpha).$$ Then $B$ is a commutative ring in which the zero ideal is irreducible but not primary. 

\end{document}%\overset?\implies

http://www.iecl.univ-lorraine.fr/~Pierre-Yves.Gaillard/DIVERS/Atiyah-MacDonald/Atiyah_MacDonald_a.pdf - https://app.box.com/s/xds73ntdm111fo36qhod - https://www.mediafire.com/folder/mtgw19tn7aefy/Atiyah_MacDonald - https://www.dropbox.com/sh/u0o5u9m7qxaujtw/AAADHlB7_qXeC5sQFysIUgGta?dl=0 - https://mega.co.nz/#F!KEBCzZxa!DO9J4U98neAjQISi8eazMQ

%

\begin{enumerate}
%\item $(0)$ irreducible $\implies\ (0)$ primary\ ? (True if $A$ is noetherian.)
%\item $(0)$ primary $\implies\ (0)$ irreducible\ ?
%\item $(0)$ primary and $A$ noetherian $\implies\ (0)$ irreducible\ ?
\item $A$ has only finitely many minimal primes $\implies\ (0)$ is decomposable\ ?
\item Each ideal is decomposable $\implies\ A$ noetherian\ ?
\item Each ideal has only finitely many minimal primes over it $\implies\ A$ noetherian\ ?
%\item Is a primary contracted ideal the contraction of a primary ideal? (See Section~\ref{cpi} p.~\pageref{cpi}.)
\item\label{ip} All irreducible ideals are primary $\implies\ A$ noetherian\ ?
%\item Is there an ideal which is not a finite intersection of irreducible ideals? 
\item Assume that each ideal of $A$ is a finite intersection of irreducible ideals. Is $A$ necessarily noetherian?
\end{enumerate}
